import"./chunk-4KI5XNAT.js";import{a as so,f as uh}from"./chunk-F75AY6IO.js";import{$ as Mr,$a as Ra,$b as hs,A as q0,Aa as wg,Ab as Dg,Ac as zg,B as Zs,Ba as bg,Bb as hl,Bc as ch,C as cg,Ca as Cg,Cb as dl,Cc as jg,D as Oa,Da as Eg,Db as pl,E as Js,Ea as us,Eb as ta,F as Fa,Fa as th,Fb as ot,G as X0,Ga as Sg,Gb as fs,H as ug,Ha as Tg,Hb as gt,I as fg,Ia as fl,Ib as Hr,J as Vi,Ja as S,Jb as io,K as ai,Ka as ce,Kb as cu,L as mn,La as rh,Lb as Rg,M as hg,Ma as iu,Mb as Mg,N as tn,Na as Ig,Nb as Ng,O as ru,Oa as au,Ob as rn,P as Jt,Pa as Nr,Pb as uu,Q as ea,Qa as no,Qb as fu,R as dt,Ra as nh,Rb as sh,S as ct,Sa as Sr,Sb as hu,T as dg,Ta as Lt,Tb as oh,U as Kt,Ua as Qt,Ub as Pg,V as Q0,Va as kg,Vb as hr,W as Mt,Wa as Ag,Wb as Lg,X as $e,Xa as Y,Xb as Bg,Y as ul,Ya as ee,Yb as Se,Z as Fe,Za as b,Zb as tr,_ as ut,_a as Og,_b as si,a as rg,aa as cs,ab as Fg,ac as Vg,b as ng,ba as pg,bb as Ve,bc as ao,c as z0,ca as eo,cb as ih,cc as Ug,d as j0,da as bi,db as ah,dc as $g,e as G0,ea as Da,eb as su,ec as Ut,f as Rt,fa as _e,fb as ou,fc as du,g as _r,ga as xe,gb as z,gc as pu,h as os,ha as er,hb as j,hc as dr,i as Aa,ia as Pt,ib as ue,ic as oi,j as Tn,ja as Y0,jb as Ye,jc as yr,k as at,ka as nu,kb as Ze,kc as or,l as ll,la as Be,lb as st,lc as wr,m as ig,ma as fr,mb as nt,mc as Et,n as ag,na as Z0,nb as Pe,nc as Wg,o as en,oa as qt,ob as P,oc as qr,p as Ue,pa as mg,pb as Pr,pc as mu,q as cl,qa as J0,qb as xr,qc as gu,r as ir,ra as gg,rb as lu,s as sg,sa as Er,sb as ar,t as K0,ta as vg,tb as At,tc as ds,u as og,ua as eh,ub as je,uc as ra,v as lg,va as to,vb as Ge,w as Qs,wa as ro,wb as sr,wc as Ui,x as Qe,xa as _g,xb as Ct,xc as Hg,y as Ys,ya as xg,yb as Tr,yc as $i,z as ls,za as yg,zb as Ma,zc as lh}from"./chunk-DXILEW5Z.js";import{a as ie,b as ze,h as Z}from"./chunk-TJICSKBO.js";var gl=class{},_u=class{},na=class e{constructor(r){this.normalizedNames=new Map,this.lazyUpdate=null,r?typeof r=="string"?this.lazyInit=()=>{this.headers=new Map,r.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let i=t.slice(0,n),a=i.toLowerCase(),s=t.slice(n+1).trim();this.maybeSetNormalizedName(i,a),this.headers.has(a)?this.headers.get(a).push(s):this.headers.set(a,[s])}})}:typeof Headers<"u"&&r instanceof Headers?(this.headers=new Map,r.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(r).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(r){return this.init(),this.headers.has(r.toLowerCase())}get(r){this.init();let t=this.headers.get(r.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(r){return this.init(),this.headers.get(r.toLowerCase())||null}append(r,t){return this.clone({name:r,value:t,op:"a"})}set(r,t){return this.clone({name:r,value:t,op:"s"})}delete(r,t){return this.clone({name:r,value:t,op:"d"})}maybeSetNormalizedName(r,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,r)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(r=>this.applyUpdate(r)),this.lazyUpdate=null))}copyFrom(r){r.init(),Array.from(r.headers.keys()).forEach(t=>{this.headers.set(t,r.headers.get(t)),this.normalizedNames.set(t,r.normalizedNames.get(t))})}clone(r){let t=new e;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([r]),t}applyUpdate(r){let t=r.name.toLowerCase();switch(r.op){case"a":case"s":let n=r.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(r.name,t);let i=(r.op==="a"?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":let a=r.value;if(!a)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(o=>a.indexOf(o)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}setHeaderEntries(r,t){let n=(Array.isArray(t)?t:[t]).map(a=>a.toString()),i=r.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(r,i)}forEach(r){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>r(this.normalizedNames.get(t),this.headers.get(t)))}};var hh=class{encodeKey(r){return Gg(r)}encodeValue(r){return Gg(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}};function NC(e,r){let t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(i=>{let a=i.indexOf("="),[s,o]=a==-1?[r.decodeKey(i),""]:[r.decodeKey(i.slice(0,a)),r.decodeValue(i.slice(a+1))],l=t.get(s)||[];l.push(o),t.set(s,l)}),t}var PC=/%(\d[a-f0-9])/gi,LC={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Gg(e){return encodeURIComponent(e).replace(PC,(r,t)=>LC[t]??r)}function vu(e){return`${e}`}var Pa=class e{constructor(r={}){if(this.updates=null,this.cloneFrom=null,this.encoder=r.encoder||new hh,r.fromString){if(r.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=NC(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach(t=>{let n=r.fromObject[t],i=Array.isArray(n)?n.map(vu):[vu(n)];this.map.set(t,i)})):this.map=null}has(r){return this.init(),this.map.has(r)}get(r){this.init();let t=this.map.get(r);return t?t[0]:null}getAll(r){return this.init(),this.map.get(r)||null}keys(){return this.init(),Array.from(this.map.keys())}append(r,t){return this.clone({param:r,value:t,op:"a"})}appendAll(r){let t=[];return Object.keys(r).forEach(n=>{let i=r[n];Array.isArray(i)?i.forEach(a=>{t.push({param:n,value:a,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(r,t){return this.clone({param:r,value:t,op:"s"})}delete(r,t){return this.clone({param:r,value:t,op:"d"})}toString(){return this.init(),this.keys().map(r=>{let t=this.encoder.encodeKey(r);return this.map.get(r).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(r=>r!=="").join("&")}clone(r){let t=new e({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(r),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(r=>this.map.set(r,this.cloneFrom.map.get(r))),this.updates.forEach(r=>{switch(r.op){case"a":case"s":let t=(r.op==="a"?this.map.get(r.param):void 0)||[];t.push(vu(r.value)),this.map.set(r.param,t);break;case"d":if(r.value!==void 0){let n=this.map.get(r.param)||[],i=n.indexOf(vu(r.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(r.param,n):this.map.delete(r.param)}else{this.map.delete(r.param);break}}}),this.cloneFrom=this.updates=null)}};var dh=class{constructor(){this.map=new Map}set(r,t){return this.map.set(r,t),this}get(r){return this.map.has(r)||this.map.set(r,r.defaultValue()),this.map.get(r)}delete(r){return this.map.delete(r),this}has(r){return this.map.has(r)}keys(){return this.map.keys()}};function BC(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Kg(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function qg(e){return typeof Blob<"u"&&e instanceof Blob}function Xg(e){return typeof FormData<"u"&&e instanceof FormData}function VC(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var ml=class e{constructor(r,t,n,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=r.toUpperCase();let a;if(BC(this.method)||i?(this.body=n!==void 0?n:null,a=i):a=n,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params),this.transferCache=a.transferCache),this.headers??=new na,this.context??=new dh,!this.params)this.params=new Pa,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let o=t.indexOf("?"),l=o===-1?"?":o<t.length-1?"&":"";this.urlWithParams=t+l+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Kg(this.body)||qg(this.body)||Xg(this.body)||VC(this.body)?this.body:this.body instanceof Pa?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Xg(this.body)?null:qg(this.body)?this.body.type||null:Kg(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Pa?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(r={}){let t=r.method||this.method,n=r.url||this.url,i=r.responseType||this.responseType,a=r.transferCache??this.transferCache,s=r.body!==void 0?r.body:this.body,o=r.withCredentials??this.withCredentials,l=r.reportProgress??this.reportProgress,c=r.headers||this.headers,u=r.params||this.params,f=r.context??this.context;return r.setHeaders!==void 0&&(c=Object.keys(r.setHeaders).reduce((h,d)=>h.set(d,r.setHeaders[d]),c)),r.setParams&&(u=Object.keys(r.setParams).reduce((h,d)=>h.set(d,r.setParams[d]),u)),new e(t,n,s,{params:u,headers:c,context:f,reportProgress:l,responseType:i,withCredentials:o,transferCache:a})}},li=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(li||{}),vl=class{constructor(r,t=200,n="OK"){this.headers=r.headers||new na,this.status=r.status!==void 0?r.status:t,this.statusText=r.statusText||n,this.url=r.url||null,this.ok=this.status>=200&&this.status<300}},xu=class e extends vl{constructor(r={}){super(r),this.type=li.ResponseHeader}clone(r={}){return new e({headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},_l=class e extends vl{constructor(r={}){super(r),this.type=li.Response,this.body=r.body!==void 0?r.body:null}clone(r={}){return new e({body:r.body!==void 0?r.body:this.body,headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},Na=class extends vl{constructor(r){super(r,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${r.url||"(unknown url)"}`:this.message=`Http failure response for ${r.url||"(unknown url)"}: ${r.status} ${r.statusText}`,this.error=r.error||null}},Jg=200,UC=204;function fh(e,r){return{body:r,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var xl=(()=>{let r=class r{constructor(n){this.handler=n}request(n,i,a={}){let s;if(n instanceof ml)s=n;else{let c;a.headers instanceof na?c=a.headers:c=new na(a.headers);let u;a.params&&(a.params instanceof Pa?u=a.params:u=new Pa({fromObject:a.params})),s=new ml(n,i,a.body!==void 0?a.body:null,{headers:c,context:a.context,params:u,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials,transferCache:a.transferCache})}let o=at(s).pipe(ls(c=>this.handler.handle(c)));if(n instanceof ml||a.observe==="events")return o;let l=o.pipe(Qe(c=>c instanceof _l));switch(a.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(Ue(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(Ue(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(Ue(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(Ue(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${a.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new Pa().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,a={}){return this.request("PATCH",n,fh(a,i))}post(n,i,a={}){return this.request("POST",n,fh(a,i))}put(n,i,a={}){return this.request("PUT",n,fh(a,i))}};r.\u0275fac=function(i){return new(i||r)(Mt(gl))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),$C=/^\)\]\}',?\n/,WC="X-Request-URL";function Qg(e){if(e.url)return e.url;let r=WC.toLocaleLowerCase();return e.headers.get(r)}var HC=(()=>{let r=class r{constructor(){this.fetchImpl=$e(ph,{optional:!0})?.fetch??((...n)=>globalThis.fetch(...n)),this.ngZone=$e(fr)}handle(n){return new z0(i=>{let a=new AbortController;return this.doRequest(n,a.signal,i).then(mh,s=>i.error(new Na({error:s}))),()=>a.abort()})}doRequest(n,i,a){return Z(this,null,function*(){let s=this.createRequestInit(n),o;try{let g=this.ngZone.runOutsideAngular(()=>this.fetchImpl(n.urlWithParams,ie({signal:i},s)));zC(g),a.next({type:li.Sent}),o=yield g}catch(g){a.error(new Na({error:g,status:g.status??0,statusText:g.statusText,url:n.urlWithParams,headers:g.headers}));return}let l=new na(o.headers),c=o.statusText,u=Qg(o)??n.urlWithParams,f=o.status,h=null;if(n.reportProgress&&a.next(new xu({headers:l,status:f,statusText:c,url:u})),o.body){let g=o.headers.get("content-length"),v=[],p=o.body.getReader(),m=0,x,_,w=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Z(this,null,function*(){for(;;){let{done:U,value:F}=yield p.read();if(U)break;if(v.push(F),m+=F.length,n.reportProgress){_=n.responseType==="text"?(_??"")+(x??=new TextDecoder).decode(F,{stream:!0}):void 0;let R=()=>a.next({type:li.DownloadProgress,total:g?+g:void 0,loaded:m,partialText:_});w?w.run(R):R()}}}));let D=this.concatChunks(v,m);try{let U=o.headers.get("Content-Type")??"";h=this.parseBody(n,D,U)}catch(U){a.error(new Na({error:U,headers:new na(o.headers),status:o.status,statusText:o.statusText,url:Qg(o)??n.urlWithParams}));return}}f===0&&(f=h?Jg:0),f>=200&&f<300?(a.next(new _l({body:h,headers:l,status:f,statusText:c,url:u})),a.complete()):a.error(new Na({error:h,headers:l,status:f,statusText:c,url:u}))})}parseBody(n,i,a){switch(n.responseType){case"json":let s=new TextDecoder().decode(i).replace($C,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:a});case"arraybuffer":return i.buffer}}createRequestInit(n){let i={},a=n.withCredentials?"include":void 0;if(n.headers.forEach((s,o)=>i[s]=o.join(",")),n.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!n.headers.has("Content-Type")){let s=n.detectContentTypeHeader();s!==null&&(i["Content-Type"]=s)}return{body:n.serializeBody(),method:n.method,headers:i,credentials:a}}concatChunks(n,i){let a=new Uint8Array(i),s=0;for(let o of n)a.set(o,s),s+=o.length;return a}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),ph=class{};function mh(){}function zC(e){e.then(mh,mh)}function jC(e,r){return r(e)}function GC(e,r,t){return(n,i)=>bi(t,()=>r(n,a=>e(a,i)))}var e1=new Kt(""),KC=new Kt(""),qC=new Kt("",{providedIn:"root",factory:()=>!0});var Yg=(()=>{let r=class r extends gl{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=$e(nu),this.contributeToStability=$e(qC)}handle(n){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(e1),...this.injector.get(KC,[])]));this.chain=i.reduceRight((a,s)=>GC(a,s,this.injector),jC)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(n,a=>this.backend.handle(a)).pipe(Js(()=>this.pendingTasks.remove(i)))}else return this.chain(n,i=>this.backend.handle(i))}};r.\u0275fac=function(i){return new(i||r)(Mt(_u),Mt(eo))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})();var XC=/^\)\]\}',?\n/;function QC(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}var Zg=(()=>{let r=class r{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new Jt(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Tn(i.\u0275loadImpl()):at(null)).pipe(mn(()=>new z0(s=>{let o=i.build();if(o.open(n.method,n.urlWithParams),n.withCredentials&&(o.withCredentials=!0),n.headers.forEach((p,m)=>o.setRequestHeader(p,m.join(","))),n.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let p=n.detectContentTypeHeader();p!==null&&o.setRequestHeader("Content-Type",p)}if(n.responseType){let p=n.responseType.toLowerCase();o.responseType=p!=="json"?p:"text"}let l=n.serializeBody(),c=null,u=()=>{if(c!==null)return c;let p=o.statusText||"OK",m=new na(o.getAllResponseHeaders()),x=QC(o)||n.url;return c=new xu({headers:m,status:o.status,statusText:p,url:x}),c},f=()=>{let{headers:p,status:m,statusText:x,url:_}=u(),w=null;m!==UC&&(w=typeof o.response>"u"?o.responseText:o.response),m===0&&(m=w?Jg:0);let D=m>=200&&m<300;if(n.responseType==="json"&&typeof w=="string"){let U=w;w=w.replace(XC,"");try{w=w!==""?JSON.parse(w):null}catch(F){w=U,D&&(D=!1,w={error:F,text:w})}}D?(s.next(new _l({body:w,headers:p,status:m,statusText:x,url:_||void 0})),s.complete()):s.error(new Na({error:w,headers:p,status:m,statusText:x,url:_||void 0}))},h=p=>{let{url:m}=u(),x=new Na({error:p,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(x)},d=!1,g=p=>{d||(s.next(u()),d=!0);let m={type:li.DownloadProgress,loaded:p.loaded};p.lengthComputable&&(m.total=p.total),n.responseType==="text"&&o.responseText&&(m.partialText=o.responseText),s.next(m)},v=p=>{let m={type:li.UploadProgress,loaded:p.loaded};p.lengthComputable&&(m.total=p.total),s.next(m)};return o.addEventListener("load",f),o.addEventListener("error",h),o.addEventListener("timeout",h),o.addEventListener("abort",h),n.reportProgress&&(o.addEventListener("progress",g),l!==null&&o.upload&&o.upload.addEventListener("progress",v)),o.send(l),s.next({type:li.Sent}),()=>{o.removeEventListener("error",h),o.removeEventListener("abort",h),o.removeEventListener("load",f),o.removeEventListener("timeout",h),n.reportProgress&&(o.removeEventListener("progress",g),l!==null&&o.upload&&o.upload.removeEventListener("progress",v)),o.readyState!==o.DONE&&o.abort()}})))}};r.\u0275fac=function(i){return new(i||r)(Mt(gu))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),t1=new Kt(""),YC="XSRF-TOKEN",ZC=new Kt("",{providedIn:"root",factory:()=>YC}),JC="X-XSRF-TOKEN",eE=new Kt("",{providedIn:"root",factory:()=>JC}),yu=class{},tE=(()=>{let r=class r{constructor(n,i,a){this.doc=n,this.platform=i,this.cookieName=a,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=pu(n,this.cookieName),this.lastCookieString=n),this.lastToken}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut),Mt(Er),Mt(ZC))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})();function rE(e,r){let t=e.url.toLowerCase();if(!$e(t1)||e.method==="GET"||e.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return r(e);let n=$e(yu).getToken(),i=$e(eE);return n!=null&&!e.headers.has(i)&&(e=e.clone({headers:e.headers.set(i,n)})),r(e)}function r1(...e){let r=[xl,Zg,Yg,{provide:gl,useExisting:Yg},{provide:_u,useFactory:()=>$e(HC,{optional:!0})??$e(Zg)},{provide:e1,useValue:rE,multi:!0},{provide:t1,useValue:!0},{provide:yu,useClass:tE}];for(let t of e)r.push(...t.\u0275providers);return cs(r)}var _h=class extends $g{constructor(){super(...arguments),this.supportsDOMEvents=!0}},xh=class e extends _h{static makeCurrent(){Ug(new e)}onAndCancel(r,t,n){return r.addEventListener(t,n),()=>{r.removeEventListener(t,n)}}dispatchEvent(r,t){r.dispatchEvent(t)}remove(r){r.remove()}createElement(r,t){return t=t||this.getDefaultDocument(),t.createElement(r)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(r){return r.nodeType===Node.ELEMENT_NODE}isShadowRoot(r){return r instanceof DocumentFragment}getGlobalEventTarget(r,t){return t==="window"?window:t==="document"?r:t==="body"?r.body:null}getBaseHref(r){let t=aE();return t==null?null:sE(t)}resetBaseElement(){yl=null}getUserAgent(){return window.navigator.userAgent}getCookie(r){return pu(document.cookie,r)}},yl=null;function aE(){return yl=yl||document.querySelector("base"),yl?yl.getAttribute("href"):null}function sE(e){return new URL(e,document.baseURI).pathname}var oE=(()=>{let r=class r{build(){return new XMLHttpRequest}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),wu=new Kt(""),o1=(()=>{let r=class r{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(a=>{a.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,a){return this._findPluginFor(i).addEventListener(n,i,a)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new Jt(5101,!1);return this._eventNameToPlugin.set(n,i),i}};r.\u0275fac=function(i){return new(i||r)(Mt(wu),Mt(fr))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),wl=class{constructor(r){this._doc=r}},gh="ng-app-id",l1=(()=>{let r=class r{constructor(n,i,a,s={}){this.doc=n,this.appId=i,this.nonce=a,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=mu(s),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(a=>a.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${gh}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(a=>{a.textContent!=null&&i.set(a.textContent,a)}),i}return null}changeUsageCount(n,i){let a=this.styleRef;if(a.has(n)){let s=a.get(n);return s.usage+=i,s.usage}return a.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let a=this.styleNodesInDOM,s=a?.get(i);if(s?.parentNode===n)return a.delete(i),s.removeAttribute(gh),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(gh,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){let a=this.getStyleElement(n,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(a):s.set(i,{elements:[a],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut),Mt(J0),Mt(eh,8),Mt(Er))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),vh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},wh=/%COMP%/g,c1="%COMP%",lE=`_nghost-${c1}`,cE=`_ngcontent-${c1}`,uE=!0,fE=new Kt("",{providedIn:"root",factory:()=>uE});function hE(e){return cE.replace(wh,e)}function dE(e){return lE.replace(wh,e)}function u1(e,r){return r.map(t=>t.replace(wh,e))}var bu=(()=>{let r=class r{constructor(n,i,a,s,o,l,c,u=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=a,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=l,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=mu(l),this.defaultRenderer=new bl(n,o,c,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ul.ShadowDom&&(i=ze(ie({},i),{encapsulation:ul.Emulated}));let a=this.getOrCreateRenderer(n,i);return a instanceof Cu?a.applyToHost(n):a instanceof Cl&&a.applyStyles(),a}getOrCreateRenderer(n,i){let a=this.rendererByCompId,s=a.get(i.id);if(!s){let o=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case ul.Emulated:s=new Cu(c,u,i,this.appId,f,o,l,h);break;case ul.ShadowDom:return new yh(c,u,n,i,o,l,this.nonce,h);default:s=new Cl(c,u,i,f,o,l,h);break}a.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};r.\u0275fac=function(i){return new(i||r)(Mt(o1),Mt(l1),Mt(J0),Mt(fE),Mt(Ut),Mt(Er),Mt(fr),Mt(eh))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),bl=class{constructor(r,t,n,i){this.eventManager=r,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(r,t){return t?this.doc.createElementNS(vh[t]||t,r):this.doc.createElement(r)}createComment(r){return this.doc.createComment(r)}createText(r){return this.doc.createTextNode(r)}appendChild(r,t){(i1(r)?r.content:r).appendChild(t)}insertBefore(r,t,n){r&&(i1(r)?r.content:r).insertBefore(t,n)}removeChild(r,t){t.remove()}selectRootElement(r,t){let n=typeof r=="string"?this.doc.querySelector(r):r;if(!n)throw new Jt(-5104,!1);return t||(n.textContent=""),n}parentNode(r){return r.parentNode}nextSibling(r){return r.nextSibling}setAttribute(r,t,n,i){if(i){t=i+":"+t;let a=vh[i];a?r.setAttributeNS(a,t,n):r.setAttribute(t,n)}else r.setAttribute(t,n)}removeAttribute(r,t,n){if(n){let i=vh[n];i?r.removeAttributeNS(i,t):r.removeAttribute(`${n}:${t}`)}else r.removeAttribute(t)}addClass(r,t){r.classList.add(t)}removeClass(r,t){r.classList.remove(t)}setStyle(r,t,n,i){i&(fl.DashCase|fl.Important)?r.style.setProperty(t,n,i&fl.Important?"important":""):r.style[t]=n}removeStyle(r,t,n){n&fl.DashCase?r.style.removeProperty(t):r.style[t]=""}setProperty(r,t,n){r!=null&&(r[t]=n)}setValue(r,t){r.nodeValue=t}listen(r,t,n){if(typeof r=="string"&&(r=ao().getGlobalEventTarget(this.doc,r),!r))throw new Error(`Unsupported event target ${r} for event ${t}`);return this.eventManager.addEventListener(r,t,this.decoratePreventDefault(n))}decoratePreventDefault(r){return t=>{if(t==="__ngUnwrap__")return r;(this.platformIsServer?this.ngZone.runGuarded(()=>r(t)):r(t))===!1&&t.preventDefault()}}};function i1(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var yh=class extends bl{constructor(r,t,n,i,a,s,o,l){super(r,a,s,l),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=u1(i.id,i.styles);for(let u of c){let f=document.createElement("style");o&&f.setAttribute("nonce",o),f.textContent=u,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(r){return r===this.hostEl?this.shadowRoot:r}appendChild(r,t){return super.appendChild(this.nodeOrShadowRoot(r),t)}insertBefore(r,t,n){return super.insertBefore(this.nodeOrShadowRoot(r),t,n)}removeChild(r,t){return super.removeChild(null,t)}parentNode(r){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(r)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Cl=class extends bl{constructor(r,t,n,i,a,s,o,l){super(r,a,s,o),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?u1(l,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Cu=class extends Cl{constructor(r,t,n,i,a,s,o,l){let c=i+"-"+n.id;super(r,t,n,a,s,o,l,c),this.contentAttr=hE(c),this.hostAttr=dE(c)}applyToHost(r){this.applyStyles(),this.setAttribute(r,this.hostAttr,"")}createElement(r,t){let n=super.createElement(r,t);return super.setAttribute(n,this.contentAttr,""),n}},pE=(()=>{let r=class r extends wl{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,a){return n.addEventListener(i,a,!1),()=>this.removeEventListener(n,i,a)}removeEventListener(n,i,a){return n.removeEventListener(i,a)}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),mE=(()=>{let r=class r extends wl{constructor(n){super(n),this.delegate=$e(Bg,{optional:!0})}supports(n){return this.delegate?this.delegate.supports(n):!1}addEventListener(n,i,a){return this.delegate.addEventListener(n,i,a)}removeEventListener(n,i,a){return this.delegate.removeEventListener(n,i,a)}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),a1=["alt","control","meta","shift"],gE={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},vE={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},_E=(()=>{let r=class r extends wl{constructor(n){super(n)}supports(n){return r.parseEventName(n)!=null}addEventListener(n,i,a){let s=r.parseEventName(i),o=r.eventCallback(s.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ao().onAndCancel(n,s.domEventName,o))}static parseEventName(n){let i=n.toLowerCase().split("."),a=i.shift();if(i.length===0||!(a==="keydown"||a==="keyup"))return null;let s=r._normalizeKey(i.pop()),o="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),o="code."),a1.forEach(u=>{let f=i.indexOf(u);f>-1&&(i.splice(f,1),o+=u+".")}),o+=s,i.length!=0||s.length===0)return null;let c={};return c.domEventName=a,c.fullKey=o,c}static matchEventFullKeyCode(n,i){let a=gE[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(a=n.code,s="code."),a==null||!a?!1:(a=a.toLowerCase(),a===" "?a="space":a==="."&&(a="dot"),a1.forEach(o=>{if(o!==a){let l=vE[o];l(n)&&(s+=o+".")}}),s+=a,s===i)}static eventCallback(n,i,a){return s=>{r.matchEventFullKeyCode(s,n)&&a.runGuarded(()=>i(s))}}static _normalizeKey(n){return n==="esc"?"escape":n}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut))},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})();function f1(e,r){return Lg(ie({rootComponent:e},xE(r)))}function xE(e){return{appProviders:[...EE,...e?.providers??[]],platformProviders:CE}}function yE(){xh.makeCurrent()}function wE(){return new Z0}function bE(){return mg(document),document}var CE=[{provide:Er,useValue:Wg},{provide:gg,useValue:yE,multi:!0},{provide:Ut,useFactory:bE,deps:[]}];var EE=[{provide:pg,useValue:"root"},{provide:Z0,useFactory:wE,deps:[]},{provide:wu,useClass:pE,multi:!0,deps:[Ut,fr,Er]},{provide:wu,useClass:_E,multi:!0,deps:[Ut]},{provide:wu,useClass:mE,multi:!0},bu,l1,o1,{provide:au,useExisting:bu},{provide:gu,useClass:oE,deps:[]},[]];var h1=(()=>{let r=class r{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut))},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var bh=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:function(i){let a=null;return i?a=new(i||r):a=Mt(SE),a},providedIn:"root"});let e=r;return e})(),SE=(()=>{let r=class r extends bh{constructor(n){super(),this._doc=n}sanitize(n,i){if(i==null)return null;switch(n){case us.NONE:return i;case us.HTML:return ro(i,"HTML")?to(i):Eg(this._doc,String(i)).toString();case us.STYLE:return ro(i,"Style")?to(i):i;case us.SCRIPT:if(ro(i,"Script"))return to(i);throw new Jt(5200,!1);case us.URL:return ro(i,"URL")?to(i):Cg(String(i));case us.RESOURCE_URL:if(ro(i,"ResourceURL"))return to(i);throw new Jt(5201,!1);default:throw new Jt(5202,!1)}}bypassSecurityTrustHtml(n){return _g(n)}bypassSecurityTrustStyle(n){return xg(n)}bypassSecurityTrustScript(n){return yg(n)}bypassSecurityTrustUrl(n){return wg(n)}bypassSecurityTrustResourceUrl(n){return bg(n)}};r.\u0275fac=function(i){return new(i||r)(Mt(Ut))},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var mt="primary",Ul=Symbol("RouteTitle"),Ih=class{constructor(r){this.params=r||{}}has(r){return Object.prototype.hasOwnProperty.call(this.params,r)}get(r){if(this.has(r)){let t=this.params[r];return Array.isArray(t)?t[0]:t}return null}getAll(r){if(this.has(r)){let t=this.params[r];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ho(e){return new Ih(e)}function TE(e,r,t){let n=t.path.split("/");if(n.length>e.length||t.pathMatch==="full"&&(r.hasChildren()||n.length<e.length))return null;let i={};for(let a=0;a<n.length;a++){let s=n[a],o=e[a];if(s[0]===":")i[s.substring(1)]=o;else if(s!==o.path)return null}return{consumed:e.slice(0,n.length),posParams:i}}function IE(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;++t)if(!Wi(e[t],r[t]))return!1;return!0}function Wi(e,r){let t=e?kh(e):void 0,n=r?kh(r):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!w1(e[i],r[i]))return!1;return!0}function kh(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function w1(e,r){if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return!1;let t=[...e].sort(),n=[...r].sort();return t.every((i,a)=>n[a]===i)}else return e===r}function b1(e){return e.length>0?e[e.length-1]:null}function La(e){return ig(e)?e:fu(e)?Tn(Promise.resolve(e)):at(e)}var kE={exact:E1,subset:S1},C1={exact:AE,subset:OE,ignored:()=>!0};function p1(e,r,t){return kE[t.paths](e.root,r.root,t.matrixParams)&&C1[t.queryParams](e.queryParams,r.queryParams)&&!(t.fragment==="exact"&&e.fragment!==r.fragment)}function AE(e,r){return Wi(e,r)}function E1(e,r,t){if(!ms(e.segments,r.segments)||!Tu(e.segments,r.segments,t)||e.numberOfChildren!==r.numberOfChildren)return!1;for(let n in r.children)if(!e.children[n]||!E1(e.children[n],r.children[n],t))return!1;return!0}function OE(e,r){return Object.keys(r).length<=Object.keys(e).length&&Object.keys(r).every(t=>w1(e[t],r[t]))}function S1(e,r,t){return T1(e,r,r.segments,t)}function T1(e,r,t,n){if(e.segments.length>t.length){let i=e.segments.slice(0,t.length);return!(!ms(i,t)||r.hasChildren()||!Tu(i,t,n))}else if(e.segments.length===t.length){if(!ms(e.segments,t)||!Tu(e.segments,t,n))return!1;for(let i in r.children)if(!e.children[i]||!S1(e.children[i],r.children[i],n))return!1;return!0}else{let i=t.slice(0,e.segments.length),a=t.slice(e.segments.length);return!ms(e.segments,i)||!Tu(e.segments,i,n)||!e.children[mt]?!1:T1(e.children[mt],r,a,n)}}function Tu(e,r,t){return r.every((n,i)=>C1[t](e[i].parameters,n.parameters))}var aa=class{constructor(r=new $t([],{}),t={},n=null){this.root=r,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=ho(this.queryParams),this._queryParamMap}toString(){return RE.serialize(this)}},$t=class{constructor(r,t){this.segments=r,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Iu(this)}},ps=class{constructor(r,t){this.path=r,this.parameters=t}get parameterMap(){return this._parameterMap??=ho(this.parameters),this._parameterMap}toString(){return k1(this)}};function FE(e,r){return ms(e,r)&&e.every((t,n)=>Wi(t.parameters,r[n].parameters))}function ms(e,r){return e.length!==r.length?!1:e.every((t,n)=>t.path===r[n].path)}function DE(e,r){let t=[];return Object.entries(e.children).forEach(([n,i])=>{n===mt&&(t=t.concat(r(i,n)))}),Object.entries(e.children).forEach(([n,i])=>{n!==mt&&(t=t.concat(r(i,n)))}),t}var ed=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:()=>new Ol,providedIn:"root"});let e=r;return e})(),Ol=class{parse(r){let t=new Oh(r);return new aa(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(r){let t=`/${El(r.root,!0)}`,n=PE(r.queryParams),i=typeof r.fragment=="string"?`#${ME(r.fragment)}`:"";return`${t}${n}${i}`}},RE=new Ol;function Iu(e){return e.segments.map(r=>k1(r)).join("/")}function El(e,r){if(!e.hasChildren())return Iu(e);if(r){let t=e.children[mt]?El(e.children[mt],!1):"",n=[];return Object.entries(e.children).forEach(([i,a])=>{i!==mt&&n.push(`${i}:${El(a,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=DE(e,(n,i)=>i===mt?[El(e.children[mt],!1)]:[`${i}:${El(n,!1)}`]);return Object.keys(e.children).length===1&&e.children[mt]!=null?`${Iu(e)}/${t[0]}`:`${Iu(e)}/(${t.join("//")})`}}function I1(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Eu(e){return I1(e).replace(/%3B/gi,";")}function ME(e){return encodeURI(e)}function Ah(e){return I1(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ku(e){return decodeURIComponent(e)}function m1(e){return ku(e.replace(/\+/g,"%20"))}function k1(e){return`${Ah(e.path)}${NE(e.parameters)}`}function NE(e){return Object.entries(e).map(([r,t])=>`;${Ah(r)}=${Ah(t)}`).join("")}function PE(e){let r=Object.entries(e).map(([t,n])=>Array.isArray(n)?n.map(i=>`${Eu(t)}=${Eu(i)}`).join("&"):`${Eu(t)}=${Eu(n)}`).filter(t=>t);return r.length?`?${r.join("&")}`:""}var LE=/^[^\/()?;#]+/;function Ch(e){let r=e.match(LE);return r?r[0]:""}var BE=/^[^\/()?;=#]+/;function VE(e){let r=e.match(BE);return r?r[0]:""}var UE=/^[^=?&#]+/;function $E(e){let r=e.match(UE);return r?r[0]:""}var WE=/^[^&#]+/;function HE(e){let r=e.match(WE);return r?r[0]:""}var Oh=class{constructor(r){this.url=r,this.remaining=r}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new $t([],{}):new $t([],this.parseChildren())}parseQueryParams(){let r={};if(this.consumeOptional("?"))do this.parseQueryParam(r);while(this.consumeOptional("&"));return r}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let r=[];for(this.peekStartsWith("(")||r.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),r.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(r.length>0||Object.keys(t).length>0)&&(n[mt]=new $t(r,t)),n}parseSegment(){let r=Ch(this.remaining);if(r===""&&this.peekStartsWith(";"))throw new Jt(4009,!1);return this.capture(r),new ps(ku(r),this.parseMatrixParams())}parseMatrixParams(){let r={};for(;this.consumeOptional(";");)this.parseParam(r);return r}parseParam(r){let t=VE(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let i=Ch(this.remaining);i&&(n=i,this.capture(n))}r[ku(t)]=ku(n)}parseQueryParam(r){let t=$E(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let s=HE(this.remaining);s&&(n=s,this.capture(n))}let i=m1(t),a=m1(n);if(r.hasOwnProperty(i)){let s=r[i];Array.isArray(s)||(s=[s],r[i]=s),s.push(a)}else r[i]=a}parseParens(r){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Ch(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new Jt(4010,!1);let a;n.indexOf(":")>-1?(a=n.slice(0,n.indexOf(":")),this.capture(a),this.capture(":")):r&&(a=mt);let s=this.parseChildren();t[a]=Object.keys(s).length===1?s[mt]:new $t([],s),this.consumeOptional("//")}return t}peekStartsWith(r){return this.remaining.startsWith(r)}consumeOptional(r){return this.peekStartsWith(r)?(this.remaining=this.remaining.substring(r.length),!0):!1}capture(r){if(!this.consumeOptional(r))throw new Jt(4011,!1)}};function A1(e){return e.segments.length>0?new $t([],{[mt]:e}):e}function O1(e){let r={};for(let[n,i]of Object.entries(e.children)){let a=O1(i);if(n===mt&&a.segments.length===0&&a.hasChildren())for(let[s,o]of Object.entries(a.children))r[s]=o;else(a.segments.length>0||a.hasChildren())&&(r[n]=a)}let t=new $t(e.segments,r);return zE(t)}function zE(e){if(e.numberOfChildren===1&&e.children[mt]){let r=e.children[mt];return new $t(e.segments.concat(r.segments),r.children)}return e}function Fl(e){return e instanceof aa}function jE(e,r,t=null,n=null){let i=F1(e);return D1(i,r,t,n)}function F1(e){let r;function t(a){let s={};for(let l of a.children){let c=t(l);s[l.outlet]=c}let o=new $t(a.url,s);return a===e&&(r=o),o}let n=t(e.root),i=A1(n);return r??i}function D1(e,r,t,n){let i=e;for(;i.parent;)i=i.parent;if(r.length===0)return Eh(i,i,i,t,n);let a=GE(r);if(a.toRoot())return Eh(i,i,new $t([],{}),t,n);let s=KE(a,i,e),o=s.processChildren?Il(s.segmentGroup,s.index,a.commands):M1(s.segmentGroup,s.index,a.commands);return Eh(i,s.segmentGroup,o,t,n)}function Au(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function Dl(e){return typeof e=="object"&&e!=null&&e.outlets}function Eh(e,r,t,n,i){let a={};n&&Object.entries(n).forEach(([l,c])=>{a[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let s;e===r?s=t:s=R1(e,r,t);let o=A1(O1(s));return new aa(o,a,i)}function R1(e,r,t){let n={};return Object.entries(e.children).forEach(([i,a])=>{a===r?n[i]=t:n[i]=R1(a,r,t)}),new $t(e.segments,n)}var Ou=class{constructor(r,t,n){if(this.isAbsolute=r,this.numberOfDoubleDots=t,this.commands=n,r&&n.length>0&&Au(n[0]))throw new Jt(4003,!1);let i=n.find(Dl);if(i&&i!==b1(n))throw new Jt(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function GE(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new Ou(!0,0,e);let r=0,t=!1,n=e.reduce((i,a,s)=>{if(typeof a=="object"&&a!=null){if(a.outlets){let o={};return Object.entries(a.outlets).forEach(([l,c])=>{o[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:o}]}if(a.segmentPath)return[...i,a.segmentPath]}return typeof a!="string"?[...i,a]:s===0?(a.split("/").forEach((o,l)=>{l==0&&o==="."||(l==0&&o===""?t=!0:o===".."?r++:o!=""&&i.push(o))}),i):[...i,a]},[]);return new Ou(t,r,n)}var co=class{constructor(r,t,n){this.segmentGroup=r,this.processChildren=t,this.index=n}};function KE(e,r,t){if(e.isAbsolute)return new co(r,!0,0);if(!t)return new co(r,!1,NaN);if(t.parent===null)return new co(t,!0,0);let n=Au(e.commands[0])?0:1,i=t.segments.length-1+n;return qE(t,i,e.numberOfDoubleDots)}function qE(e,r,t){let n=e,i=r,a=t;for(;a>i;){if(a-=i,n=n.parent,!n)throw new Jt(4005,!1);i=n.segments.length}return new co(n,!1,i-a)}function XE(e){return Dl(e[0])?e[0].outlets:{[mt]:e}}function M1(e,r,t){if(e??=new $t([],{}),e.segments.length===0&&e.hasChildren())return Il(e,r,t);let n=QE(e,r,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){let a=new $t(e.segments.slice(0,n.pathIndex),{});return a.children[mt]=new $t(e.segments.slice(n.pathIndex),e.children),Il(a,0,i)}else return n.match&&i.length===0?new $t(e.segments,{}):n.match&&!e.hasChildren()?Fh(e,r,t):n.match?Il(e,0,i):Fh(e,r,t)}function Il(e,r,t){if(t.length===0)return new $t(e.segments,{});{let n=XE(t),i={};if(Object.keys(n).some(a=>a!==mt)&&e.children[mt]&&e.numberOfChildren===1&&e.children[mt].segments.length===0){let a=Il(e.children[mt],r,t);return new $t(e.segments,a.children)}return Object.entries(n).forEach(([a,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[a]=M1(e.children[a],r,s))}),Object.entries(e.children).forEach(([a,s])=>{n[a]===void 0&&(i[a]=s)}),new $t(e.segments,i)}}function QE(e,r,t){let n=0,i=r,a={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(n>=t.length)return a;let s=e.segments[i],o=t[n];if(Dl(o))break;let l=`${o}`,c=n<t.length-1?t[n+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!v1(l,c,s))return a;n+=2}else{if(!v1(l,{},s))return a;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function Fh(e,r,t){let n=e.segments.slice(0,r),i=0;for(;i<t.length;){let a=t[i];if(Dl(a)){let l=YE(a.outlets);return new $t(n,l)}if(i===0&&Au(t[0])){let l=e.segments[r];n.push(new ps(l.path,g1(t[0]))),i++;continue}let s=Dl(a)?a.outlets[mt]:`${a}`,o=i<t.length-1?t[i+1]:null;s&&o&&Au(o)?(n.push(new ps(s,g1(o))),i+=2):(n.push(new ps(s,{})),i++)}return new $t(n,{})}function YE(e){let r={};return Object.entries(e).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(r[t]=Fh(new $t([],{}),0,n))}),r}function g1(e){let r={};return Object.entries(e).forEach(([t,n])=>r[t]=`${n}`),r}function v1(e,r,t){return e==t.path&&Wi(r,t.parameters)}var kl="imperative",nn=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(nn||{}),ci=class{constructor(r,t){this.id=r,this.url=t}},Rl=class extends ci{constructor(r,t,n="imperative",i=null){super(r,t),this.type=nn.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},gs=class extends ci{constructor(r,t,n){super(r,t),this.urlAfterRedirects=n,this.type=nn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},zn=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(zn||{}),Dh=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(Dh||{}),ia=class extends ci{constructor(r,t,n,i){super(r,t),this.reason=n,this.code=i,this.type=nn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},vs=class extends ci{constructor(r,t,n,i){super(r,t),this.reason=n,this.code=i,this.type=nn.NavigationSkipped}},Ml=class extends ci{constructor(r,t,n,i){super(r,t),this.error=n,this.target=i,this.type=nn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Fu=class extends ci{constructor(r,t,n,i){super(r,t),this.urlAfterRedirects=n,this.state=i,this.type=nn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Rh=class extends ci{constructor(r,t,n,i){super(r,t),this.urlAfterRedirects=n,this.state=i,this.type=nn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mh=class extends ci{constructor(r,t,n,i,a){super(r,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=a,this.type=nn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Nh=class extends ci{constructor(r,t,n,i){super(r,t),this.urlAfterRedirects=n,this.state=i,this.type=nn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ph=class extends ci{constructor(r,t,n,i){super(r,t),this.urlAfterRedirects=n,this.state=i,this.type=nn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lh=class{constructor(r){this.route=r,this.type=nn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Bh=class{constructor(r){this.route=r,this.type=nn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Vh=class{constructor(r){this.snapshot=r,this.type=nn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uh=class{constructor(r){this.snapshot=r,this.type=nn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$h=class{constructor(r){this.snapshot=r,this.type=nn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Wh=class{constructor(r){this.snapshot=r,this.type=nn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Nl=class{},po=class{constructor(r,t){this.url=r,this.navigationBehaviorOptions=t}};function ZE(e,r){return e.providers&&!e._injector&&(e._injector=Ag(e.providers,r,`Route: ${e.path}`)),e._injector??r}function Ei(e){return e.outlet||mt}function JE(e,r){let t=e.filter(n=>Ei(n)===r);return t.push(...e.filter(n=>Ei(n)!==r)),t}function $l(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let r=e.parent;r;r=r.parent){let t=r.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Hh=class{get injector(){return $l(this.route?.snapshot)??this.rootInjector}set injector(r){}constructor(r){this.rootInjector=r,this.outlet=null,this.route=null,this.children=new Bu(this.rootInjector),this.attachRef=null}},Bu=(()=>{let r=class r{constructor(n){this.rootInjector=n,this.contexts=new Map}onChildOutletCreated(n,i){let a=this.getOrCreateContext(n);a.outlet=i,this.contexts.set(n,a)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new Hh(this.rootInjector),this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};r.\u0275fac=function(i){return new(i||r)(Mt(eo))},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})(),Du=class{constructor(r){this._root=r}get root(){return this._root.value}parent(r){let t=this.pathFromRoot(r);return t.length>1?t[t.length-2]:null}children(r){let t=zh(r,this._root);return t?t.children.map(n=>n.value):[]}firstChild(r){let t=zh(r,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(r){let t=jh(r,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==r)}pathFromRoot(r){return jh(r,this._root).map(t=>t.value)}};function zh(e,r){if(e===r.value)return r;for(let t of r.children){let n=zh(e,t);if(n)return n}return null}function jh(e,r){if(e===r.value)return[r];for(let t of r.children){let n=jh(e,t);if(n.length)return n.unshift(r),n}return[]}var Hn=class{constructor(r,t){this.value=r,this.children=t}toString(){return`TreeNode(${this.value})`}};function lo(e){let r={};return e&&e.children.forEach(t=>r[t.value.outlet]=t),r}var Ru=class extends Du{constructor(r,t){super(r),this.snapshot=t,td(this,r)}toString(){return this.snapshot.toString()}};function N1(e){let r=eS(e),t=new _r([new ps("",{})]),n=new _r({}),i=new _r({}),a=new _r({}),s=new _r(""),o=new mo(t,n,a,s,i,mt,e,r.root);return o.snapshot=r.root,new Ru(new Hn(o,[]),r)}function eS(e){let r={},t={},n={},i="",a=new uo([],r,n,i,t,mt,e,null,{});return new Nu("",new Hn(a,[]))}var mo=class{constructor(r,t,n,i,a,s,o,l){this.urlSubject=r,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=a,this.outlet=s,this.component=o,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ue(c=>c[Ul]))??at(void 0),this.url=r,this.params=t,this.queryParams=n,this.fragment=i,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ue(r=>ho(r))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ue(r=>ho(r))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Mu(e,r,t="emptyOnly"){let n,{routeConfig:i}=e;return r!==null&&(t==="always"||i?.path===""||!r.component&&!r.routeConfig?.loadComponent)?n={params:ie(ie({},r.params),e.params),data:ie(ie({},r.data),e.data),resolve:ie(ie(ie(ie({},e.data),r.data),i?.data),e._resolvedData)}:n={params:ie({},e.params),data:ie({},e.data),resolve:ie(ie({},e.data),e._resolvedData??{})},i&&L1(i)&&(n.resolve[Ul]=i.title),n}var uo=class{get title(){return this.data?.[Ul]}constructor(r,t,n,i,a,s,o,l,c){this.url=r,this.params=t,this.queryParams=n,this.fragment=i,this.data=a,this.outlet=s,this.component=o,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ho(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ho(this.queryParams),this._queryParamMap}toString(){let r=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${r}', path:'${t}')`}},Nu=class extends Du{constructor(r,t){super(t),this.url=r,td(this,t)}toString(){return P1(this._root)}};function td(e,r){r.value._routerState=e,r.children.forEach(t=>td(e,t))}function P1(e){let r=e.children.length>0?` { ${e.children.map(P1).join(", ")} } `:"";return`${e.value}${r}`}function Sh(e){if(e.snapshot){let r=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Wi(r.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),r.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Wi(r.params,t.params)||e.paramsSubject.next(t.params),IE(r.url,t.url)||e.urlSubject.next(t.url),Wi(r.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Gh(e,r){let t=Wi(e.params,r.params)&&FE(e.url,r.url),n=!e.parent!=!r.parent;return t&&!n&&(!e.parent||Gh(e.parent,r.parent))}function L1(e){return typeof e.title=="string"||e.title===null}var rd=(()=>{let r=class r{constructor(){this.activated=null,this._activatedRoute=null,this.name=mt,this.activateEvents=new Be,this.deactivateEvents=new Be,this.attachEvents=new Be,this.detachEvents=new Be,this.parentContexts=$e(Bu),this.location=$e(no),this.changeDetector=$e(hr),this.inputBinder=$e(nd,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:a}=n.name;if(i)return;this.isTrackedInParentContexts(a)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(a)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Jt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Jt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Jt(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Jt(4013,!1);this._activatedRoute=n;let a=this.location,o=n.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new Kh(n,l,a.injector);this.activated=a.createComponent(o,{index:a.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275dir=Mr({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Da]});let e=r;return e})(),Kh=class e{__ngOutletInjector(r){return new e(this.route,this.childContexts,r)}constructor(r,t,n){this.route=r,this.childContexts=t,this.parent=n}get(r,t){return r===mo?this.route:r===Bu?this.childContexts:this.parent.get(r,t)}},nd=new Kt("");function tS(e,r,t){let n=Pl(e,r._root,t?t._root:void 0);return new Ru(n,r)}function Pl(e,r,t){if(t&&e.shouldReuseRoute(r.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=r.value;let i=rS(e,r,t);return new Hn(n,i)}else{if(e.shouldAttach(r.value)){let a=e.retrieve(r.value);if(a!==null){let s=a.route;return s.value._futureSnapshot=r.value,s.children=r.children.map(o=>Pl(e,o)),s}}let n=nS(r.value),i=r.children.map(a=>Pl(e,a));return new Hn(n,i)}}function rS(e,r,t){return r.children.map(n=>{for(let i of t.children)if(e.shouldReuseRoute(n.value,i.value.snapshot))return Pl(e,n,i);return Pl(e,n)})}function nS(e){return new mo(new _r(e.url),new _r(e.params),new _r(e.queryParams),new _r(e.fragment),new _r(e.data),e.outlet,e.component,e)}var Ll=class{constructor(r,t){this.redirectTo=r,this.navigationBehaviorOptions=t}},B1="ngNavigationCancelingError";function Pu(e,r){let{redirectTo:t,navigationBehaviorOptions:n}=Fl(r)?{redirectTo:r,navigationBehaviorOptions:void 0}:r,i=V1(!1,zn.Redirect);return i.url=t,i.navigationBehaviorOptions=n,i}function V1(e,r){let t=new Error(`NavigationCancelingError: ${e||""}`);return t[B1]=!0,t.cancellationCode=r,t}function iS(e){return U1(e)&&Fl(e.url)}function U1(e){return!!e&&e[B1]}var aS=(e,r,t,n)=>Ue(i=>(new qh(r,i.targetRouterState,i.currentRouterState,t,n).activate(e),i)),qh=class{constructor(r,t,n,i,a){this.routeReuseStrategy=r,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=a}activate(r){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,r),Sh(this.futureState.root),this.activateChildRoutes(t,n,r)}deactivateChildRoutes(r,t,n){let i=lo(t);r.children.forEach(a=>{let s=a.value.outlet;this.deactivateRoutes(a,i[s],n),delete i[s]}),Object.values(i).forEach(a=>{this.deactivateRouteAndItsChildren(a,n)})}deactivateRoutes(r,t,n){let i=r.value,a=t?t.value:null;if(i===a)if(i.component){let s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(r,t,s.children)}else this.deactivateChildRoutes(r,t,n);else a&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(r,t){r.value.component&&this.routeReuseStrategy.shouldDetach(r.value.snapshot)?this.detachAndStoreRouteSubtree(r,t):this.deactivateRouteAndOutlet(r,t)}detachAndStoreRouteSubtree(r,t){let n=t.getContext(r.value.outlet),i=n&&r.value.component?n.children:t,a=lo(r);for(let s of Object.values(a))this.deactivateRouteAndItsChildren(s,i);if(n&&n.outlet){let s=n.outlet.detach(),o=n.children.onOutletDeactivated();this.routeReuseStrategy.store(r.value.snapshot,{componentRef:s,route:r,contexts:o})}}deactivateRouteAndOutlet(r,t){let n=t.getContext(r.value.outlet),i=n&&r.value.component?n.children:t,a=lo(r);for(let s of Object.values(a))this.deactivateRouteAndItsChildren(s,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(r,t,n){let i=lo(t);r.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],n),this.forwardEvent(new Wh(a.value.snapshot))}),r.children.length&&this.forwardEvent(new Uh(r.value.snapshot))}activateRoutes(r,t,n){let i=r.value,a=t?t.value:null;if(Sh(i),i===a)if(i.component){let s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(r,t,s.children)}else this.activateChildRoutes(r,t,n);else if(i.component){let s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let o=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(o.contexts),s.attachRef=o.componentRef,s.route=o.route.value,s.outlet&&s.outlet.attach(o.componentRef,o.route.value),Sh(o.route.value),this.activateChildRoutes(r,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(r,null,s.children)}else this.activateChildRoutes(r,null,n)}},Lu=class{constructor(r){this.path=r,this.route=this.path[this.path.length-1]}},fo=class{constructor(r,t){this.component=r,this.route=t}};function sS(e,r,t){let n=e._root,i=r?r._root:null;return Sl(n,i,t,[n.value])}function oS(e){let r=e.routeConfig?e.routeConfig.canActivateChild:null;return!r||r.length===0?null:{node:e,guards:r}}function vo(e,r){let t=Symbol(),n=r.get(e,t);return n===t?typeof e=="function"&&!dg(e)?e:r.get(e):n}function Sl(e,r,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let a=lo(r);return e.children.forEach(s=>{lS(s,a[s.value.outlet],t,n.concat([s.value]),i),delete a[s.value.outlet]}),Object.entries(a).forEach(([s,o])=>Al(o,t.getContext(s),i)),i}function lS(e,r,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let a=e.value,s=r?r.value:null,o=t?t.getContext(e.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){let l=cS(s,a,a.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Lu(n)):(a.data=s.data,a._resolvedData=s._resolvedData),a.component?Sl(e,r,o?o.children:null,n,i):Sl(e,r,t,n,i),l&&o&&o.outlet&&o.outlet.isActivated&&i.canDeactivateChecks.push(new fo(o.outlet.component,s))}else s&&Al(r,o,i),i.canActivateChecks.push(new Lu(n)),a.component?Sl(e,null,o?o.children:null,n,i):Sl(e,null,t,n,i);return i}function cS(e,r,t){if(typeof t=="function")return t(e,r);switch(t){case"pathParamsChange":return!ms(e.url,r.url);case"pathParamsOrQueryParamsChange":return!ms(e.url,r.url)||!Wi(e.queryParams,r.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Gh(e,r)||!Wi(e.queryParams,r.queryParams);case"paramsChange":default:return!Gh(e,r)}}function Al(e,r,t){let n=lo(e),i=e.value;Object.entries(n).forEach(([a,s])=>{i.component?r?Al(s,r.children.getContext(a),t):Al(s,null,t):Al(s,r,t)}),i.component?r&&r.outlet&&r.outlet.isActivated?t.canDeactivateChecks.push(new fo(r.outlet.component,i)):t.canDeactivateChecks.push(new fo(null,i)):t.canDeactivateChecks.push(new fo(null,i))}function Wl(e){return typeof e=="function"}function uS(e){return typeof e=="boolean"}function fS(e){return e&&Wl(e.canLoad)}function hS(e){return e&&Wl(e.canActivate)}function dS(e){return e&&Wl(e.canActivateChild)}function pS(e){return e&&Wl(e.canDeactivate)}function mS(e){return e&&Wl(e.canMatch)}function $1(e){return e instanceof ag||e?.name==="EmptyError"}var Su=Symbol("INITIAL_VALUE");function go(){return mn(e=>cl(e.map(r=>r.pipe(Zs(1),ai(Su)))).pipe(Ue(r=>{for(let t of r)if(t!==!0){if(t===Su)return Su;if(t===!1||gS(t))return t}return!0}),Qe(r=>r!==Su),Zs(1)))}function gS(e){return Fl(e)||e instanceof Ll}function vS(e,r){return ir(t=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:s}}=t;return s.length===0&&a.length===0?at(ze(ie({},t),{guardsResult:!0})):_S(s,n,i,e).pipe(ir(o=>o&&uS(o)?xS(n,a,e,r):at(o)),Ue(o=>ze(ie({},t),{guardsResult:o})))})}function _S(e,r,t,n){return Tn(e).pipe(ir(i=>ES(i.component,i.route,t,r,n)),Fa(i=>i!==!0,!0))}function xS(e,r,t,n){return Tn(r).pipe(ls(i=>sg(wS(i.route.parent,n),yS(i.route,n),CS(e,i.path,t),bS(e,i.route,t))),Fa(i=>i!==!0,!0))}function yS(e,r){return e!==null&&r&&r(new $h(e)),at(!0)}function wS(e,r){return e!==null&&r&&r(new Vh(e)),at(!0)}function bS(e,r,t){let n=r.routeConfig?r.routeConfig.canActivate:null;if(!n||n.length===0)return at(!0);let i=n.map(a=>K0(()=>{let s=$l(r)??t,o=vo(a,s),l=hS(o)?o.canActivate(r,e):bi(s,()=>o(r,e));return La(l).pipe(Fa())}));return at(i).pipe(go())}function CS(e,r,t){let n=r[r.length-1],a=r.slice(0,r.length-1).reverse().map(s=>oS(s)).filter(s=>s!==null).map(s=>K0(()=>{let o=s.guards.map(l=>{let c=$l(s.node)??t,u=vo(l,c),f=dS(u)?u.canActivateChild(n,e):bi(c,()=>u(n,e));return La(f).pipe(Fa())});return at(o).pipe(go())}));return at(a).pipe(go())}function ES(e,r,t,n,i){let a=r&&r.routeConfig?r.routeConfig.canDeactivate:null;if(!a||a.length===0)return at(!0);let s=a.map(o=>{let l=$l(r)??i,c=vo(o,l),u=pS(c)?c.canDeactivate(e,r,t,n):bi(l,()=>c(e,r,t,n));return La(u).pipe(Fa())});return at(s).pipe(go())}function SS(e,r,t,n){let i=r.canLoad;if(i===void 0||i.length===0)return at(!0);let a=i.map(s=>{let o=vo(s,e),l=fS(o)?o.canLoad(r,t):bi(e,()=>o(r,t));return La(l)});return at(a).pipe(go(),W1(n))}function W1(e){return ng(tn(r=>{if(typeof r!="boolean")throw Pu(e,r)}),Ue(r=>r===!0))}function TS(e,r,t,n){let i=r.canMatch;if(!i||i.length===0)return at(!0);let a=i.map(s=>{let o=vo(s,e),l=mS(o)?o.canMatch(r,t):bi(e,()=>o(r,t));return La(l)});return at(a).pipe(go(),W1(n))}var Bl=class{constructor(r){this.segmentGroup=r||null}},Vl=class extends Error{constructor(r){super(),this.urlTree=r}};function oo(e){return ll(new Bl(e))}function IS(e){return ll(new Jt(4e3,!1))}function kS(e){return ll(V1(!1,zn.GuardRejected))}var Xh=class{constructor(r,t){this.urlSerializer=r,this.urlTree=t}lineralizeSegments(r,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return at(n);if(i.numberOfChildren>1||!i.children[mt])return IS(`${r.redirectTo}`);i=i.children[mt]}}applyRedirectCommands(r,t,n,i,a){if(typeof t!="string"){let o=t,{queryParams:l,fragment:c,routeConfig:u,url:f,outlet:h,params:d,data:g,title:v}=i,p=bi(a,()=>o({params:d,data:g,queryParams:l,fragment:c,routeConfig:u,url:f,outlet:h,title:v}));if(p instanceof aa)throw new Vl(p);t=p}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),r,n);if(t[0]==="/")throw new Vl(s);return s}applyRedirectCreateUrlTree(r,t,n,i){let a=this.createSegmentGroup(r,t.root,n,i);return new aa(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(r,t){let n={};return Object.entries(r).forEach(([i,a])=>{if(typeof a=="string"&&a[0]===":"){let o=a.substring(1);n[i]=t[o]}else n[i]=a}),n}createSegmentGroup(r,t,n,i){let a=this.createSegments(r,t.segments,n,i),s={};return Object.entries(t.children).forEach(([o,l])=>{s[o]=this.createSegmentGroup(r,l,n,i)}),new $t(a,s)}createSegments(r,t,n,i){return t.map(a=>a.path[0]===":"?this.findPosParam(r,a,i):this.findOrReturn(a,n))}findPosParam(r,t,n){let i=n[t.path.substring(1)];if(!i)throw new Jt(4001,!1);return i}findOrReturn(r,t){let n=0;for(let i of t){if(i.path===r.path)return t.splice(n),i;n++}return r}},Qh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function AS(e,r,t,n,i){let a=H1(e,r,t);return a.matched?(n=ZE(r,n),TS(n,r,t,i).pipe(Ue(s=>s===!0?a:ie({},Qh)))):at(a)}function H1(e,r,t){if(r.path==="**")return OS(t);if(r.path==="")return r.pathMatch==="full"&&(e.hasChildren()||t.length>0)?ie({},Qh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(r.matcher||TE)(t,e,r);if(!i)return ie({},Qh);let a={};Object.entries(i.posParams??{}).forEach(([o,l])=>{a[o]=l.path});let s=i.consumed.length>0?ie(ie({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function OS(e){return{matched:!0,parameters:e.length>0?b1(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function _1(e,r,t,n){return t.length>0&&RS(e,t,n)?{segmentGroup:new $t(r,DS(n,new $t(t,e.children))),slicedSegments:[]}:t.length===0&&MS(e,t,n)?{segmentGroup:new $t(e.segments,FS(e,t,n,e.children)),slicedSegments:t}:{segmentGroup:new $t(e.segments,e.children),slicedSegments:t}}function FS(e,r,t,n){let i={};for(let a of t)if(Vu(e,r,a)&&!n[Ei(a)]){let s=new $t([],{});i[Ei(a)]=s}return ie(ie({},n),i)}function DS(e,r){let t={};t[mt]=r;for(let n of e)if(n.path===""&&Ei(n)!==mt){let i=new $t([],{});t[Ei(n)]=i}return t}function RS(e,r,t){return t.some(n=>Vu(e,r,n)&&Ei(n)!==mt)}function MS(e,r,t){return t.some(n=>Vu(e,r,n))}function Vu(e,r,t){return(e.hasChildren()||r.length>0)&&t.pathMatch==="full"?!1:t.path===""}function NS(e,r,t){return r.length===0&&!e.children[t]}var Yh=class{};function PS(e,r,t,n,i,a,s="emptyOnly"){return new Zh(e,r,t,n,i,s,a).recognize()}var LS=31,Zh=class{constructor(r,t,n,i,a,s,o){this.injector=r,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=a,this.paramsInheritanceStrategy=s,this.urlSerializer=o,this.applyRedirects=new Xh(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(r){return new Jt(4002,`'${r.segmentGroup}'`)}recognize(){let r=_1(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(r).pipe(Ue(({children:t,rootSnapshot:n})=>{let i=new Hn(n,t),a=new Nu("",i),s=jE(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(s),{state:a,tree:s}}))}match(r){let t=new uo([],Object.freeze({}),Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),mt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,r,mt,t).pipe(Ue(n=>({children:n,rootSnapshot:t})),Ys(n=>{if(n instanceof Vl)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Bl?this.noMatchError(n):n}))}processSegmentGroup(r,t,n,i,a){return n.segments.length===0&&n.hasChildren()?this.processChildren(r,t,n,a):this.processSegment(r,t,n,n.segments,i,!0,a).pipe(Ue(s=>s instanceof Hn?[s]:[]))}processChildren(r,t,n,i){let a=[];for(let s of Object.keys(n.children))s==="primary"?a.unshift(s):a.push(s);return Tn(a).pipe(ls(s=>{let o=n.children[s],l=JE(t,s);return this.processSegmentGroup(r,l,o,s,i)}),fg((s,o)=>(s.push(...o),s)),q0(null),ug(),ir(s=>{if(s===null)return oo(n);let o=z1(s);return BS(o),at(o)}))}processSegment(r,t,n,i,a,s,o){return Tn(t).pipe(ls(l=>this.processSegmentAgainstRoute(l._injector??r,t,l,n,i,a,s,o).pipe(Ys(c=>{if(c instanceof Bl)return at(null);throw c}))),Fa(l=>!!l),Ys(l=>{if($1(l))return NS(n,i,a)?at(new Yh):oo(n);throw l}))}processSegmentAgainstRoute(r,t,n,i,a,s,o,l){return Ei(n)!==s&&(s===mt||!Vu(i,a,n))?oo(i):n.redirectTo===void 0?this.matchSegmentAgainstRoute(r,i,n,a,s,l):this.allowRedirects&&o?this.expandSegmentAgainstRouteUsingRedirect(r,i,t,n,a,s,l):oo(i)}expandSegmentAgainstRouteUsingRedirect(r,t,n,i,a,s,o){let{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:f,remainingSegments:h}=H1(t,i,a);if(!l)return oo(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>LS&&(this.allowRedirects=!1));let d=new uo(a,c,Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,x1(i),Ei(i),i.component??i._loadedComponent??null,i,y1(i)),g=Mu(d,o,this.paramsInheritanceStrategy);d.params=Object.freeze(g.params),d.data=Object.freeze(g.data);let v=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,f,d,r);return this.applyRedirects.lineralizeSegments(i,v).pipe(ir(p=>this.processSegment(r,n,t,p.concat(h),s,!1,o)))}matchSegmentAgainstRoute(r,t,n,i,a,s){let o=AS(t,n,i,r,this.urlSerializer);return n.path==="**"&&(t.children={}),o.pipe(mn(l=>l.matched?(r=n._injector??r,this.getChildConfig(r,n,i).pipe(mn(({routes:c})=>{let u=n._loadedInjector??r,{parameters:f,consumedSegments:h,remainingSegments:d}=l,g=new uo(h,f,Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,x1(n),Ei(n),n.component??n._loadedComponent??null,n,y1(n)),v=Mu(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(v.params),g.data=Object.freeze(v.data);let{segmentGroup:p,slicedSegments:m}=_1(t,h,d,c);if(m.length===0&&p.hasChildren())return this.processChildren(u,c,p,g).pipe(Ue(_=>new Hn(g,_)));if(c.length===0&&m.length===0)return at(new Hn(g,[]));let x=Ei(n)===a;return this.processSegment(u,c,p,m,x?mt:a,!0,g).pipe(Ue(_=>new Hn(g,_ instanceof Hn?[_]:[])))}))):oo(t)))}getChildConfig(r,t,n){return t.children?at({routes:t.children,injector:r}):t.loadChildren?t._loadedRoutes!==void 0?at({routes:t._loadedRoutes,injector:t._loadedInjector}):SS(r,t,n,this.urlSerializer).pipe(ir(i=>i?this.configLoader.loadChildren(r,t).pipe(tn(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):kS(t))):at({routes:[],injector:r})}};function BS(e){e.sort((r,t)=>r.value.outlet===mt?-1:t.value.outlet===mt?1:r.value.outlet.localeCompare(t.value.outlet))}function VS(e){let r=e.value.routeConfig;return r&&r.path===""}function z1(e){let r=[],t=new Set;for(let n of e){if(!VS(n)){r.push(n);continue}let i=r.find(a=>n.value.routeConfig===a.value.routeConfig);i!==void 0?(i.children.push(...n.children),t.add(i)):r.push(n)}for(let n of t){let i=z1(n.children);r.push(new Hn(n.value,i))}return r.filter(n=>!t.has(n))}function x1(e){return e.data||{}}function y1(e){return e.resolve||{}}function US(e,r,t,n,i,a){return ir(s=>PS(e,r,t,n,s.extractedUrl,i,a).pipe(Ue(({state:o,tree:l})=>ze(ie({},s),{targetSnapshot:o,urlAfterRedirects:l}))))}function $S(e,r){return ir(t=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return at(t);let a=new Set(i.map(l=>l.route)),s=new Set;for(let l of a)if(!s.has(l))for(let c of j1(l))s.add(c);let o=0;return Tn(s).pipe(ls(l=>a.has(l)?WS(l,n,e,r):(l.data=Mu(l,l.parent,e).resolve,at(void 0))),tn(()=>o++),X0(1),ir(l=>o===s.size?at(t):Aa))})}function j1(e){let r=e.children.map(t=>j1(t)).flat();return[e,...r]}function WS(e,r,t,n){let i=e.routeConfig,a=e._resolve;return i?.title!==void 0&&!L1(i)&&(a[Ul]=i.title),HS(a,e,r,n).pipe(Ue(s=>(e._resolvedData=s,e.data=Mu(e,e.parent,t).resolve,null)))}function HS(e,r,t,n){let i=kh(e);if(i.length===0)return at({});let a={};return Tn(i).pipe(ir(s=>zS(e[s],r,t,n).pipe(Fa(),tn(o=>{if(o instanceof Ll)throw Pu(new Ol,o);a[s]=o}))),X0(1),cg(a),Ys(s=>$1(s)?Aa:ll(s)))}function zS(e,r,t,n){let i=$l(r)??n,a=vo(e,i),s=a.resolve?a.resolve(r,t):bi(i,()=>a(r,t));return La(s)}function Th(e){return mn(r=>{let t=e(r);return t?Tn(t).pipe(Ue(()=>r)):at(r)})}var G1=(()=>{let r=class r{buildTitle(n){let i,a=n.root;for(;a!==void 0;)i=this.getResolvedTitleForRoute(a)??i,a=a.children.find(s=>s.outlet===mt);return i}getResolvedTitleForRoute(n){return n.data[Ul]}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:()=>$e(jS),providedIn:"root"});let e=r;return e})(),jS=(()=>{let r=class r extends G1{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};r.\u0275fac=function(i){return new(i||r)(Mt(h1))},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})(),id=new Kt("",{providedIn:"root",factory:()=>({})}),GS=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=Fe({type:r,selectors:[["ng-component"]],standalone:!0,features:[ot],decls:1,vars:0,template:function(i,a){i&1&&ue(0,"router-outlet")},dependencies:[rd],encapsulation:2});let e=r;return e})();function ad(e){let r=e.children&&e.children.map(ad),t=r?ze(ie({},e),{children:r}):ie({},e);return!t.component&&!t.loadComponent&&(r||t.loadChildren)&&t.outlet&&t.outlet!==mt&&(t.component=GS),t}var sd=new Kt(""),KS=(()=>{let r=class r{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=$e(oh)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return at(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=La(n.loadComponent()).pipe(Ue(K1),tn(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Js(()=>{this.componentLoaders.delete(n)})),a=new G0(i,()=>new Rt).pipe(j0());return this.componentLoaders.set(n,a),a}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return at({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=qS(i,this.compiler,n,this.onLoadEndListener).pipe(Js(()=>{this.childrenLoaders.delete(i)})),o=new G0(s,()=>new Rt).pipe(j0());return this.childrenLoaders.set(i,o),o}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();function qS(e,r,t,n){return La(e.loadChildren()).pipe(Ue(K1),ir(i=>i instanceof kg||Array.isArray(i)?at(i):Tn(r.compileModuleAsync(i))),Ue(i=>{n&&n(e);let a,s,o=!1;return Array.isArray(i)?(s=i,o=!0):(a=i.create(t).injector,s=a.get(sd,[],{optional:!0,self:!0}).flat()),{routes:s.map(ad),injector:a}}))}function XS(e){return e&&typeof e=="object"&&"default"in e}function K1(e){return XS(e)?e.default:e}var od=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:()=>$e(QS),providedIn:"root"});let e=r;return e})(),QS=(()=>{let r=class r{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})(),YS=new Kt("");var ZS=new Kt(""),JS=(()=>{let r=class r{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Rt,this.transitionAbortSubject=new Rt,this.configLoader=$e(KS),this.environmentInjector=$e(eo),this.urlSerializer=$e(ed),this.rootContexts=$e(Bu),this.location=$e(du),this.inputBindingEnabled=$e(nd,{optional:!0})!==null,this.titleStrategy=$e(G1),this.options=$e(id,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=$e(od),this.createViewTransition=$e(YS,{optional:!0}),this.navigationErrorHandler=$e(ZS,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>at(void 0),this.rootComponentType=null;let n=a=>this.events.next(new Lh(a)),i=a=>this.events.next(new Bh(a));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(ze(ie(ie({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,a){return this.transitions=new _r({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:kl,restoredState:null,currentSnapshot:a.snapshot,targetSnapshot:null,currentRouterState:a,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Qe(s=>s.id!==0),Ue(s=>ze(ie({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),mn(s=>{let o=!1,l=!1;return at(s).pipe(mn(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",zn.SupersededByNewNavigation),Aa;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ze(ie({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!u&&f!=="reload"){let h="";return this.events.next(new vs(c.id,this.urlSerializer.serialize(c.rawUrl),h,Dh.IgnoredSameUrlNavigation)),c.resolve(!1),Aa}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return at(c).pipe(mn(h=>{let d=this.transitions?.getValue();return this.events.next(new Rl(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),d!==this.transitions?.getValue()?Aa:Promise.resolve(h)}),US(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),tn(h=>{s.targetSnapshot=h.targetSnapshot,s.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ze(ie({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let d=new Fu(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(d)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:d,source:g,restoredState:v,extras:p}=c,m=new Rl(h,this.urlSerializer.serialize(d),g,v);this.events.next(m);let x=N1(this.rootComponentType).snapshot;return this.currentTransition=s=ze(ie({},c),{targetSnapshot:x,urlAfterRedirects:d,extras:ze(ie({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,at(s)}else{let h="";return this.events.next(new vs(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Dh.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Aa}}),tn(c=>{let u=new Rh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),Ue(c=>(this.currentTransition=s=ze(ie({},c),{guards:sS(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),vS(this.environmentInjector,c=>this.events.next(c)),tn(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Pu(this.urlSerializer,c.guardsResult);let u=new Mh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),Qe(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",zn.GuardRejected),!1)),Th(c=>{if(c.guards.canActivateChecks.length)return at(c).pipe(tn(u=>{let f=new Nh(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),mn(u=>{let f=!1;return at(u).pipe($S(this.paramsInheritanceStrategy,this.environmentInjector),tn({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(u,"",zn.NoDataFromResolver)}}))}),tn(u=>{let f=new Ph(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),Th(c=>{let u=f=>{let h=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(f.routeConfig).pipe(tn(d=>{f.component=d}),Ue(()=>{})));for(let d of f.children)h.push(...u(d));return h};return cl(u(c.targetSnapshot.root)).pipe(q0(null),Zs(1))}),Th(()=>this.afterPreactivation()),mn(()=>{let{currentSnapshot:c,targetSnapshot:u}=s,f=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return f?Tn(f).pipe(Ue(()=>s)):at(s)}),Ue(c=>{let u=tS(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=ze(ie({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),tn(()=>{this.events.next(new Nl)}),aS(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Zs(1),tn({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new gs(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),hg(this.transitionAbortSubject.pipe(tn(c=>{throw c}))),Js(()=>{!o&&!l&&this.cancelNavigationTransition(s,"",zn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ys(c=>{if(l=!0,U1(c))this.events.next(new ia(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),iS(c)?this.events.next(new po(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let u=new Ml(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let f=bi(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(f instanceof Ll){let{message:h,cancellationCode:d}=Pu(this.urlSerializer,f);this.events.next(new ia(s.id,this.urlSerializer.serialize(s.extractedUrl),h,d)),this.events.next(new po(f.redirectTo,f.navigationBehaviorOptions))}else{this.events.next(u);let h=n.errorHandler(c);s.resolve(!!h)}}catch(f){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(f)}}return Aa}))}))}cancelNavigationTransition(n,i,a){let s=new ia(n.id,this.urlSerializer.serialize(n.extractedUrl),i,a);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();function eT(e){return e!==kl}var tT=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:()=>$e(rT),providedIn:"root"});let e=r;return e})(),Jh=class{shouldDetach(r){return!1}store(r,t){}shouldAttach(r){return!1}retrieve(r){return null}shouldReuseRoute(r,t){return r.routeConfig===t.routeConfig}},rT=(()=>{let r=class r extends Jh{};r.\u0275fac=(()=>{let n;return function(a){return(n||(n=Pt(r)))(a||r)}})(),r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})(),q1=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:()=>$e(nT),providedIn:"root"});let e=r;return e})(),nT=(()=>{let r=class r extends q1{constructor(){super(...arguments),this.location=$e(du),this.urlSerializer=$e(ed),this.options=$e(id,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=$e(od),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new aa,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=N1(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof Rl)this.stateMemento=this.createStateMemento();else if(n instanceof vs)this.rawUrlTree=i.initialUrl;else if(n instanceof Fu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let a=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??a,i)}}else n instanceof Nl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):n instanceof ia&&(n.code===zn.GuardRejected||n.code===zn.NoDataFromResolver)?this.restoreHistory(i):n instanceof Ml?this.restoreHistory(i,!0):n instanceof gs&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let a=n instanceof aa?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(a)||i.extras.replaceUrl){let s=this.browserPageId,o=ie(ie({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(a,"",o)}else{let s=ie(ie({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(a,"",s)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let a=this.browserPageId,s=this.currentPageId-a;s!==0?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&s===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};r.\u0275fac=(()=>{let n;return function(a){return(n||(n=Pt(r)))(a||r)}})(),r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})(),Tl=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Tl||{});function iT(e,r){e.events.pipe(Qe(t=>t instanceof gs||t instanceof ia||t instanceof Ml||t instanceof vs),Ue(t=>t instanceof gs||t instanceof vs?Tl.COMPLETE:(t instanceof ia?t.code===zn.Redirect||t.code===zn.SupersededByNewNavigation:!1)?Tl.REDIRECTING:Tl.FAILED),Qe(t=>t!==Tl.REDIRECTING),Zs(1)).subscribe(()=>{r()})}function aT(e){throw e}var sT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},oT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},X1=(()=>{let r=class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=$e(uu),this.stateManager=$e(q1),this.options=$e(id,{optional:!0})||{},this.pendingTasks=$e(nu),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=$e(JS),this.urlSerializer=$e(ed),this.location=$e(du),this.urlHandlingStrategy=$e(od),this._events=new Rt,this.errorHandler=this.options.errorHandler||aT,this.navigated=!1,this.routeReuseStrategy=$e(tT),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=$e(sd,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!$e(nd,{optional:!0}),this.eventsSubscription=new rg,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let a=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(a!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof ia&&i.code!==zn.Redirect&&i.code!==zn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof gs)this.navigated=!0;else if(i instanceof po){let o=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,a.currentRawUrl),c=ie({browserUrl:a.extras.browserUrl,info:a.extras.info,skipLocationChange:a.extras.skipLocationChange,replaceUrl:a.extras.replaceUrl||this.urlUpdateStrategy==="eager"||eT(a.source)},o);this.scheduleNavigation(l,kl,null,c,{resolve:a.resolve,reject:a.reject,promise:a.promise})}}cT(i)&&this._events.next(i)}catch(a){this.navigationTransitions.transitionAbortSubject.next(a)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),kl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,a){let s={replaceUrl:!0},o=a?.navigationId?a:null;if(a){let c=ie({},a);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let l=this.parseUrl(n);this.scheduleNavigation(l,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(ad),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:a,queryParams:s,fragment:o,queryParamsHandling:l,preserveFragment:c}=i,u=c?this.currentUrlTree.fragment:o,f=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":f=ie(ie({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let h;try{let d=a?a.snapshot:this.routerState.snapshot.root;h=F1(d)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),h=this.currentUrlTree.root}return D1(h,n,f,u??null)}navigateByUrl(n,i={skipLocationChange:!1}){let a=Fl(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(a,this.rawUrlTree);return this.scheduleNavigation(s,kl,null,i)}navigate(n,i={skipLocationChange:!1}){return lT(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let a;if(i===!0?a=ie({},sT):i===!1?a=ie({},oT):a=i,Fl(n))return p1(this.currentUrlTree,n,a);let s=this.parseUrl(n);return p1(this.currentUrlTree,s,a)}removeEmptyProps(n){return Object.entries(n).reduce((i,[a,s])=>(s!=null&&(i[a]=s),i),{})}scheduleNavigation(n,i,a,s,o){if(this.disposed)return Promise.resolve(!1);let l,c,u;o?(l=o.resolve,c=o.reject,u=o.promise):u=new Promise((h,d)=>{l=h,c=d});let f=this.pendingTasks.add();return iT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:a,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();function lT(e){for(let r=0;r<e.length;r++)if(e[r]==null)throw new Jt(4008,!1)}function cT(e){return!(e instanceof Nl)&&!(e instanceof po)}var uT=new Kt("");function Q1(e,...r){return cs([{provide:sd,multi:!0,useValue:e},[],{provide:mo,useFactory:fT,deps:[X1]},{provide:sh,multi:!0,useFactory:hT},r.map(t=>t.\u0275providers)])}function fT(e){return e.routerState.root}function hT(){let e=$e(Y0);return r=>{let t=e.get(hu);if(r!==t.components[0])return;let n=e.get(X1),i=e.get(dT);e.get(pT)===1&&n.initialNavigation(),e.get(mT,null,Q0.Optional)?.setUpPreloading(),e.get(uT,null,Q0.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var dT=new Kt("",{factory:()=>new Rt}),pT=new Kt("",{providedIn:"root",factory:()=>1});var mT=new Kt("");var Je=class e{static isArray(r,t=!0){return Array.isArray(r)&&(t||r.length!==0)}static isObject(r,t=!0){return typeof r=="object"&&!Array.isArray(r)&&r!=null&&(t||Object.keys(r).length!==0)}static equals(r,t,n){return n?this.resolveFieldData(r,n)===this.resolveFieldData(t,n):this.equalsByValue(r,t)}static equalsByValue(r,t){if(r===t)return!0;if(r&&t&&typeof r=="object"&&typeof t=="object"){var n=Array.isArray(r),i=Array.isArray(t),a,s,o;if(n&&i){if(s=r.length,s!=t.length)return!1;for(a=s;a--!==0;)if(!this.equalsByValue(r[a],t[a]))return!1;return!0}if(n!=i)return!1;var l=this.isDate(r),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return r.getTime()==t.getTime();var u=r instanceof RegExp,f=t instanceof RegExp;if(u!=f)return!1;if(u&&f)return r.toString()==t.toString();var h=Object.keys(r);if(s=h.length,s!==Object.keys(t).length)return!1;for(a=s;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,h[a]))return!1;for(a=s;a--!==0;)if(o=h[a],!this.equalsByValue(r[o],t[o]))return!1;return!0}return r!==r&&t!==t}static resolveFieldData(r,t){if(r&&t){if(this.isFunction(t))return t(r);if(t.indexOf(".")==-1)return r[t];{let n=t.split("."),i=r;for(let a=0,s=n.length;a<s;++a){if(i==null)return null;i=i[n[a]]}return i}}else return null}static isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)}static reorderArray(r,t,n){let i;r&&t!==n&&(n>=r.length&&(n%=r.length,t%=r.length),r.splice(n,0,r.splice(t,1)[0]))}static insertIntoOrderedArray(r,t,n,i){if(n.length>0){let a=!1;for(let s=0;s<n.length;s++)if(this.findIndexInList(n[s],i)>t){n.splice(s,0,r),a=!0;break}a||n.push(r)}else n.push(r)}static findIndexInList(r,t){let n=-1;if(t){for(let i=0;i<t.length;i++)if(t[i]==r){n=i;break}}return n}static contains(r,t){if(r!=null&&t&&t.length){for(let n of t)if(this.equals(r,n))return!0}return!1}static removeAccents(r){return r&&(r=r.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"")),r}static isDate(r){return Object.prototype.toString.call(r)==="[object Date]"}static isEmpty(r){return r==null||r===""||Array.isArray(r)&&r.length===0||!this.isDate(r)&&typeof r=="object"&&Object.keys(r).length===0}static isNotEmpty(r){return!this.isEmpty(r)}static compare(r,t,n,i=1){let a=-1,s=this.isEmpty(r),o=this.isEmpty(t);return s&&o?a=0:s?a=i:o?a=-i:typeof r=="string"&&typeof t=="string"?a=r.localeCompare(t,n,{numeric:!0}):a=r<t?-1:r>t?1:0,a}static sort(r,t,n=1,i,a=1){let s=e.compare(r,t,i,n),o=n;return(e.isEmpty(r)||e.isEmpty(t))&&(o=a===1?n:a),o*s}static merge(r,t){if(!(r==null&&t==null)){{if((r==null||typeof r=="object")&&(t==null||typeof t=="object"))return ie(ie({},r||{}),t||{});if((r==null||typeof r=="string")&&(t==null||typeof t=="string"))return[r||"",t||""].join(" ")}return t||r}}static isPrintableCharacter(r=""){return this.isNotEmpty(r)&&r.length===1&&r.match(/\S| /)}static getItemValue(r,...t){return this.isFunction(r)?r(...t):r}static findLastIndex(r,t){let n=-1;if(this.isNotEmpty(r))try{n=r.findLastIndex(t)}catch{n=r.lastIndexOf([...r].reverse().find(t))}return n}static findLast(r,t){let n;if(this.isNotEmpty(r))try{n=r.findLast(t)}catch{n=[...r].reverse().find(t)}return n}static deepEquals(r,t){if(r===t)return!0;if(r&&t&&typeof r=="object"&&typeof t=="object"){var n=Array.isArray(r),i=Array.isArray(t),a,s,o;if(n&&i){if(s=r.length,s!=t.length)return!1;for(a=s;a--!==0;)if(!this.deepEquals(r[a],t[a]))return!1;return!0}if(n!=i)return!1;var l=r instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return r.getTime()==t.getTime();var u=r instanceof RegExp,f=t instanceof RegExp;if(u!=f)return!1;if(u&&f)return r.toString()==t.toString();var h=Object.keys(r);if(s=h.length,s!==Object.keys(t).length)return!1;for(a=s;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,h[a]))return!1;for(a=s;a--!==0;)if(o=h[a],!this.deepEquals(r[o],t[o]))return!1;return!0}return r!==r&&t!==t}},Y1=0;function br(e="pn_id_"){return Y1++,`${e}${Y1}`}function gT(){let e=[],r=(a,s)=>{let o=e.length>0?e[e.length-1]:{key:a,value:s},l=o.value+(o.key===a?0:s)+2;return e.push({key:a,value:l}),l},t=a=>{e=e.filter(s=>s.value!==a)},n=()=>e.length>0?e[e.length-1].value:0,i=a=>a&&parseInt(a.style.zIndex,10)||0;return{get:i,set:(a,s,o)=>{s&&(s.style.zIndex=String(r(a,o)))},clear:a=>{a&&(t(i(a)),a.style.zIndex="")},getCurrent:()=>n()}}var ui=gT();var Z1=["*"];var gn=(()=>{class e{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"}return e})();var J1=(()=>{class e{filter(t,n,i,a,s){let o=[];if(t)for(let l of t)for(let c of n){let u=Je.resolveFieldData(l,c);if(this.filters[a](u,i,s)){o.push(l);break}}return o}filters={startsWith:(t,n,i)=>{if(n==null||n.trim()==="")return!0;if(t==null)return!1;let a=Je.removeAccents(n.toString()).toLocaleLowerCase(i);return Je.removeAccents(t.toString()).toLocaleLowerCase(i).slice(0,a.length)===a},contains:(t,n,i)=>{if(n==null||typeof n=="string"&&n.trim()==="")return!0;if(t==null)return!1;let a=Je.removeAccents(n.toString()).toLocaleLowerCase(i);return Je.removeAccents(t.toString()).toLocaleLowerCase(i).indexOf(a)!==-1},notContains:(t,n,i)=>{if(n==null||typeof n=="string"&&n.trim()==="")return!0;if(t==null)return!1;let a=Je.removeAccents(n.toString()).toLocaleLowerCase(i);return Je.removeAccents(t.toString()).toLocaleLowerCase(i).indexOf(a)===-1},endsWith:(t,n,i)=>{if(n==null||n.trim()==="")return!0;if(t==null)return!1;let a=Je.removeAccents(n.toString()).toLocaleLowerCase(i),s=Je.removeAccents(t.toString()).toLocaleLowerCase(i);return s.indexOf(a,s.length-a.length)!==-1},equals:(t,n,i)=>n==null||typeof n=="string"&&n.trim()===""?!0:t==null?!1:t.getTime&&n.getTime?t.getTime()===n.getTime():t==n?!0:Je.removeAccents(t.toString()).toLocaleLowerCase(i)==Je.removeAccents(n.toString()).toLocaleLowerCase(i),notEquals:(t,n,i)=>n==null||typeof n=="string"&&n.trim()===""?!1:t==null?!0:t.getTime&&n.getTime?t.getTime()!==n.getTime():t==n?!1:Je.removeAccents(t.toString()).toLocaleLowerCase(i)!=Je.removeAccents(n.toString()).toLocaleLowerCase(i),in:(t,n)=>{if(n==null||n.length===0)return!0;for(let i=0;i<n.length;i++)if(Je.equals(t,n[i]))return!0;return!1},between:(t,n)=>n==null||n[0]==null||n[1]==null?!0:t==null?!1:t.getTime?n[0].getTime()<=t.getTime()&&t.getTime()<=n[1].getTime():n[0]<=t&&t<=n[1],lt:(t,n,i)=>n==null?!0:t==null?!1:t.getTime&&n.getTime?t.getTime()<n.getTime():t<n,lte:(t,n,i)=>n==null?!0:t==null?!1:t.getTime&&n.getTime?t.getTime()<=n.getTime():t<=n,gt:(t,n,i)=>n==null?!0:t==null?!1:t.getTime&&n.getTime?t.getTime()>n.getTime():t>n,gte:(t,n,i)=>n==null?!0:t==null?!1:t.getTime&&n.getTime?t.getTime()>=n.getTime():t>=n,is:(t,n,i)=>this.filters.equals(t,n,i),isNot:(t,n,i)=>this.filters.notEquals(t,n,i),before:(t,n,i)=>this.filters.lt(t,n,i),after:(t,n,i)=>this.filters.gt(t,n,i),dateIs:(t,n)=>n==null?!0:t==null?!1:t.toDateString()===n.toDateString(),dateIsNot:(t,n)=>n==null?!0:t==null?!1:t.toDateString()!==n.toDateString(),dateBefore:(t,n)=>n==null?!0:t==null?!1:t.getTime()<n.getTime(),dateAfter:(t,n)=>{if(n==null)return!0;if(t==null)return!1;let i=new Date(t);return i.setHours(0,0,0,0),i.getTime()>n.getTime()}};register(t,n){this.filters[t]=n}static \u0275fac=function(n){return new(n||e)};static \u0275prov=dt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ba=(()=>{class e{messageSource=new Rt;clearSource=new Rt;messageObserver=this.messageSource.asObservable();clearObserver=this.clearSource.asObservable();add(t){t&&this.messageSource.next(t)}addAll(t){t&&t.length&&this.messageSource.next(t)}clear(t){this.clearSource.next(t||null)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=dt({token:e,factory:e.\u0275fac})}return e})(),ev=(()=>{class e{clickSource=new Rt;clickObservable=this.clickSource.asObservable();add(t){t&&this.clickSource.next(t)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=dt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var an=(()=>{class e{ripple=!1;inputStyle=Sr("outlined");overlayOptions={};csp=Sr({nonce:void 0});filterMatchModeOptions={text:[gn.STARTS_WITH,gn.CONTAINS,gn.NOT_CONTAINS,gn.ENDS_WITH,gn.EQUALS,gn.NOT_EQUALS],numeric:[gn.EQUALS,gn.NOT_EQUALS,gn.LESS_THAN,gn.LESS_THAN_OR_EQUAL_TO,gn.GREATER_THAN,gn.GREATER_THAN_OR_EQUAL_TO],date:[gn.DATE_IS,gn.DATE_IS_NOT,gn.DATE_BEFORE,gn.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List",selectColor:"Select a color",removeLabel:"Remove",browseFiles:"Browse Files",maximizeLabel:"Maximize"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new Rt;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation=ie(ie({},this.translation),t),this.translationSource.next(this.translation)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=dt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),tv=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["p-header"]],standalone:!0,features:[ot],ngContentSelectors:Z1,decls:1,vars:0,template:function(n,i){n&1&&(Pr(),xr(0))},encapsulation:2})}return e})(),rv=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["p-footer"]],standalone:!0,features:[ot],ngContentSelectors:Z1,decls:1,vars:0,template:function(n,i){n&1&&(Pr(),xr(0))},encapsulation:2})}return e})(),mr=(()=>{class e{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(n){return new(n||e)(ce(iu))};static \u0275dir=Mr({type:e,selectors:[["","pTemplate",""]],inputs:{type:"type",name:[0,"pTemplate","name"]},standalone:!0})}return e})(),lr=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({})}return e})(),Si=(()=>{class e{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static NO_FILTER="noFilter";static LT="lt";static LTE="lte";static GT="gt";static GTE="gte";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static CLEAR="clear";static APPLY="apply";static MATCH_ALL="matchAll";static MATCH_ANY="matchAny";static ADD_RULE="addRule";static REMOVE_RULE="removeRule";static ACCEPT="accept";static REJECT="reject";static CHOOSE="choose";static UPLOAD="upload";static CANCEL="cancel";static PENDING="pending";static FILE_SIZE_TYPES="fileSizeTypes";static DAY_NAMES="dayNames";static DAY_NAMES_SHORT="dayNamesShort";static DAY_NAMES_MIN="dayNamesMin";static MONTH_NAMES="monthNames";static MONTH_NAMES_SHORT="monthNamesShort";static FIRST_DAY_OF_WEEK="firstDayOfWeek";static TODAY="today";static WEEK_HEADER="weekHeader";static WEAK="weak";static MEDIUM="medium";static STRONG="strong";static PASSWORD_PROMPT="passwordPrompt";static EMPTY_MESSAGE="emptyMessage";static EMPTY_FILTER_MESSAGE="emptyFilterMessage";static SHOW_FILTER_MENU="showFilterMenu";static HIDE_FILTER_MENU="hideFilterMenu";static SELECTION_MESSAGE="selectionMessage";static ARIA="aria";static SELECT_COLOR="selectColor";static BROWSE_FILES="browseFiles"}return e})();var J=(()=>{class e{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,n){t&&n&&(t.classList?t.classList.add(n):t.className+=" "+n)}static addMultipleClasses(t,n){if(t&&n)if(t.classList){let i=n.trim().split(" ");for(let a=0;a<i.length;a++)t.classList.add(i[a])}else{let i=n.split(" ");for(let a=0;a<i.length;a++)t.className+=" "+i[a]}}static removeClass(t,n){t&&n&&(t.classList?t.classList.remove(n):t.className=t.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(t,n){t&&n&&[n].flat().filter(Boolean).forEach(i=>i.split(" ").forEach(a=>this.removeClass(t,a)))}static hasClass(t,n){return t&&n?t.classList?t.classList.contains(n):new RegExp("(^| )"+n+"( |$)","gi").test(t.className):!1}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(n){return n!==t})}static find(t,n){return Array.from(t.querySelectorAll(n))}static findSingle(t,n){return this.isElement(t)?t.querySelector(n):null}static index(t){let n=t.parentNode.childNodes,i=0;for(var a=0;a<n.length;a++){if(n[a]==t)return i;n[a].nodeType==1&&i++}return-1}static indexWithinGroup(t,n){let i=t.parentNode?t.parentNode.childNodes:[],a=0;for(var s=0;s<i.length;s++){if(i[s]==t)return a;i[s].attributes&&i[s].attributes[n]&&i[s].nodeType==1&&a++}return-1}static appendOverlay(t,n,i="self"){i!=="self"&&t&&n&&this.appendChild(t,n)}static alignOverlay(t,n,i="self",a=!0){t&&n&&(a&&(t.style.minWidth=`${e.getOuterWidth(n)}px`),i==="self"?this.relativePosition(t,n):this.absolutePosition(t,n))}static relativePosition(t,n,i=!0){let a=x=>{if(x)return getComputedStyle(x).getPropertyValue("position")==="relative"?x:a(x.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=n.offsetHeight??n.getBoundingClientRect().height,l=n.getBoundingClientRect(),c=this.getWindowScrollTop(),u=this.getWindowScrollLeft(),f=this.getViewport(),d=a(t)?.getBoundingClientRect()||{top:-1*c,left:-1*u},g,v;l.top+o+s.height>f.height?(g=l.top-d.top-s.height,t.style.transformOrigin="bottom",l.top+g<0&&(g=-1*l.top)):(g=o+l.top-d.top,t.style.transformOrigin="top");let p=l.left+s.width-f.width,m=l.left-d.left;s.width>f.width?v=(l.left-d.left)*-1:p>0?v=m-p:v=l.left-d.left,t.style.top=g+"px",t.style.left=v+"px",i&&(t.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static absolutePosition(t,n,i=!0){let a=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=a.height,o=a.width,l=n.offsetHeight??n.getBoundingClientRect().height,c=n.offsetWidth??n.getBoundingClientRect().width,u=n.getBoundingClientRect(),f=this.getWindowScrollTop(),h=this.getWindowScrollLeft(),d=this.getViewport(),g,v;u.top+l+s>d.height?(g=u.top+f-s,t.style.transformOrigin="bottom",g<0&&(g=f)):(g=l+u.top+f,t.style.transformOrigin="top"),u.left+o>d.width?v=Math.max(0,u.left+h+c-o):v=u.left+h,t.style.top=g+"px",t.style.left=v+"px",i&&(t.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static getParents(t,n=[]){return t.parentNode===null?n:this.getParents(t.parentNode,n.concat([t.parentNode]))}static getScrollableParents(t){let n=[];if(t){let i=this.getParents(t),a=/(auto|scroll)/,s=o=>{let l=window.getComputedStyle(o,null);return a.test(l.getPropertyValue("overflow"))||a.test(l.getPropertyValue("overflowX"))||a.test(l.getPropertyValue("overflowY"))};for(let o of i){let l=o.nodeType===1&&o.dataset.scrollselectors;if(l){let c=l.split(",");for(let u of c){let f=this.findSingle(o,u);f&&s(f)&&n.push(f)}}o.nodeType!==9&&s(o)&&n.push(o)}}return n}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let n=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",n}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let n=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",n}static getHiddenElementDimensions(t){let n={};return t.style.visibility="hidden",t.style.display="block",n.width=t.offsetWidth,n.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",n}static scrollInView(t,n){let i=getComputedStyle(t).getPropertyValue("borderTopWidth"),a=i?parseFloat(i):0,s=getComputedStyle(t).getPropertyValue("paddingTop"),o=s?parseFloat(s):0,l=t.getBoundingClientRect(),u=n.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-a-o,f=t.scrollTop,h=t.clientHeight,d=this.getOuterHeight(n);u<0?t.scrollTop=f+u:u+d>h&&(t.scrollTop=f+u-h+d)}static fadeIn(t,n){t.style.opacity=0;let i=+new Date,a=0,s=function(){a=+t.style.opacity.replace(",",".")+(new Date().getTime()-i)/n,t.style.opacity=a,i=+new Date,+a<1&&(window.requestAnimationFrame&&requestAnimationFrame(s)||setTimeout(s,16))};s()}static fadeOut(t,n){var i=1,a=50,s=n,o=a/s;let l=setInterval(()=>{i=i-o,i<=0&&(i=0,clearInterval(l)),t.style.opacity=i},a)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,n){var i=Element.prototype,a=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(s){return[].indexOf.call(document.querySelectorAll(s),this)!==-1};return a.call(t,n)}static getOuterWidth(t,n){let i=t.offsetWidth;if(n){let a=getComputedStyle(t);i+=parseFloat(a.marginLeft)+parseFloat(a.marginRight)}return i}static getHorizontalPadding(t){let n=getComputedStyle(t);return parseFloat(n.paddingLeft)+parseFloat(n.paddingRight)}static getHorizontalMargin(t){let n=getComputedStyle(t);return parseFloat(n.marginLeft)+parseFloat(n.marginRight)}static innerWidth(t){let n=t.offsetWidth,i=getComputedStyle(t);return n+=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),n}static width(t){let n=t.offsetWidth,i=getComputedStyle(t);return n-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),n}static getInnerHeight(t){let n=t.offsetHeight,i=getComputedStyle(t);return n+=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom),n}static getOuterHeight(t,n){let i=t.offsetHeight;if(n){let a=getComputedStyle(t);i+=parseFloat(a.marginTop)+parseFloat(a.marginBottom)}return i}static getHeight(t){let n=t.offsetHeight,i=getComputedStyle(t);return n-=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)+parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth),n}static getWidth(t){let n=t.offsetWidth,i=getComputedStyle(t);return n-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)+parseFloat(i.borderLeftWidth)+parseFloat(i.borderRightWidth),n}static getViewport(){let t=window,n=document,i=n.documentElement,a=n.getElementsByTagName("body")[0],s=t.innerWidth||i.clientWidth||a.clientWidth,o=t.innerHeight||i.clientHeight||a.clientHeight;return{width:s,height:o}}static getOffset(t){var n=t.getBoundingClientRect();return{top:n.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:n.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,n){let i=t.parentNode;if(!i)throw"Can't replace element";return i.replaceChild(n,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent,n=t.indexOf("MSIE ");if(n>0)return!0;var i=t.indexOf("Trident/");if(i>0){var a=t.indexOf("rv:");return!0}var s=t.indexOf("Edge/");return s>0}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,n){if(this.isElement(n))n.appendChild(t);else if(n&&n.el&&n.el.nativeElement)n.el.nativeElement.appendChild(t);else throw"Cannot append "+n+" to "+t}static removeChild(t,n){if(this.isElement(n))n.removeChild(t);else if(n.el&&n.el.nativeElement)n.el.nativeElement.removeChild(t);else throw"Cannot remove "+t+" from "+n}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return typeof HTMLElement=="object"?t instanceof HTMLElement:t&&typeof t=="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName=="string"}static calculateScrollbarWidth(t){if(t){let n=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth)}else{if(this.calculatedScrollbarWidth!==null)return this.calculatedScrollbarWidth;let n=document.createElement("div");n.className="p-scrollbar-measure",document.body.appendChild(n);let i=n.offsetWidth-n.clientWidth;return document.body.removeChild(n),this.calculatedScrollbarWidth=i,i}}static calculateScrollbarHeight(){if(this.calculatedScrollbarHeight!==null)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let n=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=n,n}static invokeElementMethod(t,n,i){t[n].apply(t,i)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:n[1]||"",version:n[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||t.offsetParent===null}static isVisible(t){return t&&t.offsetParent!=null}static isExist(t){return t!==null&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,n){t&&document.activeElement!==t&&t.focus(n)}static getFocusableSelectorString(t=""){return`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        .p-inputtext:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        .p-button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t}`}static getFocusableElements(t,n=""){let i=this.find(t,this.getFocusableSelectorString(n)),a=[];for(let s of i){let o=getComputedStyle(s);this.isVisible(s)&&o.display!="none"&&o.visibility!="hidden"&&a.push(s)}return a}static getFocusableElement(t,n=""){let i=this.findSingle(t,this.getFocusableSelectorString(n));if(i){let a=getComputedStyle(i);if(this.isVisible(i)&&a.display!="none"&&a.visibility!="hidden")return i}return null}static getFirstFocusableElement(t,n=""){let i=this.getFocusableElements(t,n);return i.length>0?i[0]:null}static getLastFocusableElement(t,n){let i=this.getFocusableElements(t,n);return i.length>0?i[i.length-1]:null}static getNextFocusableElement(t,n=!1){let i=e.getFocusableElements(t),a=0;if(i&&i.length>0){let s=i.indexOf(i[0].ownerDocument.activeElement);n?s==-1||s===0?a=i.length-1:a=s-1:s!=-1&&s!==i.length-1&&(a=s+1)}return i[a]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,n){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return n?.nextElementSibling;case"@prev":return n?.previousElementSibling;case"@parent":return n?.parentElement;case"@grandparent":return n?.parentElement.parentElement;default:let i=typeof t;if(i==="string")return document.querySelector(t);if(i==="object"&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;let s=(o=>!!(o&&o.constructor&&o.call&&o.apply))(t)?t():t;return s&&s.nodeType===9||this.isExist(s)?s:null}}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,n){if(t){let i=t.getAttribute(n);return isNaN(i)?i==="true"||i==="false"?i==="true":i:+i}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}static createElement(t,n={},...i){if(t){let a=document.createElement(t);return this.setAttributes(a,n),a.append(...i),a}}static setAttribute(t,n="",i){this.isElement(t)&&i!==null&&i!==void 0&&t.setAttribute(n,i)}static setAttributes(t,n={}){if(this.isElement(t)){let i=(a,s)=>{let o=t?.$attrs?.[a]?[t?.$attrs?.[a]]:[];return[s].flat().reduce((l,c)=>{if(c!=null){let u=typeof c;if(u==="string"||u==="number")l.push(c);else if(u==="object"){let f=Array.isArray(c)?i(a,c):Object.entries(c).map(([h,d])=>a==="style"&&(d||d===0)?`${h.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${d}`:d?h:void 0);l=f.length?l.concat(f.filter(h=>!!h)):l}}return l},o)};Object.entries(n).forEach(([a,s])=>{if(s!=null){let o=a.match(/^on(.+)/);o?t.addEventListener(o[1].toLowerCase(),s):a==="pBind"?this.setAttributes(t,s):(s=a==="class"?[...new Set(i("class",s))].join(" ").trim():a==="style"?i("style",s).join(";").trim():s,(t.$attrs=t.$attrs||{})&&(t.$attrs[a]=s),t.setAttribute(a,s))}})}}static isFocusableElement(t,n=""){return this.isElement(t)?t.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n}`):!1}}return e})(),_o=class{element;listener;scrollableParents;constructor(r,t=()=>{}){this.element=r,this.listener=t}bindScrollListener(){this.scrollableParents=J.getScrollableParents(this.element);for(let r=0;r<this.scrollableParents.length;r++)this.scrollableParents[r].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let r=0;r<this.scrollableParents.length;r++)this.scrollableParents[r].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}};var vT=["*"],rr=(()=>{class e{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){let t=Je.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:[2,"spin","spin",Se],styleClass:"styleClass"},standalone:!0,features:[Qt,ot],ngContentSelectors:vT,decls:1,vars:0,template:function(n,i){n&1&&(Pr(),xr(0))},encapsulation:2,changeDetection:0})}return e})();var ld=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["ChevronLeftIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M9.61296 13C9.50997 13.0005 9.40792 12.9804 9.3128 12.9409C9.21767 12.9014 9.13139 12.8433 9.05902 12.7701L3.83313 7.54416C3.68634 7.39718 3.60388 7.19795 3.60388 6.99022C3.60388 6.78249 3.68634 6.58325 3.83313 6.43628L9.05902 1.21039C9.20762 1.07192 9.40416 0.996539 9.60724 1.00012C9.81032 1.00371 10.0041 1.08597 10.1477 1.22959C10.2913 1.37322 10.3736 1.56698 10.3772 1.77005C10.3808 1.97313 10.3054 2.16968 10.1669 2.31827L5.49496 6.99022L10.1669 11.6622C10.3137 11.8091 10.3962 12.0084 10.3962 12.2161C10.3962 12.4238 10.3137 12.6231 10.1669 12.7701C10.0945 12.8433 10.0083 12.9014 9.91313 12.9409C9.81801 12.9804 9.71596 13.0005 9.61296 13Z","fill","currentColor"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"path",1),j()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return e})();var cd=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["ChevronRightIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z","fill","currentColor"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"path",1),j()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return e})();var In=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["TimesIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z","fill","currentColor"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"path",1),j()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return e})();var fi=(()=>{class e{document;platformId;renderer;el;zone;config;constructor(t,n,i,a,s,o){this.document=t,this.platformId=n,this.renderer=i,this.el=a,this.zone=s,this.config=o}animationListener;mouseDownListener;timeout;ngAfterViewInit(){qr(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let n=this.getInk();if(!n||this.document.defaultView?.getComputedStyle(n,null).display==="none")return;if(J.removeClass(n,"p-ink-active"),!J.getHeight(n)&&!J.getWidth(n)){let o=Math.max(J.getOuterWidth(this.el.nativeElement),J.getOuterHeight(this.el.nativeElement));n.style.height=o+"px",n.style.width=o+"px"}let i=J.getOffset(this.el.nativeElement),a=t.pageX-i.left+this.document.body.scrollTop-J.getWidth(n)/2,s=t.pageY-i.top+this.document.body.scrollLeft-J.getHeight(n)/2;this.renderer.setStyle(n,"top",s+"px"),this.renderer.setStyle(n,"left",a+"px"),J.addClass(n,"p-ink-active"),this.timeout=setTimeout(()=>{let o=this.getInk();o&&J.removeClass(o,"p-ink-active")},401)}getInk(){let t=this.el.nativeElement.children;for(let n=0;n<t.length;n++)if(typeof t[n].className=="string"&&t[n].className.indexOf("p-ink")!==-1)return t[n];return null}resetInk(){let t=this.getInk();t&&J.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),J.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,J.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(n){return new(n||e)(ce(Ut),ce(Er),ce(Nr),ce(qt),ce(fr),ce(an,8))};static \u0275dir=Mr({type:e,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"],standalone:!0})}return e})(),Hi=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({})}return e})();var Uu=(()=>{class e{platformId;el;zone;config;renderer;viewContainer;tooltipPosition;tooltipEvent="hover";appendTo;positionStyle;tooltipStyleClass;tooltipZIndex;escape=!0;showDelay;hideDelay;life;positionTop;positionLeft;autoHide=!0;fitContent=!0;hideOnEscape=!0;content;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this.deactivate()}tooltipOptions;_tooltipOptions={tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0,id:br()+"_tooltip"};_disabled;container;styleClass;tooltipText;showTimeout;hideTimeout;active;mouseEnterListener;mouseLeaveListener;containerMouseleaveListener;clickListener;focusListener;blurListener;scrollHandler;resizeListener;interactionInProgress=!1;constructor(t,n,i,a,s,o){this.platformId=t,this.el=n,this.zone=i,this.config=a,this.renderer=s,this.viewContainer=o}ngAfterViewInit(){qr(this.platformId)&&this.zone.runOutsideAngular(()=>{let t=this.getOption("tooltipEvent");if((t==="hover"||t==="both")&&(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener)),t==="focus"||t==="both"){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let n=this.getTarget(this.el.nativeElement);n.addEventListener("focus",this.focusListener),n.addEventListener("blur",this.blurListener)}})}ngOnChanges(t){t.tooltipPosition&&this.setOption({tooltipPosition:t.tooltipPosition.currentValue}),t.tooltipEvent&&this.setOption({tooltipEvent:t.tooltipEvent.currentValue}),t.appendTo&&this.setOption({appendTo:t.appendTo.currentValue}),t.positionStyle&&this.setOption({positionStyle:t.positionStyle.currentValue}),t.tooltipStyleClass&&this.setOption({tooltipStyleClass:t.tooltipStyleClass.currentValue}),t.tooltipZIndex&&this.setOption({tooltipZIndex:t.tooltipZIndex.currentValue}),t.escape&&this.setOption({escape:t.escape.currentValue}),t.showDelay&&this.setOption({showDelay:t.showDelay.currentValue}),t.hideDelay&&this.setOption({hideDelay:t.hideDelay.currentValue}),t.life&&this.setOption({life:t.life.currentValue}),t.positionTop&&this.setOption({positionTop:t.positionTop.currentValue}),t.positionLeft&&this.setOption({positionLeft:t.positionLeft.currentValue}),t.disabled&&this.setOption({disabled:t.disabled.currentValue}),t.content&&(this.setOption({tooltipLabel:t.content.currentValue}),this.active&&(t.content.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),t.autoHide&&this.setOption({autoHide:t.autoHide.currentValue}),t.id&&this.setOption({id:t.id.currentValue}),t.tooltipOptions&&(this._tooltipOptions=ie(ie({},this._tooltipOptions),t.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(t){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(t){this.isAutoHide()?this.deactivate():!(J.hasClass(t.relatedTarget,"p-tooltip")||J.hasClass(t.relatedTarget,"p-tooltip-text")||J.hasClass(t.relatedTarget,"p-tooltip-arrow"))&&this.deactivate()}onFocus(t){this.activate()}onBlur(t){this.deactivate()}onInputClick(t){this.deactivate()}onPressEscape(){this.hideOnEscape&&this.deactivate()}activate(){if(!this.interactionInProgress&&(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life"))){let t=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},t)}this.interactionInProgress=!0}deactivate(){this.interactionInProgress=!1,this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div"),this.container.setAttribute("id",this.getOption("id")),this.container.setAttribute("role","tooltip");let t=document.createElement("div");t.className="p-tooltip-arrow",this.container.appendChild(t),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),this.getOption("appendTo")==="body"?document.body.appendChild(this.container):this.getOption("appendTo")==="target"?J.appendChild(this.container,this.el.nativeElement):J.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()?this.container.style.pointerEvents="none":(this.container.style.pointerEvents="unset",this.bindContainerMouseleaveListener())}bindContainerMouseleaveListener(){if(!this.containerMouseleaveListener){let t=this.container??this.container.nativeElement;this.containerMouseleaveListener=this.renderer.listen(t,"mouseleave",n=>{this.deactivate()})}}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){if(!this.getOption("tooltipLabel")||this.getOption("disabled"))return;this.create(),this.el.nativeElement.closest("p-dialog")?setTimeout(()=>{this.container&&this.align()},100):this.align(),J.fadeIn(this.container,250),this.getOption("tooltipZIndex")==="auto"?ui.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener()}hide(){this.getOption("tooltipZIndex")==="auto"&&ui.clear(this.container),this.remove()}updateText(){let t=this.getOption("tooltipLabel");if(t instanceof iu){let n=this.viewContainer.createEmbeddedView(t);n.detectChanges(),n.rootNodes.forEach(i=>this.tooltipText.appendChild(i))}else this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(t))):this.tooltipText.innerHTML=t}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break}}getHostOffset(){if(this.getOption("appendTo")==="body"||this.getOption("appendTo")==="target"){let t=this.el.nativeElement.getBoundingClientRect(),n=t.left+J.getWindowScrollLeft(),i=t.top+J.getWindowScrollTop();return{left:n,top:i}}else return{left:0,top:0}}alignRight(){this.preAlign("right");let t=this.activeElement,n=this.getHostOffset(),i=n.left+J.getOuterWidth(t),a=n.top+(J.getOuterHeight(t)-J.getOuterHeight(this.container))/2;this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=a+this.getOption("positionTop")+"px"}get activeElement(){return this.el.nativeElement.nodeName.includes("P-")?J.findSingle(this.el.nativeElement,".p-component")||this.el.nativeElement:this.el.nativeElement}alignLeft(){this.preAlign("left");let t=this.getHostOffset(),n=t.left-J.getOuterWidth(this.container),i=t.top+(J.getOuterHeight(this.el.nativeElement)-J.getOuterHeight(this.container))/2;this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=i+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let t=this.getHostOffset(),n=t.left+(J.getOuterWidth(this.el.nativeElement)-J.getOuterWidth(this.container))/2,i=t.top-J.getOuterHeight(this.container);this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=i+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let t=this.getHostOffset(),n=t.left+(J.getOuterWidth(this.el.nativeElement)-J.getOuterWidth(this.container))/2,i=t.top+J.getOuterHeight(this.el.nativeElement);this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=i+this.getOption("positionTop")+"px"}setOption(t){this._tooltipOptions=ie(ie({},this._tooltipOptions),t)}getOption(t){return this._tooltipOptions[t]}getTarget(t){return J.hasClass(t,"p-inputwrapper")?J.findSingle(t,"input"):t.querySelector(".p-component")||t}preAlign(t){this.container.style.left="-999px",this.container.style.top="-999px";let n="p-tooltip p-component p-tooltip-"+t;this.container.className=this.getOption("tooltipStyleClass")?n+" "+this.getOption("tooltipStyleClass"):n}isOutOfBounds(){let t=this.container.getBoundingClientRect(),n=t.top,i=t.left,a=J.getOuterWidth(this.container),s=J.getOuterHeight(this.container),o=J.getViewport();return i+a>o.width||i<0||n<0||n+s>o.height}onWindowResize(t){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new _o(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){let t=this.getOption("tooltipEvent");if((t==="hover"||t==="both")&&(this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener)),t==="focus"||t==="both"){let n=this.getTarget(this.el.nativeElement);n.removeEventListener("focus",this.focusListener),n.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&(this.getOption("appendTo")==="body"?document.body.removeChild(this.container):this.getOption("appendTo")==="target"?this.el.nativeElement.removeChild(this.container):J.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&ui.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}static \u0275fac=function(n){return new(n||e)(ce(Er),ce(qt),ce(fr),ce(an),ce(Nr),ce(no))};static \u0275dir=Mr({type:e,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],hostBindings:function(n,i){n&1&&Pe("keydown.escape",function(s){return i.onPressEscape(s)},!1,Tg)},inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:[2,"escape","escape",Se],showDelay:[2,"showDelay","showDelay",tr],hideDelay:[2,"hideDelay","hideDelay",tr],life:[2,"life","life",tr],positionTop:[2,"positionTop","positionTop",tr],positionLeft:[2,"positionLeft","positionLeft",tr],autoHide:[2,"autoHide","autoHide",Se],fitContent:[2,"fitContent","fitContent",Se],hideOnEscape:[2,"hideOnEscape","hideOnEscape",Se],content:[0,"pTooltip","content"],disabled:[0,"tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[Qt,Da]})}return e})(),$u=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et]})}return e})();var iv=["*"];function _T(e,r){e&1&&st(0)}function xT(e,r){if(e&1&&(Ye(0),Y(1,_T,1,0,"ng-container",3),Ze()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.contentTemplate)}}function yT(e,r){if(e&1&&(z(0,"div",1),xr(1),Y(2,xT,2,1,"ng-container",2),j()),e&2){let t=P();b("hidden",!t.selected),ee("id",t.tabView.getTabContentId(t.id))("aria-hidden",!t.selected)("aria-labelledby",t.tabView.getTabHeaderActionId(t.id))("data-pc-name","tabpanel"),S(2),b("ngIf",t.contentTemplate&&(t.cache?t.loaded:t.selected))}}var wT=["content"],bT=["navbar"],CT=["prevBtn"],ET=["nextBtn"],ST=["inkbar"],TT=["elementToObserve"],IT=e=>({"p-tabview p-component":!0,"p-tabview-scrollable":e}),kT=(e,r)=>({"p-highlight":e,"p-disabled":r});function AT(e,r){e&1&&ue(0,"ChevronLeftIcon"),e&2&&ee("aria-hidden",!0)}function OT(e,r){}function FT(e,r){e&1&&Y(0,OT,0,0,"ng-template")}function DT(e,r){if(e&1){let t=nt();z(0,"button",15,4),Pe("click",function(){_e(t);let i=P();return xe(i.navBackward())}),Y(2,AT,1,1,"ChevronLeftIcon",16)(3,FT,1,0,null,17),j()}if(e&2){let t=P();ee("tabindex",t.tabindex)("aria-label",t.prevButtonAriaLabel),S(2),b("ngIf",!t.previousIconTemplate),S(),b("ngTemplateOutlet",t.previousIconTemplate)}}function RT(e,r){if(e&1&&ue(0,"span",26),e&2){let t=P(3).$implicit;b("ngClass",t.leftIcon)}}function MT(e,r){}function NT(e,r){e&1&&Y(0,MT,0,0,"ng-template")}function PT(e,r){if(e&1&&(z(0,"span",27),Y(1,NT,1,0,null,17),j()),e&2){let t=P(3).$implicit;S(),b("ngTemplateOutlet",t.leftIconTemplate)}}function LT(e,r){if(e&1&&ue(0,"span",28),e&2){let t=P(3).$implicit;b("ngClass",t.rightIcon)}}function BT(e,r){}function VT(e,r){e&1&&Y(0,BT,0,0,"ng-template")}function UT(e,r){if(e&1&&(z(0,"span",29),Y(1,VT,1,0,null,17),j()),e&2){let t=P(3).$implicit;S(),b("ngTemplateOutlet",t.rightIconTemplate)}}function $T(e,r){if(e&1&&(Ye(0),Y(1,RT,1,1,"span",21)(2,PT,2,1,"span",22),z(3,"span",23),Ct(4),j(),Y(5,LT,1,1,"span",24)(6,UT,2,1,"span",25),Ze()),e&2){let t=P(2).$implicit;S(),b("ngIf",t.leftIcon&&!t.leftIconTemplate),S(),b("ngIf",t.leftIconTemplate),S(2),Tr(t.header),S(),b("ngIf",t.rightIcon&&!t.rightIconTemplate),S(),b("ngIf",t.rightIconTemplate)}}function WT(e,r){e&1&&st(0)}function HT(e,r){if(e&1){let t=nt();z(0,"TimesIcon",32),Pe("click",function(i){_e(t);let a=P(3).$implicit,s=P();return xe(s.close(i,a))}),j()}e&2&&b("styleClass","p-tabview-close")}function zT(e,r){e&1&&ue(0,"span",33)}function jT(e,r){}function GT(e,r){e&1&&Y(0,jT,0,0,"ng-template")}function KT(e,r){if(e&1&&(Ye(0),Y(1,HT,1,1,"TimesIcon",30)(2,zT,1,0,"span",31)(3,GT,1,0,null,17),Ze()),e&2){let t=P(2).$implicit;S(),b("ngIf",!t.closeIconTemplate),S(),b("ngIf",t.closeIconTemplate),S(),b("ngTemplateOutlet",t.closeIconTemplate)}}function qT(e,r){if(e&1){let t=nt();z(0,"li",19)(1,"a",20),Pe("click",function(i){_e(t);let a=P().$implicit,s=P();return xe(s.open(i,a))})("keydown",function(i){_e(t);let a=P().$implicit,s=P();return xe(s.onTabKeyDown(i,a))}),Y(2,$T,7,5,"ng-container",16)(3,WT,1,0,"ng-container",17)(4,KT,4,3,"ng-container",16),j()()}if(e&2){let t=P(),n=t.$implicit,i=t.index,a=P();Ve(n.headerStyleClass),b("ngClass",Hr(19,kT,n.selected,n.disabled))("ngStyle",n.headerStyle),ee("data-p-disabled",n.disabled),S(),b("pTooltip",n.tooltip)("tooltipPosition",n.tooltipPosition)("positionStyle",n.tooltipPositionStyle)("tooltipStyleClass",n.tooltipStyleClass),ee("id",a.getTabHeaderActionId(n.id))("aria-controls",a.getTabContentId(n.id))("aria-selected",n.selected)("tabindex",n.disabled||!n.selected?"-1":a.tabindex)("aria-disabled",n.disabled)("data-pc-index",i)("data-pc-section","headeraction"),S(),b("ngIf",!n.headerTemplate),S(),b("ngTemplateOutlet",n.headerTemplate),S(),b("ngIf",n.closable)}}function XT(e,r){if(e&1&&Y(0,qT,5,22,"li",18),e&2){let t=r.$implicit;b("ngIf",!t.closed)}}function QT(e,r){e&1&&ue(0,"ChevronRightIcon"),e&2&&ee("aria-hidden",!0)}function YT(e,r){}function ZT(e,r){e&1&&Y(0,YT,0,0,"ng-template")}function JT(e,r){if(e&1){let t=nt();z(0,"button",34,5),Pe("click",function(){_e(t);let i=P();return xe(i.navForward())}),Y(2,QT,1,1,"ChevronRightIcon",16)(3,ZT,1,0,null,17),j()}if(e&2){let t=P();ee("tabindex",t.tabindex)("aria-label",t.nextButtonAriaLabel),S(2),b("ngIf",!t.nextIconTemplate),S(),b("ngTemplateOutlet",t.nextIconTemplate)}}var ud=(()=>{class e{el;viewContainer;cd;closable=!1;get headerStyle(){return this._headerStyle}set headerStyle(t){this._headerStyle=t,this.tabView.cd.markForCheck()}get headerStyleClass(){return this._headerStyleClass}set headerStyleClass(t){this._headerStyleClass=t,this.tabView.cd.markForCheck()}cache=!0;tooltip;tooltipPosition="top";tooltipPositionStyle="absolute";tooltipStyleClass;get selected(){return!!this._selected}set selected(t){this._selected=t,this.loaded||this.cd.detectChanges(),t&&(this.loaded=!0)}get disabled(){return!!this._disabled}set disabled(t){this._disabled=t,this.tabView.cd.markForCheck()}get header(){return this._header}set header(t){this._header=t,Promise.resolve().then(()=>{this.tabView.updateInkBar(),this.tabView.cd.markForCheck()})}get leftIcon(){return this._leftIcon}set leftIcon(t){this._leftIcon=t,this.tabView.cd.markForCheck()}get rightIcon(){return this._rightIcon}set rightIcon(t){this._rightIcon=t,this.tabView.cd.markForCheck()}templates;closed=!1;view=null;_headerStyle;_headerStyleClass;_selected;_disabled;_header;_leftIcon;_rightIcon=void 0;loaded=!1;id;contentTemplate;headerTemplate;leftIconTemplate;rightIconTemplate;closeIconTemplate;tabView;constructor(t,n,i,a){this.el=n,this.viewContainer=i,this.cd=a,this.tabView=t,this.id=br()}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":this.contentTemplate=t.template;break;case"righticon":this.rightIconTemplate=t.template;break;case"lefticon":this.leftIconTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}ngOnDestroy(){this.view=null}static \u0275fac=function(n){return new(n||e)(ce(ea(()=>zl)),ce(qt),ce(no),ce(hr))};static \u0275cmp=Fe({type:e,selectors:[["p-tabPanel"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},hostAttrs:[1,"p-element"],inputs:{closable:[2,"closable","closable",Se],headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",cache:[2,"cache","cache",Se],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",selected:"selected",disabled:"disabled",header:"header",leftIcon:"leftIcon",rightIcon:"rightIcon"},features:[Qt],ngContentSelectors:iv,decls:1,vars:1,consts:[["class","p-tabview-panel","role","tabpanel",3,"hidden",4,"ngIf"],["role","tabpanel",1,"p-tabview-panel",3,"hidden"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(n,i){n&1&&(Pr(),Y(0,yT,3,6,"div",0)),n&2&&b("ngIf",!i.closed)},dependencies:[yr,wr],encapsulation:2})}return e})(),zl=(()=>{class e{platformId;el;cd;renderer;style;styleClass;controlClose;scrollable;get activeIndex(){return this._activeIndex}set activeIndex(t){if(this._activeIndex=t,this.preventActiveIndexPropagation){this.preventActiveIndexPropagation=!1;return}this.tabs&&this.tabs.length&&this._activeIndex!=null&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0,this.tabChanged=!0,this.updateScrollBar(t))}selectOnFocus=!1;nextButtonAriaLabel;prevButtonAriaLabel;autoHideButtons=!0;tabindex=0;onChange=new Be;onClose=new Be;activeIndexChange=new Be;content;navbar;prevBtn;nextBtn;inkbar;tabPanels;templates;initialized;tabs;_activeIndex;preventActiveIndexPropagation;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;tabChangesSubscription;nextIconTemplate;previousIconTemplate;resizeObserver;container;list;buttonVisible;elementToObserve;constructor(t,n,i,a){this.platformId=t,this.el=n,this.cd=i,this.renderer=a}ngAfterContentInit(){this.initTabs(),this.tabChangesSubscription=this.tabPanels.changes.subscribe(t=>{this.initTabs(),this.refreshButtonState(),this.callResizeObserver()}),this.templates.forEach(t=>{switch(t.getType()){case"previousicon":this.previousIconTemplate=t.template;break;case"nexticon":this.nextIconTemplate=t.template;break}})}callResizeObserver(){qr(this.platformId)&&this.autoHideButtons&&this.bindResizeObserver()}ngAfterViewInit(){this.callResizeObserver()}bindResizeObserver(){this.container=J.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=J.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.resizeObserver=new ResizeObserver(()=>{this.list.offsetWidth>=this.container.offsetWidth?this.buttonVisible=!0:this.buttonVisible=!1,this.updateButtonState(),this.cd.detectChanges()}),this.resizeObserver.observe(this.container)}unbindResizeObserver(){this.resizeObserver.unobserve(this.elementToObserve.nativeElement),this.resizeObserver=null}ngAfterViewChecked(){qr(this.platformId)&&this.tabChanged&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.tabChangesSubscription&&this.tabChangesSubscription.unsubscribe(),this.resizeObserver&&this.unbindResizeObserver()}getTabHeaderActionId(t){return`${t}_header_action`}getTabContentId(t){return`${t}_content`}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(this.activeIndex!=null&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0,this.tabChanged=!0),this.cd.markForCheck()}onTabKeyDown(t,n){switch(t.code){case"ArrowLeft":this.onTabArrowLeftKey(t);break;case"ArrowRight":this.onTabArrowRightKey(t);break;case"Home":this.onTabHomeKey(t);break;case"End":this.onTabEndKey(t);break;case"PageDown":this.onTabEndKey(t);break;case"PageUp":this.onTabHomeKey(t);break;case"Enter":case"Space":this.open(t,n);break;default:break}}onTabArrowLeftKey(t){let n=this.findPrevHeaderAction(t.target.parentElement),i=J.getAttribute(n,"data-pc-index");n?this.changeFocusedTab(t,n,i):this.onTabEndKey(t),t.preventDefault()}onTabArrowRightKey(t){let n=this.findNextHeaderAction(t.target.parentElement),i=J.getAttribute(n,"data-pc-index");n?this.changeFocusedTab(t,n,i):this.onTabHomeKey(t),t.preventDefault()}onTabHomeKey(t){let n=this.findFirstHeaderAction(),i=J.getAttribute(n,"data-pc-index");this.changeFocusedTab(t,n,i),t.preventDefault()}onTabEndKey(t){let n=this.findLastHeaderAction(),i=J.getAttribute(n,"data-pc-index");this.changeFocusedTab(t,n,i),t.preventDefault()}changeFocusedTab(t,n,i){if(n&&(J.focus(n),n.scrollIntoView({block:"nearest"}),this.selectOnFocus)){let a=this.tabs[i];this.open(t,a)}}findNextHeaderAction(t,n=!1){let i=n?t:t.nextElementSibling;return i?J.getAttribute(i,"data-p-disabled")||J.getAttribute(i,"data-pc-section")==="inkbar"?this.findNextHeaderAction(i):J.findSingle(i,'[data-pc-section="headeraction"]'):null}findPrevHeaderAction(t,n=!1){let i=n?t:t.previousElementSibling;return i?J.getAttribute(i,"data-p-disabled")||J.getAttribute(i,"data-pc-section")==="inkbar"?this.findPrevHeaderAction(i):J.findSingle(i,'[data-pc-section="headeraction"]'):null}findFirstHeaderAction(){let t=this.navbar.nativeElement.firstElementChild;return this.findNextHeaderAction(t,!0)}findLastHeaderAction(){let t=this.navbar.nativeElement.lastElementChild,n=J.getAttribute(t,"data-pc-section")==="inkbar"?t.previousElementSibling:t;return this.findPrevHeaderAction(n,!0)}open(t,n){if(n.disabled){t&&t.preventDefault();return}if(!n.selected){let i=this.findSelectedTab();i&&(i.selected=!1),this.tabChanged=!0,n.selected=!0;let a=this.findTabIndex(n);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(a),this.onChange.emit({originalEvent:t,index:a}),this.updateScrollBar(a)}t&&t.preventDefault()}close(t,n){this.controlClose?this.onClose.emit({originalEvent:t,index:this.findTabIndex(n),close:()=>{this.closeTab(n)}}):(this.closeTab(n),this.onClose.emit({originalEvent:t,index:this.findTabIndex(n)}))}closeTab(t){if(!t.disabled){if(t.selected){this.tabChanged=!0,t.selected=!1;for(let n=0;n<this.tabs.length;n++){let i=this.tabs[n];if(!i.closed&&!t.disabled){i.selected=!0;break}}}t.closed=!0,setTimeout(()=>{this.updateInkBar()})}}findSelectedTab(){for(let t=0;t<this.tabs.length;t++)if(this.tabs[t].selected)return this.tabs[t];return null}findTabIndex(t){let n=-1;for(let i=0;i<this.tabs.length;i++)if(this.tabs[i]==t){n=i;break}return n}getBlockableElement(){return this.el.nativeElement.children[0]}updateInkBar(){if(qr(this.platformId)&&this.navbar){let t=J.findSingle(this.navbar.nativeElement,"li.p-highlight");if(!t)return;this.inkbar.nativeElement.style.width=J.getWidth(t)+"px",this.inkbar.nativeElement.style.left=J.getOffset(t).left-J.getOffset(this.navbar.nativeElement).left+"px"}}updateScrollBar(t){let n=this.navbar.nativeElement.children[t];n&&n.scrollIntoView({block:"nearest"})}updateButtonState(){let t=this.content.nativeElement,{scrollLeft:n,scrollWidth:i}=t,a=J.getWidth(t);this.backwardIsDisabled=n===0,this.forwardIsDisabled=Math.round(n)===i-a}refreshButtonState(){this.container=J.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=J.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.list.offsetWidth>=this.container.offsetWidth&&(this.list.offsetWidth>=this.container.offsetWidth?this.buttonVisible=!0:this.buttonVisible=!1,this.updateButtonState(),this.cd.markForCheck())}onScroll(t){this.scrollable&&this.updateButtonState(),t.preventDefault()}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((t,n)=>n?t+J.getWidth(n):t,0)}navBackward(){let t=this.content.nativeElement,n=J.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft-n;t.scrollLeft=i<=0?0:i}navForward(){let t=this.content.nativeElement,n=J.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft+n,a=t.scrollWidth-n;t.scrollLeft=i>=a?a:i}static \u0275fac=function(n){return new(n||e)(ce(Er),ce(qt),ce(hr),ce(Nr))};static \u0275cmp=Fe({type:e,selectors:[["p-tabView"]],contentQueries:function(n,i,a){if(n&1&&(ar(a,ud,4),ar(a,mr,4)),n&2){let s;je(s=Ge())&&(i.tabPanels=s),je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(At(wT,5),At(bT,5),At(CT,5),At(ET,5),At(ST,5),At(TT,5)),n&2){let a;je(a=Ge())&&(i.content=a.first),je(a=Ge())&&(i.navbar=a.first),je(a=Ge())&&(i.prevBtn=a.first),je(a=Ge())&&(i.nextBtn=a.first),je(a=Ge())&&(i.inkbar=a.first),je(a=Ge())&&(i.elementToObserve=a.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",controlClose:[2,"controlClose","controlClose",Se],scrollable:[2,"scrollable","scrollable",Se],activeIndex:"activeIndex",selectOnFocus:[2,"selectOnFocus","selectOnFocus",Se],nextButtonAriaLabel:"nextButtonAriaLabel",prevButtonAriaLabel:"prevButtonAriaLabel",autoHideButtons:[2,"autoHideButtons","autoHideButtons",Se],tabindex:[2,"tabindex","tabindex",tr]},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},features:[Qt],ngContentSelectors:iv,decls:14,vars:13,consts:[["elementToObserve",""],["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabview-nav-container"],["class","p-tabview-nav-prev p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-nav-content",3,"scroll"],["role","tablist",1,"p-tabview-nav"],["ngFor","",3,"ngForOf"],["role","presentation","aria-hidden","true",1,"p-tabview-ink-bar"],["class","p-tabview-nav-next p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-panels"],["type","button","pRipple","",1,"p-tabview-nav-prev","p-tabview-nav-btn","p-link",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation",3,"ngClass","ngStyle","class",4,"ngIf"],["role","presentation",3,"ngClass","ngStyle"],["role","tab","pRipple","",1,"p-tabview-nav-link",3,"click","keydown","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],["class","p-tabview-left-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-left-icon",4,"ngIf"],[1,"p-tabview-title"],["class","p-tabview-right-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-right-icon",4,"ngIf"],[1,"p-tabview-left-icon",3,"ngClass"],[1,"p-tabview-left-icon"],[1,"p-tabview-right-icon",3,"ngClass"],[1,"p-tabview-right-icon"],[3,"styleClass","click",4,"ngIf"],["class","tab.closeIconTemplate",4,"ngIf"],[3,"click","styleClass"],[1,"tab.closeIconTemplate"],["type","button","pRipple","",1,"p-tabview-nav-next","p-tabview-nav-btn","p-link",3,"click"]],template:function(n,i){if(n&1){let a=nt();Pr(),z(0,"div",6)(1,"div",7,0),Y(3,DT,4,4,"button",8),z(4,"div",9,1),Pe("scroll",function(o){return _e(a),xe(i.onScroll(o))}),z(6,"ul",10,2),Y(8,XT,1,1,"ng-template",11),ue(9,"li",12,3),j()(),Y(11,JT,4,4,"button",13),j(),z(12,"div",14),xr(13),j()()}n&2&&(Ve(i.styleClass),b("ngClass",gt(11,IT,i.scrollable))("ngStyle",i.style),ee("data-pc-name","tabview"),S(3),b("ngIf",i.scrollable&&!i.backwardIsDisabled&&i.autoHideButtons),S(),ee("data-pc-section","navcontent"),S(2),ee("data-pc-section","nav"),S(2),b("ngForOf",i.tabs),S(),ee("data-pc-section","inkbar"),S(2),b("ngIf",i.scrollable&&!i.forwardIsDisabled&&i.buttonVisible))},dependencies:()=>[dr,oi,yr,wr,or,Uu,fi,In,ld,cd],styles:[`@layer primeng{.p-tabview-nav-container{position:relative}.p-tabview-scrollable .p-tabview-nav-container{overflow:hidden}.p-tabview-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabview-nav{display:inline-flex;min-width:100%;margin:0;padding:0;list-style-type:none;flex:1 1 auto}.p-tabview-nav-link{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabview-ink-bar{display:none;z-index:1}.p-tabview-nav-link:focus{z-index:1}.p-tabview-title{line-height:1;white-space:nowrap}.p-tabview-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabview-nav-prev{left:0}.p-tabview-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabview-close{z-index:1}}
`],encapsulation:2,changeDetection:0})}return e})(),av=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr,$u,Hi,In,ld,cd,lr]})}return e})();var o_={};o_.version="0.20.3";var xn=1200,So=1252,_t,tI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Od={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fd=function(e){tI.indexOf(e)!=-1&&(So=Od[0]=e)};function rI(){Fd(1252)}var Ii=function(e){xn=e,Fd(e)};function l_(){Ii(1200),rI()}function wd(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function c_(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function nI(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e[2*t]+(e[2*t+1]<<8));return r.join("")}function u_(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var jl=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?c_(e.slice(2)):r==254&&t==255?u_(e.slice(2)):r==65279?e.slice(1):e},Wu=function(r){return String.fromCharCode(r)},sv=function(r){return String.fromCharCode(r)};var Ar=null,ov=!0,$a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lv(e){for(var r="",t=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)t=e.charCodeAt(c++),a=t>>2,n=e.charCodeAt(c++),s=(t&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),r+=$a.charAt(a)+$a.charAt(s)+$a.charAt(o)+$a.charAt(l);return r}function qn(e){var r="",t=0,n=0,i=0,a=0,s=0,o=0,l=0;if(e.slice(0,5)=="data:"){var c=e.slice(0,1024).indexOf(";base64,");c>-1&&(e=e.slice(c+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=$a.indexOf(e.charAt(c++)),s=$a.indexOf(e.charAt(c++)),t=a<<2|s>>4,r+=String.fromCharCode(t),o=$a.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),l=$a.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(r+=String.fromCharCode(i));return r}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}(),ac=function(){if(typeof Buffer>"u")return!1;var e=Ga([65,0]);if(!e)return!1;var r=e.toString("utf16le");return r.length==1}();function Ha(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function cv(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gn=function(r){return xt?Ga(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function da(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Dd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Dd(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Ua=xt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ga(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)i=e[r].length,e[r]instanceof Uint8Array?n.set(e[r],t):typeof e[r]=="string"?n.set(new Uint8Array(Gn(e[r])),t):n.set(new Uint8Array(e[r]),t);return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function iI(e){for(var r=[],t=0,n=e.length+250,i=Ha(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[t++]=s;else if(s<2048)i[t++]=192|s>>6&31,i[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[t++]=240|s>>8&7,i[t++]=128|s>>2&63,i[t++]=128|o>>6&15|(s&3)<<4,i[t++]=128|o&63}else i[t++]=224|s>>12&15,i[t++]=128|s>>6&63,i[t++]=128|s&63;t>n&&(r.push(i.slice(0,t)),t=0,i=Ha(65535),n=65530)}return r.push(i.slice(0,t)),Ua(r)}var Fn=/\u0000/g,Gl=/[\u0001-\u0006]/g;function bo(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ki(e,r){var t=""+e;return t.length>=r?t:St("0",r-t.length)+t}function Rd(e,r){var t=""+e;return t.length>=r?t:St(" ",r-t.length)+t}function Zu(e,r){var t=""+e;return t.length>=r?t:t+St(" ",r-t.length)}function aI(e,r){var t=""+Math.round(e);return t.length>=r?t:St("0",r-t.length)+t}function sI(e,r){var t=""+e;return t.length>=r?t:St("0",r-t.length)+t}var uv=Math.pow(2,32);function xo(e,r){if(e>uv||e<-uv)return aI(e,r);var t=Math.round(e);return sI(t,r)}function Ju(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var fv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},hv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ef(e,r,t){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<r&&(f=Math.floor(i),o=f*s+a,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),a=s,s=o,l=c,c=u;if(u>r&&(c>r?(u=l,o=a):(u=c,o=s)),!t)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function cI(e){var r=e.toPrecision(16);if(r.indexOf("e")>-1){var t=r.slice(0,r.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+St("0",t.length-15),t+r.slice(r.indexOf("e"))}var n=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+St("0",r.length-15);return Number(n)}function la(e,r,t){if(e>2958465||e<0)return null;e=cI(e);var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),t&&(a=dI(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}function Md(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function uI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fI(e){var r=e<0?12:11,t=Md(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function hI(e){var r=Md(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function sc(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=fI(e):r===10?t=e.toFixed(10).substr(0,12):t=hI(e),Md(uI(t.toUpperCase()))}function Ss(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Xn(14,jr(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function dI(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function pI(e,r,t,n){var i="",a=0,s=0,o=t.y,l,c=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,c=r.length;break;case 3:return fd[t.m-1][1];case 5:return fd[t.m-1][0];default:return fd[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,c=r.length;break;case 3:return fv[t.q][0];default:return fv[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ki(t.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(t.S+t.u)),a>=60*s&&(a=0),r==="s"?a===0?"0":""+a/s:(i=ki(a,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+(n==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ki(l,c):"";return u}function ca(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var f_=/%/g;function mI(e,r,t){var n=r.replace(f_,""),i=r.length-n.length;return fa(e,n,t*Math.pow(10,2*i))+St("%",i)}function gI(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return fa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function h_(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+h_(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var d_=/# (\?+)( ?)\/( ?)(\d+)/;function vI(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),a=Math.floor(i/n),s=i-a*n,o=n;return t+(a===0?"":""+a)+" "+(s===0?St(" ",e[1].length+1+e[4].length):Rd(s,e[1].length)+e[2]+"/"+e[3]+ki(o,e[4].length))}function _I(e,r,t){return t+(r===0?"":""+r)+St(" ",e[1].length+2+e[4].length)}var p_=/^#*0*\.([0#]+)/,m_=/\)[^)]*[0#]/,g_=/\(###\) ###\\?-####/;function kn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function dv(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function pv(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function xI(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function yI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function di(e,r,t){if(e.charCodeAt(0)===40&&!r.match(m_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?di("n",n,t):"("+di("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return gI(e,r,t);if(r.indexOf("%")!==-1)return mI(e,r,t);if(r.indexOf("E")!==-1)return h_(r,t);if(r.charCodeAt(0)===36)return"$"+di(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,s,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+xo(l,r.length);if(r.match(/^[#?]+$/))return i=xo(t,0),i==="0"&&(i=""),i.length>r.length?i:kn(r.substr(0,r.length-i.length))+i;if(a=r.match(d_))return vI(a,l,c);if(r.match(/^#+0+$/))return c+xo(l,r.length-r.indexOf("0"));if(a=r.match(p_))return i=dv(t,a[1].length).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+St("0",kn(a[1]).length-v.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+dv(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+ca(xo(l,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+di(e,r,-t):ca(""+(Math.floor(t)+xI(t,a[1].length)))+"."+ki(pv(t,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return di(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bo(di(e,r.replace(/[\\-]/g,""),t)),s=0,bo(bo(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(r.match(g_))return i=di(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ef(l,Math.pow(10,s)-1,!1),i=""+c,u=fa("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Zu(o[2],s),u.length<a[4].length&&(u=kn(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ef(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rd(o[1],s)+a[2]+"/"+a[3]+Zu(o[2],s):St(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=xo(t,0),r.length<=i.length?i:kn(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=r.indexOf(".")-s,h=r.length-i.length-f;return kn(r.substr(0,f)+i+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return s=pv(t,a[1].length),t<0?"-"+di(e,r,-t):ca(yI(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ki(0,3-g.length):"")+g})+"."+ki(s,a[1].length);switch(r){case"###,##0.00":return di(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=ca(xo(l,0));return d!=="0"?c+d:"";case"###,###.00":return di(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return di(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function wI(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return fa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function bI(e,r,t){var n=r.replace(f_,""),i=r.length-n.length;return fa(e,n,t*Math.pow(10,2*i))+St("%",i)}function v_(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+v_(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ji(e,r,t){if(e.charCodeAt(0)===40&&!r.match(m_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ji("n",n,t):"("+ji("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return wI(e,r,t);if(r.indexOf("%")!==-1)return bI(e,r,t);if(r.indexOf("E")!==-1)return v_(r,t);if(r.charCodeAt(0)===36)return"$"+ji(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,s,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+ki(l,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:kn(r.substr(0,r.length-i.length))+i;if(a=r.match(d_))return _I(a,l,c);if(r.match(/^#+0+$/))return c+ki(l,r.length-r.indexOf("0"));if(a=r.match(p_))return i=(""+t).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])),i=i.replace(/\.(\d*)$/,function(g,v){return"."+v+St("0",kn(a[1]).length-v.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+ca(""+l);if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ji(e,r,-t):ca(""+t)+"."+St("0",a[1].length);if(a=r.match(/^#,#*,#0/))return ji(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bo(ji(e,r.replace(/[\\-]/g,""),t)),s=0,bo(bo(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(r.match(g_))return i=ji(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ef(l,Math.pow(10,s)-1,!1),i=""+c,u=fa("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Zu(o[2],s),u.length<a[4].length&&(u=kn(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ef(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rd(o[1],s)+a[2]+"/"+a[3]+Zu(o[2],s):St(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:kn(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=r.indexOf(".")-s,h=r.length-i.length-f;return kn(r.substr(0,f)+i+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ji(e,r,-t):ca(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ki(0,3-g.length):"")+g})+"."+ki(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=ca(""+l);return d!=="0"?c+d:"";default:if(r.match(/\.[0#?]*$/))return ji(e,r.slice(0,r.lastIndexOf(".")),t)+kn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function fa(e,r,t){return(t|0)===t?ji(e,r,t):di(e,r,t)}function CI(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var __=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ai(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Ju(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(__))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function EI(e,r,t,n){for(var i=[],a="",s=0,o="",l="t",c,u,f,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Ju(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(f=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(f);i[i.length]={t:"t",v:a},++s;break;case"\\":var d=e.charAt(++s),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=la(r,t,e.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=la(r,t),c==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"\u4E0A":var v={t:o,v:o};if(c==null&&(c=la(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?e.charAt(s+2):o),v.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(v.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),v.t="T",s+=5,h="h"):(v.t="t",++s),c==null&&v.t==="T")return"";i[i.length]=v,l=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(__)){if(c==null&&(c=la(r,t),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ai(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var p=0,m=0,x;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=h,l="h",p<1&&(p=1);break;case"s":(x=i[s].v.match(/\.0+$/))&&(m=Math.max(m,x[0].length-1),p=4),p<3&&(p=3);case"d":case"y":case"e":l=i[s].t;break;case"M":l=i[s].t,p<2&&(p=2);break;case"m":l==="s"&&(i[s].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[s].v.match(/[Hh]/)&&(p=1),p<2&&i[s].v.match(/[Mm]/)&&(p=2),p<3&&i[s].v.match(/[Ss]/)&&(p=3)}var _;switch(p){case 0:break;case 1:case 2:case 3:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H),c.H>=24&&(c.H=0,++c.D,_=la(c.D),_.u=c.u,_.S=c.S,_.M=c.M,_.H=c.H,c=_);break;case 4:switch(m){case 1:c.u=Math.round(c.u*10)/10;break;case 2:c.u=Math.round(c.u*100)/100;break;case 3:c.u=Math.round(c.u*1e3)/1e3;break}c.u>=1&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H),c.H>=24&&(c.H=0,++c.D,_=la(c.D),_.u=c.u,_.S=c.S,_.M=c.M,_.H=c.H,c=_);break}var w="",D;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=pI(i[s].t.charCodeAt(0),i[s].v,c,m),i[s].t="t";break;case"n":case"?":for(D=s+1;i[D]!=null&&((o=i[D].t)==="?"||o==="D"||(o===" "||o==="t")&&i[D+1]!=null&&(i[D+1].t==="?"||i[D+1].t==="t"&&i[D+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[D].v==="/"||i[D].v===" "&&i[D+1]!=null&&i[D+1].t=="?"));)i[s].v+=i[D].v,i[D]={v:"",t:";"},++D;w+=i[s].v,s=D-1;break;case"G":i[s].t="t",i[s].v=Ss(r,t);break}var U="",F,R;if(w.length>0){w.charCodeAt(0)==40?(F=r<0&&w.charCodeAt(0)===45?-r:r,R=fa("n",w,F)):(F=r<0&&n>1?-r:r,R=fa("n",w,F),F<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),D=R.length-1;var M=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){M=s;break}var W=i.length;if(M===i.length&&R.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(D>=i[s].v.length-1?(D-=i[s].v.length,i[s].v=R.substr(D+1,i[s].v.length)):D<0?i[s].v="":(i[s].v=R.substr(0,D+1),D=-1),i[s].t="t",W=s);D>=0&&W<i.length&&(i[W].v=R.substr(0,D+1)+i[W].v)}else if(M!==i.length&&R.indexOf("E")===-1){for(D=R.indexOf(".")-1,s=M;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===M?i[s].v.indexOf(".")-1:i[s].v.length-1,U=i[s].v.substr(u+1);u>=0;--u)D>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(U=R.charAt(D--)+U);i[s].v=U,i[s].t="t",W=s}for(D>=0&&W<i.length&&(i[W].v=R.substr(0,D+1)+i[W].v),D=R.indexOf(".")+1,s=M;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==M)){for(u=i[s].v.indexOf(".")>-1&&s===M?i[s].v.indexOf(".")+1:0,U=i[s].v.substr(0,u);u<i[s].v.length;++u)D<R.length&&(U+=R.charAt(D++));i[s].v=U,i[s].t="t",W=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(F=n>1&&r<0&&s>0&&i[s-1].v==="-"?-r:r,i[s].v=fa(i[s].t,i[s].v,F),i[s].t="t");var B="";for(s=0;s!==i.length;++s)i[s]!=null&&(B+=i[s].v);return B}var mv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gv(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function SI(e,r){var t=CI(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(typeof r=="number"&&!isFinite(r)&&(r=0),t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var a=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(mv),o=t[1].match(mv);return gv(r,s)?[n,t[0]]:gv(r,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,a]}function Xn(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:et)[e],n==null&&(n=t.table&&t.table[hv[e]]||et[hv[e]]),n==null&&(n=lI[e]||"General");break}if(Ju(n,0))return Ss(r,t);r instanceof Date&&(r=jr(r,t.date1904));var i=SI(n,r);if(Ju(i[1]))return Ss(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else{if(r===""||r==null)return"";if(isNaN(r)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(r)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return EI(i[1],r,t,i[0])}function TI(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(et[t]==null){r<0&&(r=t);continue}if(et[t]==e){r=t;break}}r<0&&(r=391)}return et[r]=e,r}function x_(){et=oI()}var II={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},tf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kI(e){var r=typeof e=="number"?et[e]:e;return r=r.replace(tf,"(\\d+)"),tf.lastIndex=0,new RegExp("^"+r+"$")}function AI(e,r,t){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(r.match(tf)||[]).forEach(function(f,h){var d=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:i=d;break}}),tf.lastIndex=0,l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&a==-1?u:c+"T"+u}var OI={"d.m":"d\\.m"};function ys(e,r){return TI(OI[e]||e,r)}var vv=function(){var e={};e.version="1.2.0";function r(){for(var F=0,R=new Array(256),M=0;M!=256;++M)F=M,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,R[M]=F;return typeof Int32Array<"u"?new Int32Array(R):R}var t=r();function n(F){var R=0,M=0,W=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)B[W]=F[W];for(W=0;W!=256;++W)for(M=F[W],R=256+W;R<4096;R+=256)M=B[R]=M>>>8^F[M&255];var V=[];for(W=1;W!=16;++W)V[W-1]=typeof Int32Array<"u"&&typeof B.subarray=="function"?B.subarray(W*256,W*256+256):B.slice(W*256,W*256+256);return V}var i=n(t),a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],g=i[9],v=i[10],p=i[11],m=i[12],x=i[13],_=i[14];function w(F,R){for(var M=R^-1,W=0,B=F.length;W<B;)M=M>>>8^t[(M^F.charCodeAt(W++))&255];return~M}function D(F,R){for(var M=R^-1,W=F.length-15,B=0;B<W;)M=_[F[B++]^M&255]^x[F[B++]^M>>8&255]^m[F[B++]^M>>16&255]^p[F[B++]^M>>>24]^v[F[B++]]^g[F[B++]]^d[F[B++]]^h[F[B++]]^f[F[B++]]^u[F[B++]]^c[F[B++]]^l[F[B++]]^o[F[B++]]^s[F[B++]]^a[F[B++]]^t[F[B++]];for(W+=15;B<W;)M=M>>>8^t[(M^F[B++])&255];return~M}function U(F,R){for(var M=R^-1,W=0,B=F.length,V=0,G=0;W<B;)V=F.charCodeAt(W++),V<128?M=M>>>8^t[(M^V)&255]:V<2048?(M=M>>>8^t[(M^(192|V>>6&31))&255],M=M>>>8^t[(M^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,G=F.charCodeAt(W++)&1023,M=M>>>8^t[(M^(240|V>>8&7))&255],M=M>>>8^t[(M^(128|V>>2&63))&255],M=M>>>8^t[(M^(128|G>>6&15|(V&3)<<4))&255],M=M>>>8^t[(M^(128|G&63))&255]):(M=M>>>8^t[(M^(224|V>>12&15))&255],M=M>>>8^t[(M^(128|V>>6&63))&255],M=M>>>8^t[(M^(128|V&63))&255]);return~M}return e.table=t,e.bstr=w,e.buf=D,e.str=U,e}(),Tt=function(){var r={};r.version="1.2.2";function t(y,I){for(var C=y.split("/"),E=I.split("/"),T=0,A=0,X=Math.min(C.length,E.length);T<X;++T){if(A=C[T].length-E[T].length)return A;if(C[T]!=E[T])return C[T]<E[T]?-1:1}return C.length-E.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var I=y.lastIndexOf("/");return I===-1?y:y.slice(0,I+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var I=y.lastIndexOf("/");return I===-1?y:y.slice(I+1)}function a(y,I){typeof I=="string"&&(I=new Date(I));var C=I.getHours();C=C<<6|I.getMinutes(),C=C<<5|I.getSeconds()>>>1,y.write_shift(2,C);var E=I.getFullYear()-1980;E=E<<4|I.getMonth()+1,E=E<<5|I.getDate(),y.write_shift(2,E)}function s(y){var I=y.read_shift(2)&65535,C=y.read_shift(2)&65535,E=new Date,T=C&31;C>>>=5;var A=C&15;C>>>=4,E.setMilliseconds(0),E.setFullYear(C+1980),E.setMonth(A-1),E.setDate(T);var X=I&31;I>>>=5;var te=I&63;return I>>>=6,E.setHours(I),E.setMinutes(te),E.setSeconds(X<<1),E}function o(y){zr(y,0);for(var I={},C=0;y.l<=y.length-4;){var E=y.read_shift(2),T=y.read_shift(2),A=y.l+T,X={};switch(E){case 21589:C=y.read_shift(1),C&1&&(X.mtime=y.read_shift(4)),T>5&&(C&2&&(X.atime=y.read_shift(4)),C&4&&(X.ctime=y.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break;case 1:{var te=y.read_shift(4),K=y.read_shift(4);X.usz=K*Math.pow(2,32)+te,te=y.read_shift(4),K=y.read_shift(4),X.csz=K*Math.pow(2,32)+te}break}y.l=A,I[E]=X}return I}var l;function c(){return l||(l=bd)}function u(y,I){if(y[0]==80&&y[1]==75)return tg(y,I);if((y[0]|32)==109&&(y[1]|32)==105)return kC(y,I);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var C=3,E=512,T=0,A=0,X=0,te=0,K=0,q=[],Q=y.slice(0,512);zr(Q,0);var de=f(Q);switch(C=de[0],C){case 3:E=512;break;case 4:E=4096;break;case 0:if(de[1]==0)return tg(y,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}E!==512&&(Q=y.slice(0,E),zr(Q,28));var me=y.slice(0,E);h(Q,C);var Ne=Q.read_shift(4,"i");if(C===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);Q.l+=4,X=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),te=Q.read_shift(4,"i"),T=Q.read_shift(4,"i"),K=Q.read_shift(4,"i"),A=Q.read_shift(4,"i");for(var ye=-1,he=0;he<109&&(ye=Q.read_shift(4,"i"),!(ye<0));++he)q[he]=ye;var it=d(y,E);p(K,A,it,E,q);var Zt=x(it,X,q,E);X<Zt.length&&(Zt[X].name="!Directory"),T>0&&te!==G&&(Zt[te].name="!MiniFAT"),Zt[q[0]].name="!FAT",Zt.fat_addrs=q,Zt.ssz=E;var Nn={},Rr=[],Wn=[],sl=[];_(X,Zt,it,Rr,T,Nn,Wn,te),g(Wn,sl,Rr),Rr.shift();var ol={FileIndex:Wn,FullPaths:sl};return I&&I.raw&&(ol.raw={header:me,sectors:it}),ol}function f(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(pe,"Header Signature: "),y.l+=16;var I=y.read_shift(2,"u");return[y.read_shift(2,"u"),I]}function h(y,I){var C=9;switch(y.l+=2,C=y.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function d(y,I){for(var C=Math.ceil(y.length/I)-1,E=[],T=1;T<C;++T)E[T-1]=y.slice(T*I,(T+1)*I);return E[C-1]=y.slice(C*I),E}function g(y,I,C){for(var E=0,T=0,A=0,X=0,te=0,K=C.length,q=[],Q=[];E<K;++E)q[E]=Q[E]=E,I[E]=C[E];for(;te<Q.length;++te)E=Q[te],T=y[E].L,A=y[E].R,X=y[E].C,q[E]===E&&(T!==-1&&q[T]!==T&&(q[E]=q[T]),A!==-1&&q[A]!==A&&(q[E]=q[A])),X!==-1&&(q[X]=E),T!==-1&&E!=q[E]&&(q[T]=q[E],Q.lastIndexOf(T)<te&&Q.push(T)),A!==-1&&E!=q[E]&&(q[A]=q[E],Q.lastIndexOf(A)<te&&Q.push(A));for(E=1;E<K;++E)q[E]===E&&(A!==-1&&q[A]!==A?q[E]=q[A]:T!==-1&&q[T]!==T&&(q[E]=q[T]));for(E=1;E<K;++E)if(y[E].type!==0){if(te=E,te!=q[te])do te=q[te],I[E]=I[te]+"/"+I[E];while(te!==0&&q[te]!==-1&&te!=q[te]);q[E]=-1}for(I[0]+="/",E=1;E<K;++E)y[E].type!==2&&(I[E]+="/")}function v(y,I,C){for(var E=y.start,T=y.size,A=[],X=E;C&&T>0&&X>=0;)A.push(I.slice(X*V,X*V+V)),T-=V,X=xs(C,X*4);return A.length===0?kr(0):Ua(A).slice(0,y.size)}function p(y,I,C,E,T){var A=G;if(y===G){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var X=C[y],te=(E>>>2)-1;if(!X)return;for(var K=0;K<te&&(A=xs(X,K*4))!==G;++K)T.push(A);I>=1&&p(xs(X,E-4),I-1,C,E,T)}}function m(y,I,C,E,T){var A=[],X=[];T||(T=[]);var te=E-1,K=0,q=0;for(K=I;K>=0;){T[K]=!0,A[A.length]=K,X.push(y[K]);var Q=C[Math.floor(K*4/E)];if(q=K*4&te,E<4+q)throw new Error("FAT boundary crossed: "+K+" 4 "+E);if(!y[Q])break;K=xs(y[Q],q)}return{nodes:A,data:Sv([X])}}function x(y,I,C,E){var T=y.length,A=[],X=[],te=[],K=[],q=E-1,Q=0,de=0,me=0,Ne=0;for(Q=0;Q<T;++Q)if(te=[],me=Q+I,me>=T&&(me-=T),!X[me]){K=[];var ye=[];for(de=me;de>=0;){ye[de]=!0,X[de]=!0,te[te.length]=de,K.push(y[de]);var he=C[Math.floor(de*4/E)];if(Ne=de*4&q,E<4+Ne)throw new Error("FAT boundary crossed: "+de+" 4 "+E);if(!y[he]||(de=xs(y[he],Ne),ye[de]))break}A[me]={nodes:te,data:Sv([K])}}return A}function _(y,I,C,E,T,A,X,te){for(var K=0,q=E.length?2:0,Q=I[y].data,de=0,me=0,Ne;de<Q.length;de+=128){var ye=Q.slice(de,de+128);zr(ye,64),me=ye.read_shift(2),Ne=df(ye,0,me-q),E.push(Ne);var he={name:Ne,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},it=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);it!==0&&(he.ct=w(ye,ye.l-8));var Zt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Zt!==0&&(he.mt=w(ye,ye.l-8)),he.start=ye.read_shift(4,"i"),he.size=ye.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=G,he.name=""),he.type===5?(K=he.start,T>0&&K!==G&&(I[K].name="!StreamData")):he.size>=4096?(he.storage="fat",I[he.start]===void 0&&(I[he.start]=m(C,he.start,I.fat_addrs,I.ssz)),I[he.start].name=he.name,he.content=I[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:K!==G&&he.start!==G&&I[K]&&(he.content=v(he,I[K].data,(I[te]||{}).data))),he.content&&zr(he.content,0),A[Ne]=he,X.push(he)}}function w(y,I){return new Date((Yr(y,I+4)/1e7*Math.pow(2,32)+Yr(y,I)/1e7-11644473600)*1e3)}function D(y,I){return c(),u(l.readFileSync(y),I)}function U(y,I){var C=I&&I.type;switch(C||xt&&Buffer.isBuffer(y)&&(C="buffer"),C||"base64"){case"file":return D(y,I);case"base64":return u(Gn(qn(y)),I);case"binary":return u(Gn(y),I)}return u(y,I)}function F(y,I){var C=I||{},E=C.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=E+"/",y.FileIndex[0]={name:E,type:5}),C.CLSID&&(y.FileIndex[0].clsid=C.CLSID),R(y)}function R(y){var I="Sh33tJ5";if(!Tt.find(y,"/"+I)){var C=kr(4);C[0]=55,C[1]=C[3]=50,C[2]=54,y.FileIndex.push({name:I,type:2,content:C,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+I),M(y)}}function M(y,I){F(y);for(var C=!1,E=!1,T=y.FullPaths.length-1;T>=0;--T){var A=y.FileIndex[T];switch(A.type){case 0:E?C=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(A.R*A.L*A.C)&&(C=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!I)){var X=new Date(1987,1,19),te=0,K=Object.create?Object.create(null):{},q=[];for(T=0;T<y.FullPaths.length;++T)K[y.FullPaths[T]]=!0,y.FileIndex[T].type!==0&&q.push([y.FullPaths[T],y.FileIndex[T]]);for(T=0;T<q.length;++T){var Q=n(q[T][0]);for(E=K[Q];!E;){for(;n(Q)&&!K[n(Q)];)Q=n(Q);q.push([Q,{name:i(Q).replace("/",""),type:1,clsid:De,ct:X,mt:X,content:null}]),K[Q]=!0,Q=n(q[T][0]),E=K[Q]}}for(q.sort(function(Ne,ye){return t(Ne[0],ye[0])}),y.FullPaths=[],y.FileIndex=[],T=0;T<q.length;++T)y.FullPaths[T]=q[T][0],y.FileIndex[T]=q[T][1];for(T=0;T<q.length;++T){var de=y.FileIndex[T],me=y.FullPaths[T];if(de.name=i(me).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||De,T===0)de.C=q.length>1?1:-1,de.size=0,de.type=5;else if(me.slice(-1)=="/"){for(te=T+1;te<q.length&&n(y.FullPaths[te])!=me;++te);for(de.C=te>=q.length?-1:te,te=T+1;te<q.length&&n(y.FullPaths[te])!=n(me);++te);de.R=te>=q.length?-1:te,de.type=1}else n(y.FullPaths[T+1]||"")==n(me)&&(de.R=T+1),de.type=2}}}function W(y,I){var C=I||{};if(C.fileType=="mad")return AC(y,C);switch(M(y),C.fileType){case"zip":return bC(y,C)}var E=function(Ne){for(var ye=0,he=0,it=0;it<Ne.FileIndex.length;++it){var Zt=Ne.FileIndex[it];if(Zt.content){var Nn=Zt.content.length;Nn>0&&(Nn<4096?ye+=Nn+63>>6:he+=Nn+511>>9)}}for(var Rr=Ne.FullPaths.length+3>>2,Wn=ye+7>>3,sl=ye+127>>7,ol=Wn+he+Rr+sl,ss=ol+127>>7,H0=ss<=109?0:Math.ceil((ss-109)/127);ol+ss+H0+127>>7>ss;)H0=++ss<=109?0:Math.ceil((ss-109)/127);var Ji=[1,H0,ss,sl,Rr,he,ye,0];return Ne.FileIndex[0].size=ye<<6,Ji[7]=(Ne.FileIndex[0].start=Ji[0]+Ji[1]+Ji[2]+Ji[3]+Ji[4]+Ji[5])+(Ji[6]+7>>3),Ji}(y),T=kr(E[7]<<9),A=0,X=0;{for(A=0;A<8;++A)T.write_shift(1,ae[A]);for(A=0;A<8;++A)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),A=0;A<3;++A)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,E[2]),T.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:G),T.write_shift(4,E[3]),T.write_shift(-4,E[1]?E[0]-1:G),T.write_shift(4,E[1]),A=0;A<109;++A)T.write_shift(-4,A<E[2]?E[1]+A:-1)}if(E[1])for(X=0;X<E[1];++X){for(;A<236+X*127;++A)T.write_shift(-4,A<E[2]?E[1]+A:-1);T.write_shift(-4,X===E[1]-1?G:X+1)}var te=function(Ne){for(X+=Ne;A<X-1;++A)T.write_shift(-4,A+1);Ne&&(++A,T.write_shift(-4,G))};for(X=A=0,X+=E[1];A<X;++A)T.write_shift(-4,re.DIFSECT);for(X+=E[2];A<X;++A)T.write_shift(-4,re.FATSECT);te(E[3]),te(E[4]);for(var K=0,q=0,Q=y.FileIndex[0];K<y.FileIndex.length;++K)Q=y.FileIndex[K],Q.content&&(q=Q.content.length,!(q<4096)&&(Q.start=X,te(q+511>>9)));for(te(E[6]+7>>3);T.l&511;)T.write_shift(-4,re.ENDOFCHAIN);for(X=A=0,K=0;K<y.FileIndex.length;++K)Q=y.FileIndex[K],Q.content&&(q=Q.content.length,!(!q||q>=4096)&&(Q.start=X,te(q+63>>6)));for(;T.l&511;)T.write_shift(-4,re.ENDOFCHAIN);for(A=0;A<E[4]<<2;++A){var de=y.FullPaths[A];if(!de||de.length===0){for(K=0;K<17;++K)T.write_shift(4,0);for(K=0;K<3;++K)T.write_shift(4,-1);for(K=0;K<12;++K)T.write_shift(4,0);continue}Q=y.FileIndex[A],A===0&&(Q.start=Q.size?Q.start-1:G);var me=A===0&&C.root||Q.name;if(me.length>31&&(console.error("Name "+me+" will be truncated to "+me.slice(0,31)),me=me.slice(0,31)),q=2*(me.length+1),T.write_shift(64,me,"utf16le"),T.write_shift(2,q),T.write_shift(1,Q.type),T.write_shift(1,Q.color),T.write_shift(-4,Q.L),T.write_shift(-4,Q.R),T.write_shift(-4,Q.C),Q.clsid)T.write_shift(16,Q.clsid,"hex");else for(K=0;K<4;++K)T.write_shift(4,0);T.write_shift(4,Q.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,Q.start),T.write_shift(4,Q.size),T.write_shift(4,0)}for(A=1;A<y.FileIndex.length;++A)if(Q=y.FileIndex[A],Q.size>=4096)if(T.l=Q.start+1<<9,xt&&Buffer.isBuffer(Q.content))Q.content.copy(T,T.l,0,Q.size),T.l+=Q.size+511&-512;else{for(K=0;K<Q.size;++K)T.write_shift(1,Q.content[K]);for(;K&511;++K)T.write_shift(1,0)}for(A=1;A<y.FileIndex.length;++A)if(Q=y.FileIndex[A],Q.size>0&&Q.size<4096)if(xt&&Buffer.isBuffer(Q.content))Q.content.copy(T,T.l,0,Q.size),T.l+=Q.size+63&-64;else{for(K=0;K<Q.size;++K)T.write_shift(1,Q.content[K]);for(;K&63;++K)T.write_shift(1,0)}if(xt)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function B(y,I){var C=y.FullPaths.map(function(K){return K.toUpperCase()}),E=C.map(function(K){var q=K.split("/");return q[q.length-(K.slice(-1)=="/"?2:1)]}),T=!1;I.charCodeAt(0)===47?(T=!0,I=C[0].slice(0,-1)+I):T=I.indexOf("/")!==-1;var A=I.toUpperCase(),X=T===!0?C.indexOf(A):E.indexOf(A);if(X!==-1)return y.FileIndex[X];var te=!A.match(Gl);for(A=A.replace(Fn,""),te&&(A=A.replace(Gl,"!")),X=0;X<C.length;++X)if((te?C[X].replace(Gl,"!"):C[X]).replace(Fn,"")==A||(te?E[X].replace(Gl,"!"):E[X]).replace(Fn,"")==A)return y.FileIndex[X];return null}var V=64,G=-2,pe="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],De="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:De,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(y,I,C){c();var E=W(y,C);l.writeFileSync(I,E)}function Oe(y){for(var I=new Array(y.length),C=0;C<y.length;++C)I[C]=String.fromCharCode(y[C]);return I.join("")}function oe(y,I){var C=W(y,I);switch(I&&I.type||"buffer"){case"file":return c(),l.writeFileSync(I.filename,C),C;case"binary":return typeof C=="string"?C:Oe(C);case"base64":return lv(typeof C=="string"?C:Oe(C));case"buffer":if(xt)return Buffer.isBuffer(C)?C:Ga(C);case"array":return typeof C=="string"?Gn(C):C}return C}var We;function le(y){try{var I=y.InflateRaw,C=new I;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)We=y;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function Ie(y,I){if(!We)return al(y,I);var C=We.InflateRaw,E=new C,T=E._processChunk(y.slice(y.l),E._finishFlushFlag);return y.l+=E.bytesRead,T}function Ee(y){return We?We.deflateRawSync(y):$n(y)}var lt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(y){var I=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(I>>16|I>>8|I)&255}for(var H=typeof Uint8Array<"u",L=H?new Uint8Array(256):[],N=0;N<256;++N)L[N]=O(N);function se(y,I){var C=L[y&255];return I<=8?C>>>8-I:(C=C<<8|L[y>>8&255],I<=16?C>>>16-I:(C=C<<8|L[y>>16&255],C>>>24-I))}function k(y,I){var C=I&7,E=I>>>3;return(y[E]|(C<=6?0:y[E+1]<<8))>>>C&3}function Le(y,I){var C=I&7,E=I>>>3;return(y[E]|(C<=5?0:y[E+1]<<8))>>>C&7}function be(y,I){var C=I&7,E=I>>>3;return(y[E]|(C<=4?0:y[E+1]<<8))>>>C&15}function fe(y,I){var C=I&7,E=I>>>3;return(y[E]|(C<=3?0:y[E+1]<<8))>>>C&31}function Ke(y,I){var C=I&7,E=I>>>3;return(y[E]|(C<=1?0:y[E+1]<<8))>>>C&127}function ht(y,I,C){var E=I&7,T=I>>>3,A=(1<<C)-1,X=y[T]>>>E;return C<8-E||(X|=y[T+1]<<8-E,C<16-E)||(X|=y[T+2]<<16-E,C<24-E)||(X|=y[T+3]<<24-E),X&A}function Ae(y,I,C){var E=I&7,T=I>>>3;return E<=5?y[T]|=(C&7)<<E:(y[T]|=C<<E&255,y[T+1]=(C&7)>>8-E),I+3}function Vt(y,I,C){var E=I&7,T=I>>>3;return C=(C&1)<<E,y[T]|=C,I+1}function jt(y,I,C){var E=I&7,T=I>>>3;return C<<=E,y[T]|=C&255,C>>>=8,y[T+1]=C,I+8}function pr(y,I,C){var E=I&7,T=I>>>3;return C<<=E,y[T]|=C&255,C>>>=8,y[T+1]=C&255,y[T+2]=C>>>8,I+16}function dn(y,I){var C=y.length,E=2*C>I?2*C:I+5,T=0;if(C>=I)return y;if(xt){var A=cv(E);if(y.copy)y.copy(A);else for(;T<y.length;++T)A[T]=y[T];return A}else if(H){var X=new Uint8Array(E);if(X.set)X.set(y);else for(;T<C;++T)X[T]=y[T];return X}return y.length=E,y}function ve(y){for(var I=new Array(y),C=0;C<y;++C)I[C]=0;return I}function we(y,I,C){var E=1,T=0,A=0,X=0,te=0,K=y.length,q=H?new Uint16Array(32):ve(32);for(A=0;A<32;++A)q[A]=0;for(A=K;A<C;++A)y[A]=0;K=y.length;var Q=H?new Uint16Array(K):ve(K);for(A=0;A<K;++A)q[T=y[A]]++,E<T&&(E=T),Q[A]=0;for(q[0]=0,A=1;A<=E;++A)q[A+16]=te=te+q[A-1]<<1;for(A=0;A<K;++A)te=y[A],te!=0&&(Q[A]=q[te+16]++);var de=0;for(A=0;A<K;++A)if(de=y[A],de!=0)for(te=se(Q[A],E)>>E-de,X=(1<<E+4-de)-1;X>=0;--X)I[te|X<<de]=de&15|A<<4;return E}var ii=H?new Uint16Array(512):ve(512),pn=H?new Uint16Array(32):ve(32);if(!H){for(var Dr=0;Dr<512;++Dr)ii[Dr]=0;for(Dr=0;Dr<32;++Dr)pn[Dr]=0}(function(){for(var y=[],I=0;I<32;I++)y.push(5);we(y,pn,32);var C=[];for(I=0;I<=143;I++)C.push(8);for(;I<=255;I++)C.push(9);for(;I<=279;I++)C.push(7);for(;I<=287;I++)C.push(8);we(C,ii,288)})();var Sn=function(){for(var I=H?new Uint8Array(32768):[],C=0,E=0;C<qe.length-1;++C)for(;E<qe[C+1];++E)I[E]=C;for(;E<32768;++E)I[E]=29;var T=H?new Uint8Array(259):[];for(C=0,E=0;C<Me.length-1;++C)for(;E<Me[C+1];++E)T[E]=C;function A(te,K){for(var q=0;q<te.length;){var Q=Math.min(65535,te.length-q),de=q+Q==te.length;for(K.write_shift(1,+de),K.write_shift(2,Q),K.write_shift(2,~Q&65535);Q-- >0;)K[K.l++]=te[q++]}return K.l}function X(te,K){for(var q=0,Q=0,de=H?new Uint16Array(32768):[];Q<te.length;){var me=Math.min(65535,te.length-Q);if(me<10){for(q=Ae(K,q,+(Q+me==te.length)),q&7&&(q+=8-(q&7)),K.l=q/8|0,K.write_shift(2,me),K.write_shift(2,~me&65535);me-- >0;)K[K.l++]=te[Q++];q=K.l*8;continue}q=Ae(K,q,+(Q+me==te.length)+2);for(var Ne=0;me-- >0;){var ye=te[Q];Ne=(Ne<<5^ye)&32767;var he=-1,it=0;if((he=de[Ne])&&(he|=Q&-32768,he>Q&&(he-=32768),he<Q))for(;te[he+it]==te[Q+it]&&it<250;)++it;if(it>2){ye=T[it],ye<=22?q=jt(K,q,L[ye+1]>>1)-1:(jt(K,q,3),q+=5,jt(K,q,L[ye-23]>>5),q+=3);var Zt=ye<8?0:ye-4>>2;Zt>0&&(pr(K,q,it-Me[ye]),q+=Zt),ye=I[Q-he],q=jt(K,q,L[ye]>>3),q-=3;var Nn=ye<4?0:ye-2>>1;Nn>0&&(pr(K,q,Q-he-qe[ye]),q+=Nn);for(var Rr=0;Rr<it;++Rr)de[Ne]=Q&32767,Ne=(Ne<<5^te[Q])&32767,++Q;me-=it-1}else ye<=143?ye=ye+48:q=Vt(K,q,1),q=jt(K,q,L[ye]),de[Ne]=Q&32767,++Q}q=jt(K,q,0)-1}return K.l=(q+7)/8|0,K.l}return function(K,q){return K.length<8?A(K,q):X(K,q)}}();function $n(y){var I=kr(50+Math.floor(y.length*1.1)),C=Sn(y,I);return I.slice(0,C)}var rt=H?new Uint16Array(32768):ve(32768),Xe=H?new Uint16Array(32768):ve(32768),Gt=H?new Uint16Array(128):ve(128),ur=1,eu=1;function ka(y,I){var C=fe(y,I)+257;I+=5;var E=fe(y,I)+1;I+=5;var T=be(y,I)+4;I+=4;for(var A=0,X=H?new Uint8Array(19):ve(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,q=H?new Uint8Array(8):ve(8),Q=H?new Uint8Array(8):ve(8),de=X.length,me=0;me<T;++me)X[lt[me]]=A=Le(y,I),K<A&&(K=A),q[A]++,I+=3;var Ne=0;for(q[0]=0,me=1;me<=K;++me)Q[me]=Ne=Ne+q[me-1]<<1;for(me=0;me<de;++me)(Ne=X[me])!=0&&(te[me]=Q[Ne]++);var ye=0;for(me=0;me<de;++me)if(ye=X[me],ye!=0){Ne=L[te[me]]>>8-ye;for(var he=(1<<7-ye)-1;he>=0;--he)Gt[Ne|he<<ye]=ye&7|me<<3}var it=[];for(K=1;it.length<C+E;)switch(Ne=Gt[Ke(y,I)],I+=Ne&7,Ne>>>=3){case 16:for(A=3+k(y,I),I+=2,Ne=it[it.length-1];A-- >0;)it.push(Ne);break;case 17:for(A=3+Le(y,I),I+=3;A-- >0;)it.push(0);break;case 18:for(A=11+Ke(y,I),I+=7;A-- >0;)it.push(0);break;default:it.push(Ne),K<Ne&&(K=Ne);break}var Zt=it.slice(0,C),Nn=it.slice(C);for(me=C;me<286;++me)Zt[me]=0;for(me=E;me<30;++me)Nn[me]=0;return ur=we(Zt,rt,286),eu=we(Nn,Xe,30),I}function as(y,I){if(y[0]==3&&!(y[1]&3))return[Ha(I),2];for(var C=0,E=0,T=cv(I||1<<18),A=0,X=T.length>>>0,te=0,K=0;!(E&1);){if(E=Le(y,C),C+=3,E>>>1)E>>1==1?(te=9,K=5):(C=ka(y,C),te=ur,K=eu);else{C&7&&(C+=8-(C&7));var q=y[C>>>3]|y[(C>>>3)+1]<<8;if(C+=32,q>0)for(!I&&X<A+q&&(T=dn(T,A+q),X=T.length);q-- >0;)T[A++]=y[C>>>3],C+=8;continue}for(;;){!I&&X<A+32767&&(T=dn(T,A+32767),X=T.length);var Q=ht(y,C,te),de=E>>>1==1?ii[Q]:rt[Q];if(C+=de&15,de>>>=4,!(de>>>8&255))T[A++]=de;else{if(de==256)break;de-=257;var me=de<8?0:de-4>>2;me>5&&(me=0);var Ne=A+Me[de];me>0&&(Ne+=ht(y,C,me),C+=me),Q=ht(y,C,K),de=E>>>1==1?pn[Q]:Xe[Q],C+=de&15,de>>>=4;var ye=de<4?0:de-2>>1,he=qe[de];for(ye>0&&(he+=ht(y,C,ye),C+=ye),!I&&X<Ne&&(T=dn(T,Ne+100),X=T.length);A<Ne;)T[A]=T[A-he],++A}}}return I?[T,C+7>>>3]:[T.slice(0,A),C+7>>>3]}function al(y,I){var C=y.slice(y.l||0),E=as(C,I);return y.l+=E[1],E[0]}function eg(y,I){if(y)typeof console<"u"&&console.error(I);else throw new Error(I)}function tg(y,I){var C=y;zr(C,0);var E=[],T=[],A={FileIndex:E,FullPaths:T};F(A,{root:I.root});for(var X=C.length-4;(C[X]!=80||C[X+1]!=75||C[X+2]!=5||C[X+3]!=6)&&X>=0;)--X;C.l=X+4,C.l+=4;var te=C.read_shift(2);C.l+=6;var K=C.read_shift(4);for(C.l=K,X=0;X<te;++X){C.l+=20;var q=C.read_shift(4),Q=C.read_shift(4),de=C.read_shift(2),me=C.read_shift(2),Ne=C.read_shift(2);C.l+=8;var ye=C.read_shift(4),he=o(C.slice(C.l+de,C.l+de+me));C.l+=de+me+Ne;var it=C.l;C.l=ye+4,he&&he[1]&&((he[1]||{}).usz&&(Q=he[1].usz),(he[1]||{}).csz&&(q=he[1].csz)),wC(C,q,Q,A,he),C.l=it}return A}function wC(y,I,C,E,T){y.l+=2;var A=y.read_shift(2),X=y.read_shift(2),te=s(y);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var K=y.read_shift(4),q=y.read_shift(4),Q=y.read_shift(4),de=y.read_shift(2),me=y.read_shift(2),Ne="",ye=0;ye<de;++ye)Ne+=String.fromCharCode(y[y.l++]);if(me){var he=o(y.slice(y.l,y.l+me));(he[21589]||{}).mt&&(te=he[21589].mt),(he[1]||{}).usz&&(Q=he[1].usz),(he[1]||{}).csz&&(q=he[1].csz),T&&((T[21589]||{}).mt&&(te=T[21589].mt),(T[1]||{}).usz&&(Q=T[1].usz),(T[1]||{}).csz&&(q=T[1].csz))}y.l+=me;var it=y.slice(y.l,y.l+q);switch(X){case 8:it=Ie(y,Q);break;case 0:y.l+=q;break;default:throw new Error("Unsupported ZIP Compression method "+X)}var Zt=!1;A&8&&(K=y.read_shift(4),K==134695760&&(K=y.read_shift(4),Zt=!0),q=y.read_shift(4),Q=y.read_shift(4)),q!=I&&eg(Zt,"Bad compressed size: "+I+" != "+q),Q!=C&&eg(Zt,"Bad uncompressed size: "+C+" != "+Q),W0(E,Ne,it,{unsafe:!0,mt:te})}function bC(y,I){var C=I||{},E=[],T=[],A=kr(1),X=C.compression?8:0,te=0,K=!1;K&&(te|=8);var q=0,Q=0,de=0,me=0,Ne=y.FullPaths[0],ye=Ne,he=y.FileIndex[0],it=[],Zt=0;for(q=1;q<y.FullPaths.length;++q)if(ye=y.FullPaths[q].slice(Ne.length),he=y.FileIndex[q],!(!he.size||!he.content||Array.isArray(he.content)&&he.content.length==0||ye=="Sh33tJ5")){var Nn=de,Rr=kr(ye.length);for(Q=0;Q<ye.length;++Q)Rr.write_shift(1,ye.charCodeAt(Q)&127);Rr=Rr.slice(0,Rr.l),it[me]=typeof he.content=="string"?vv.bstr(he.content,0):vv.buf(he.content,0);var Wn=typeof he.content=="string"?Gn(he.content):he.content;X==8&&(Wn=Ee(Wn)),A=kr(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,te),A.write_shift(2,X),he.mt?a(A,he.mt):A.write_shift(4,0),A.write_shift(-4,te&8?0:it[me]),A.write_shift(4,te&8?0:Wn.length),A.write_shift(4,te&8?0:he.content.length),A.write_shift(2,Rr.length),A.write_shift(2,0),de+=A.length,E.push(A),de+=Rr.length,E.push(Rr),de+=Wn.length,E.push(Wn),te&8&&(A=kr(12),A.write_shift(-4,it[me]),A.write_shift(4,Wn.length),A.write_shift(4,he.content.length),de+=A.l,E.push(A)),A=kr(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,te),A.write_shift(2,X),A.write_shift(4,0),A.write_shift(-4,it[me]),A.write_shift(4,Wn.length),A.write_shift(4,he.content.length),A.write_shift(2,Rr.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,Nn),Zt+=A.l,T.push(A),Zt+=Rr.length,T.push(Rr),++me}return A=kr(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,me),A.write_shift(2,me),A.write_shift(4,Zt),A.write_shift(4,de),A.write_shift(2,0),Ua([Ua(E),Ua(T),A])}var tu={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function CC(y,I){if(y.ctype)return y.ctype;var C=y.name||"",E=C.match(/\.([^\.]+)$/);return E&&tu[E[1]]||I&&(E=(C=I).match(/[\.\\]([^\.\\])+$/),E&&tu[E[1]])?tu[E[1]]:"application/octet-stream"}function EC(y){for(var I=lv(y),C=[],E=0;E<I.length;E+=76)C.push(I.slice(E,E+76));return C.join(`\r
`)+`\r
`}function SC(y){var I=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var Q=q.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],E=I.split(`\r
`),T=0;T<E.length;++T){var A=E[T];if(A.length==0){C.push("");continue}for(var X=0;X<A.length;){var te=76,K=A.slice(X,X+te);K.charAt(te-1)=="="?te--:K.charAt(te-2)=="="?te-=2:K.charAt(te-3)=="="&&(te-=3),K=A.slice(X,X+te),X+=te,X<A.length&&(K+="="),C.push(K)}}return C.join(`\r
`)}function TC(y){for(var I=[],C=0;C<y.length;++C){for(var E=y[C];C<=y.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+y[++C];I.push(E)}for(var T=0;T<I.length;++T)I[T]=I[T].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Gn(I.join(`\r
`))}function IC(y,I,C){for(var E="",T="",A="",X,te=0;te<10;++te){var K=I[te];if(!K||K.match(/^\s*$/))break;var q=K.match(/^([^:]*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":E=q[2].trim();break;case"content-type":A=q[2].trim();break;case"content-transfer-encoding":T=q[2].trim();break}}switch(++te,T.toLowerCase()){case"base64":X=Gn(qn(I.slice(te).join("")));break;case"quoted-printable":X=TC(I.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var Q=W0(y,E.slice(C.length),X,{unsafe:!0});A&&(Q.ctype=A)}function kC(y,I){if(Oe(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=I&&I.root||"",E=(xt&&Buffer.isBuffer(y)?y.toString("binary"):Oe(y)).split(`\r
`),T=0,A="";for(T=0;T<E.length;++T)if(A=E[T],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),C||(C=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),A.slice(0,C.length)!=C););var X=(E[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var te="--"+(X[1]||""),K=[],q=[],Q={FileIndex:K,FullPaths:q};F(Q);var de,me=0;for(T=0;T<E.length;++T){var Ne=E[T];Ne!==te&&Ne!==te+"--"||(me++&&IC(Q,E.slice(de,T),C),de=T)}return Q}function AC(y,I){var C=I||{},E=C.boundary||"SheetJS";E="------="+E;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],A=y.FullPaths[0],X=A,te=y.FileIndex[0],K=1;K<y.FullPaths.length;++K)if(X=y.FullPaths[K].slice(A.length),te=y.FileIndex[K],!(!te.size||!te.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var q=te.content,Q=xt&&Buffer.isBuffer(q)?q.toString("binary"):Oe(q),de=0,me=Math.min(1024,Q.length),Ne=0,ye=0;ye<=me;++ye)(Ne=Q.charCodeAt(ye))>=32&&Ne<128&&++de;var he=de>=me*4/5;T.push(E),T.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+X),T.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),T.push("Content-Type: "+CC(te,X)),T.push(""),T.push(he?SC(Q):EC(Q))}return T.push(E+`--\r
`),T.join(`\r
`)}function OC(y){var I={};return F(I,y),I}function W0(y,I,C,E){var T=E&&E.unsafe;T||F(y);var A=!T&&Tt.find(y,I);if(!A){var X=y.FullPaths[0];I.slice(0,X.length)==X?X=I:(X.slice(-1)!="/"&&(X+="/"),X=(X+I).replace("//","/")),A={name:i(I),type:2},y.FileIndex.push(A),y.FullPaths.push(X),T||Tt.utils.cfb_gc(y)}return A.content=C,A.size=C?C.length:0,E&&(E.CLSID&&(A.clsid=E.CLSID),E.mt&&(A.mt=E.mt),E.ct&&(A.ct=E.ct)),A}function FC(y,I){F(y);var C=Tt.find(y,I);if(C){for(var E=0;E<y.FileIndex.length;++E)if(y.FileIndex[E]==C)return y.FileIndex.splice(E,1),y.FullPaths.splice(E,1),!0}return!1}function DC(y,I,C){F(y);var E=Tt.find(y,I);if(E){for(var T=0;T<y.FileIndex.length;++T)if(y.FileIndex[T]==E)return y.FileIndex[T].name=i(C),y.FullPaths[T]=C,!0}return!1}function RC(y){M(y,!0)}return r.find=B,r.read=U,r.parse=u,r.write=oe,r.writeFile=ge,r.utils={cfb_new:OC,cfb_add:W0,cfb_del:FC,cfb_mov:DC,cfb_gc:RC,ReadShift:Xl,CheckField:V_,prep_blob:zr,bconcat:Ua,use_zlib:le,_deflateRaw:$n,_inflateRaw:al,consts:re},r}(),bd;function FI(e){if(typeof bd<"u")return bd.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||n.message.indexOf("onstruct")==-1)throw n}throw new Error("Cannot access file "+e)}function mi(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Nd(e){for(var r=[],t=mi(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var y_=Date.UTC(1899,11,30,0,0,0),DI=Date.UTC(1899,11,31,0,0,0),RI=Date.UTC(1904,0,1,0,0,0);function jr(e,r){var t=e.getTime(),n=(t-y_)/(24*60*60*1e3);return r?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Wa(e){if(e>=60&&e<61)return e;var r=new Date;return r.setTime((e>60?e:e+1)*24*60*60*1e3+y_),r}function MI(e){var r=0,t=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(t=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(i[a],10)}return r}var NI=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,PI=/^(\d+)-(\d+)-(\d+)$/,w_=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function ln(e,r){if(e instanceof Date)return e;var t=e.match(NI);if(t)return new Date((r?RI:DI)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=e.match(PI),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=e.match(w_),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function Ts(e,r){if(xt&&Buffer.isBuffer(e)){if(r&&ac){if(e[0]==255&&e[1]==254)return Kl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Kl(u_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Kl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Kl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return t[a]||a})}catch{}var n=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{try{for(;i<e.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{for(;i!=e.length;++i)n.push(String.fromCharCode(e[i]))}}return n.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Ur(e[t]));return r}function St(e,r){for(var t="";t.length<r;)t+=e;return t}function Kn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(i,a){return t=-t,a}),!isNaN(r=Number(n)))?r/t:r}var LI=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,BI=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,VI=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,UI=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function $I(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function WI(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var HI=["january","february","march","april","may","june","july","august","september","october","november","december"];function oc(e){if(VI.test(e))return e.indexOf("Z")==-1?ff(new Date(e)):new Date(e);var r=e.toLowerCase(),t=r.replace(/\s+/g," ").trim(),n=t.match(LI);if(n)return $I(n);if(n=t.match(BI),n)return WI(n);if(n=t.match(w_),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var i=new Date(UI&&e.indexOf("UTC")==-1?e+" UTC":e),a=new Date(NaN),s=i.getYear(),o=i.getMonth(),l=i.getDate();if(isNaN(l))return a;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&HI.indexOf(r)==-1)return a}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return a;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?a:i}var zI=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(e||typeof n=="string")return t.split(n);for(var a=t.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function Is(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function ff(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function Pd(e){var r=e.slice(0,1024),t=r.indexOf("<!DOCTYPE");if(t==-1)return e;var n=e.match(/<[\w]/);return n?e.slice(0,t)+e.slice(n.index):e}function Ld(e,r,t){for(var n=[],i=e.indexOf(r);i>-1;){var a=e.indexOf(t,i+r.length);if(a==-1)break;n.push(e.slice(i,a+t.length)),i=e.indexOf(r,a+t.length)}return n.length>0?n:null}function dc(e,r,t){var n=[],i=0,a=e.indexOf(r);if(a==-1)return e;for(;a>-1;){n.push(e.slice(i,a));var s=e.indexOf(t,a+r.length);if(s==-1)break;(a=e.indexOf(r,i=s+t.length))==-1&&n.push(e.slice(i))}return n.join("")}var jI={" ":1,"	":1,"\r":1,"\n":1,">":1};function ws(e,r){for(var t=e.indexOf("<"+r),n=r.length+1,i=e.length;t>=0&&t<=i-n&&!jI[e.charAt(t+n)];)t=e.indexOf("<"+r,t+1);if(t===-1)return null;var a=e.indexOf(">",t+r.length);if(a===-1)return null;var s="</"+r+">",o=e.indexOf(s,a);return o==-1?null:[e.slice(t,o+s.length),e.slice(a+1,o)]}var Zr=function(){var e={};return function(t,n){var i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;var a=i[0].exec(t);if(!a)return null;var s=a.index,o=i[0].lastIndex;if(i[1].lastIndex=i[0].lastIndex,a=i[1].exec(t),!a)return null;var l=a.index,c=i[1].lastIndex;return[t.slice(s,c),t.slice(o,l)]}}(),b_=function(){var e={};return function(t,n){var i=[],a=e[n];a||(e[n]=a=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),a[0].lastIndex=a[1].lastIndex=0;for(var s;s=a[0].exec(t);){var o=s.index;if(a[1].lastIndex=a[0].lastIndex,s=a[1].exec(t),!s)return null;var l=a[1].lastIndex;i.push(t.slice(o,l)),a[0].lastIndex=a[1].lastIndex}return i.length==0?null:i}}(),GI=function(){var e={};return function(t,n){var i=[],a=e[n];a||(e[n]=a=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),a[0].lastIndex=a[1].lastIndex=0;for(var s,o=0,l=0;s=a[0].exec(t);){if(o=s.index,i.push(t.slice(l,o)),l=o,a[1].lastIndex=a[0].lastIndex,s=a[1].exec(t),!s)return null;l=a[1].lastIndex,a[0].lastIndex=a[1].lastIndex}return i.push(t.slice(l)),i.length==0?"":i.join("")}}(),KI=function(){var e={};return function(t,n){var i=[],a=e[n];a||(e[n]=a=[new RegExp("<"+n+"\\b[^<>]*>","ig"),new RegExp("</"+n+">","ig")]),a[0].lastIndex=a[1].lastIndex=0;for(var s;s=a[0].exec(t);){var o=s.index;if(a[1].lastIndex=a[0].lastIndex,s=a[1].exec(t),!s)return null;var l=a[1].lastIndex;i.push(t.slice(o,l)),a[0].lastIndex=a[1].lastIndex}return i.length==0?null:i}}();function C_(e){return e?e.content&&e.type?Ts(e.content,!0):e.data?jl(e.data):e.asNodeBuffer&&xt?jl(e.asNodeBuffer().toString("binary")):e.asBinary?jl(e.asBinary()):e._data&&e._data.getContent?jl(Ts(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function E_(e){if(!e)return null;if(e.data)return wd(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?wd(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function qI(e){return e&&e.name.slice(-4)===".bin"?E_(e):C_(e)}function pi(e,r){for(var t=e.FullPaths||mi(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<t.length;++a){var s=t[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[t[a]]:e.FileIndex[a]}return null}function Bd(e,r){var t=pi(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Br(e,r,t){if(!t)return qI(Bd(e,r));if(!r)return null;try{return Br(e,r)}catch{return null}}function On(e,r,t){if(!t)return C_(Bd(e,r));if(!r)return null;try{return On(e,r)}catch{return null}}function S_(e,r,t){if(!t)return E_(Bd(e,r));if(!r)return null;try{return S_(e,r)}catch{return null}}function _v(e){for(var r=e.FullPaths||mi(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function XI(e,r,t){if(e.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var n;return xt?n=Ga(t):n=iI(t),Tt.utils.cfb_add(e,r,n)}Tt.utils.cfb_add(e,r,t)}else e.file(r,t)}function T_(e,r){switch(r.type){case"base64":return Tt.read(e,{type:"base64"});case"binary":return Tt.read(e,{type:"binary"});case"buffer":case"array":return Tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function wo(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var I_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,k_=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/mg,QI=/<[^<>]*>/g,cn=I_.match(xv)?xv:QI,YI=/<\w*:/,ZI=/<(\/?)\w+:/;function Re(e,r,t){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(k_),o=0,l="",c=0,u="",f="",h=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c].slice(1),a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(u=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(i=f.charCodeAt(a+1))==34||i==39?1:0,l=f.slice(a+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,t||(n[u.toLowerCase()]=l);else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,t||(n[d.toLowerCase()]=l)}}return n}function JI(e,r,t){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(k_),o=0,l="",c=0,u="",f="",h=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c].slice(1),a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(u=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;h=(i=f.charCodeAt(a+1))==34||i==39?1:0,l=f.slice(a+1+h,f.length-h),u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,t||(n[u.toLowerCase()]=l)}return n}function gi(e){return e.replace(ZI,"<$1")}var A_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},e4=Nd(A_),yt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;function t(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,l){return A_[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return t(i.slice(0,a))+i.slice(a+9,s)+t(i.slice(s+3))}return function(i,a){var s=t(i);return a?s.replace(/\r\n/g,`
`):s}}(),t4=/[&<>'"]/g;var r4=/[\u0000-\u001f]/g;function ql(e){var r=e+"";return r.replace(t4,function(t){return e4[t]}).replace(/\n/g,"<br/>").replace(r4,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var yv=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Wt(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function hd(e){for(var r="",t=0,n=0,i=0,a=0,s=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=i&63,r+=String.fromCharCode(s);continue}if(a=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function wv(e){var r=Ha(2*e.length),t,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[a++]=s&255,r[a++]=s>>>8,s=0),r[a++]=t%256,r[a++]=t>>>8;return r.slice(0,a).toString("ucs2")}function bv(e){return Ga(e,"binary").toString("utf8")}var Hu="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Xt=xt&&(bv(Hu)==hd(Hu)&&bv||wv(Hu)==hd(Hu)&&wv)||hd,Kl=xt?function(e){return Ga(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},O_=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),n4=/<\/?(?:vt:)?variant>/g,i4=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function Cv(e,r){var t=Re(e),n=b_(e,t.baseType)||[],i=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(a){var s=a.replace(n4,"").match(i4);s&&i.push({v:Xt(s[2]),t:s[1]})}),i}var a4=/(^\s|\s$|\n)/;function s4(e){return mi(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function o4(e,r,t){return"<"+e+(t!=null?s4(t):"")+(r!=null?(r.match(a4)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function hf(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(da(Dd(e)));throw new Error("Bad input format: expected Buffer or string")}var Vr=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/mg,l4={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},c4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function u4(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,a=5;a>=0;--a)i=i*256+e[r+a];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function f4(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,s=n?-r:r;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var o=0;o<=5;++o,a/=256)e[t+o]=a&255;e[t+6]=(i&15)<<4|a&15,e[t+7]=i>>4|n}var Ev=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=t)r.push.apply(r,e[0][n].slice(i,i+t));return r},Sv=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ga(r)})):Ev(e)}:Ev,Tv=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(ua(e,i)));return n.join("").replace(Fn,"")},df=xt?function(e,r,t){return!Buffer.isBuffer(e)||!ac?Tv(e,r,t):e.toString("utf16le",r,t).replace(Fn,"")}:Tv,Iv=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},F_=xt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Iv(e,r,t)}:Iv,kv=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(yo(e,i)));return n.join("")},ko=xt?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):kv(r,t,n)}:kv,D_=function(e,r){var t=Yr(e,r);return t>0?ko(e,r+4,r+4+t-1):""},Vd=D_,R_=function(e,r){var t=Yr(e,r);return t>0?ko(e,r+4,r+4+t-1):""},Ud=R_,M_=function(e,r){var t=2*Yr(e,r);return t>0?ko(e,r+4,r+4+t-1):""},$d=M_,N_=function(r,t){var n=Yr(r,t);return n>0?df(r,t+4,t+4+n):""},Wd=N_,P_=function(e,r){var t=Yr(e,r);return t>0?ko(e,r+4,r+4+t):""},Hd=P_,L_=function(e,r){return u4(e,r)},rf=L_,B_=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};xt&&(Vd=function(r,t){if(!Buffer.isBuffer(r))return D_(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Ud=function(r,t){if(!Buffer.isBuffer(r))return R_(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},$d=function(r,t){if(!Buffer.isBuffer(r)||!ac)return M_(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Wd=function(r,t){if(!Buffer.isBuffer(r)||!ac)return N_(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Hd=function(r,t){if(!Buffer.isBuffer(r))return P_(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},rf=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):L_(r,t)},B_=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function h4(){df=function(e,r,t){return _t.utils.decode(1200,e.slice(r,t)).replace(Fn,"")},ko=function(e,r,t){return _t.utils.decode(65001,e.slice(r,t))},Vd=function(e,r){var t=Yr(e,r);return t>0?_t.utils.decode(So,e.slice(r+4,r+4+t-1)):""},Ud=function(e,r){var t=Yr(e,r);return t>0?_t.utils.decode(xn,e.slice(r+4,r+4+t-1)):""},$d=function(e,r){var t=2*Yr(e,r);return t>0?_t.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},Wd=function(e,r){var t=Yr(e,r);return t>0?_t.utils.decode(1200,e.slice(r+4,r+4+t)):""},Hd=function(e,r){var t=Yr(e,r);return t>0?_t.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof _t<"u"&&h4();var yo=function(e,r){return e[r]},ua=function(e,r){return e[r+1]*256+e[r]},d4=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Yr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},xs=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},p4=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Xl(e,r){var t="",n,i,a=[],s,o,l,c;switch(r){case"dbcs":if(c=this.l,xt&&Buffer.isBuffer(this)&&ac)t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(ua(this,c)),c+=2;e*=2;break;case"utf8":t=ko(this,this.l,this.l+e);break;case"utf16le":e*=2,t=df(this,this.l,this.l+e);break;case"wstr":if(typeof _t<"u")t=_t.utils.decode(xn,this.slice(this.l,this.l+2*e));else return Xl.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=Vd(this,this.l),e=4+Yr(this,this.l);break;case"lpstr-cp":t=Ud(this,this.l),e=4+Yr(this,this.l);break;case"lpwstr":t=$d(this,this.l),e=4+2*Yr(this,this.l);break;case"lpp4":e=4+Yr(this,this.l),t=Wd(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Yr(this,this.l),t=Hd(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=yo(this,this.l+e++))!==0;)a.push(Wu(s));t=a.join("");break;case"_wstr":for(e=0,t="";(s=ua(this,this.l+e))!==0;)a.push(Wu(s)),e+=2;e+=2,t=a.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=yo(this,c),this.l=c+1,o=Xl.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Wu(ua(this,c))),c+=2}t=a.join(""),e*=2;break;case"cpstr":if(typeof _t<"u"){t=_t.utils.decode(xn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=yo(this,c),this.l=c+1,o=Xl.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Wu(yo(this,c))),c+=1}t=a.join("");break;default:switch(e){case 1:return n=yo(this,this.l),this.l++,n;case 2:return n=(r==="i"?d4:ua)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?xs:p4)(this,this.l),this.l+=4,n):(i=Yr(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=rf(this,this.l):i=rf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=F_(this,this.l,e);break}}return this.l+=e,t}var m4=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},g4=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},v4=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function _4(e,r,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)v4(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(t==="sbcs"||t=="cpstr")if(typeof _t<"u"&&So==874){for(i=0;i!=r.length;++i){var a=_t.utils.encode(So,r.charAt(i));this[this.l+i]=a[0]}n=r.length}else if(typeof _t<"u"&&t=="cpstr"){if(a=_t.utils.encode(xn,r),a.length==r.length)for(i=0;i<r.length;++i)a[i]==0&&r.charCodeAt(i)!=0&&(a[i]=95);if(a.length==2*r.length)for(i=0;i<r.length;++i)a[2*i]==0&&a[2*i+1]==0&&r.charCodeAt(i)!=0&&(a[2*i]=95);for(i=0;i<a.length;++i)this[this.l+i]=a[i];n=a.length}else{for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var o=r.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,m4(this,r,this.l);break;case 8:if(n=8,t==="f"){f4(this,r,this.l);break}case 16:break;case-4:n=4,g4(this,r,this.l);break}return this.l+=n,this}function V_(e,r){var t=F_(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function zr(e,r){e.l=r,e.read_shift=Xl,e.chk=V_,e.write_shift=_4}function Cn(e,r){e.l+=r}function kr(e){var r=Ha(e);return zr(r,0),r}function pa(e,r,t){if(e){var n,i,a;zr(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=cf[o]||cf[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var u=c.f&&c.f(e,a,t);if(e.l=l,r(u,c,o))return}}}function Cd(){var e=[],r=xt?16384:2048,t=xt&&typeof kr(r).copy=="function",n=function(f){var h=kr(f);return zr(h,0),h},i=n(r),a=function(){i&&(i.l&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i)),i=null)},s=function(f){return i&&f<i.length-i.l?i:(a(),i=n(Math.max(f+1,r)))},o=function(){return a(),Ua(e)},l=function(){return a(),e},c=function(f){a(),i=f,i.l==null&&(i.l=i.length),s(r)};return{next:s,push:c,end:o,_bufs:e,end2:l}}function Ql(e,r,t){var n=Ur(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Av(e,r,t){var n=Ur(e);return n.s=Ql(n.s,r.s,t),n.e=Ql(n.e,r.s,t),n}function Yl(e,r){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Ft(e);return!e.cRel&&e.cRel!=null&&(t=w4(t)),!e.rRel&&e.rRel!=null&&(t=x4(t)),t}function dd(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dt(e.s.c)+":"+(e.e.cRel?"":"$")+Dt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ht(e.s.r)+":"+(e.e.rRel?"":"$")+Ht(e.e.r):Yl(e.s,r.biff)+":"+Yl(e.e,r.biff)}function zd(e){return parseInt(y4(e),10)-1}function Ht(e){return""+(e+1)}function x4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function y4(e){return e.replace(/\$(\d+)$/,"$1")}function jd(e){for(var r=b4(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Dt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function w4(e){return e.replace(/^([A-Z])/,"$$$1")}function b4(e){return e.replace(/^\$([A-Z])/,"$1")}function C4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wn(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Ft(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function As(e){var r=e.indexOf(":");return r==-1?{s:wn(e),e:wn(e)}:{s:wn(e.slice(0,r)),e:wn(e.slice(r+1))}}function wt(e,r){return typeof r>"u"||typeof r=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=Ft(e)),typeof r!="string"&&(r=Ft(r)),e==r?e:e+":"+r)}function E4(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Or(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,a=e.length;for(t=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===a||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function Ov(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Xn(e.z,t?jr(r):r)}catch{}try{return e.w=Xn((e.XF||{}).numFmtId||(t?14:0),t?jr(r):r)}catch{return""+r}}function za(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ln[e.v]||e.v:r==null?Ov(e,e.v):Ov(e,r))}function Ka(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function S4(e){var r={},t=e||{};return t.dense&&(r["!data"]=[]),r}function U_(e,r,t){var n=t||{},i=e?e["!data"]!=null:n.dense;Ar!=null&&i==null&&(i=Ar);var a=e||(i?{"!data":[]}:{});i&&!a["!data"]&&(a["!data"]=[]);var s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?wn(n.origin):n.origin;s=l.r,o=l.c}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=Or(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=a["!ref"]?u.e.r+1:0)}else c.s.c=c.e.c=c.s.r=c.e.r=0;for(var f=[],h=!1,d=0;d!=r.length;++d)if(r[d]){if(!Array.isArray(r[d]))throw new Error("aoa_to_sheet expects an array of arrays");var g=s+d;i&&(a["!data"][g]||(a["!data"][g]=[]),f=a["!data"][g]);for(var v=r[d],p=0;p!=v.length;++p)if(!(typeof v[p]>"u")){var m={v:v[p],t:""},x=o+p;if(c.s.r>g&&(c.s.r=g),c.s.c>x&&(c.s.c=x),c.e.r<g&&(c.e.r=g),c.e.c<x&&(c.e.c=x),h=!0,v[p]&&typeof v[p]=="object"&&!Array.isArray(v[p])&&!(v[p]instanceof Date))m=v[p];else if(Array.isArray(m.v)&&(m.f=v[p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?isFinite(m.v)?m.t="n":isNaN(m.v)?(m.t="e",m.v=15):(m.t="e",m.v=7):typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||et[14],n.UTC||(m.v=ff(m.v)),n.cellDates?(m.t="d",m.w=Xn(m.z,jr(m.v,n.date1904))):(m.t="n",m.v=jr(m.v,n.date1904),m.w=Xn(m.z,m.v))):m.t="s";if(i)f[x]&&f[x].z&&(m.z=f[x].z),f[x]=m;else{var _=Dt(x)+(g+1);a[_]&&a[_].z&&(m.z=a[_].z),a[_]=m}}}return h&&c.s.c<104e5&&(a["!ref"]=wt(c)),a}function Ao(e,r){return U_(null,e,r)}function T4(e){return e.read_shift(4,"i")}function bn(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function I4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Gd(e,r){var t=e.l,n=e.read_shift(1),i=bn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(I4(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}var k4=Gd;function vi(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Os(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var A4=bn;function pf(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var O4=bn,Ed=pf;function mf(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?rf([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):xs(r,0)>>2;return t?i/100:i}function $_(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Fs=$_;function yn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function F4(e){var r={},t=e.read_shift(1),n=t>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var c=bs[i];c&&(r.rgb=cc(c));break;case 2:r.rgb=cc([s,o,l]);break;case 3:r.theme=i;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function D4(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function W_(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function R4(e){return W_(e,1)}function M4(e){return W_(e,2)}var Kd=2,Pn=3,zu=11,Fv=12,nf=19,ju=64,N4=65,P4=71,L4=4108,B4=4126,Xr=80,H_=81,V4=[Xr,H_],U4={1:{n:"CodePage",t:Kd},2:{n:"Category",t:Xr},3:{n:"PresentationFormat",t:Xr},4:{n:"ByteCount",t:Pn},5:{n:"LineCount",t:Pn},6:{n:"ParagraphCount",t:Pn},7:{n:"SlideCount",t:Pn},8:{n:"NoteCount",t:Pn},9:{n:"HiddenCount",t:Pn},10:{n:"MultimediaClipCount",t:Pn},11:{n:"ScaleCrop",t:zu},12:{n:"HeadingPairs",t:L4},13:{n:"TitlesOfParts",t:B4},14:{n:"Manager",t:Xr},15:{n:"Company",t:Xr},16:{n:"LinksUpToDate",t:zu},17:{n:"CharacterCount",t:Pn},19:{n:"SharedDoc",t:zu},22:{n:"HyperlinksChanged",t:zu},23:{n:"AppVersion",t:Pn,p:"version"},24:{n:"DigSig",t:N4},26:{n:"ContentType",t:Xr},27:{n:"ContentStatus",t:Xr},28:{n:"Language",t:Xr},29:{n:"Version",t:Xr},255:{},2147483648:{n:"Locale",t:nf},2147483651:{n:"Behavior",t:nf},1919054434:{}},$4={1:{n:"CodePage",t:Kd},2:{n:"Title",t:Xr},3:{n:"Subject",t:Xr},4:{n:"Author",t:Xr},5:{n:"Keywords",t:Xr},6:{n:"Comments",t:Xr},7:{n:"Template",t:Xr},8:{n:"LastAuthor",t:Xr},9:{n:"RevNumber",t:Xr},10:{n:"EditTime",t:ju},11:{n:"LastPrinted",t:ju},12:{n:"CreatedDate",t:ju},13:{n:"ModifiedDate",t:ju},14:{n:"PageCount",t:Pn},15:{n:"WordCount",t:Pn},16:{n:"CharCount",t:Pn},17:{n:"Thumbnail",t:P4},18:{n:"Application",t:Xr},19:{n:"DocSecurity",t:Pn},255:{},2147483648:{n:"Locale",t:nf},2147483651:{n:"Behavior",t:nf},1919054434:{}},Dv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},W4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function H4(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var z4=H4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),bs=Ur(z4),Ln={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sn={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},z_=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Rv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function j4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function G4(e){var r=j4();if(!e||!e.match)return r;var t={};if((e.match(cn)||[]).forEach(function(n){var i=Re(n);switch(i[0].replace(YI,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension.toLowerCase()]=i.ContentType;break;case"<Override":r[Rv[i.ContentType]]!==void 0&&r[Rv[i.ContentType]].push(i.PartName);break}}),r.xmlns!==l4.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var oa={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sd(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Zl(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(cn)||[]).forEach(function(i){var a=Re(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=yt(a.Target),s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:wo(a.Target,r);t[o]=s,n[a.Id]=s}}),t["!id"]=n,t}var K4="application/vnd.oasis.opendocument.spreadsheet";function q4(e,r){for(var t=hf(e),n,i;n=Vr.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Re(n[0],!1),i.path=="/"&&i.type!==K4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Mv=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function j_(e){var r={};e=Xt(e);for(var t=0;t<Mv.length;++t){var n=Mv[t],i=ws(e,n[0]);i!=null&&i.length>0&&(r[n[1]]=yt(i[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=ln(r[n[1]]))}return r}var X4=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function G_(e,r,t,n){var i=[];if(typeof e=="string")i=Cv(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(u){return{v:u}}));var s=typeof r=="string"?Cv(r,n).map(function(u){return u.v}):r,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=l,t.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=s.slice(o,o+l);break}o+=l}}function Q4(e,r,t){var n={};return r||(r={}),e=Xt(e),X4.forEach(function(i){var a=(Zr(e,i[0])||[])[1];switch(i[2]){case"string":a&&(r[i[1]]=yt(a));break;case"bool":r[i[1]]=a==="true";break;case"raw":var s=ws(e,i[0]);s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&G_(n.HeadingPairs,n.TitlesOfParts,r,t),r}var Y4=/<[^<>]+>[^<]*/g;function Z4(e,r){var t={},n="",i=e.match(Y4);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=Re(s);switch(gi(o[0])){case"<?xml":break;case"<Properties":break;case"<property":n=yt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":t[n]=yt(u);break;case"bool":t[n]=Wt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=ln(u);break;case"cy":case"error":t[n]=yt(u);break;default:if(c.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}var J4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pd;function ek(e,r,t){pd||(pd=Nd(J4)),r=pd[r]||r,e[r]=t}function qd(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tk(e,r,t){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return i}function rk(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}function K_(e,r,t){return r===31?rk(e):tk(e,r,t)}function Jl(e,r,t){return K_(e,r,t===!1?0:4)}function nk(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return K_(e,r,0)}function ik(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var i=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Fn,""),e.l-i&2&&(e.l+=2)}return t}function ak(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Fn,"");return t}function sk(e){var r=e.l,t=af(e,H_);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=af(e,Pn);return[t,n]}function ok(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(sk(e));return t}function Nv(e,r){for(var t=e.read_shift(4),n={},i=0;i!=t;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Fn,"").replace(Gl,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function q_(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function lk(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function af(e,r,t){var n=e.read_shift(2),i,a=t||{};if(e.l+=2,r!==Fv&&n!==r&&V4.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Fv?n:r){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:e.l+=4,val=Jl(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,val=Jl(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return qd(e);case 65:return q_(e);case 71:return lk(e);case 80:return Jl(e,n,!a.raw).replace(Fn,"");case 81:return nk(e,n).replace(Fn,"");case 4108:return ok(e);case 4126:case 4127:return n==4127?ik(e):ak(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Pv(e,r){var t=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=i;++s){var u=e.read_shift(4),f=e.read_shift(4);a[s]=[u,f+t]}a.sort(function(x,_){return x[1]-_[1]});var h={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var d=!0;if(s>0&&r)switch(r[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],d=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],d=!1);break}if((!r||s==0)&&e.l<=a[s][1]&&(d=!1,e.l=a[s][1]),d)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(r){if(a[s][0]==0&&a.length>s+1&&a[s][1]==a[s+1][1])continue;var g=r[a[s][0]];if(h[g.n]=af(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ii(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(a[s][0]===1){if(o=h.CodePage=af(e,Kd),Ii(o),l!==-1){var v=e.l;e.l=a[l][1],c=Nv(e,o),e.l=v}}else if(a[s][0]===0){if(o===0){l=s,e.l=a[s+1][1];continue}c=Nv(e,o)}else{var p=c[a[s][0]],m;switch(e[e.l]){case 65:e.l+=4,m=q_(e);break;case 30:e.l+=4,m=Jl(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,m=Jl(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=Ir(e,4);break;case 64:e.l+=4,m=ln(qd(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=m}}return e.l=t+n,h}function Lv(e,r,t){var n=e.content;if(!n)return{};zr(n,0);var i,a,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Tt.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=Pv(n,r),h={SystemIdentifier:c};for(var d in f)h[d]=f[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Pv(n,null)}catch{}for(d in g)h[d]=g[d];return h.FMTID=[a,s],h}function Va(e,r){return e.read_shift(r),null}function ck(e,r,t){for(var n=[],i=e.l+r;e.l<i;)n.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Ir(e,r){return e.read_shift(r)===1}function Cr(e){return e.read_shift(2,"u")}function X_(e,r){return ck(e,r,Cr)}function Q_(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function To(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=xn;if(t&&t.biff>=8&&(xn=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return xn=a,o}function uk(e){var r=xn;xn=1200;var t=e.read_shift(2),n=e.read_shift(1),i=n&4,a=n&8,s=1+(n&1),o=0,l,c={};a&&(o=e.read_shift(2)),i&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*o),i&&(e.l+=l),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),xn=r,c}function ks(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function pc(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):ks(e,n,t)}function Ds(e,r,t){if(t.biff>5)return pc(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fk(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function hk(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Fn,"");return n&&(e.l+=24),i}function dk(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Fn,"");return t+s}function pk(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return hk(e,r);case"0303000000000000c000000000000046":return dk(e,r);default:throw new Error("Unsupported Moniker "+t)}}function Gu(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Fn,""):"";return t}function mk(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,l,c="",u,f;i&16&&(a=Gu(e,t-e.l)),i&128&&(s=Gu(e,t-e.l)),(i&257)===257&&(o=Gu(e,t-e.l)),(i&257)===1&&(l=pk(e,t-e.l)),i&8&&(c=Gu(e,t-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=qd(e)),e.l=t;var h=s||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),a&&(d.Tooltip=a),d}function Y_(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[r,t,n,i]}function Z_(e,r){var t=Y_(e,r);return t[3]=0,t}function Oi(e,r,t){var n=e.read_shift(2),i=e.read_shift(2),a={r:n,c:i,ixfe:0};if(t&&t.biff==2||r==7){var s=e.read_shift(1);a.ixfe=s&63,e.l+=2}else a.ixfe=e.read_shift(2);return a}function gk(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function vk(e,r,t){return r===0?"":Ds(e,r,t)}function _k(e,r,t){var n=t.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function J_(e){var r=e.read_shift(2),t=mf(e);return[r,t]}function xk(e,r,t){e.l+=4,r-=4;var n=e.l+r,i=To(e,r,t),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function gf(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:t}}}function ex(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r},e:{c:i,r:t}}}var yk=ex;function tx(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function wk(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function bk(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function vn(e){e.l+=2,e.l+=e.read_shift(2)}var Ck={0:vn,4:vn,5:vn,6:vn,7:bk,8:vn,9:vn,10:vn,11:vn,12:vn,13:wk,14:vn,15:vn,16:vn,17:vn,18:vn,19:vn,20:vn,21:tx};function Ek(e,r){for(var t=e.l+r,n=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{n[i]=Ck[i](e,t-e.l)}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Ku(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Sk(e,r){return r===0||e.read_shift(2),1200}function Tk(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,i=Ds(e,0,t);return e.read_shift(r+n-e.l),i}function Ik(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function kk(e,r,t){var n="";if(t.biff==4)return n=To(e,0,t),n.length===0&&(n="Sheet1"),{name:n};var i=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}return n=To(e,0,t),n.length===0&&(n="Sheet1"),{pos:i,hs:a,dt:s,name:n}}function Ak(e,r){for(var t=e.l+r,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<t;++s)a.push(uk(e));return a.Count=n,a.Unique=i,a}function Ok(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Fk(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function Dk(e){var r=gk(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Rk(e){return e.read_shift(2),e.read_shift(4)}function Bv(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function Mk(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[r,t],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function Nk(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Pk(){}function Lk(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=To(e,0,t),n}function Bk(e,r,t){var n=Oi(e,r,t);return n.isst=e.read_shift(4),n}function Vk(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,i=Oi(e,r,t),a=pc(e,n-e.l,t);return i.val=a,i}function Uk(e,r,t){var n=e.read_shift(2),i=Ds(e,0,t);return[n,i]}var $k=Ds;function Vv(e,r,t){var n=e.l+r,i=t.biff==8||!t.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:l}}}function Wk(e){var r=e.read_shift(2),t=e.read_shift(2),n=J_(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function Hk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<t;)a.push(J_(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function zk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<t;)a.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function jk(e,r,t,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=W4[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function Gk(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=jk(e,r,n.fStyle,t),n}function Kk(e){var r={};return r.ifnt=e.read_shift(1),e.l++,r.flags=e.read_shift(1),r.numFmtId=r.flags&63,r.flags>>=6,r.fStyle=0,r.data={},r}function qk(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function Xk(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function Qk(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Yk(e,r,t){var n=Oi(e,6,t),i=Q_(e,2);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Zk(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Oi(e,6,t),i=yn(e,8);return n.val=i,n}var Uv=vk;function Jk(e,r,t){var n=e.l+r,i=e.read_shift(2),a=e.read_shift(2);if(t.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=ks(e,a),o=[];n>e.l;)o.push(pc(e));return[a,i,s,o]}function $v(e,r,t){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=xk(e,r-2,t)),a.body=i||e.read_shift(r-2),typeof i=="string"&&(a.Name=i),a}function Wv(e,r,t){var n=e.l+r,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),l=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var c=ks(e,s,t);i&32&&(c=z_[c.charCodeAt(0)]);var u=n-e.l;t&&t.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:kF(e,u,t,o);return{chKey:a,Name:c,itab:l,rgce:f}}function rx(e,r,t){if(t.biff<8||!(t.biff>8)&&r==e[e.l]+(e[e.l+1]==3?1:0)+1)return Hv(e,r,t);for(var n=[],i=e.l+r,a=e.read_shift(t.biff>8?4:2);a--!==0;)n.push(_k(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Hv(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=To(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function eA(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),i=e.read_shift(2),a=ks(e,n,t),s=ks(e,i,t);return[a,s]}function tA(e,r,t){var n=ex(e,6);e.l++;var i=e.read_shift(1);return r-=8,[AF(e,r,t),i,n]}function zv(e,r,t){var n=yk(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,TF(e,r,t,n)]}function rA(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function nA(e,r,t){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=Ds(e,0,t);return[{r:n,c:i},o,s,a]}function iA(e,r,t){if(t&&t.biff<8){var n=e.read_shift(2),i=e.read_shift(2);if(n==65535||n==-1)return;var a=e.read_shift(2),s=e.read_shift(Math.min(a,2048),"cpstr");return[{r:n,c:i},s]}return nA(e,r,t)}function aA(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(gf(e,r));return t}function sA(e,r,t){if(t&&t.biff<8)return lA(e,r,t);var n=tx(e,22),i=Ek(e,r-22,n[1]);return{cmo:n,ft:i}}var oA={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:n}}};function lA(e,r,t){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((oA[n]||Cn)(e,r,t)),{cmo:[i,n,a],ft:s}}function cA(e,r,t){var n=e.l,i="";try{e.l+=4;var a=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=fk(e,6,t);var o=e.read_shift(2);e.read_shift(2),Cr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=ks(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}function uA(e,r){var t=gf(e,8);e.l+=16;var n=mk(e,r-24);return[t,n]}function fA(e,r){e.read_shift(2);var t=gf(e,8),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Fn,""),[t,n]}function hA(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Dv[t]||t,t=e.read_shift(2),r[1]=Dv[t]||t,r}function dA(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Z_(e,8));return t}function pA(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Z_(e,8));return t}function mA(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function nx(e,r,t){if(!t.cellStyles)return Cn(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function gA(e,r){var t={};return r<32||(e.l+=16,t.header=yn(e,8),t.footer=yn(e,8),e.l+=2),t}function vA(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var _A=Oi,xA=X_,yA=pc;function wA(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function bA(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Oi(e,7,t),i=Ds(e,r-7,t);return n.t="str",n.val=i,n}function CA(e,r,t){var n=Oi(e,7,t),i=yn(e,8);return n.t="n",n.val=i,n}function EA(e,r,t){var n=Oi(e,7,t),i=e.read_shift(2);return n.t="n",n.val=i,n}function SA(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function TA(e,r,t){var n=e.l+7,i=Oi(e,6,t);e.l=n;var a=Q_(e,2);return i.val=a,i.t=a===!0||a===!1?"b":"e",i}function IA(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function kA(e,r,t){var n=e.l+r,i=Oi(e,6,t),a=e.read_shift(2),s=ks(e,a,t);return e.l=n,i.t="str",i.val=s,i}function AA(e){var r=e.read_shift(4),t=e.read_shift(1),n=e.read_shift(t,"sbcs");return n.length===0&&(n="Sheet1"),{flags:r,name:n}}var OA=[2,3,48,49,131,139,140,245],jv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Nd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],u=Ha(1);switch(l.type){case"base64":u=Gn(qn(o));break;case"binary":u=Gn(o);break;case"buffer":case"array":u=o;break}zr(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,p=521;f==2&&(v=u.read_shift(2)),u.l+=3,f!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(p=u.read_shift(2));var m=u.read_shift(2),x=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var _=[],w={},D=Math.min(u.length,f==2?521:p-10-(d?264:0)),U=g?32:11;u.l<D&&u[u.l]!=13;)switch(w={},w.name=(typeof _t<"u"?_t.utils.decode(x,u.slice(u.l,u.l+U)):da(u.slice(u.l,u.l+U))).replace(/[\u0000\r\n][\S\s]*$/g,""),u.l+=U,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&_.push(w),f!=2&&(u.l+=g?13:14),w.type){case"B":(!d||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=p-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=p;var F=0,R=0;for(c[0]=[],R=0;R!=_.length;++R)c[0][R]=_[R].name;for(;v-- >0;){if(u[u.l]===42){u.l+=m;continue}for(++u.l,c[++F]=[],R=0,R=0;R!=_.length;++R){var M=u.slice(u.l,u.l+_[R].len);u.l+=_[R].len,zr(M,0);var W=typeof _t<"u"?_t.utils.decode(x,M):da(M);switch(_[R].type){case"C":W.trim().length&&(c[F][R]=W.replace(/([^\s])\s+$/,"$1"));break;case"D":W.length===8?(c[F][R]=new Date(Date.UTC(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8),0,0,0,0)),l&&l.UTC||(c[F][R]=Is(c[F][R]))):c[F][R]=W;break;case"F":c[F][R]=parseFloat(W.trim());break;case"+":case"I":c[F][R]=g?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[F][R]=!0;break;case"N":case"F":c[F][R]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[F][R]="##MEMO##"+(g?parseInt(W.trim(),10):M.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[F][R]=+W||0);break;case"@":c[F][R]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":{var B=M.read_shift(4),V=M.read_shift(4);if(B==0&&V==0)break;c[F][R]=new Date((B-2440588)*864e5+V),l&&l.UTC||(c[F][R]=Is(c[F][R]))}break;case"Y":c[F][R]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[F][R]=-M.read_shift(-8,"f");break;case"B":if(d&&_[R].len==8){c[F][R]=M.read_shift(8,"f");break}case"G":case"P":M.l+=_[R].len;break;case"0":if(_[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[R].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ao(t(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{var c=Ka(n(o,l),l);return c.bookType="dbf",c}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){if(!o["!ref"])throw new Error("Cannot export empty sheet to DBF");var c=l||{},u=xn;if(+c.codepage>=0&&Ii(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Cd(),h=Ad(o,{header:1,raw:!0,cellDates:!0}),d=h[0],g=h.slice(1),v=o["!cols"]||[],p=0,m=0,x=0,_=1;for(p=0;p<d.length;++p){if(((v[p]||{}).DBF||{}).name){d[p]=v[p].DBF.name,++x;continue}if(d[p]!=null){if(++x,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(m=0;m<1024;++m)if(d.indexOf(d[p]+"_"+m)==-1){d[p]+="_"+m;break}}}}var w=Or(o["!ref"]),D=[],U=[],F=[];for(p=0;p<=w.e.c-w.s.c;++p){var R="",M="",W=0,B=[];for(m=0;m<g.length;++m)g[m][p]!=null&&B.push(g[m][p]);if(B.length==0||d[p]==null){D[p]="?";continue}for(m=0;m<B.length;++m){switch(typeof B[m]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=B[m]instanceof Date?"D":"C";break;default:M="C"}W=Math.max(W,(typeof _t<"u"&&typeof B[m]=="string"?_t.utils.encode(So,B[m]):String(B[m])).length),R=R&&R!=M?"C":M}W>250&&(W=250),M=((v[p]||{}).DBF||{}).type,M=="C"&&v[p].DBF.len>W&&(W=v[p].DBF.len),R=="B"&&M=="N"&&(R="N",F[p]=v[p].DBF.dec,W=v[p].DBF.len),U[p]=R=="C"||M=="N"?W:a[R]||0,_+=U[p],D[p]=R}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,g.length),V.write_shift(2,296+32*x),V.write_shift(2,_),p=0;p<4;++p)V.write_shift(4,0);var G=+r[xn]||3;for(V.write_shift(4,0|G<<8),e[G]!=+c.codepage&&(c.codepage&&console.error("DBF Unsupported codepage "+xn+", using 1252"),xn=1252),p=0,m=0;p<d.length;++p)if(d[p]!=null){var pe=f.next(32),ae=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);pe.write_shift(1,ae,"sbcs"),pe.write_shift(1,D[p]=="?"?"C":D[p],"sbcs"),pe.write_shift(4,m),pe.write_shift(1,U[p]||a[D[p]]||0),pe.write_shift(1,F[p]||0),pe.write_shift(1,2),pe.write_shift(4,0),pe.write_shift(1,0),pe.write_shift(4,0),pe.write_shift(4,0),m+=U[p]||a[D[p]]||0}var De=f.next(264);for(De.write_shift(4,13),p=0;p<65;++p)De.write_shift(4,0);for(p=0;p<g.length;++p){var re=f.next(_);for(re.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(D[m]){case"L":re.write_shift(1,g[p][m]==null?63:g[p][m]?84:70);break;case"B":re.write_shift(8,g[p][m]||0,"f");break;case"N":var ge="0";for(typeof g[p][m]=="number"&&(ge=g[p][m].toFixed(F[m]||0)),ge.length>U[m]&&(ge=ge.slice(0,U[m])),x=0;x<U[m]-ge.length;++x)re.write_shift(1,32);re.write_shift(1,ge,"sbcs");break;case"D":g[p][m]?(re.write_shift(4,("0000"+g[p][m].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(g[p][m].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+g[p][m].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Oe=re.l,oe=String(g[p][m]!=null?g[p][m]:"").slice(0,U[m]);for(re.write_shift(1,oe,"cpstr"),Oe+=U[m]-re.l,x=0;x<Oe;++x)re.write_shift(1,32);break}}return xn=u,f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),FA=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+mi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1BN("+mi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(d,g){var v=e[g];return typeof v=="number"?sv(v):v},n=function(d,g,v){var p=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?d:sv(p)};e["|"]=254;var i=function(d){return d.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function a(d,g){switch(g.type){case"base64":return s(qn(d),g);case"binary":return s(d,g);case"buffer":return s(xt&&Buffer.isBuffer(d)?d.toString("binary"):da(d),g);case"array":return s(Ts(d),g)}throw new Error("Unrecognized type "+g.type)}function s(d,g){var v=d.split(/[\n\r]+/),p=-1,m=-1,x=0,_=0,w=[],D=[],U=null,F={},R=[],M=[],W=[],B=0,V,G={Workbook:{WBProps:{},Names:[]}};for(+g.codepage>=0&&Ii(+g.codepage);x!==v.length;++x){B=0;var pe=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),ae=pe.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),De=ae[0],re;if(pe.length>0)switch(De){case"ID":break;case"E":break;case"B":break;case"O":for(_=1;_<ae.length;++_)switch(ae[_].charAt(0)){case"V":{var ge=parseInt(ae[_].slice(1),10);ge>=1&&ge<=4&&(G.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(ae[1].charAt(0)){case"P":D.push(pe.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Oe={Sheet:0};for(_=1;_<ae.length;++_)switch(ae[_].charAt(0)){case"N":Oe.Name=ae[_].slice(1);break;case"E":Oe.Ref=(g&&g.sheet||"Sheet1")+"!"+Cs(ae[_].slice(1));break}G.Workbook.Names.push(Oe)}break;case"C":var oe=!1,We=!1,le=!1,Ie=!1,Ee=-1,lt=-1,Me="",qe="z",O="";for(_=1;_<ae.length;++_)switch(ae[_].charAt(0)){case"A":O=ae[_].slice(1);break;case"X":m=parseInt(ae[_].slice(1),10)-1,We=!0;break;case"Y":for(p=parseInt(ae[_].slice(1),10)-1,We||(m=0),V=w.length;V<=p;++V)w[V]=[];break;case"K":re=ae[_].slice(1),re.charAt(0)==='"'?(re=re.slice(1,re.length-1),qe="s"):re==="TRUE"||re==="FALSE"?(re=re==="TRUE",qe="b"):re.charAt(0)=="#"&&sn[re]!=null?(qe="e",re=sn[re]):isNaN(Kn(re))||(re=Kn(re),qe="n",U!==null&&Ai(U)&&g.cellDates&&(re=Wa(G.Workbook.WBProps.date1904?re+1462:re),qe=typeof re=="number"?"n":"d")),typeof _t<"u"&&typeof re=="string"&&(g||{}).type!="string"&&(g||{}).codepage&&(re=_t.utils.decode(g.codepage,re)),oe=!0;break;case"E":Ie=!0,Me=Cs(ae[_].slice(1),{r:p,c:m});break;case"S":le=!0;break;case"G":break;case"R":Ee=parseInt(ae[_].slice(1),10)-1;break;case"C":lt=parseInt(ae[_].slice(1),10)-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+pe)}if(oe&&(w[p][m]?(w[p][m].t=qe,w[p][m].v=re):w[p][m]={t:qe,v:re},U&&(w[p][m].z=U),g.cellText!==!1&&U&&(w[p][m].w=Xn(w[p][m].z,w[p][m].v,{date1904:G.Workbook.WBProps.date1904})),U=null),le){if(Ie)throw new Error("SYLK shared formula cannot have own formula");var H=Ee>-1&&w[Ee][lt];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");Me=hx(H[1],{r:p-Ee,c:m-lt})}Me&&(w[p][m]?w[p][m].f=Me:w[p][m]={t:"n",f:Me}),O&&(w[p][m]||(w[p][m]={t:"z"}),w[p][m].c=[{a:"SheetJSYLK",t:O}]);break;case"F":var L=0;for(_=1;_<ae.length;++_)switch(ae[_].charAt(0)){case"X":m=parseInt(ae[_].slice(1),10)-1,++L;break;case"Y":for(p=parseInt(ae[_].slice(1),10)-1,V=w.length;V<=p;++V)w[V]=[];break;case"M":B=parseInt(ae[_].slice(1),10)/20;break;case"F":break;case"G":break;case"P":U=D[parseInt(ae[_].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(W=ae[_].slice(1).split(" "),V=parseInt(W[0],10);V<=parseInt(W[1],10);++V)B=parseInt(W[2],10),M[V-1]=B===0?{hidden:!0}:{wch:B};break;case"C":m=parseInt(ae[_].slice(1),10)-1,M[m]||(M[m]={});break;case"R":p=parseInt(ae[_].slice(1),10)-1,R[p]||(R[p]={}),B>0?(R[p].hpt=B,R[p].hpx=uc(B)):B===0&&(R[p].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+pe)}L<1&&(U=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+pe)}}return R.length>0&&(F["!rows"]=R),M.length>0&&(F["!cols"]=M),M.forEach(function(N){Io(N)}),g&&g.sheetRows&&(w=w.slice(0,g.sheetRows)),[w,F,G]}function o(d,g){var v=a(d,g),p=v[0],m=v[1],x=v[2],_=Ur(g);_.date1904=(((x||{}).Workbook||{}).WBProps||{}).date1904;var w=Ao(p,_);mi(m).forEach(function(U){w[U]=m[U]});var D=Ka(w,g);return mi(x).forEach(function(U){D[U]=x[U]}),D.bookType="sylk",D}function l(d,g,v,p,m,x){var _="C;Y"+(v+1)+";X"+(p+1)+";K";switch(d.t){case"n":_+=isFinite(d.v)?d.v||0:Ln[isNaN(d.v)?36:7],d.f&&!d.F&&(_+=";E"+f3(d.f,{r:v,c:p}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||Ln[d.v]||d.v;break;case"d":_+=jr(ln(d.v,x),x);break;case"s":_+='"'+(d.v==null?"":String(d.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,g,v){var p="C;Y"+(g+1)+";X"+(v+1)+";A";return p+=i(d.map(function(m){return m.t}).join("")),p}function u(d,g){g.forEach(function(v,p){var m="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?m+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=of(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=lf(v.wpx)),typeof v.wch=="number"&&(m+=Math.round(v.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function f(d,g){g.forEach(function(v,p){var m="F;";v.hidden?m+="M0;":v.hpt?m+="M"+20*v.hpt+";":v.hpx&&(m+="M"+20*ux(v.hpx)+";"),m.length>2&&d.push(m+"R"+(p+1))})}function h(d,g,v){g||(g={}),g._formats=["General"];var p=["ID;PSheetJS;N;E"],m=[],x=Or(d["!ref"]||"A1"),_,w=d["!data"]!=null,D=`\r
`,U=(((v||{}).Workbook||{}).WBProps||{}).date1904,F="General";p.push("P;PGeneral");var R=x.s.r,M=x.s.c,W=[];if(d["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(w&&!d["!data"][R])){for(W=[],M=x.s.c;M<=x.e.c;++M)_=w?d["!data"][R][M]:d[Dt(M)+Ht(R)],!(!_||!_.c)&&W.push(c(_.c,R,M));W.length&&m.push(W.join(D))}}if(d["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(w&&!d["!data"][R])){for(W=[],M=x.s.c;M<=x.e.c;++M)if(_=w?d["!data"][R][M]:d[Dt(M)+Ht(R)],!(!_||_.v==null&&(!_.f||_.F))){if((_.z||(_.t=="d"?et[14]:"General"))!=F){var B=g._formats.indexOf(_.z);B==-1&&(g._formats.push(_.z),B=g._formats.length-1,p.push("P;P"+_.z.replace(/;/g,";;"))),W.push("F;P"+B+";Y"+(R+1)+";X"+(M+1))}W.push(l(_,d,R,M,g,U))}m.push(W.join(D))}}return p.push("F;P0;DG0G8;M255"),d["!cols"]&&u(p,d["!cols"]),d["!rows"]&&f(p,d["!rows"]),d["!ref"]&&p.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" ")),p.push("O;L;D;B"+(U?";V4":"")+";K47;G100 0.001"),delete g._formats,p.join(D)+D+m.join(D)+D+"E"+D}return{to_workbook:o,from_sheet:h}}(),DA=function(){function e(o,l){switch(l.type){case"base64":return r(qn(o),l);case"binary":return r(o,l);case"buffer":return r(xt&&Buffer.isBuffer(o)?o.toString("binary"):da(o),l);case"array":return r(Ts(o),l)}throw new Error("Unrecognized type "+l.type)}function r(o,l){for(var c=o.split(`
`),u=-1,f=-1,h=0,d=[];h!==c.length;++h){if(c[h].trim()==="BOT"){d[++u]=[],f=0;continue}if(!(u<0)){var g=c[h].trim().split(","),v=g[0],p=g[1];++h;for(var m=c[h]||"";(m.match(/["]/g)||[]).length&1&&h<c.length-1;)m+=`
`+c[++h];switch(m=m.trim(),+v){case-1:if(m==="BOT"){d[++u]=[],f=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[u][f]=!0:m==="FALSE"?d[u][f]=!1:isNaN(Kn(p))?isNaN(oc(p).getDate())?d[u][f]=p:(d[u][f]=ln(p),l&&l.UTC||(d[u][f]=Is(d[u][f]))):d[u][f]=Kn(p),++f;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),ov&&m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[u][f++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(d=d.slice(0,l.sheetRows)),d}function t(o,l){return Ao(e(o,l),l)}function n(o,l){var c=Ka(t(o,l),l);return c.bookType="dif",c}function i(o,l){return"0,"+String(o)+`\r
`+l}function a(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function s(o){var l=ov;if(!o["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var c=Or(o["!ref"]),u=o["!data"]!=null,f=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],h=c.s.r;h<=c.e.r;++h){for(var d=u?o["!data"][h]:[],g=`-1,0\r
BOT\r
`,v=c.s.c;v<=c.e.c;++v){var p=u?d&&d[v]:o[Ft({r:h,c:v})];if(p==null){g+=`1,0\r
""\r
`;continue}switch(p.t){case"n":l?p.w!=null?g+="0,"+p.w+`\r
V`:p.v!=null?g+=i(p.v,"V"):p.f!=null&&!p.F?g+=a("="+p.f):g+=`1,0\r
""`:p.v==null?g+=`1,0\r
""`:g+=i(p.v,"V");break;case"b":g+=p.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":g+=a(!l||isNaN(+p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Xn(p.z||et[14],jr(ln(p.v)))),l?g+=i(p.w,"V"):g+=a(p.w);break;default:g+=`1,0\r
""`}g+=`\r
`}f.push(g)}return f.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:t,from_sheet:s}}(),RA=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var d=f.split(`
`),g=-1,v=-1,p=0,m=[];p!==d.length;++p){var x=d[p].trim().split(":");if(x[0]==="cell"){var _=wn(x[1]);if(m.length<=_.r)for(g=m.length;g<=_.r;++g)m[g]||(m[g]=[]);switch(g=_.r,v=_.c,x[2]){case"t":m[g][v]=e(x[3]);break;case"v":m[g][v]=+x[3];break;case"vtf":var w=x[x.length-1];case"vtc":switch(x[3]){case"nl":m[g][v]=!!+x[4];break;default:m[g][v]=x[x.length-1].charAt(0)=="#"?{t:"e",v:sn[x[x.length-1]]}:+x[4];break}x[2]=="vtf"&&(m[g][v]=[m[g][v],w])}}}return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}function n(f,h){return Ao(t(f,h),h)}function i(f,h){return Ka(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],g,v="",p=As(f["!ref"]),m=f["!data"]!=null,x=p.s.r;x<=p.e.r;++x)for(var _=p.s.c;_<=p.e.c;++_)if(v=Ft({r:x,c:_}),g=m?(f["!data"][x]||[])[_]:f[v],!(!g||g.v==null||g.t==="z")){switch(d=["cell",v,"t"],g.t){case"s":d.push(r(g.v));break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=r(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=jr(ln(g.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=g.w||Xn(g.z||et[14],w);break;case"n":isFinite(g.v)?g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=r(g.f)):(d[2]="v",d[3]=g.v):(d[2]="vt"+(g.f?"f":"c"),d[3]="e"+Ln[isNaN(g.v)?36:7],d[4]="0",d[5]=g.f||d[3].slice(1),d[6]="e",d[7]=d[3].slice(1));break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[a,s,o,s,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),lc=function(){function e(u,f,h,d,g){g.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(Kn(u))?isNaN(oc(u).getDate())?u.charCodeAt(0)==35&&sn[u]!=null?f[h][d]={t:"e",v:sn[u],w:u}:f[h][d]=u:f[h][d]=ln(u):f[h][d]=Kn(u))}function r(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var p=10,m=0,x=0;x<=v;++x)m=g[x].indexOf(" "),m==-1?m=g[x].length:m++,p=Math.max(p,m);for(x=0;x<=v;++x){d[x]=[];var _=0;for(e(g[x].slice(0,p).trim(),d,x,_,h),_=1;_<=(g[x].length-p)/10+1;++_)e(g[x].slice(p+(_-1)*10,p+_*10).trim(),d,x,_,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?h=!h:!h&&g in t&&(f[g]=(f[g]||0)+1);g=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d]);if(!g.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d])}return g.sort(function(v,p){return v[0]-p[0]||n[v[1]]-n[p[1]]}),t[g.pop()[1]]||44}function a(u,f){var h=f||{},d="";Ar!=null&&h.dense==null&&(h.dense=Ar);var g={};h.dense&&(g["!data"]=[]);var v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var p=0,m=0,x=0,_=0,w=0,D=d.charCodeAt(0),U=!1,F=0,R=u.charCodeAt(0),M=h.dateNF!=null?kI(h.dateNF):null;function W(){var B=u.slice(_,w);B.slice(-1)=="\r"&&(B=B.slice(0,-1));var V={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(V.w=B),B.length===0)V.t="z";else if(h.raw)V.t="s",V.v=B;else if(B.trim().length===0)V.t="s",V.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(V.t="s",V.v=B.slice(2,-1).replace(/""/g,'"')):h3(B)?(V.t="s",V.f=B.slice(1),V.v=B):(V.t="s",V.v=B);else if(B=="TRUE")V.t="b",V.v=!0;else if(B=="FALSE")V.t="b",V.v=!1;else if(!isNaN(x=Kn(B)))V.t="n",V.v=x;else if(!isNaN((x=oc(B)).getDate())||M&&B.match(M)){if(V.z=h.dateNF||et[14],M&&B.match(M)){var G=AI(B,h.dateNF,B.match(M)||[]);x=ln(G),h&&h.UTC===!1&&(x=Is(x))}else h&&h.UTC===!1?x=Is(x):h.cellText!==!1&&h.dateNF&&(V.w=Xn(V.z,x));h.cellDates?(V.t="d",V.v=x):(V.t="n",V.v=jr(x)),h.cellNF||delete V.z}else B.charCodeAt(0)==35&&sn[B]!=null?(V.t="e",V.w=B,V.v=sn[B]):(V.t="s",V.v=B);if(V.t=="z"||(h.dense?(g["!data"][p]||(g["!data"][p]=[]),g["!data"][p][m]=V):g[Ft({c:m,r:p})]=V),_=w+1,R=u.charCodeAt(_),v.e.c<m&&(v.e.c=m),v.e.r<p&&(v.e.r=p),F==D)++m;else if(m=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;w<u.length;++w)switch(F=u.charCodeAt(w)){case 34:R===34&&(U=!U);break;case 13:if(U)break;u.charCodeAt(w+1)==10&&++w;case D:case 10:if(!U&&W())break e;break;default:break}return w-_>0&&W(),g["!ref"]=wt(v),g}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,f):Ao(r(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:tp(u,f);switch(f.type){case"base64":h=qn(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof _t<"u"?h=_t.utils.decode(f.codepage,u):h=xt&&Buffer.isBuffer(u)?u.toString("binary"):da(u);break;case"array":h=Ts(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Xt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Xt(h):f.type=="binary"&&typeof _t<"u"&&f.codepage&&(h=_t.utils.decode(f.codepage,_t.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?RA.to_sheet(f.type=="string"?h:Xt(h),f):s(h,f)}function l(u,f){return Ka(o(u,f),f)}function c(u){var f=[];if(!u["!ref"])return"";for(var h=Or(u["!ref"]),d,g=u["!data"]!=null,v=h.s.r;v<=h.e.r;++v){for(var p=[],m=h.s.c;m<=h.e.c;++m){var x=Ft({r:v,c:m});if(d=g?(u["!data"][v]||[])[m]:u[x],!d||d.v==null){p.push("          ");continue}for(var _=(d.w||(za(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";p.push(_+(m===0?" ":""))}f.push(p.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function MA(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var i=FA.to_workbook(e,t);return t.WTF=n,i}catch(a){if(t.WTF=n,a.message.indexOf("SYLK bad record ID")==-1&&n)throw a;return lc.to_workbook(e,r)}}var ec=function(){function e(O,H,L){if(O){zr(O,O.l||0);for(var N=L.Enum||Ie;O.l<O.length;){var se=O.read_shift(2),k=N[se]||N[65535],Le=O.read_shift(2),be=O.l+Le,fe=k.f&&k.f(O,Le,L);if(O.l=be,H(fe,k,se))return}}}function r(O,H){switch(H.type){case"base64":return n(Gn(qn(O)),H);case"binary":return n(Gn(O),H);case"buffer":case"array":return n(O,H)}throw"Unsupported type "+H.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(O,H){if(!O)return O;var L=H||{};Ar!=null&&L.dense==null&&(L.dense=Ar);var N={},se="Sheet1",k="",Le=0,be={},fe=[],Ke=[],ht=[];L.dense&&(ht=N["!data"]=[]);var Ae={s:{r:0,c:0},e:{r:0,c:0}},Vt=L.sheetRows||0,jt={};if(O[4]==81&&O[5]==80&&O[6]==87)return qe(O,H);if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)L.Enum=Ie,e(O,function(we,ii,pn){switch(pn){case 0:L.vers=we,we>=4096&&(L.qpro=!0);break;case 255:L.vers=we,L.works=!0;break;case 6:Ae=we;break;case 204:we&&(k=we);break;case 222:k=we;break;case 15:case 51:(!L.qpro&&!L.works||pn==51)&&we[1].v.charCodeAt(0)<48&&(we[1].v=we[1].v.slice(1)),(L.works||L.works2)&&(we[1].v=we[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=L.dateNF||t[(we[2]&15)-1]||et[14],L.cellDates&&(we[1].v=Wa(we[1].v),we[1].t=typeof we[1].v=="number"?"n":"d")),L.qpro&&we[3]>Le&&(N["!ref"]=wt(Ae),be[se]=N,fe.push(se),N={},L.dense&&(ht=N["!data"]=[]),Ae={s:{r:0,c:0},e:{r:0,c:0}},Le=we[3],se=k||"Sheet"+(Le+1),k="");var Dr=L.dense?(ht[we[0].r]||[])[we[0].c]:N[Ft(we[0])];if(Dr){Dr.t=we[1].t,Dr.v=we[1].v,we[1].z!=null&&(Dr.z=we[1].z),we[1].f!=null&&(Dr.f=we[1].f),jt=Dr;break}L.dense?(ht[we[0].r]||(ht[we[0].r]=[]),ht[we[0].r][we[0].c]=we[1]):N[Ft(we[0])]=we[1],jt=we[1];break;case 21509:L.works2=!0;break;case 21506:we==5281&&(jt.z="hh:mm:ss",L.cellDates&&jt.t=="n"&&(jt.v=Wa(jt.v),jt.t=typeof jt.v=="number"?"n":"d"));break}},L);else if(O[2]==26||O[2]==14)L.Enum=Ee,O[2]==14&&(L.qpro=!0,O.l=0),e(O,function(we,ii,pn){switch(pn){case 204:se=we;break;case 22:we[1].v.charCodeAt(0)<48&&(we[1].v=we[1].v.slice(1)),we[1].v=we[1].v.replace(/\x0F./g,function(Dr){return String.fromCharCode(Dr.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>Le&&(N["!ref"]=wt(Ae),be[se]=N,fe.push(se),N={},L.dense&&(ht=N["!data"]=[]),Ae={s:{r:0,c:0},e:{r:0,c:0}},Le=we[3],se="Sheet"+(Le+1)),Vt>0&&we[0].r>=Vt)break;L.dense?(ht[we[0].r]||(ht[we[0].r]=[]),ht[we[0].r][we[0].c]=we[1]):N[Ft(we[0])]=we[1],Ae.e.c<we[0].c&&(Ae.e.c=we[0].c),Ae.e.r<we[0].r&&(Ae.e.r=we[0].r);break;case 27:we[14e3]&&(Ke[we[14e3][0]]=we[14e3][1]);break;case 1537:Ke[we[0]]=we[1],we[0]==Le&&(se=we[1]);break;default:break}},L);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(N["!ref"]=wt(Ae),be[k||se]=N,fe.push(k||se),!Ke.length)return{SheetNames:fe,Sheets:be};for(var pr={},dn=[],ve=0;ve<Ke.length;++ve)be[fe[ve]]?(dn.push(Ke[ve]||fe[ve]),pr[Ke[ve]]=be[Ke[ve]]||be[fe[ve]]):(dn.push(Ke[ve]),pr[Ke[ve]]={"!ref":"A1"});return{SheetNames:dn,Sheets:pr}}function i(O,H){var L=H||{};if(+L.codepage>=0&&Ii(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var N=Cd();if(!O["!ref"])throw new Error("Cannot export empty sheet to WK1");var se=Or(O["!ref"]),k=O["!data"]!=null,Le=[];jn(N,0,s(1030)),jn(N,6,c(se));for(var be=Math.min(se.e.r,8191),fe=se.s.c;fe<=se.e.c;++fe)Le[fe]=Dt(fe);for(var Ke=se.s.r;Ke<=be;++Ke){var ht=Ht(Ke);for(fe=se.s.c;fe<=se.e.c;++fe){var Ae=k?(O["!data"][Ke]||[])[fe]:O[Le[fe]+ht];if(!(!Ae||Ae.t=="z"))switch(Ae.t){case"n":(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?jn(N,13,p(Ke,fe,Ae)):jn(N,14,x(Ke,fe,Ae));break;case"d":var Vt=jr(Ae.v);(Vt|0)==Vt&&Vt>=-32768&&Vt<=32767?jn(N,13,p(Ke,fe,{t:"n",v:Vt,z:Ae.z||et[14]})):jn(N,14,x(Ke,fe,{t:"n",v:Vt,z:Ae.z||et[14]}));break;default:var jt=za(Ae);jn(N,15,d(Ke,fe,jt.slice(0,239)))}}}return jn(N,1),N.end()}function a(O,H){var L=H||{};if(+L.codepage>=0&&Ii(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var N=Cd();jn(N,0,o(O));for(var se=0,k=0;se<O.SheetNames.length;++se)(O.Sheets[O.SheetNames[se]]||{})["!ref"]&&jn(N,27,le(O.SheetNames[se],k++));var Le=0;for(se=0;se<O.SheetNames.length;++se){var be=O.Sheets[O.SheetNames[se]];if(!(!be||!be["!ref"])){for(var fe=Or(be["!ref"]),Ke=be["!data"]!=null,ht=[],Ae=Math.min(fe.e.r,8191),Vt=fe.s.r;Vt<=Ae;++Vt)for(var jt=Ht(Vt),pr=fe.s.c;pr<=fe.e.c;++pr){Vt===fe.s.r&&(ht[pr]=Dt(pr));var dn=ht[pr]+jt,ve=Ke?(be["!data"][Vt]||[])[pr]:be[dn];if(!(!ve||ve.t=="z"))if(ve.t=="n")jn(N,23,G(Vt,pr,Le,ve.v));else{var we=za(ve);jn(N,22,W(Vt,pr,Le,we.slice(0,239)))}}++Le}}return jn(N,1),N.end()}function s(O){var H=kr(2);return H.write_shift(2,O),H}function o(O){var H=kr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var L=0,N=0,se=0,k=0;k<O.SheetNames.length;++k){var Le=O.SheetNames[k],be=O.Sheets[Le];if(!(!be||!be["!ref"])){++se;var fe=As(be["!ref"]);L<fe.e.r&&(L=fe.e.r),N<fe.e.c&&(N=fe.e.c)}}return L>8191&&(L=8191),H.write_shift(2,L),H.write_shift(1,se),H.write_shift(1,N),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(O,H,L){var N={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&L.qpro?(N.s.c=O.read_shift(1),O.l++,N.s.r=O.read_shift(2),N.e.c=O.read_shift(1),O.l++,N.e.r=O.read_shift(2),N):(N.s.c=O.read_shift(2),N.s.r=O.read_shift(2),H==12&&L.qpro&&(O.l+=2),N.e.c=O.read_shift(2),N.e.r=O.read_shift(2),H==12&&L.qpro&&(O.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function c(O){var H=kr(8);return H.write_shift(2,O.s.c),H.write_shift(2,O.s.r),H.write_shift(2,O.e.c),H.write_shift(2,O.e.r),H}function u(O,H,L){var N=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(N[0].c=O.read_shift(1),N[3]=O.read_shift(1),N[0].r=O.read_shift(2),O.l+=2):L.works?(N[0].c=O.read_shift(2),N[0].r=O.read_shift(2),N[2]=O.read_shift(2)):(N[2]=O.read_shift(1),N[0].c=O.read_shift(2),N[0].r=O.read_shift(2)),N}function f(O){return O.z&&Ai(O.z)?240|(t.indexOf(O.z)+1||2):255}function h(O,H,L){var N=O.l+H,se=u(O,H,L);if(se[1].t="s",(L.vers&65534)==20768){O.l++;var k=O.read_shift(1);return se[1].v=O.read_shift(k,"utf8"),se}return L.qpro&&O.l++,se[1].v=O.read_shift(N-O.l,"cstr"),se}function d(O,H,L){var N=kr(7+L.length);N.write_shift(1,255),N.write_shift(2,H),N.write_shift(2,O),N.write_shift(1,39);for(var se=0;se<N.length;++se){var k=L.charCodeAt(se);N.write_shift(1,k>=128?95:k)}return N.write_shift(1,0),N}function g(O,H,L){var N=O.l+H,se=u(O,H,L);if(se[1].t="s",L.vers==20768){var k=O.read_shift(1);return se[1].v=O.read_shift(k,"utf8"),se}return se[1].v=O.read_shift(N-O.l,"cstr"),se}function v(O,H,L){var N=u(O,H,L);return N[1].v=O.read_shift(2,"i"),N}function p(O,H,L){var N=kr(7);return N.write_shift(1,f(L)),N.write_shift(2,H),N.write_shift(2,O),N.write_shift(2,L.v,"i"),N}function m(O,H,L){var N=u(O,H,L);return N[1].v=O.read_shift(8,"f"),N}function x(O,H,L){var N=kr(13);return N.write_shift(1,f(L)),N.write_shift(2,H),N.write_shift(2,O),N.write_shift(8,L.v,"f"),N}function _(O,H,L){var N=O.l+H,se=u(O,H,L);if(se[1].v=O.read_shift(8,"f"),L.qpro)O.l=N;else{var k=O.read_shift(2);F(O.slice(O.l,O.l+k),se),O.l+=k}return se}function w(O,H,L){var N=H&32768;return H&=-32769,H=(N?O:0)+(H>=8192?H-16384:H),(N?"":"$")+(L?Dt(H):Ht(H))}var D={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},U=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(O,H){zr(O,0);for(var L=[],N=0,se="",k="",Le="",be="";O.l<O.length;){var fe=O[O.l++];switch(fe){case 0:L.push(O.read_shift(8,"f"));break;case 1:k=w(H[0].c,O.read_shift(2),!0),se=w(H[0].r,O.read_shift(2),!1),L.push(k+se);break;case 2:{var Ke=w(H[0].c,O.read_shift(2),!0),ht=w(H[0].r,O.read_shift(2),!1);k=w(H[0].c,O.read_shift(2),!0),se=w(H[0].r,O.read_shift(2),!1),L.push(Ke+ht+":"+k+se)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(O.read_shift(2));break;case 6:{for(var Ae="";fe=O[O.l++];)Ae+=String.fromCharCode(fe);L.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:be=L.pop(),Le=L.pop(),L.push(["AND","OR"][fe-20]+"("+Le+","+be+")");break;default:if(fe<32&&U[fe])be=L.pop(),Le=L.pop(),L.push(Le+U[fe]+be);else if(D[fe]){if(N=D[fe][1],N==69&&(N=O[O.l++]),N>L.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+L.join("|")+"|");return}var Vt=L.slice(-N);L.length-=N,L.push(D[fe][0]+"("+Vt.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}L.length==1?H[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function R(O){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=O.read_shift(2),H[3]=O[O.l++],H[0].c=O[O.l++],H}function M(O,H){var L=R(O,H);return L[1].t="s",L[1].v=O.read_shift(H-4,"cstr"),L}function W(O,H,L,N){var se=kr(6+N.length);se.write_shift(2,O),se.write_shift(1,L),se.write_shift(1,H),se.write_shift(1,39);for(var k=0;k<N.length;++k){var Le=N.charCodeAt(k);se.write_shift(1,Le>=128?95:Le)}return se.write_shift(1,0),se}function B(O,H){var L=R(O,H);L[1].v=O.read_shift(2);var N=L[1].v>>1;if(L[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return L[1].v=N,L}function V(O,H){var L=R(O,H),N=O.read_shift(4),se=O.read_shift(4),k=O.read_shift(2);if(k==65535)return N===0&&se===3221225472?(L[1].t="e",L[1].v=15):N===0&&se===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var Le=k&32768;return k=(k&32767)-16446,L[1].v=(1-Le*2)*(se*Math.pow(2,k+32)+N*Math.pow(2,k)),L}function G(O,H,L,N){var se=kr(14);if(se.write_shift(2,O),se.write_shift(1,L),se.write_shift(1,H),N==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var k=0,Le=0,be=0,fe=0;return N<0&&(k=1,N=-N),Le=Math.log2(N)|0,N/=Math.pow(2,Le-31),fe=N>>>0,fe&2147483648||(N/=2,++Le,fe=N>>>0),N-=fe,fe|=2147483648,fe>>>=0,N*=Math.pow(2,32),be=N>>>0,se.write_shift(4,be),se.write_shift(4,fe),Le+=16383+(k?32768:0),se.write_shift(2,Le),se}function pe(O,H){var L=V(O,14);return O.l+=H-14,L}function ae(O,H){var L=R(O,H),N=O.read_shift(4);return L[1].v=N>>6,L}function De(O,H){var L=R(O,H),N=O.read_shift(8,"f");return L[1].v=N,L}function re(O,H){var L=De(O,12);return O.l+=H-12,L}function ge(O,H){return O[O.l+H-1]==0?O.read_shift(H,"cstr"):""}function Oe(O,H){var L=O[O.l++];L>H-1&&(L=H-1);for(var N="";N.length<L;)N+=String.fromCharCode(O[O.l++]);return N}function oe(O,H,L){if(!(!L.qpro||H<21)){var N=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var se=O.read_shift(H-21,"cstr");return[N,se]}}function We(O,H){for(var L={},N=O.l+H;O.l<N;){var se=O.read_shift(2);if(se==14e3){for(L[se]=[0,""],L[se][0]=O.read_shift(2);O[O.l];)L[se][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return L}function le(O,H){var L=kr(5+O.length);L.write_shift(2,14e3),L.write_shift(2,H);for(var N=0;N<O.length;++N){var se=O.charCodeAt(N);L[L.l++]=se>127?95:se}return L[L.l++]=0,L}var Ie={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:Oe},255:{n:"BOF",f:Cr},21506:{n:"WKSNF",f:Cr},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:pe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:We},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ae},38:{n:"??"},39:{n:"NUMBER27",f:De},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},lt={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Me(O){var H=O.read_shift(2),L=O.read_shift(1);if(L!=0)throw"unsupported QPW string type "+L.toString(16);return O.read_shift(H,"sbcs-cont")}function qe(O,H){zr(O,0);var L=H||{};Ar!=null&&L.dense==null&&(L.dense=Ar);var N={};L.dense&&(N["!data"]=[]);var se=[],k="",Le=[],be={s:{r:-1,c:-1},e:{r:-1,c:-1}},fe=0,Ke=0,ht=0,Ae=0,Vt={SheetNames:[],Sheets:{}},jt=[];e:for(;O.l<O.length;){var pr=O.read_shift(2),dn=O.read_shift(2),ve=O.slice(O.l,O.l+dn);switch(zr(ve,0),pr){case 1:if(ve.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var we=ve.read_shift(4),ii=(ve.length-ve.l)/we|0,pn=0;pn<we;++pn){var Dr=ve.l+ii,Sn={};ve.l+=2,Sn.numFmtId=ve.read_shift(2),lt[Sn.numFmtId]&&(Sn.z=lt[Sn.numFmtId]),ve.l=Dr,jt.push(Sn)}break;case 1025:break;case 1026:break;case 1031:for(ve.l+=12;ve.l<ve.length;)fe=ve.read_shift(2),Ke=ve.read_shift(1),se.push(ve.read_shift(fe,"cstr"));break;case 1032:break;case 1537:{var $n=ve.read_shift(2);N={},L.dense&&(N["!data"]=[]),be.s.c=ve.read_shift(2),be.e.c=ve.read_shift(2),be.s.r=ve.read_shift(4),be.e.r=ve.read_shift(4),ve.l+=4,ve.l+2<ve.length&&(fe=ve.read_shift(2),Ke=ve.read_shift(1),k=fe==0?"":ve.read_shift(fe,"cstr")),k||(k=Dt($n))}break;case 1538:{if(be.s.c>255||be.s.r>999999)break;be.e.c<be.s.c&&(be.e.c=be.s.c),be.e.r<be.s.r&&(be.e.r=be.s.r),N["!ref"]=wt(be),_c(Vt,N,k)}break;case 2561:ht=ve.read_shift(2),be.e.c<ht&&(be.e.c=ht),be.s.c>ht&&(be.s.c=ht),Ae=ve.read_shift(4),be.s.r>Ae&&(be.s.r=Ae),Ae=ve.read_shift(4),be.e.r<Ae&&(be.e.r=Ae);break;case 3073:{Ae=ve.read_shift(4),fe=ve.read_shift(4),be.s.r>Ae&&(be.s.r=Ae),be.e.r<Ae+fe-1&&(be.e.r=Ae+fe-1);for(var rt=Dt(ht);ve.l<ve.length;){var Xe={t:"z"},Gt=ve.read_shift(1),ur=-1;Gt&128&&(ur=ve.read_shift(2));var eu=Gt&64?ve.read_shift(2)-1:0;switch(Gt&31){case 0:break;case 1:break;case 2:Xe={t:"n",v:ve.read_shift(2)};break;case 3:Xe={t:"n",v:ve.read_shift(2,"i")};break;case 4:Xe={t:"n",v:mf(ve)};break;case 5:Xe={t:"n",v:ve.read_shift(8,"f")};break;case 7:Xe={t:"s",v:se[Ke=ve.read_shift(4)-1]};break;case 8:Xe={t:"n",v:ve.read_shift(8,"f")},ve.l+=2,ve.l+=4,isNaN(Xe.v)&&(Xe={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Gt&31)}ur!=-1&&(jt[ur-1]||{}).z&&(Xe.z=jt[ur-1].z);var ka=0;if(Gt&32)switch(Gt&31){case 2:ka=ve.read_shift(2);break;case 3:ka=ve.read_shift(2,"i");break;case 7:ka=ve.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Gt&31)}if(!(!L.sheetStubs&&Xe.t=="z")){var as=Ur(Xe);Xe.t=="n"&&Xe.z&&Ai(Xe.z)&&L.cellDates&&(as.v=Wa(Xe.v),as.t=typeof as.v=="number"?"n":"d"),N["!data"]!=null?(N["!data"][Ae]||(N["!data"][Ae]=[]),N["!data"][Ae][ht]=as):N[rt+Ht(Ae)]=as}for(++Ae,--fe;eu-- >0&&fe>=0;){if(Gt&32)switch(Gt&31){case 2:Xe={t:"n",v:Xe.v+ka&65535};break;case 3:Xe={t:"n",v:Xe.v+ka&65535},Xe.v>32767&&(Xe.v-=65536);break;case 7:Xe={t:"s",v:se[Ke=Ke+ka>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Gt&31)}else switch(Gt&31){case 1:Xe={t:"z"};break;case 2:Xe={t:"n",v:ve.read_shift(2)};break;case 7:Xe={t:"s",v:se[Ke=ve.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Gt&31)}ur!=-1,!L.sheetStubs&&Xe.t=="z"||(N["!data"]!=null?(N["!data"][Ae]||(N["!data"][Ae]=[]),N["!data"][Ae][ht]=Xe):N[rt+Ht(Ae)]=Xe),++Ae,--fe}}}break;case 3074:{ht=ve.read_shift(2),Ae=ve.read_shift(4);var al=Me(ve);N["!data"]!=null?(N["!data"][Ae]||(N["!data"][Ae]=[]),N["!data"][Ae][ht]={t:"s",v:al}):N[Dt(ht)+Ht(Ae)]={t:"s",v:al}}break;default:break}O.l+=dn}return Vt}return{sheet_to_wk1:i,book_to_wk3:a,to_workbook:r}}();function NA(e){var r={},t=e.match(cn),n=0,i=!1;if(t)for(;n!=t.length;++n){var a=Re(t[n]);switch(a[0].replace(/<\w*:/g,"<")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;r.cp=Od[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=a.val;break;case"<sz":r.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":a.rgb&&(r.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return r}var PA=function(){function e(n){var i=Zr(n,"t");if(!i)return{t:"s",v:""};var a={t:"s",v:yt(i[1])},s=Zr(n,"rPr");return s&&(a.s=NA(s[1])),a}var r=/<(?:\w+:)?r>/g,t=/<\/(?:\w+:)?r>/;return function(i){return i.replace(r,"").split(t).map(e).filter(function(a){return a.v})}}(),LA=function(){var r=/(\r\n|\n)/g;function t(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&t(i.s,a[0],a[2]),a[0].join("")+a[1].replace(r,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),BA=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,VA=/<(?:\w+:)?r\b[^<>]*>/;function Xd(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=yt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=Xt(e),t&&(n.h=ql(n.t))):e.match(VA)&&(n.r=Xt(e),n.t=yt(Xt((GI(e,"rPh").match(BA)||[]).join("").replace(cn,"")),!0),t&&(n.h=LA(PA(n.r)))),n):{t:""}}var UA=/<(?:\w+:)?(?:si|sstItem)>/g,$A=/<\/(?:\w+:)?(?:si|sstItem)>/;function WA(e,r){var t=[],n="";if(!e)return t;var i=Zr(e,"sst");if(i){n=i[1].replace(UA,"").split($A);for(var a=0;a!=n.length;++a){var s=Xd(n[a].trim(),r);s!=null&&(t[t.length]=s)}i=Re(i[0].slice(0,i[0].indexOf(">"))),t.Count=i.count,t.Unique=i.uniqueCount}return t}function HA(e){return[e.read_shift(4),e.read_shift(4)]}function zA(e,r){var t=[],n=!1;return pa(e,function(a,s,o){switch(o){case 159:t.Count=a[0],t.Unique=a[1];break;case 19:t.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function ix(e){if(typeof _t<"u")return _t.utils.encode(So,e);for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function ha(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function jA(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=ha(e,4),r.U=ha(e,4),r.W=ha(e,4),r}function GA(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function KA(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(GA(e));return r}function qA(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function XA(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=ha(e,4),r.U=ha(e,4),r.W=ha(e,4),r}function QA(e){var r=XA(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function ax(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function sx(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function YA(e){var r=ha(e);switch(r.Minor){case 2:return[r.Minor,ZA(e,r)];case 3:return[r.Minor,JA(e,r)];case 4:return[r.Minor,eO(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function ZA(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=ax(e,t),i=sx(e,e.length-e.l);return{t:"Std",h:n,v:i}}function JA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function eO(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(cn,function(a){var s=Re(a);switch(gi(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function tO(e,r){var t={},n=t.EncryptionVersionInfo=ha(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=ax(e,i),r-=i,t.EncryptionVerifier=sx(e,r),t}function rO(e){var r={},t=r.EncryptionVersionInfo=ha(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function nO(e){var r=0,t,n=ix(e),i=n.length+1,a,s,o,l,c;for(t=Ha(i),t[0]=n.length,a=1;a!=i;++a)t[a]=n[a-1];for(a=i-1;a>=0;--a)s=t[a],o=r&16384?1:0,l=r<<1&32767,c=o|l,r=c^s;return r^52811}var ox=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=r[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=t[l]),u*=2,--l;return o};return function(s){for(var o=ix(s),l=a(o),c=o.length,u=Ha(16),f=0;f!=16;++f)u[f]=0;var h,d,g;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,d=o[o.length-1],u[c]=i(d,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,u[c]=i(e[g],h),--c,--g,h=l&255,u[c]=i(o[c],h),--c,--g;return u}}(),iO=function(e,r,t,n,i){i||(i=r),n||(n=ox(e));var a,s;for(a=0;a!=r.length;++a)s=r[a],s^=n[t],s=(s>>5|s<<3)&255,i[a]=s,++t;return[i,t,n]},aO=function(e){var r=0,t=ox(e);return function(n){var i=iO("",n,r,t);return r=i[1],i[0]}};function sO(e,r,t,n){var i={key:Cr(e),verificationBytes:Cr(e)};return t.password&&(i.verifier=nO(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=aO(t.password)),i}function oO(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=rO(e,r):n.Data=tO(e,r),n}function lO(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?oO(e,r-2,n):sO(e,t.biff>=8?r:r-2,t,n),n}function cO(e,r){switch(r.type){case"base64":return qu(qn(e),r);case"binary":return qu(e,r);case"buffer":return qu(xt&&Buffer.isBuffer(e)?e.toString("binary"):da(e),r);case"array":return qu(Ts(e),r)}throw new Error("Unrecognized type "+r.type)}function qu(e,r){var t=r||{},n={},i=t.dense;i&&(n["!data"]=[]);var a=Ld(e,"\\trowd","\\row");if(!a)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:a.length-1}},o=[];return a.forEach(function(l,c){i&&(o=n["!data"][c]=[]);for(var u=/\\[\w\-]+\b/g,f=0,h,d=-1,g=[];(h=u.exec(l))!=null;){var v=l.slice(f,u.lastIndex-h[0].length);switch(v.charCodeAt(0)==32&&(v=v.slice(1)),v.length&&g.push(v),h[0]){case"\\cell":if(++d,g.length){var p={v:g.join(""),t:"s"};p.v=="TRUE"||p.v=="FALSE"?(p.v=p.v=="TRUE",p.t="b"):isNaN(Kn(p.v))?sn[p.v]!=null&&(p.t="e",p.w=p.v,p.v=sn[p.v]):(p.t="n",t.cellText!==!1&&(p.w=p.v),p.v=Kn(p.v)),i?o[d]=p:n[Ft({r:c,c:d})]=p}g=[];break;case"\\par":g.push(`
`);break}f=u.lastIndex}d>s.e.c&&(s.e.c=d)}),n["!ref"]=wt(s),n}function uO(e,r){var t=Ka(cO(e,r),r);return t.bookType="rtf",t}function fO(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function cc(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function hO(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,i=Math.max(r,t,n),a=Math.min(r,t,n),s=i-a;if(s===0)return[0,0,r];var o=0,l=0,c=i+a;switch(l=s/(c>1?2-c:c),i){case r:o=((t-n)/s+6)%6;break;case t:o=(n-r)/s+2;break;case n:o=(r-t)/s+4;break}return[o/6,l,c/2]}function dO(e){var r=e[0],t=e[1],n=e[2],i=t*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*r,l;if(t!==0)switch(o|0){case 0:case 6:l=i*o,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-o),s[0]+=l,s[1]+=i;break;case 2:l=i*(o-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-o),s[1]+=l,s[2]+=i;break;case 4:l=i*(o-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-o),s[2]+=l,s[0]+=i;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function sf(e,r){if(r===0)return e;var t=hO(fO(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),cc(dO(t))}var lx=6,pO=15,mO=1,An=lx;function of(e){return Math.floor((e+Math.round(128/An)/256)*An)}function lf(e){return Math.floor((e-5)/An*100+.5)/100}function Td(e){return Math.round((e*An+5)/An*256)/256}function md(e){return Td(lf(of(e)))}function Qd(e){var r=Math.abs(e-md(e)),t=An;if(r>.005)for(An=mO;An<pO;++An)Math.abs(e-md(e))<=r&&(r=Math.abs(e-md(e)),t=An);An=t}function Io(e){e.width?(e.wpx=of(e.width),e.wch=lf(e.wpx),e.MDW=An):e.wpx?(e.wch=lf(e.wpx),e.width=Td(e.wch),e.MDW=An):typeof e.wch=="number"&&(e.width=Td(e.wch),e.wpx=of(e.width),e.MDW=An),e.customWidth&&delete e.customWidth}var gO=96,cx=gO;function ux(e){return e*96/cx}function uc(e){return e*cx/96}var vO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _O(e,r,t,n){r.Borders=[];var i={},a=!1;(e.match(cn)||[]).forEach(function(s){var o=Re(s);switch(gi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Wt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Wt(o.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function xO(e,r,t,n){r.Fills=[];var i={},a=!1;(e.match(cn)||[]).forEach(function(s){var o=Re(s);switch(gi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function yO(e,r,t,n){r.Fonts=[];var i={},a=!1;(e.match(cn)||[]).forEach(function(s){var o=Re(s);switch(gi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Xt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Wt(o.val):1;break;case"<b/>":i.bold=1;break;case"</b>":case"</b":break;case"<i":i.italic=o.val?Wt(o.val):1;break;case"<i/>":i.italic=1;break;case"</i>":case"</i":break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"</u>":case"</u":break;case"<strike":i.strike=o.val?Wt(o.val):1;break;case"<strike/>":i.strike=1;break;case"</strike>":case"</strike":break;case"<outline":i.outline=o.val?Wt(o.val):1;break;case"<outline/>":i.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":i.shadow=o.val?Wt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":i.condense=o.val?Wt(o.val):1;break;case"<condense/>":i.condense=1;break;case"</condense>":case"</condense":break;case"<extend":i.extend=o.val?Wt(o.val):1;break;case"<extend/>":i.extend=1;break;case"</extend>":case"</extend":break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":if(o.val=="1")break;o.codepage=Od[parseInt(o.val,10)];break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Wt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=bs[i.color.index];i.color.index==81&&(l=bs[1]),l||(l=bs[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=sf(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":case"</AlternateContent":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function wO(e,r,t){r.NumberFmt=[];for(var n=mi(et),i=0;i<n.length;++i)r.NumberFmt[n[i]]=et[n[i]];var a=e.match(cn);if(a)for(i=0;i<a.length;++i){var s=Re(a[i]);switch(gi(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=yt(Xt(s.formatCode)),l=parseInt(s.numFmtId,10);if(r.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=o}ys(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Xu=["numFmtId","fillId","fontId","borderId","xfId"],Qu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function bO(e,r,t){r.CellXf=[];var n,i=!1;(e.match(cn)||[]).forEach(function(a){var s=Re(a),o=0;switch(gi(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(n=s,delete n[0],o=0;o<Xu.length;++o)n[Xu[o]]&&(n[Xu[o]]=parseInt(n[Xu[o]],10));for(o=0;o<Qu.length;++o)n[Qu[o]]&&(n[Qu[o]]=Wt(n[Qu[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Wt(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var CO=function(){return function(t,n,i){var a={};if(!t)return a;t=Pd(dc(t,"<!--","-->"));var s;return(s=Zr(t,"numFmts"))&&wO(s[0],a,i),(s=Zr(t,"fonts"))&&yO(s[0],a,n,i),(s=Zr(t,"fills"))&&xO(s[0],a,n,i),(s=Zr(t,"borders"))&&_O(s[0],a,n,i),(s=Zr(t,"cellXfs"))&&bO(s[0],a,i),a}}();function EO(e,r){var t=e.read_shift(2),n=bn(e,r-2);return[t,n]}function SO(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=D4(e,2,t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=F4(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=bn(e,r-21),n}var TO=Cn;function IO(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}var kO=Cn;function AO(e,r,t){var n={};n.NumberFmt=[];for(var i in et)n.NumberFmt[i]=et[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return pa(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ys(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=sf(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!s||t.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var OO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FO(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(cn)||[]).forEach(function(i){var a=Re(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"</a:srgbClr>":break;case"<a:sysClr":n.rgb=a.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(r.themeElements.clrScheme[OO.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function DO(e,r,t){r.themeElements={};var n;if(!(n=ws(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(FO(n,r,t),!(n=ws(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(n=ws(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements");}function fx(e,r){(!e||e.length===0)&&(e=RO());var t,n={};if(!(t=ws(e,"a:themeElements")))throw new Error("themeElements not found in theme");return DO(t[0],n,r),n.raw=e,n}function RO(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[I_];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function MO(e,r,t){var n=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=T_(a,{type:"array"})}catch{return}var o=On(s,"theme/theme/theme1.xml",!0);if(o)return fx(o,t)}}function NO(e){return e.read_shift(4)}function PO(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=LO(e,4);break;case 2:r.xclrValue=Y_(e,4);break;case 3:r.xclrValue=NO(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function LO(e,r){return Cn(e,r)}function BO(e,r){return Cn(e,r)}function VO(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=PO(e,t);break;case 6:n[1]=BO(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function UO(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(VO(e,t-e.l));return{ixfe:n,ext:a}}function $O(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function WO(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:bn(e,r-8)}}function HO(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function zO(e){return e.l+=4,e.read_shift(4)!=0}function jO(e,r,t){var n={Types:[],Cell:[],Value:[]},i=t||{},a=[],s=!1,o=2;return pa(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!c.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function GO(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(cn,function(o){var l=Re(o);switch(gi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&t?.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function KO(e){var r=[];if(!e)return r;var t=1;return(e.match(cn)||[]).forEach(function(n){var i=Re(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function qO(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Ft(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function XO(e,r,t){var n=[],i=!1;return pa(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),n}function QO(e,r,t,n){if(!e)return e;var i=n||{},a=!1,s=!1;pa(e,function(l,c,u){if(!s)switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function YO(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return r["!id"][t].Target}function ZO(e,r,t){var n=0;(b_(e,"shape")||[]).forEach(function(i){var a="",s=!0,o=-1,l=-1,c=-1;switch(i.replace(cn,function(f,h){var d=Re(f);switch(gi(d[0])){case"<ClientData":d.ObjectType&&(a=d.ObjectType);break;case"<Visible":case"<Visible/>":s=!1;break;case"<Row":case"<Row>":o=h+f.length;break;case"</Row>":l=+i.slice(o,h).trim();break;case"<Column":case"<Column>":o=h+f.length;break;case"</Column>":c=+i.slice(o,h).trim();break}return""}),a){case"Note":var u=hc(r,l>=0&&c>=0?Ft({r:l,c}):t[n].ref);u.c&&(u.c.hidden=s),++n;break}})}function Gv(e,r,t,n){var i=e["!data"]!=null,a;r.forEach(function(s){var o=wn(s.ref);if(!(o.r<0||o.c<0)){if(i?(e["!data"][o.r]||(e["!data"][o.r]=[]),a=e["!data"][o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e["!data"][o.r][o.c]=a:e[s.ref]=a;var l=Or(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=wt(l);e["!ref"]=c}a.c||(a.c=[]);var u={a:s.author,t:s.t,r:s.r,T:t};s.h&&(u.h=s.h);for(var f=a.c.length-1;f>=0;--f){if(!t&&a.c[f].T)return;t&&!a.c[f].T&&a.c.splice(f,1)}if(t&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}a.c.push(u)}})}function JO(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=Zr(e,"authors");i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^<>]*>(.*)/);o&&t.push(o[1])}});var a=Zr(e,"commentList");return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^<>]*>/);if(o){var l=Re(o[0]),c={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=wn(l.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var f=Zr(s,"text"),h=!!f&&!!f[1]&&Xd(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function e3(e,r){var t=[],n=!1,i={},a=0;return e.replace(cn,function(o,l){var c=Re(o);switch(gi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),t}function t3(e,r){var t=[],n=!1;return e.replace(cn,function(a){var s=Re(a);switch(gi(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),t}function r3(e){var r={};r.iauthor=e.read_shift(4);var t=Fs(e,16);return r.rfx=t.s,r.ref=Ft(t.s),e.l+=16,r}var n3=bn;function i3(e,r){var t=[],n=[],i={},a=!1;return pa(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),t}var a3="application/vnd.ms-office.vbaProject";function s3(e){var r=Tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tt.utils.cfb_add(r,i,e.FileIndex[n].content)}}),Tt.write(r)}function o3(){return{"!type":"dialog"}}function l3(){return{"!type":"dialog"}}function c3(){return{"!type":"macro"}}function u3(){return{"!type":"macro"}}var Cs=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=r.c:--u,l?c+=r.r:--c,i+(o?"":"$")+Dt(u)+(l?"":"$")+Ht(c)}return function(i,a){return r=a,i.replace(e,t)}}(),Yd=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Yd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var f3=function(){return function(r,t){return r.replace(Yd,function(n,i,a,s,o,l){var c=jd(s)-(a?0:t.c),u=zd(l)-(o?0:t.r),f=o=="$"?u+1:u==0?"":"["+u+"]",h=a=="$"?c+1:c==0?"":"["+c+"]";return i+"R"+f+"C"+h})}}();function hx(e,r){return e.replace(Yd,function(t,n,i,a,s,o){return n+(i=="$"?i+a:Dt(jd(a)+r.c))+(s=="$"?s+o:Ht(zd(o)+r.r))})}function Kv(e,r,t){var n=As(r),i=n.s,a=wn(t),s={r:a.r-i.r,c:a.c-i.c};return hx(e,s)}function h3(e){return e.length!=1}function qv(e){return e.replace(/_xlfn\./g,"")}function Lr(e){e.l+=1}function ja(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function dx(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return px(e,r,t);t.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=ja(e,2),o=ja(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function px(e){var r=ja(e,2),t=ja(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function d3(e,r,t){if(t.biff<8)return px(e,r,t);var n=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),a=ja(e,2),s=ja(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function mx(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return p3(e,r,t);var n=e.read_shift(t&&t.biff==12?4:2),i=ja(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function p3(e){var r=ja(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function m3(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function g3(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return v3(e,r,t);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function v3(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:n}}function _3(e,r,t){var n=(e[e.l++]&96)>>5,i=dx(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function x3(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=dx(e,a,t);return[n,i,s]}function y3(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function w3(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function b3(e,r,t){var n=(e[e.l++]&96)>>5,i=d3(e,r-1,t);return[n,i]}function C3(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Xv(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function E3(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function S3(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function T3(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function I3(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function k3(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function gx(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function A3(e){return e.read_shift(2),gx(e,2)}function O3(e){return e.read_shift(2),gx(e,2)}function F3(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=mx(e,0,t);return[n,i]}function D3(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=g3(e,0,t);return[n,i]}function R3(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var a=mx(e,0,t);return[n,i,a]}function M3(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[NF[i],xx[i],n]}function N3(e,r,t){var n=e[e.l++],i=e.read_shift(1),a=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:P3(e);return[i,(a[0]===0?xx:MF)[a[1]]]}function P3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function L3(e,r,t){e.l+=t&&t.biff==2?3:4}function B3(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function V3(e){return e.l++,Ln[e.read_shift(1)]}function U3(e){return e.l++,e.read_shift(2)}function $3(e){return e.l++,e.read_shift(1)!==0}function W3(e){return e.l++,yn(e,8)}function H3(e,r,t){return e.l++,To(e,r-1,t)}function z3(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ir(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ln[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=yn(e,8);break;case 2:t[1]=Ds(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function j3(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((t.biff==12?Fs:gf)(e,8));return i}function G3(e,r,t){var n=0,i=0;t.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=z3(e,t.biff);return s}function K3(e,r,t){var n=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,a=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function q3(e,r,t){if(t.biff==5)return X3(e,r,t);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function X3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Q3(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function Y3(e,r,t){var n=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function Z3(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function J3(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var eF=Cn,tF=Cn,rF=Cn;function mc(e,r,t){return e.l+=2,[m3(e,4,t)]}function Zd(e){return e.l+=6,[]}var nF=mc,iF=Zd,aF=Zd,sF=mc;function vx(e){return e.l+=2,[Cr(e),e.read_shift(2)&1]}var oF=mc,lF=vx,cF=Zd,uF=mc,fF=mc,hF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dF(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=hF[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:n,c:i,C:a}}function pF(e){return e.l+=2,[e.read_shift(4)]}function mF(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function gF(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function vF(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function _F(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function xF(e){return e.l+=4,[0,0]}var Qv={1:{n:"PtgExp",f:B3},2:{n:"PtgTbl",f:rF},3:{n:"PtgAdd",f:Lr},4:{n:"PtgSub",f:Lr},5:{n:"PtgMul",f:Lr},6:{n:"PtgDiv",f:Lr},7:{n:"PtgPower",f:Lr},8:{n:"PtgConcat",f:Lr},9:{n:"PtgLt",f:Lr},10:{n:"PtgLe",f:Lr},11:{n:"PtgEq",f:Lr},12:{n:"PtgGe",f:Lr},13:{n:"PtgGt",f:Lr},14:{n:"PtgNe",f:Lr},15:{n:"PtgIsect",f:Lr},16:{n:"PtgUnion",f:Lr},17:{n:"PtgRange",f:Lr},18:{n:"PtgUplus",f:Lr},19:{n:"PtgUminus",f:Lr},20:{n:"PtgPercent",f:Lr},21:{n:"PtgParen",f:Lr},22:{n:"PtgMissArg",f:Lr},23:{n:"PtgStr",f:H3},26:{n:"PtgSheet",f:mF},27:{n:"PtgEndSheet",f:gF},28:{n:"PtgErr",f:V3},29:{n:"PtgBool",f:$3},30:{n:"PtgInt",f:U3},31:{n:"PtgNum",f:W3},32:{n:"PtgArray",f:C3},33:{n:"PtgFunc",f:M3},34:{n:"PtgFuncVar",f:N3},35:{n:"PtgName",f:K3},36:{n:"PtgRef",f:F3},37:{n:"PtgArea",f:_3},38:{n:"PtgMemArea",f:Q3},39:{n:"PtgMemErr",f:eF},40:{n:"PtgMemNoMem",f:tF},41:{n:"PtgMemFunc",f:Y3},42:{n:"PtgRefErr",f:Z3},43:{n:"PtgAreaErr",f:y3},44:{n:"PtgRefN",f:D3},45:{n:"PtgAreaN",f:b3},46:{n:"PtgMemAreaN",f:vF},47:{n:"PtgMemNoMemN",f:_F},57:{n:"PtgNameX",f:q3},58:{n:"PtgRef3d",f:R3},59:{n:"PtgArea3d",f:x3},60:{n:"PtgRefErr3d",f:J3},61:{n:"PtgAreaErr3d",f:w3},255:{}},yF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wF={1:{n:"PtgElfLel",f:vx},2:{n:"PtgElfRw",f:uF},3:{n:"PtgElfCol",f:nF},6:{n:"PtgElfRwV",f:fF},7:{n:"PtgElfColV",f:sF},10:{n:"PtgElfRadical",f:oF},11:{n:"PtgElfRadicalS",f:cF},13:{n:"PtgElfColS",f:iF},15:{n:"PtgElfColSV",f:aF},16:{n:"PtgElfRadicalLel",f:lF},25:{n:"PtgList",f:dF},29:{n:"PtgSxName",f:pF},255:{}},bF={0:{n:"PtgAttrNoop",f:xF},1:{n:"PtgAttrSemi",f:k3},2:{n:"PtgAttrIf",f:T3},4:{n:"PtgAttrChoose",f:E3},8:{n:"PtgAttrGoto",f:S3},16:{n:"PtgAttrSum",f:L3},32:{n:"PtgAttrBaxcel",f:Xv},33:{n:"PtgAttrBaxcel",f:Xv},64:{n:"PtgAttrSpace",f:A3},65:{n:"PtgAttrSpaceSemi",f:O3},128:{n:"PtgAttrIfError",f:I3},255:{}};function gc(e,r,t,n){if(n.biff<8)return Cn(e,r);for(var i=e.l+r,a=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=G3(e,0,n),a.push(t[s][1]);break;case"PtgMemArea":t[s][2]=j3(e,t[s][1],n),a.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=e.read_shift(4),a.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return r=i-e.l,r!==0&&a.push(Cn(e,r)),a}function vc(e,r,t){for(var n=e.l+r,i,a,s=[];n!=e.l;)r=n-e.l,a=e[e.l],i=Qv[a]||Qv[yF[a]],(a===24||a===25)&&(i=(a===24?wF:bF)[e[e.l+1]]),!i||!i.f?Cn(e,r):s.push([i.n,i.f(e,r,t)]);return s}function CF(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var EF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SF(e,r){var t=e.lastIndexOf("!"),n=r.lastIndexOf("!");return t==-1&&n==-1?e+":"+r:t>0&&n>0&&e.slice(0,t).toLowerCase()==r.slice(0,n).toLowerCase()?e+":"+r.slice(n+1):(console.error("Cannot hydrate range",e,r),e+":"+r)}function _x(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Yv(e,r,t){var n=_x(e,r,t);return n=="#REF"?n:E4(n,t)}function _n(e,r,t,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,g="";if(!e[0]||!e[0][0])return"";for(var v=-1,p="",m=0,x=e[0].length;m<x;++m){var _=e[0][m];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:p=St(" ",e[0][v][1][1]);break;case 1:p=St("\r",e[0][v][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}c=c+p,v=-1}o.push(c+EF[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(SF(c,l));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ql(_[1][1],s,i),o.push(Yl(u,a));break;case"PtgRefN":u=t?Ql(_[1][1],t,i):_[1][1],o.push(Yl(u,a));break;case"PtgRef3d":f=_[1][1],u=Ql(_[1][2],s,i),g=Yv(n,f,i);var w=g;o.push(g+"!"+Yl(u,a));break;case"PtgFunc":case"PtgFuncVar":var D=_[1][0],U=_[1][1];D||(D=0),D&=127;var F=D==0?[]:o.slice(-D);o.length-=D,U==="User"&&(U=F.shift()),o.push(U+"("+F.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=Av(_[1][1],t?{s:t}:s,i),o.push(dd(d,i));break;case"PtgArea":d=Av(_[1][1],s,i),o.push(dd(d,i));break;case"PtgArea3d":f=_[1][1],d=_[1][2],g=Yv(n,f,i),o.push(g+"!"+dd(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var R=(n.names||[])[h-1]||(n[0]||[])[h],M=R?R.Name:"SH33TJSNAME"+String(h);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var W=_[1][1];h=_[1][2];var B;if(i.biff<=5)W<0&&(W=-W),n[W]&&(B=n[W][h]);else{var V="";if(((n[W]||[])[0]||[])[0]==14849||(((n[W]||[])[0]||[])[0]==1025?n[W][h]&&n[W][h].itab>0&&(V=n.SheetNames[n[W][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[W]&&n[W][h])V+=n[W][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var G=(_x(n,W,i)||"").split(";;");G[h-1]?V=G[h-1]:V+="SH33TJSERRX"}o.push(V);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var pe="(",ae=")";if(v>=0){switch(p="",e[0][v][1][0]){case 2:pe=St(" ",e[0][v][1][1])+pe;break;case 3:pe=St("\r",e[0][v][1][1])+pe;break;case 4:ae=St(" ",e[0][v][1][1])+ae;break;case 5:ae=St("\r",e[0][v][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(pe+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var De={c:t.c,r:t.r};if(n.sharedf[Ft(u)]){var re=n.sharedf[Ft(u)];o.push(_n(re,s,De,n,i))}else{var ge=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(_n(c[1],s,De,n,i)),ge=!0;break}ge||o.push(_[1])}break;case"PtgArray":o.push("{"+CF(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&Oe.indexOf(e[0][m][0])==-1){_=e[0][v];var oe=!0;switch(_[1][0]){case 4:oe=!1;case 0:p=St(" ",_[1][1]);break;case 5:oe=!1;case 1:p=St("\r",_[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((oe?p:"")+o.pop()+(oe?"":p)),v=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function TF(e,r,t){var n=e.l+r,i=t.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],Cn(e,r-2)];var o=vc(e,s,t);return r!==s+i&&(a=gc(e,r-s-i,o,t)),e.l=n,[o,a]}function IF(e,r,t){var n=e.l+r,i=t.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],Cn(e,r-2)];var o=vc(e,s,t);return r!==s+i&&(a=gc(e,r-s-i,o,t)),e.l=n,[o,a]}function kF(e,r,t,n){var i=e.l+r,a=vc(e,n,t),s;return i!==e.l&&(s=gc(e,i-e.l,a,t)),[a,s]}function AF(e,r,t){var n=e.l+r,i,a=e.read_shift(2),s=vc(e,a,t);return a==65535?[[],Cn(e,r-2)]:(r!==a+2&&(i=gc(e,n-a-2,s,t)),[s,i])}function OF(e){var r;if(ua(e,e.l+6)!==65535)return[yn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function gd(e,r,t){var n=e.l+r,i=Oi(e,6,t),a=OF(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=IF(e,n-e.l,t);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function vf(e,r,t){var n=e.read_shift(4),i=vc(e,n,t),a=e.read_shift(4),s=a>0?gc(e,a,i,t):null;return[i,s]}var FF=vf,_f=vf,DF=vf,RF=vf;var MF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Zv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(r,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:t}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function vd(e){e=e.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(n,i){return i.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:i});var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var tc={},Co={};function rc(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function yx(e,r,t,n,i,a,s){try{n.cellNF&&(e.z=et[r])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ln(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(et[r]==null&&ys(II[r]||"General",r),e.t==="e")e.w=e.w||Ln[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v);else if(e.t==="d"){var o=jr(e.v,!!s);(o|0)===o?e.w=o.toString(10):e.w=sc(o)}else{if(e.v===void 0)return"";e.w=Ss(e.v,Co)}else e.t==="d"?e.w=Xn(r,jr(e.v,!!s),Co):e.w=Xn(r,e.v,Co)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&t!=null)try{e.s=a.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=sf(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=sf(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function PF(e,r){var t=Or(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=wt(t))}var LF=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,BF=/<(?:\w+:)?hyperlink [^<>]*>/mg,VF=/"(\w*:\w*)"/,UF=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,$F=/<(?:\w+:)?autoFilter[^>]*/g,WF=/<(?:\w+:)?pageMargins[^<>]*\/>/g,wx=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function HF(e,r,t,n,i,a,s){if(!e)return e;n||(n={"!id":{}}),Ar!=null&&r.dense==null&&(r.dense=Ar);var o={};r.dense&&(o["!data"]=[]);var l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=Zr(e,"sheetData");f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match(wx);h?Jd(h[0],o,i,t):(h=Zr(c,"sheetPr"))&&zF(h[0],h[1]||"",o,i,t,s,a);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var g=c.slice(d,d+50).match(VF);g&&!(r&&r.nodim)&&PF(o,g[1])}var v=Zr(c,"sheetViews");v&&v[1]&&QF(v[1],i);var p=[];if(r.cellStyles){var m=c.match(UF);m&&KF(p,m)}f&&YF(f[1],o,r,l,a,s,i);var x=u.match($F);x&&(o["!autofilter"]=qF(x[0]));var _=[],w=u.match(LF);if(w)for(d=0;d!=w.length;++d)_[d]=Or(w[d].slice(w[d].indexOf("=")+2));var D=u.match(BF);D&&jF(o,D,n);var U=u.match(WF);U&&(o["!margins"]=GF(Re(U[0])));var F;if((F=u.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=F[1]),r&&r.nodim&&(l.s.c=l.s.r=0),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=wt(l)),r.sheetRows>0&&o["!ref"]){var R=Or(o["!ref"]);r.sheetRows<=+R.e.r&&(R.e.r=r.sheetRows-1,R.e.r>l.e.r&&(R.e.r=l.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>l.e.c&&(R.e.c=l.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),o["!fullref"]=o["!ref"],o["!ref"]=wt(R))}return p.length>0&&(o["!cols"]=p),_.length>0&&(o["!merges"]=_),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function Jd(e,r,t,n){var i=Re(e);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=yt(Xt(i.codeName)))}function zF(e,r,t,n,i){Jd(e.slice(0,e.indexOf(">")),t,n,i)}function jF(e,r,t){for(var n=e["!data"]!=null,i=0;i!=r.length;++i){var a=Re(Xt(r[i]),!0);if(!a.ref)return;var s=((t||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+yt(a.location))):(a.Target="#"+yt(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Or(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Dt(c)+Ht(l);n?(e["!data"][l]||(e["!data"][l]=[]),e["!data"][l][c]||(e["!data"][l][c]={t:"z",v:void 0}),e["!data"][l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function GF(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function KF(e,r){for(var t=!1,n=0;n!=r.length;++n){var i=Re(r[n],!0);i.hidden&&(i.hidden=Wt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,Qd(i.width)),Io(i);a<=s;)e[a++]=Ur(i)}}function qF(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var XF=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function QF(e,r){r.Views||(r.Views=[{}]),(e.match(XF)||[]).forEach(function(t,n){var i=Re(t);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),i.rightToLeft&&Wt(i.rightToLeft)&&(r.Views[n].RTL=!0)})}var YF=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/ref=["']([^"']*)["']/;return function(a,s,o,l,c,u,f){for(var h=0,d="",g=[],v=[],p=0,m=0,x=0,_="",w,D,U=0,F=0,R,M,W=0,B=0,V=Array.isArray(u.CellXf),G,pe=[],ae=[],De=s["!data"]!=null,re=[],ge={},Oe=!1,oe=!!o.sheetStubs,We=!!((f||{}).WBProps||{}).date1904,le=a.split(r),Ie=0,Ee=le.length;Ie!=Ee;++Ie){d=le[Ie].trim();var lt=d.length;if(lt!==0){var Me=0;e:for(h=0;h<lt;++h)switch(d[h]){case">":if(d[h-1]!="/"){++h;break e}if(o&&o.cellStyles){if(D=Re(d.slice(Me,h),!0),U=D.r!=null?parseInt(D.r,10):U+1,F=-1,o.sheetRows&&o.sheetRows<U)continue;ge={},Oe=!1,D.ht&&(Oe=!0,ge.hpt=parseFloat(D.ht),ge.hpx=uc(ge.hpt)),D.hidden&&Wt(D.hidden)&&(Oe=!0,ge.hidden=!0),D.outlineLevel!=null&&(Oe=!0,ge.level=+D.outlineLevel),Oe&&(re[U-1]=ge)}break;case"<":Me=h;break}if(Me>=h)break;if(D=Re(d.slice(Me,h),!0),U=D.r!=null?parseInt(D.r,10):U+1,F=-1,!(o.sheetRows&&o.sheetRows<U)){o.nodim||(l.s.r>U-1&&(l.s.r=U-1),l.e.r<U-1&&(l.e.r=U-1)),o&&o.cellStyles&&(ge={},Oe=!1,D.ht&&(Oe=!0,ge.hpt=parseFloat(D.ht),ge.hpx=uc(ge.hpt)),D.hidden&&Wt(D.hidden)&&(Oe=!0,ge.hidden=!0),D.outlineLevel!=null&&(Oe=!0,ge.level=+D.outlineLevel),Oe&&(re[U-1]=ge)),g=d.slice(h).split(e);for(var qe=0;qe!=g.length&&g[qe].trim().charAt(0)=="<";++qe);for(g=g.slice(qe),h=0;h!=g.length;++h)if(d=g[h].trim(),d.length!==0){if(v=d.match(t),p=h,m=0,x=0,d="<c "+(d.slice(0,1)=="<"?">":"")+d,v!=null&&v.length===2){for(p=0,_=v[1],m=0;m!=_.length&&!((x=_.charCodeAt(m)-64)<1||x>26);++m)p=26*p+x;--p,F=p}else++F;for(m=0;m!=d.length&&d.charCodeAt(m)!==62;++m);if(++m,D=Re(d.slice(0,m),!0),D.r||(D.r=Ft({r:U-1,c:F})),_=d.slice(m),w={t:""},(v=Zr(_,"v"))!=null&&v[1]!==""&&(w.v=yt(v[1])),o.cellFormula){if((v=Zr(_,"f"))!=null){if(v[1]=="")v[0].indexOf('t="shared"')>-1&&(M=Re(v[0]),ae[M.si]&&(w.f=Kv(ae[M.si][1],ae[M.si][2],D.r)));else if(w.f=yt(Xt(v[1]),!0),o.xlfn||(w.f=qv(w.f)),v[0].indexOf('t="array"')>-1)w.F=(_.match(n)||[])[1],w.F.indexOf(":")>-1&&pe.push([Or(w.F),w.F]);else if(v[0].indexOf('t="shared"')>-1){M=Re(v[0]);var O=yt(Xt(v[1]));o.xlfn||(O=qv(O)),ae[parseInt(M.si,10)]=[M,O,D.r]}}else(v=_.match(/<f[^<>]*\/>/))&&(M=Re(v[0]),ae[M.si]&&(w.f=Kv(ae[M.si][1],ae[M.si][2],D.r)));var H=wn(D.r);for(m=0;m<pe.length;++m)H.r>=pe[m][0].s.r&&H.r<=pe[m][0].e.r&&H.c>=pe[m][0].s.c&&H.c<=pe[m][0].e.c&&(w.F=pe[m][1])}if(D.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(oe)w.t="z";else continue;else w.t=D.t||"n";switch(l.s.c>F&&(l.s.c=F),l.e.c<F&&(l.e.c=F),w.t){case"n":if(w.v==""||w.v==null){if(!oe)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!oe)continue;w.t="z"}else R=tc[parseInt(w.v,10)],w.v=R.t,w.r=R.r,o.cellHTML&&(w.h=R.h);break;case"str":w.t="s",w.v=w.v!=null?yt(Xt(w.v),!0):"",o.cellHTML&&(w.h=ql(w.v));break;case"inlineStr":v=Zr(_,"is"),w.t="s",v!=null&&(R=Xd(v[1]))?(w.v=R.t,o.cellHTML&&(w.h=R.h)):w.v="";break;case"b":w.v=Wt(w.v);break;case"d":o.cellDates?w.v=ln(w.v,We):(w.v=jr(ln(w.v,We),We),w.t="n");break;case"e":(!o||o.cellText!==!1)&&(w.w=w.v),w.v=sn[w.v];break}if(W=B=0,G=null,V&&D.s!==void 0&&(G=u.CellXf[D.s],G!=null&&(G.numFmtId!=null&&(W=G.numFmtId),o.cellStyles&&G.fillId!=null&&(B=G.fillId))),yx(w,W,B,o,c,u,We),o.cellDates&&V&&w.t=="n"&&Ai(et[W])&&(w.v=Wa(w.v+(We?1462:0)),w.t=typeof w.v=="number"?"n":"d"),D.cm&&o.xlmeta){var L=(o.xlmeta.Cell||[])[+D.cm-1];L&&L.type=="XLDAPR"&&(w.D=!0)}var N;o.nodim&&(N=wn(D.r),l.s.r>N.r&&(l.s.r=N.r),l.e.r<N.r&&(l.e.r=N.r)),De?(N=wn(D.r),s["!data"][N.r]||(s["!data"][N.r]=[]),s["!data"][N.r][N.c]=w):s[D.r]=w}}}}re.length>0&&(s["!rows"]=re)}}();function ZF(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=i/20),t}var JF=Fs;function eD(){}function tD(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=A4(e,r-19),t}function rD(e){var r=vi(e);return[r]}function nD(e){var r=Os(e);return[r]}function iD(e){var r=vi(e),t=e.read_shift(1);return[r,t,"b"]}function aD(e){var r=Os(e),t=e.read_shift(1);return[r,t,"b"]}function sD(e){var r=vi(e),t=e.read_shift(1);return[r,t,"e"]}function oD(e){var r=Os(e),t=e.read_shift(1);return[r,t,"e"]}function lD(e){var r=vi(e),t=e.read_shift(4);return[r,t,"s"]}function cD(e){var r=Os(e),t=e.read_shift(4);return[r,t,"s"]}function uD(e){var r=vi(e),t=yn(e);return[r,t,"n"]}function bx(e){var r=Os(e),t=yn(e);return[r,t,"n"]}function fD(e){var r=vi(e),t=mf(e);return[r,t,"n"]}function hD(e){var r=Os(e),t=mf(e);return[r,t,"n"]}function dD(e){var r=vi(e),t=Gd(e);return[r,t,"is"]}function pD(e){var r=vi(e),t=bn(e);return[r,t,"str"]}function mD(e){var r=Os(e),t=bn(e);return[r,t,"str"]}function gD(e,r,t){var n=e.l+r,i=vi(e);i.r=t["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(t.cellFormula){e.l+=2;var o=_f(e,n-e.l,t);s[3]=_n(o,null,i,t.supbooks,t)}else e.l=n;return s}function vD(e,r,t){var n=e.l+r,i=vi(e);i.r=t["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(t.cellFormula){e.l+=2;var o=_f(e,n-e.l,t);s[3]=_n(o,null,i,t.supbooks,t)}else e.l=n;return s}function _D(e,r,t){var n=e.l+r,i=vi(e);i.r=t["!row"];var a=yn(e),s=[i,a,"n"];if(t.cellFormula){e.l+=2;var o=_f(e,n-e.l,t);s[3]=_n(o,null,i,t.supbooks,t)}else e.l=n;return s}function xD(e,r,t){var n=e.l+r,i=vi(e);i.r=t["!row"];var a=bn(e),s=[i,a,"str"];if(t.cellFormula){e.l+=2;var o=_f(e,n-e.l,t);s[3]=_n(o,null,i,t.supbooks,t)}else e.l=n;return s}var yD=Fs;function wD(e,r){var t=e.l+r,n=Fs(e,16),i=pf(e),a=bn(e),s=bn(e),o=bn(e);e.l=t;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function bD(){}function CD(e,r,t){var n=e.l+r,i=$_(e,16),a=e.read_shift(1),s=[i];if(s[2]=a,t.cellFormula){var o=FF(e,n-e.l,t);s[1]=o}else e.l=n;return s}function ED(e,r,t){var n=e.l+r,i=Fs(e,16),a=[i];if(t.cellFormula){var s=RF(e,n-e.l,t);a[1]=s,e.l=n}else e.l=n;return a}var SD=["left","right","top","bottom","header","footer"];function TD(e){var r={};return SD.forEach(function(t){r[t]=yn(e,8)}),r}function ID(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function kD(){}function AD(){}function OD(e,r,t,n,i,a,s){if(!e)return e;var o=r||{};n||(n={"!id":{}}),Ar!=null&&o.dense==null&&(o.dense=Ar);var l={};o.dense&&(l["!data"]=[]);var c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],h=!1,d=!1,g,v,p,m,x,_,w,D,U,F=[];o.biff=12,o["!row"]=0;var R=0,M=!1,W=[],B={},V=o.supbooks||i.supbooks||[[]];if(V.sharedf=B,V.arrayf=W,V.SheetNames=i.SheetNames||i.Sheets.map(function(We){return We.name}),!o.supbooks&&(o.supbooks=V,i.Names))for(var G=0;G<i.Names.length;++G)V[0][G+1]=i.Names[G];var pe=[],ae=[],De=!1;cf[16]={n:"BrtShortReal",f:bx};var re,ge,Oe=1462*+!!((i||{}).WBProps||{}).date1904;if(pa(e,function(le,Ie,Ee){if(!d)switch(Ee){case 148:c=le;break;case 0:g=le,o.sheetRows&&o.sheetRows<=g.r&&(d=!0),D=Ht(m=g.r),o["!row"]=g.r,(le.hidden||le.hpt||le.level!=null)&&(le.hpt&&(le.hpx=uc(le.hpt)),ae[le.r]=le);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:le[2]},le[2]){case"n":v.v=le[1];break;case"s":w=tc[le[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!le[1];break;case"e":v.v=le[1],o.cellText!==!1&&(v.w=Ln[v.v]);break;case"str":v.t="s",v.v=le[1];break;case"is":v.t="s",v.v=le[1].t;break}if((p=s.CellXf[le[0].iStyleRef])&&yx(v,p.numFmtId,null,o,a,s,Oe>0),x=le[0].c==-1?x+1:le[0].c,o.dense?(l["!data"][m]||(l["!data"][m]=[]),l["!data"][m][x]=v):l[Dt(x)+D]=v,o.cellFormula){for(M=!1,R=0;R<W.length;++R){var lt=W[R];g.r>=lt[0].s.r&&g.r<=lt[0].e.r&&x>=lt[0].s.c&&x<=lt[0].e.c&&(v.F=wt(lt[0]),M=!0)}!M&&le.length>3&&(v.f=le[3])}if(u.s.r>g.r&&(u.s.r=g.r),u.s.c>x&&(u.s.c=x),u.e.r<g.r&&(u.e.r=g.r),u.e.c<x&&(u.e.c=x),o.cellDates&&p&&v.t=="n"&&Ai(et[p.numFmtId])){var Me=la(v.v+Oe);Me&&(v.t="d",v.v=new Date(Date.UTC(Me.y,Me.m-1,Me.d,Me.H,Me.M,Me.S,Me.u)))}re&&(re.type=="XLDAPR"&&(v.D=!0),re=void 0),ge&&(ge=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},x=le[0].c==-1?x+1:le[0].c,o.dense?(l["!data"][m]||(l["!data"][m]=[]),l["!data"][m][x]=v):l[Dt(x)+D]=v,u.s.r>g.r&&(u.s.r=g.r),u.s.c>x&&(u.s.c=x),u.e.r<g.r&&(u.e.r=g.r),u.e.c<x&&(u.e.c=x),re&&(re.type=="XLDAPR"&&(v.D=!0),re=void 0),ge&&(ge=void 0);break;case 176:F.push(le);break;case 49:re=((o.xlmeta||{}).Cell||[])[le-1];break;case 494:var qe=n["!id"][le.relId];for(qe?(le.Target=qe.Target,le.loc&&(le.Target+="#"+le.loc),le.Rel=qe):le.relId==""&&(le.Target="#"+le.loc),m=le.rfx.s.r;m<=le.rfx.e.r;++m)for(x=le.rfx.s.c;x<=le.rfx.e.c;++x)o.dense?(l["!data"][m]||(l["!data"][m]=[]),l["!data"][m][x]||(l["!data"][m][x]={t:"z",v:void 0}),l["!data"][m][x].l=le):(_=Dt(x)+Ht(m),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=le);break;case 426:if(!o.cellFormula)break;W.push(le),U=o.dense?l["!data"][m][x]:l[Dt(x)+D],U.f=_n(le[1],u,{r:g.r,c:x},V,o),U.F=wt(le[0]);break;case 427:if(!o.cellFormula)break;B[Ft(le[0].s)]=le[1],U=o.dense?l["!data"][m][x]:l[Dt(x)+D],U.f=_n(le[1],u,{r:g.r,c:x},V,o);break;case 60:if(!o.cellStyles)break;for(;le.e>=le.s;)pe[le.e--]={width:le.w/256,hidden:!!(le.flags&1),level:le.level},De||(De=!0,Qd(le.w/256)),Io(pe[le.e+1]);break;case 551:le&&(l["!legrel"]=le);break;case 161:l["!autofilter"]={ref:wt(le)};break;case 476:l["!margins"]=le;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),le.name&&(i.Sheets[t].CodeName=le.name),(le.above||le.left)&&(l["!outline"]={above:le.above,left:le.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),le.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:f.push(Ee),h=!0;break;case 38:f.pop(),h=!1;break;default:if(!Ie.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=wt(c||u)),o.sheetRows&&l["!ref"]){var oe=Or(l["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>u.e.r&&(oe.e.r=u.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>u.e.c&&(oe.e.c=u.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=wt(oe))}return F.length>0&&(l["!merges"]=F),pe.length>0&&(l["!cols"]=pe),ae.length>0&&(l["!rows"]=ae),n["!id"][l["!legrel"]]&&(l["!legdrawel"]=n["!id"][l["!legrel"]]),l}function FD(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var i=yt((ws(e,"c:formatCode")||["","General"])[1]);return(Ld(e,"<c:f>","</c:f>")||[]).forEach(function(a){n=a.replace(/<[^<>]*>/g,"")}),[r,i,n]}function DD(e,r,t,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(Ld(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(f){var h=FD(f);u.s.r=u.s.c=0,u.e.c=o,c=Dt(o),h[0].forEach(function(d,g){s["!data"]?(s["!data"][g]||(s["!data"][g]=[]),s["!data"][g][o]={t:"n",v:d,z:h[1]}):s[c+Ht(g)]={t:"n",v:d,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=wt(u)),s}function RD(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(wx);return o&&Jd(o[0],a,i,t),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function MD(e,r){e.l+=10;var t=bn(e,r-10);return{name:t}}function ND(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return pa(e,function(c,u,f){switch(f){case 550:a["!rel"]=c;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),c.name&&(i.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(f);break;case 38:s.pop();break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},r),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Cx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LD=[],BD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Jv(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],i=0;i!=r.length;++i){var a=r[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Wt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function e_(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Ex(e){e_(e.WBProps,Cx),e_(e.CalcPr,BD),Jv(e.WBView,PD),Jv(e.Sheets,LD),Co.date1904=Wt(e.WBProps.date1904)}var VD=":][*?/\\".split("");function UD(e,r){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");VD.forEach(function(t){if(e.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){if(r)return!1;throw t}return!0}var $D=/<\w+:workbook/;function WD(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(cn,function(l,c){var u=Re(l);switch(gi(u[0])){case"<?xml":break;case"<workbook":l.match($D)&&(i="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Cx.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=Wt(u[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:t.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(t.WBProps.CodeName=Xt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=yt(Xt(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Xt(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Wt(u.hidden||"0")&&(a.Hidden=!0),s=c+l.length;break;case"</definedName>":a.Ref=yt(Xt(e.slice(s,c))),t.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),c4.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Ex(t),t}function HD(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Ed(e,r-8),t.name=bn(e),t}function zD(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?bn(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function jD(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function GD(e,r,t){var n=e.l+r,i=e.read_shift(4);e.l+=1;var a=e.read_shift(4),s=O4(e),o,l="";try{o=DF(e,0,t);try{l=pf(e)}catch{}}catch{console.error("Could not parse defined name "+s)}i&32&&(s="_xlnm."+s),e.l=n;var c={Name:s,Ptg:o,Flags:i};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function KD(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],cf[16]={n:"BrtFRTArchID$",f:jD},pa(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=l.Ptg?_n(l.Ptg,null,null,s,r):"#REF!",delete r.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),Ex(t),t.Names=a,t.supbooks=s,t}function qD(e,r,t){return r.slice(-4)===".bin"?KD(e,t):WD(e,t)}function XD(e,r,t,n,i,a,s,o){return r.slice(-4)===".bin"?OD(e,n,t,i,a,s,o):HF(e,n,t,i,a,s,o)}function QD(e,r,t,n,i,a,s,o){return r.slice(-4)===".bin"?ND(e,n,t,i,a,s,o):RD(e,n,t,i,a,s,o)}function YD(e,r,t,n,i,a,s,o){return r.slice(-4)===".bin"?c3(e,n,t,i,a,s,o):u3(e,n,t,i,a,s,o)}function ZD(e,r,t,n,i,a,s,o){return r.slice(-4)===".bin"?o3(e,n,t,i,a,s,o):l3(e,n,t,i,a,s,o)}function JD(e,r,t,n){return r.slice(-4)===".bin"?AO(e,t,n):CO(e,t,n)}function eR(e,r,t){return r.slice(-4)===".bin"?zA(e,t):WA(e,t)}function tR(e,r,t){return r.slice(-4)===".bin"?i3(e,t):JO(e,t)}function rR(e,r,t){return r.slice(-4)===".bin"?XO(e,r,t):KO(e,r,t)}function nR(e,r,t,n){return t.slice(-4)===".bin"?QO(e,r,t,n):void 0}function iR(e,r,t){return r.slice(-4)===".bin"?jO(e,r,t):GO(e,r,t)}var Sx=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Tx=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ti(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),t.length===1)return n;var i=e.match(Sx),a,s,o,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(Tx),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function aR(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Sx),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Tx),(a=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),t[s]=i[2].slice(1,i[2].length-1));return t}var nc;function sR(e,r,t){var n=nc[e]||yt(e);return n==="General"?Ss(r):Xn(n,r,{date1904:!!t})}function oR(e,r,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Wt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ln(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[yt(r)]=i}function lR(e,r,t,n){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ln[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v):e.w=Ss(e.v):e.w=sR(r||"General",e.v,n)}catch(s){if(t.WTF)throw s}try{var i=nc[r]||r||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&Ai(i)){var a=la(e.v+(n?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}catch(s){if(t.WTF)throw s}}}function cR(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=vO[n.Pattern]||n.Pattern)}e[r.ID]=r}function uR(e,r,t,n,i,a,s,o,l,c,u){var f="General",h=n.StyleID,d={};c=c||{};var g=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);a[h]!==void 0;){var p=a[h];if(p.nf&&(f=p.nf),p.Interior&&g.push(p.Interior),!p.Parent)break;h=p.Parent}switch(t.Type){case"Boolean":n.t="b",n.v=Wt(e);break;case"String":n.t="s",n.r=yv(yt(e)),n.v=e.indexOf("<")>-1?yt(r||e).replace(/<[^<>]*>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=jr(ln(e,u),u),n.v!==n.v&&(n.v=yt(e)),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sn[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=yv(r||e));break}if(lR(n,f,c,u),c.cellFormula!==!1)if(n.Formula){var m=yt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Cs(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Cs("RC:RC",i):n.ArrayRange&&(n.F=Cs(n.ArrayRange,i),l.push([Or(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(g.forEach(function(x){!d.patternType&&x.patternType&&(d.patternType=x.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fR(e){return z_.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function hR(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _d(e,r){var t=r||{};x_();var n=jl(hf(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof _t<"u"?n=_t.utils.decode(65001,wd(n)):n=Xt(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Ur(t);return s.type="string",lc.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){i.indexOf("<"+ht)>=0&&(a=!0)}),a)return wR(n,t);nc={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c;Ar!=null&&t.dense==null&&(t.dense=Ar);var u={},f=[],h={},d="";t.dense&&(h["!data"]=[]);var g={},v={},p=Ti('<Data ss:Type="String">'),m=0,x=0,_=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},U={},F="",R=0,M=[],W={},B={},V=0,G=[],pe=[],ae={},De=[],re,ge=!1,Oe=[],oe=[],We={},le=0,Ie=0,Ee={Sheets:[],WBProps:{date1904:!1}},lt={};Vr.lastIndex=0,n=dc(n,"<!--","-->");for(var Me="";o=Vr.exec(n);)switch(o[3]=(Me=o[3]).toLowerCase()){case"data":if(Me=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?uR(n.slice(m,o.index),F,p,l[l.length-1][0]=="comment"?ae:g,{c:x,r:_},D,De[x],v,Oe,t,Ee.WBProps.date1904):(F="",p=Ti(o[0]),m=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(pe.length>0&&(g.c=pe),(!t.sheetRows||t.sheetRows>_)&&g.v!==void 0&&(t.dense?(h["!data"][_]||(h["!data"][_]=[]),h["!data"][_][x]=g):h[Dt(x)+Ht(_)]=g),g.HRef&&(g.l={Target:yt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(le=x+(parseInt(g.MergeAcross,10)|0),Ie=_+(parseInt(g.MergeDown,10)|0),(le>x||Ie>_)&&M.push({s:{c:x,r:_},e:{c:le,r:Ie}})),!t.sheetStubs)g.MergeAcross?x=le+1:++x;else if(g.MergeAcross||g.MergeDown){for(var qe=x;qe<=le;++qe)for(var O=_;O<=Ie;++O)(qe>x||O>_)&&(t.dense?(h["!data"][O]||(h["!data"][O]=[]),h["!data"][O][qe]={t:"z"}):h[Dt(qe)+Ht(O)]={t:"z"});x=le+1}else++x;else g=aR(o[0]),g.Index&&(x=+g.Index-1),x<w.s.c&&(w.s.c=x),x>w.e.c&&(w.e.c=x),o[0].slice(-2)==="/>"&&++x,pe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<w.s.r&&(w.s.r=_),_>w.e.r&&(w.e.r=_),o[0].slice(-2)==="/>"&&(v=Ti(o[0]),v.Index&&(_=+v.Index-1)),x=0,++_):(v=Ti(o[0]),v.Index&&(_=+v.Index-1),We={},(v.AutoFitHeight=="0"||v.Height)&&(We.hpx=parseInt(v.Height,10),We.hpt=ux(We.hpx),oe[_]=We),v.Hidden=="1"&&(We.hidden=!0,oe[_]=We));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(d),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=wt(w),t.sheetRows&&t.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=t.sheetRows-1,h["!ref"]=wt(w))),M.length&&(h["!merges"]=M),De.length>0&&(h["!cols"]=De),oe.length>0&&(h["!rows"]=oe),u[d]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=x=0,l.push([o[3],!1]),c=Ti(o[0]),d=yt(c.Name),h={},t.dense&&(h["!data"]=[]),M=[],Oe=[],oe=[],lt={name:d,Hidden:0},Ee.Sheets.push(lt);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),De=[],ge=!1}break;case"style":o[1]==="/"?cR(D,U,t):U=Ti(o[0]);break;case"numberformat":U.nf=yt(Ti(o[0]).Format||"General"),nc[U.nf]&&(U.nf=nc[U.nf]);for(var H=0;H!=392&&et[H]!=U.nf;++H);if(H==392){for(H=57;H!=392;++H)if(et[H]==null){ys(U.nf,H);break}}break;case"column":if(l[l.length-1][0]!=="table"||o[1]==="/")break;if(re=Ti(o[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!ge&&re.wpx>10){ge=!0,An=lx;for(var L=0;L<De.length;++L)De[L]&&Io(De[L])}ge&&Io(re),De[re.Index-1||De.length]=re;for(var N=0;N<+re.Span;++N)De[De.length]=Ur(re);break;case"namedrange":if(o[1]==="/")break;Ee.Names||(Ee.Names=[]);var se=Re(o[0]),k={Name:fR(se.Name),Ref:Cs(se.RefersTo.slice(1),{r:0,c:0})};Ee.Sheets.length>0&&(k.Sheet=Ee.Sheets.length-1),Ee.Names.push(k);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(R,o.index):R=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;U.Interior=Ti(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ek(W,Me,n.slice(V,o.index)):V=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));hR(ae),pe.push(ae)}else l.push([o[3],!1]),c=Ti(o[0]),Wt(c.ShowAlways||"0")||(pe.hidden=!0),ae={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Le=Ti(o[0]);h["!autofilter"]={ref:Cs(Le.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return a_(n,t);var be=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Ee.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(V,o.index)){case"SheetHidden":lt.Hidden=1;break;case"SheetVeryHidden":lt.Hidden=2;break}else V=o.index+o[0].length;break;case"header":h["!margins"]||rc(h["!margins"]={},"xlml"),isNaN(+Re(o[0]).Margin)||(h["!margins"].header=+Re(o[0]).Margin);break;case"footer":h["!margins"]||rc(h["!margins"]={},"xlml"),isNaN(+Re(o[0]).Margin)||(h["!margins"].footer=+Re(o[0]).Margin);break;case"pagemargins":var fe=Re(o[0]);h["!margins"]||rc(h["!margins"]={},"xlml"),isNaN(+fe.Top)||(h["!margins"].top=+fe.Top),isNaN(+fe.Left)||(h["!margins"].left=+fe.Left),isNaN(+fe.Right)||(h["!margins"].right=+fe.Right),isNaN(+fe.Bottom)||(h["!margins"].bottom=+fe.Bottom);break;case"displayrighttoleft":Ee.Views||(Ee.Views=[]),Ee.Views[0]||(Ee.Views[0]={}),Ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?oR(B,Me,G,n.slice(V,o.index)):(G=o,V=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ke={};return!t.bookSheets&&!t.bookProps&&(Ke.Sheets=u),Ke.SheetNames=f,Ke.Workbook=Ee,Ke.SSF=Ur(et),Ke.Props=W,Ke.Custprops=B,Ke.bookType="xlml",Ke}function Id(e,r){switch(ep(r=r||{}),r.type||"base64"){case"base64":return _d(qn(e),r);case"binary":case"buffer":case"file":return _d(e,r);case"array":return _d(da(e),r)}}function dR(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=R4(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=M4(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var pR=[60,1084,2066,2165,2175];function mR(e,r,t,n,i){var a=n,s=[],o=t.slice(t.l,t.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),t.l+=a;for(var l=ua(t,t.l),c=kd[l],u=0;c!=null&&pR.indexOf(l)>-1;)a=ua(t,t.l+2),u=t.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=t.slice(u,t.l+4+a),s.push(o),t.l+=4+a,c=kd[l=ua(t,t.l)];var f=Ua(s);zr(f,0);var h=0;f.lens=[];for(var d=0;d<s.length;++d)f.lens.push(h),h+=s[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return r.f(f,f.length,i)}function zi(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&e.z==null&&(e.z=et[n])}catch(a){if(r.WTF)throw a}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ln[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v):e.w=Ss(e.v):e.w=Xn(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(a){if(r.WTF)throw a}if(r.cellDates&&n&&e.t=="n"&&Ai(et[n]||String(n))){var i=la(e.v+(t?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}}function Yu(e,r,t){return{v:e,ixfe:r,t}}function gR(e,r){var t={opts:{}},n={};Ar!=null&&r.dense==null&&(r.dense=Ar);var i={};r.dense&&(i["!data"]=[]);var a={},s={},o=null,l=[],c="",u={},f,h="",d,g,v,p,m={},x=[],_,w,D=[],U=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},M=!1,W=function(rt){return rt<8?bs[rt]:rt<64&&U[rt-8]||bs[rt]},B=function(rt,Xe){var Gt=rt.XF.data;if(!(!Gt||!Gt.patternType||!Xe||!Xe.cellStyles)){rt.s={},rt.s.patternType=Gt.patternType;var ur;(ur=cc(W(Gt.icvFore)))&&(rt.s.fgColor={rgb:ur}),(ur=cc(W(Gt.icvBack)))&&(rt.s.bgColor={rgb:ur})}},V=function(rt,Xe,Gt){if(!(!M&&le>1)&&!(Gt.sheetRows&&rt.r>=Gt.sheetRows)){if(Gt.cellStyles&&Xe.XF&&Xe.XF.data&&B(Xe,Gt),delete Xe.ixfe,delete Xe.XF,f=rt,h=Ft(rt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<s.s.r&&(s.s.r=rt.r),rt.c<s.s.c&&(s.s.c=rt.c),rt.r+1>s.e.r&&(s.e.r=rt.r+1),rt.c+1>s.e.c&&(s.e.c=rt.c+1),Gt.cellFormula&&Xe.f){for(var ur=0;ur<x.length;++ur)if(!(x[ur][0].s.c>rt.c||x[ur][0].s.r>rt.r)&&!(x[ur][0].e.c<rt.c||x[ur][0].e.r<rt.r)){Xe.F=wt(x[ur][0]),(x[ur][0].s.c!=rt.c||x[ur][0].s.r!=rt.r)&&delete Xe.f,Xe.f&&(Xe.f=""+_n(x[ur][1],s,rt,oe,G));break}}Gt.dense?(i["!data"][rt.r]||(i["!data"][rt.r]=[]),i["!data"][rt.r][rt.c]=Xe):i[h]=Xe}},G={enc:!1,sbcch:0,snames:[],sharedf:m,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(G.password=r.password);var pe,ae=[],De=[],re=[],ge=[],Oe=!1,oe=[];oe.SheetNames=G.snames,oe.sharedf=G.sharedf,oe.arrayf=G.arrayf,oe.names=[],oe.XTI=[];var We=0,le=0,Ie=0,Ee=[],lt=[],Me;G.codepage=1200,Ii(1200);for(var qe=!1;e.l<e.length-1;){var O=e.l,H=e.read_shift(2);if(H===0&&We===10)break;var L=e.l===e.length?0:e.read_shift(2),N=kd[H];if(le==0&&[9,521,1033,2057].indexOf(H)==-1)break;if(N&&N.f){if(r.bookSheets&&We===133&&H!==133)break;if(We=H,N.r===2||N.r==12){var se=e.read_shift(2);if(L-=2,!G.enc&&se!==H&&((se&255)<<8|se>>8)!==H)throw new Error("rt mismatch: "+se+"!="+H);N.r==12&&(e.l+=10,L-=10)}var k={};if(H===10?k=N.f(e,L,G):k=mR(H,N,e,L,G),le==0&&[9,521,1033,2057].indexOf(We)===-1)continue;switch(H){case 34:t.opts.Date1904=F.WBProps.date1904=k;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=k,!r.password)throw new Error("File is password-protected");if(k.valid==null)throw new Error("Encryption scheme unsupported");if(!k.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=k;break;case 66:var Le=Number(k);switch(Le){case 21010:Le=1200;break;case 32768:Le=1e4;break;case 32769:Le=1252;break}Ii(G.codepage=Le),qe=!0;break;case 317:G.rrtabid=k;break;case 25:G.winlocked=k;break;case 439:t.opts.RefreshAll=k;break;case 12:t.opts.CalcCount=k;break;case 16:t.opts.CalcDelta=k;break;case 17:t.opts.CalcIter=k;break;case 13:t.opts.CalcMode=k;break;case 14:t.opts.CalcPrecision=k;break;case 95:t.opts.CalcSaveRecalc=k;break;case 15:G.CalcRefMode=k;break;case 2211:t.opts.FullCalc=k;break;case 129:k.fDialog&&(i["!type"]="dialog"),k.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),k.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:D.push(k);break;case 430:oe.push([k]),oe[oe.length-1].XTI=[];break;case 35:case 547:oe[oe.length-1].push(k);break;case 24:case 536:Me={Name:k.Name,Ref:_n(k.rgce,s,null,oe,G)},k.itab>0&&(Me.Sheet=k.itab-1),oe.names.push(Me),oe[0]||(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].push(k),k.Name=="_xlnm._FilterDatabase"&&k.itab>0&&k.rgce&&k.rgce[0]&&k.rgce[0][0]&&k.rgce[0][0][0]=="PtgArea3d"&&(lt[k.itab-1]={ref:wt(k.rgce[0][0][1][2])});break;case 22:G.ExternCount=k;break;case 23:oe.length==0&&(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].XTI=oe[oe.length-1].XTI.concat(k),oe.XTI=oe.XTI.concat(k);break;case 2196:if(G.biff<8)break;Me!=null&&(Me.Comment=k[1]);break;case 18:i["!protect"]=k;break;case 19:k!==0&&G.WTF&&console.error("Password verifier: "+k);break;case 133:a[G.biff==4?G.snames.length:k.pos]=k,G.snames.push(k.name);break;case 10:{if(--le?!M:M)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=wt(s),r.sheetRows&&r.sheetRows<=s.e.r){var be=s.e.r;s.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=wt(s),s.e.r=be}s.e.r++,s.e.c++}ae.length>0&&(i["!merges"]=ae),De.length>0&&(i["!objects"]=De),re.length>0&&(i["!cols"]=re),ge.length>0&&(i["!rows"]=ge),F.Sheets.push(R)}c===""?u=i:n[c]=i,i={},r.dense&&(i["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[k.BIFFVer]||8),G.biffguess=k.BIFFVer==0,k.BIFFVer==0&&k.dt==4096&&(G.biff=5,qe=!0,Ii(G.codepage=28591)),G.biff==4&&k.dt&256&&(M=!0),G.biff==8&&k.BIFFVer==0&&k.dt==16&&(G.biff=2),le++&&!M)break;if(i={},r.dense&&(i["!data"]=[]),G.biff<8&&!qe&&(qe=!0,Ii(G.codepage=r.codepage||1252)),G.biff==4&&M)c=(a[G.snames.indexOf(c)+1]||{name:""}).name;else if(G.biff<5||k.BIFFVer==0&&k.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var fe={pos:e.l-L,name:c};a[fe.pos]=fe,G.snames.push(c)}else c=(a[O]||{name:""}).name;k.dt==32&&(i["!type"]="chart"),k.dt==64&&(i["!type"]="macro"),ae=[],De=[],G.arrayf=x=[],re=[],ge=[],Oe=!1,R={Hidden:(a[O]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i["!data"][k.r]||[])[k.c]:i[Dt(k.c)+Ht(k.r)])&&++k.c,_={ixfe:k.ixfe,XF:D[k.ixfe]||{},v:k.val,t:"n"},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r);break;case 5:case 517:_={ixfe:k.ixfe,XF:D[k.ixfe],v:k.val,t:k.t},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r);break;case 638:_={ixfe:k.ixfe,XF:D[k.ixfe],v:k.rknum,t:"n"},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r);break;case 189:for(var Ke=k.c;Ke<=k.C;++Ke){var ht=k.rkrec[Ke-k.c][0];_={ixfe:ht,XF:D[ht],v:k.rkrec[Ke-k.c][1],t:"n"},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:Ke,r:k.r},_,r)}break;case 6:case 518:case 1030:{if(k.val=="String"){o=k;break}if(_=Yu(k.val,k.cell.ixfe,k.tt),_.XF=D[_.ixfe],r.cellFormula){var Ae=k.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var Vt=Ae[0][0][1][0],jt=Ae[0][0][1][1],pr=Ft({r:Vt,c:jt});m[pr]?_.f=""+_n(k.formula,s,k.cell,oe,G):_.F=((r.dense?(i["!data"][Vt]||[])[jt]:i[pr])||{}).F}else _.f=""+_n(k.formula,s,k.cell,oe,G)}Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V(k.cell,_,r),o=k}break;case 7:case 519:if(o)o.val=k,_=Yu(k,o.cell.ixfe,"s"),_.XF=D[_.ixfe],r.cellFormula&&(_.f=""+_n(o.formula,s,o.cell,oe,G)),Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V(o.cell,_,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(k);var dn=Ft(k[0].s);if(d=r.dense?(i["!data"][k[0].s.r]||[])[k[0].s.c]:i[dn],r.cellFormula&&d){if(!o||!dn||!d)break;d.f=""+_n(k[1],s,k[0],oe,G),d.F=wt(k[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;m[Ft(o.cell)]=k[0],d=r.dense?(i["!data"][o.cell.r]||[])[o.cell.c]:i[Ft(o.cell)],(d||{}).f=""+_n(k[0],s,f,oe,G)}}break;case 253:_=Yu(l[k.isst].t,k.ixfe,"s"),l[k.isst].h&&(_.h=l[k.isst].h),_.XF=D[_.ixfe],Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r);break;case 513:r.sheetStubs&&(_={ixfe:k.ixfe,XF:D[k.ixfe],t:"z"},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r));break;case 190:if(r.sheetStubs)for(var ve=k.c;ve<=k.C;++ve){var we=k.ixfe[ve-k.c];_={ixfe:we,XF:D[we],t:"z"},Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:ve,r:k.r},_,r)}break;case 214:case 516:case 4:_=Yu(k.val,k.ixfe,"s"),_.XF=D[_.ixfe],Ie>0&&(_.z=_.XF&&_.XF.numFmtId&&Ee[_.XF.numFmtId]||Ee[_.ixfe>>8&63]),zi(_,r,t.opts.Date1904),V({c:k.c,r:k.r},_,r);break;case 0:case 512:le===1&&(s=k);break;case 252:l=k;break;case 1054:if(G.biff>=3&&G.biff<=4){Ee[Ie++]=k[1];for(var ii=0;ii<Ie+163&&et[ii]!=k[1];++ii);ii>=163&&ys(k[1],Ie+163)}else ys(k[1],k[0]);break;case 30:{Ee[Ie++]=k;for(var pn=0;pn<Ie+163&&et[pn]!=k;++pn);pn>=163&&ys(k,Ie+163)}break;case 229:ae=ae.concat(k);break;case 93:De[k.cmo[0]]=G.lastobj=k;break;case 438:G.lastobj.TxO=k;break;case 127:G.lastobj.ImData=k;break;case 440:for(p=k[0].s.r;p<=k[0].e.r;++p)for(v=k[0].s.c;v<=k[0].e.c;++v)d=r.dense?(i["!data"][p]||[])[v]:i[Ft({c:v,r:p})],d&&(d.l=k[1]);break;case 2048:for(p=k[0].s.r;p<=k[0].e.r;++p)for(v=k[0].s.c;v<=k[0].e.c;++v)d=r.dense?(i["!data"][p]||[])[v]:i[Ft({c:v,r:p})],d&&d.l&&(d.l.Tooltip=k[1]);break;case 28:{if(d=r.dense?(i["!data"][k[0].r]||[])[k[0].c]:i[Ft(k[0])],d||(r.dense?(i["!data"][k[0].r]||(i["!data"][k[0].r]=[]),d=i["!data"][k[0].r][k[0].c]={t:"z"}):d=i[Ft(k[0])]={t:"z"},s.e.r=Math.max(s.e.r,k[0].r),s.s.r=Math.min(s.s.r,k[0].r),s.e.c=Math.max(s.e.c,k[0].c),s.s.c=Math.min(s.s.c,k[0].c)),d.c||(d.c=[]),G.biff<=5&&G.biff>=2)g={a:"SheetJ5",t:k[1]};else{var Dr=De[k[2]];g={a:k[1],t:Dr.TxO.t},k[3]!=null&&!(k[3]&2)&&(d.c.hidden=!0)}d.c.push(g)}break;case 2173:$O(D[k.ixfe],k.ext);break;case 125:{if(!G.cellStyles)break;for(;k.e>=k.s;)re[k.e--]={width:k.w/256,level:k.level||0,hidden:!!(k.flags&1)},Oe||(Oe=!0,Qd(k.w/256)),Io(re[k.e+1])}break;case 520:{var Sn={};k.level!=null&&(ge[k.r]=Sn,Sn.level=k.level),k.hidden&&(ge[k.r]=Sn,Sn.hidden=!0),k.hpt&&(ge[k.r]=Sn,Sn.hpt=k.hpt,Sn.hpx=uc(k.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||rc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=k;break;case 161:i["!margins"]||rc(i["!margins"]={}),i["!margins"].header=k.header,i["!margins"].footer=k.footer;break;case 574:k.RTL&&(F.Views[0].RTL=!0);break;case 146:U=k;break;case 2198:pe=k;break;case 140:w=k;break;case 442:c?R.CodeName=k||R.name:F.WBProps.CodeName=k||"ThisWorkbook";break}}else N||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=L}return t.SheetNames=mi(a).sort(function($n,rt){return Number($n)-Number(rt)}).map(function($n){return a[$n].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&lt.forEach(function($n,rt){t.Sheets[t.SheetNames[rt]]["!autofilter"]=$n}),t.Strings=l,t.SSF=Ur(et),G.enc&&(t.Encryption=G.enc),pe&&(t.Themes=pe),t.Metadata={},w!==void 0&&(t.Metadata.Country=w),oe.names.length>0&&(F.Names=oe.names),t.Workbook=F,t}var t_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vR(e,r,t){var n=Tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Lv(n,U4,t_.DSI);for(var a in i)r[a]=i[a]}catch(c){if(t.WTF)throw c}var s=Tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Lv(s,$4,t_.SI);for(var l in o)r[l]==null&&(r[l]=o[l])}catch(c){if(t.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(G_(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Ix(e,r){r||(r={}),ep(r),l_(),r.codepage&&Fd(r.codepage);var t,n;if(e.FullPaths){if(Tt.find(e,"/encryption"))throw new Error("File is password-protected");t=Tt.find(e,"!CompObj"),n=Tt.find(e,"/Workbook")||Tt.find(e,"/Book")}else{switch(r.type){case"base64":e=Gn(qn(e));break;case"binary":e=Gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}zr(e,0),n={content:e}}var i,a;if(t&&dR(t),r.bookProps&&!r.bookSheets)i={};else{var s=xt?"buffer":"array";if(n&&n.content)i=gR(n.content,r);else if((a=Tt.find(e,"PerfectOffice_MAIN"))&&a.content)i=ec.to_workbook(a.content,(r.type=s,r));else if((a=Tt.find(e,"NativeContent_MAIN"))&&a.content)i=ec.to_workbook(a.content,(r.type=s,r));else throw(a=Tt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=s3(e))}var o={};return e.FullPaths&&vR(e,o,r),i.Props=i.Custprops=o,r.bookFiles&&(i.cfb=e),i}var cf={0:{f:ZF},1:{f:rD},2:{f:fD},3:{f:sD},4:{f:iD},5:{f:uD},6:{f:pD},7:{f:lD},8:{f:xD},9:{f:_D},10:{f:gD},11:{f:vD},12:{f:nD},13:{f:hD},14:{f:oD},15:{f:aD},16:{f:bx},17:{f:mD},18:{f:cD},19:{f:Gd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GD},40:{},42:{},43:{f:SO},44:{f:EO},45:{f:TO},46:{f:kO},47:{f:IO},48:{},49:{f:T4},50:{},51:{f:HO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nx},62:{f:dD},63:{f:qO},64:{f:kD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ID},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tD},148:{f:JF,p:16},151:{f:bD},152:{},153:{f:zD},154:{},155:{},156:{f:HD},157:{},158:{},159:{T:1,f:HA},160:{T:-1},161:{T:1,f:Fs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WO},336:{T:-1},337:{f:zO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ed},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CD},427:{f:ED},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ed},551:{f:pf},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:n3},633:{T:1},634:{T:-1},635:{T:1,f:r3},636:{T:-1},637:{f:k4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:MD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kd={6:{f:gd},10:{f:Va},12:{f:Cr},13:{f:Cr},14:{f:Ir},15:{f:Ir},16:{f:yn},17:{f:Ir},18:{f:Ir},19:{f:Cr},20:{f:Uv},21:{f:Uv},23:{f:rx},24:{f:Wv},25:{f:Ir},26:{},27:{},28:{f:iA},29:{},34:{f:Ir},35:{f:$v},38:{f:yn},39:{f:yn},40:{f:yn},41:{f:yn},42:{f:Ir},43:{f:Ir},47:{f:lO},49:{f:Lk},51:{f:Cr},60:{},61:{f:Mk},64:{f:Ir},65:{f:Pk},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:Tk},93:{f:sA},94:{},95:{f:Ir},96:{},97:{},99:{f:Ir},125:{f:nx},128:{f:Qk},129:{f:Ik},130:{f:Cr},131:{f:Ir},132:{f:Ir},133:{f:kk},134:{},140:{f:hA},141:{f:Cr},144:{},146:{f:pA},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:xA},161:{f:gA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Hk},190:{f:zk},193:{f:Va},197:{},198:{},199:{},200:{},201:{},202:{f:Ir},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:Ir},222:{},224:{f:Gk},225:{f:Sk},226:{f:Va},227:{},229:{f:aA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ak},253:{f:Bk},255:{f:Ok},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:X_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ir},353:{f:Va},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Jk},431:{f:Ir},432:{},433:{},434:{},437:{},438:{f:cA},439:{f:Ir},440:{f:uA},441:{},442:{f:pc},443:{},444:{f:Cr},445:{},446:{},448:{f:Va},449:{f:Rk,r:2},450:{f:Va},512:{f:Vv},513:{f:_A},515:{f:Zk},516:{f:Vk},517:{f:Yk},519:{f:yA},520:{f:Fk},523:{},545:{f:zv},549:{f:Bv},566:{},574:{f:Nk},638:{f:Wk},659:{},1048:{},1054:{f:Uk},1084:{},1212:{f:tA},2048:{f:fA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ku},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Va},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mA,r:12},2173:{f:UO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ir,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eA,r:12},2197:{},2198:{f:MO,r:12},2199:{},2200:{},2201:{},2202:{f:rA,r:12},2203:{f:Va},2204:{},2205:{},2206:{},2207:{},2211:{f:Dk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Vv},1:{},2:{f:EA},3:{f:CA},4:{f:bA},5:{f:TA},7:{f:SA},8:{},9:{f:Ku},11:{},22:{f:Cr},30:{f:$k},31:{},32:{},33:{f:zv},36:{},37:{f:Bv},50:{f:IA},62:{},52:{},67:{f:Kk},68:{f:Cr},69:{},86:{},126:{},127:{f:wA},135:{},136:{},137:{},143:{f:AA},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kA},223:{},234:{},354:{},421:{},518:{f:gd},521:{f:Ku},536:{f:Wv},547:{f:$v},561:{},579:{f:qk},1030:{f:gd},1033:{f:Ku},1091:{f:Xk},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function jn(e,r,t,n){var i=r;if(!isNaN(i)){var a=n||(t||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&B_(t)&&e.push(t)}}function r_(e,r){var t=r||{},n=t.dense!=null?t.dense:Ar,i={};n&&(i["!data"]=[]),e=dc(e,"<!--","-->");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,l=s&&s.index||e.length,c=zI(e.slice(o,l),/(:?<tr[^<>]*>)/i,"<tr>"),u=-1,f=0,h=0,d=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<c.length;++o){var p=c[o].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++u,t.sheetRows&&t.sheetRows<=u){--u;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var x=p.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var _=x[l].trim();if(_.match(/<t[dh]/i)){for(var w=_,D=0;w.charAt(0)=="<"&&(D=w.indexOf(">"))>-1;)w=w.slice(D+1);for(var U=0;U<v.length;++U){var F=v[U];F.s.c==f&&F.s.r<u&&u<=F.e.r&&(f=F.e.c+1,U=-1)}var R=Re(_.slice(0,_.indexOf(">")));d=R.colspan?+R.colspan:1,((h=+R.rowspan)>1||d>1)&&v.push({s:{r:u,c:f},e:{r:u+(h||1)-1,c:f+d-1}});var M=R.t||R["data-t"]||"";if(!w.length){f+=d;continue}if(w=O_(w),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>f&&(g.s.c=f),g.e.c<f&&(g.e.c=f),!w.length){f+=d;continue}var W={t:"s",v:w};t.raw||!w.trim().length||M=="s"||(w==="TRUE"?W={t:"b",v:!0}:w==="FALSE"?W={t:"b",v:!1}:isNaN(Kn(w))?isNaN(oc(w).getDate())?w.charCodeAt(0)==35&&sn[w]!=null&&(W.t="e",W.w=w,W.v=sn[w]):(W={t:"d",v:ln(w)},t.UTC===!1&&(W.v=Is(W.v)),t.cellDates||(W={t:"n",v:jr(W.v)}),W.z=t.dateNF||et[14]):W={t:"n",v:Kn(w)}),W.cellText!==!1&&(W.w=w),n?(i["!data"][u]||(i["!data"][u]=[]),i["!data"][u][f]=W):i[Ft({r:u,c:f})]=W,f+=d}}}}return i["!ref"]=wt(g),v.length&&(i["!merges"]=v),i}function _R(e,r,t,n){for(var i=e["!merges"]||[],a=[],s={},o=e["!data"]!=null,l=r.s.c;l<=r.e.c;++l){for(var c=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>t||i[f].s.c>l)&&!(i[f].e.r<t||i[f].e.c<l)){if(i[f].s.r<t||i[f].s.c<l){c=-1;break}c=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(c<0)){var h=Dt(l)+Ht(t),d=o?(e["!data"][t]||[])[l]:e[h];d&&d.t=="n"&&d.v!=null&&!isFinite(d.v)&&(isNaN(d.v)?d={t:"e",v:36,w:Ln[36]}:d={t:"e",v:7,w:Ln[7]});var g=d&&d.v!=null&&(d.h||ql(d.w||(za(d),d.w)||""))||"";s={},c>1&&(s.rowspan=c),u>1&&(s.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":d&&(s["data-t"]=d&&d.t||"z",d.v!=null&&(s["data-v"]=ql(d.v instanceof Date?d.v.toISOString():d.v)),d.z!=null&&(s["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+ql(d.l.Target)+'">'+g+"</a>")),s.id=(n.id||"sjs")+"-"+h,a.push(o4("td",g,s))}}var v="<tr>";return v+a.join("")+"</tr>"}var xR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yR="</body></html>";function wR(e,r){var t=KI(e,"table");if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1){var n=Ka(r_(t[0],r),r);return n.bookType="html",n}var i=rp();return t.forEach(function(a,s){_c(i,r_(a,r),"Sheet"+(s+1))}),i.bookType="html",i}function bR(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function CR(e,r){var t=r||{},n=t.header!=null?t.header:xR,i=t.footer!=null?t.footer:yR,a=[n],s=As(e["!ref"]||"A1");if(a.push(bR(e,s,t)),e["!ref"])for(var o=s.s.r;o<=s.e.r;++o)a.push(_R(e,s,o,t));return a.push("</table>"+i),a.join("")}function kx(e,r,t){var n=r.rows;if(!n)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var i=t||{},a=e["!data"]!=null,s=0,o=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var l=typeof i.origin=="string"?wn(i.origin):i.origin;s=l.r,o=l.c}var c=Math.min(i.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var f=As(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var h=[],d=0,g=e["!rows"]||(e["!rows"]=[]),v=0,p=0,m=0,x=0,_=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<n.length&&p<c;++v){var D=n[v];if(n_(D)){if(i.display)continue;g[p]={hidden:!0}}var U=D.cells;for(m=x=0;m<U.length;++m){var F=U[m];if(!(i.display&&n_(F))){var R=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):O_(F.innerHTML),M=F.getAttribute("data-z")||F.getAttribute("z");for(d=0;d<h.length;++d){var W=h[d];W.s.c==x+o&&W.s.r<p+s&&p+s<=W.e.r&&(x=W.e.c+1-o,d=-1)}w=+F.getAttribute("colspan")||1,((_=+F.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:p+s,c:x+o},e:{r:p+s+(_||1)-1,c:x+o+(w||1)-1}});var B={t:"s",v:R},V=F.getAttribute("data-t")||F.getAttribute("t")||"";R!=null&&(R.length==0?B.t=V||"z":i.raw||R.trim().length==0||V=="s"||(V=="e"&&Ln[+R]?B={t:"e",v:+R,w:Ln[+R]}:R==="TRUE"?B={t:"b",v:!0}:R==="FALSE"?B={t:"b",v:!1}:isNaN(Kn(R))?isNaN(oc(R).getDate())?R.charCodeAt(0)==35&&sn[R]!=null&&(B={t:"e",v:sn[R],w:R}):(B={t:"d",v:ln(R)},i.UTC&&(B.v=ff(B.v)),i.cellDates||(B={t:"n",v:jr(B.v)}),B.z=i.dateNF||et[14]):B={t:"n",v:Kn(R)})),B.z===void 0&&M!=null&&(B.z=M);var G="",pe=F.getElementsByTagName("A");if(pe&&pe.length)for(var ae=0;ae<pe.length&&!(pe[ae].hasAttribute("href")&&(G=pe[ae].getAttribute("href"),G.charAt(0)!="#"));++ae);G&&G.charAt(0)!="#"&&G.slice(0,11).toLowerCase()!="javascript:"&&(B.l={Target:G}),a?(e["!data"][p+s]||(e["!data"][p+s]=[]),e["!data"][p+s][x+o]=B):e[Ft({c:x+o,r:p+s})]=B,u.e.c<x+o&&(u.e.c=x+o),x+=w}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,p-1+s),e["!ref"]=wt(u),p>=c&&(e["!fullref"]=wt((u.e.r=n.length-v+p-1+s,u))),e}function Ax(e,r){var t=r||{},n={};return t.dense&&(n["!data"]=[]),kx(n,e,r)}function ER(e,r){var t=Ka(Ax(e,r),r);return t}function n_(e){var r="",t=SR(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function SR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TR(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=yt(r.replace(/<[^<>]*>/g,""));return[t]}function Ox(e,r,t){var n=t||{},i=hf(e);Vr.lastIndex=0,i=Pd(dc(i,"<!--","-->"));for(var a,s,o="",l="",c,u=0,f=-1,h=!1,d="";a=Vr.exec(i);)switch(a[3]=a[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":a[1]==="/"?(h=!1,s["truncate-on-overflow"]=="false"&&(o.match(/h/)?o=o.replace(/h+/,"[$&]"):o.match(/m/)?o=o.replace(/m+/,"[$&]"):o.match(/s/)&&(o=o.replace(/s+/,"[$&]"))),n[s.name]=o,o=""):a[0].charAt(a[0].length-2)!=="/"&&(h=!0,o="",s=Re(a[0],!1));break;case"boolean-style":a[1]==="/"?(h=!1,n[s.name]="General",o=""):a[0].charAt(a[0].length-2)!=="/"&&(h=!0,o="",s=Re(a[0],!1));break;case"boolean":o+="General";break;case"text":a[1]==="/"?(d=i.slice(f,Vr.lastIndex-a[0].length),d=="%"&&s[0]=="<number:percentage-style"?o+="%":o+='"'+d.replace(/"/g,'""')+'"'):a[0].charAt(a[0].length-2)!=="/"&&(f=Vr.lastIndex);break;case"day":switch(c=Re(a[0],!1),c.style){case"short":o+="d";break;case"long":o+="dd";break;default:o+="dd";break}break;case"day-of-week":switch(c=Re(a[0],!1),c.style){case"short":o+="ddd";break;case"long":o+="dddd";break;default:o+="ddd";break}break;case"era":switch(c=Re(a[0],!1),c.style){case"short":o+="ee";break;case"long":o+="eeee";break;default:o+="eeee";break}break;case"hours":switch(c=Re(a[0],!1),c.style){case"short":o+="h";break;case"long":o+="hh";break;default:o+="hh";break}break;case"minutes":switch(c=Re(a[0],!1),c.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="mm";break}break;case"month":switch(c=Re(a[0],!1),c.textual&&(o+="mm"),c.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="m";break}break;case"seconds":{switch(c=Re(a[0],!1),c.style){case"short":o+="s";break;case"long":o+="ss";break;default:o+="ss";break}c["decimal-places"]&&(o+="."+St("0",+c["decimal-places"]))}break;case"year":switch(c=Re(a[0],!1),c.style){case"short":o+="yy";break;case"long":o+="yyyy";break;default:o+="yy";break}break;case"am-pm":o+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+a[3]);break;case"fill-character":a[1]==="/"?(d=i.slice(f,Vr.lastIndex-a[0].length),o+='"'+d.replace(/"/g,'""')+'"*'):a[0].charAt(a[0].length-2)!=="/"&&(f=Vr.lastIndex);break;case"scientific-number":c=Re(a[0],!1),o+="0."+St("0",+c["min-decimal-places"]||+c["decimal-places"]||2)+St("?",+c["decimal-places"]-+c["min-decimal-places"]||0)+"E"+(Wt(c["forced-exponent-sign"])?"+":"")+St("0",+c["min-exponent-digits"]||2);break;case"fraction":c=Re(a[0],!1),+c["min-integer-digits"]?o+=St("0",+c["min-integer-digits"]):o+="#",o+=" ",o+=St("?",+c["min-numerator-digits"]||1),o+="/",+c["denominator-value"]?o+=c["denominator-value"]:o+=St("?",+c["min-denominator-digits"]||1);break;case"currency-symbol":a[1]==="/"?o+='"'+i.slice(f,Vr.lastIndex-a[0].length).replace(/"/g,'""')+'"':a[0].charAt(a[0].length-2)!=="/"?f=Vr.lastIndex:o+="$";break;case"text-properties":switch(c=Re(a[0],!1),(c.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":o="[Red]"+o;break}break;case"text-content":o+="@";break;case"map":c=Re(a[0],!1),yt(c.condition)=="value()>=0"?o=n[c["apply-style-name"]]+";"+o:console.error("ODS number format may be incorrect: "+c.condition);break;case"number":if(a[1]==="/")break;c=Re(a[0],!1),l="",l+=St("0",+c["min-integer-digits"]||1),Wt(c.grouping)&&(l=ca(St("#",Math.max(0,4-l.length))+l)),(+c["min-decimal-places"]||+c["decimal-places"])&&(l+="."),+c["min-decimal-places"]&&(l+=St("0",+c["min-decimal-places"]||1)),+c["decimal-places"]-(+c["min-decimal-places"]||0)&&(l+=St("0",+c["decimal-places"]-(+c["min-decimal-places"]||0))),o+=l;break;case"embedded-text":a[1]==="/"?u==0?o+='"'+i.slice(f,Vr.lastIndex-a[0].length).replace(/"/g,'""')+'"':o=o.slice(0,u)+'"'+i.slice(f,Vr.lastIndex-a[0].length).replace(/"/g,'""')+'"'+o.slice(u):a[0].charAt(a[0].length-2)!=="/"&&(f=Vr.lastIndex,u=-+Re(a[0],!1).position||0);break}return n}function Fx(e,r,t){var n=r||{};Ar!=null&&n.dense==null&&(n.dense=Ar);var i=hf(e),a=[],s,o,l,c="",u=0,f,h,d={},g=[],v={};n.dense&&(v["!data"]=[]);var p,m,x={value:""},_={},w="",D=0,U,F="",R=0,M=[],W=[],B=-1,V=-1,G={s:{r:1e6,c:1e7},e:{r:0,c:0}},pe=0,ae=t||{},De={},re=[],ge={},Oe=0,oe=0,We=[],le=1,Ie=1,Ee=[],lt={Names:[],WBProps:{}},Me={},qe=["",""],O=[],H={},L="",N=0,se=!1,k=!1,Le=0;for(Vr.lastIndex=0,i=Pd(dc(i,"<!--","-->"));p=Vr.exec(i);)switch(p[3]=p[3].replace(/_[\s\S]*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(G.e.c>=G.s.c&&G.e.r>=G.s.r?v["!ref"]=wt(G):v["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=G.e.r&&(v["!fullref"]=v["!ref"],G.e.r=n.sheetRows-1,v["!ref"]=wt(G)),re.length&&(v["!merges"]=re),We.length&&(v["!rows"]=We),f.name=f.\u540D\u79F0||f.name,typeof JSON<"u"&&JSON.stringify(f),g.push(f.name),d[f.name]=v,k=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Re(p[0],!1),B=V=-1,G.s.r=G.s.c=1e7,G.e.r=G.e.c=0,v={},n.dense&&(v["!data"]=[]),re=[],We=[],k=!0);break;case"table-row-group":p[1]==="/"?--pe:++pe;break;case"table-row":case"\u884C":if(p[1]==="/"){B+=le,le=1;break}if(h=Re(p[0],!1),h.\u884C\u53F7?B=h.\u884C\u53F7-1:B==-1&&(B=0),le=+h["number-rows-repeated"]||1,le<10)for(Le=0;Le<le;++Le)pe>0&&(We[B+Le]={level:pe});V=-1;break;case"covered-table-cell":if(p[1]!=="/")if(++V,x=Re(p[0],!1),Ie=parseInt(x["number-columns-repeated"]||"1",10)||1,n.sheetStubs){for(;Ie-- >0;)n.dense?(v["!data"][B]||(v["!data"][B]=[]),v["!data"][B][V]={t:"z"}):v[Ft({r:B,c:V})]={t:"z"},++V;--V}else V+=Ie-1;w="",M=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++V,x=Re(p[0],!1),Ie=parseInt(x["number-columns-repeated"]||"1",10)||1,m={t:"z",v:null},x.formula&&n.cellFormula!=!1&&(m.f=Zv(yt(x.formula))),x["style-name"]&&De[x["style-name"]]&&(m.z=De[x["style-name"]]),(x.\u6570\u636E\u7C7B\u578B||x["value-type"])=="string"&&(m.t="s",m.v=yt(x["string-value"]||""),n.dense?(v["!data"][B]||(v["!data"][B]=[]),v["!data"][B][V]=m):v[Dt(V)+Ht(B)]=m),V+=Ie-1;else if(p[1]!=="/"){++V,w=F="",D=R=0,M=[],W=[],Ie=1;var be=le?B+le-1:B;if(V>G.e.c&&(G.e.c=V),V<G.s.c&&(G.s.c=V),B<G.s.r&&(G.s.r=B),be>G.e.r&&(G.e.r=be),x=Re(p[0],!1),_=JI(p[0],!0),O=[],H={},m={t:x.\u6570\u636E\u7C7B\u578B||x["value-type"],v:null},x["style-name"]&&De[x["style-name"]]&&(m.z=De[x["style-name"]]),n.cellFormula)if(x.formula&&(x.formula=yt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(Oe=parseInt(x["number-matrix-rows-spanned"],10)||0,oe=parseInt(x["number-matrix-columns-spanned"],10)||0,ge={s:{r:B,c:V},e:{r:B+Oe-1,c:V+oe-1}},m.F=wt(ge),Ee.push([ge,m.F])),x.formula)m.f=Zv(x.formula);else for(Le=0;Le<Ee.length;++Le)B>=Ee[Le][0].s.r&&B<=Ee[Le][0].e.r&&V>=Ee[Le][0].s.c&&V<=Ee[Le][0].e.c&&(m.F=Ee[Le][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(Oe=parseInt(x["number-rows-spanned"]||"1",10)||1,oe=parseInt(x["number-columns-spanned"]||"1",10)||1,Oe*oe>1&&(ge={s:{r:B,c:V},e:{r:B+Oe-1,c:V+oe-1}},re.push(ge))),x["number-columns-repeated"]&&(Ie=parseInt(x["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Wt(x["boolean-value"])||+x["boolean-value"]>=1;break;case"float":m.t="n",m.v=parseFloat(x.value),n.cellDates&&m.z&&Ai(m.z)&&(m.v=Wa(m.v+(lt.WBProps.date1904?1462:0)),m.t=typeof m.v=="number"?"n":"d");break;case"percentage":m.t="n",m.v=parseFloat(x.value);break;case"currency":m.t="n",m.v=parseFloat(x.value);break;case"date":m.t="d",m.v=ln(x["date-value"],lt.WBProps.date1904),n.cellDates||(m.t="n",m.v=jr(m.v,lt.WBProps.date1904)),m.z||(m.z="m/d/yy");break;case"time":m.t="n",m.v=MI(x["time-value"])/86400,n.cellDates&&(m.v=Wa(m.v),m.t=typeof m.v=="number"?"n":"d"),m.z||(m.z="HH:MM:SS");break;case"number":m.t="n",m.v=parseFloat(x.\u6570\u636E\u6570\u503C);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",x["string-value"]!=null&&(w=yt(x["string-value"]),M=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(se=!1,_["calcext:value-type"]=="error"&&sn[w]!=null&&(m.t="e",m.w=w,m.v=sn[w]),m.t==="s"&&(m.v=w||"",M.length&&(m.R=M),se=D==0),Me.Target&&(m.l=Me),O.length>0&&(m.c=O,O=[]),w&&n.cellText!==!1&&(m.w=w),se&&(m.t="z",delete m.v),(!se||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var fe=0;fe<le;++fe){if(Ie=parseInt(x["number-columns-repeated"]||"1",10),n.dense)for(v["!data"][B+fe]||(v["!data"][B+fe]=[]),v["!data"][B+fe][V]=fe==0?m:Ur(m);--Ie>0;)v["!data"][B+fe][V+Ie]=Ur(m);else for(v[Ft({r:B+fe,c:V})]=m;--Ie>0;)v[Ft({r:B+fe,c:V+Ie})]=Ur(m);G.e.c<=V&&(G.e.c=V)}Ie=parseInt(x["number-columns-repeated"]||"1",10),V+=Ie-1,Ie=0,m={},w="",M=[]}Me={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;H.t=w,M.length&&(H.R=M),H.a=L,O.push(H),w=F,D=R,M=W}else if(p[0].charAt(p[0].length-2)!=="/"){a.push([p[3],!1]);var Ke=Re(p[0],!0);Ke.display&&Wt(Ke.display)||(O.hidden=!0),F=w,R=D,W=M,w="",D=0,M=[]}L="",N=0;break;case"creator":p[1]==="/"?L=i.slice(N,p.index):N=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",D=0,M=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){var ht=Vr.lastIndex;Ox(i.slice(l,Vr.lastIndex),r,ae),Vr.lastIndex=ht}else p[0].charAt(p[0].length-2)!=="/"&&(l=Vr.lastIndex-p[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var Ae=Re(p[0],!1);Ae.family=="table-cell"&&ae[Ae["data-style-name"]]&&(De[Ae.name]=ae[Ae["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=i.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Re(p[0],!1),qe=vd(o["cell-range-address"]);var Vt={Name:o.name,Ref:qe[0]+"!"+qe[1]};k&&(Vt.Sheet=g.length),lt.Names.push(Vt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(o=Re(p[0],!1),o["date-value"]){case"1904-01-01":lt.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var jt=TR(i.slice(D,p.index),U);w=(w.length>0?w+`
`:"")+jt[0]}else p[0].slice(-2)=="/>"?w+=`
`:(U=Re(p[0],!1),D=p.index+p[0].length);break;case"s":break;case"database-range":if(p[1]==="/")break;try{qe=vd(Re(p[0])["target-range-address"]),d[qe[0]]["!autofilter"]={ref:qe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Me=Re(p[0],!1),!Me.href)break;Me.Target=yt(Me.href),delete Me.href,Me.Target.charAt(0)=="#"&&Me.Target.indexOf(".")>-1?(qe=vd(Me.Target.slice(1)),Me.Target="#"+qe[0]+"!"+qe[1]):Me.Target.match(/^\.\.[\\\/]/)&&(Me.Target=Me.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(n.WTF)throw new Error(p)}}var pr={Sheets:d,SheetNames:g,Workbook:lt};return n.bookSheets&&delete pr.Sheets,pr}function i_(e,r){r=r||{},pi(e,"META-INF/manifest.xml")&&q4(Br(e,"META-INF/manifest.xml"),r);var t=On(e,"styles.xml"),n=t&&Ox(Xt(t),r),i=On(e,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var a=Fx(Xt(i),r,n);return pi(e,"meta.xml")&&(a.Props=j_(Br(e,"meta.xml"))),a.bookType="ods",a}function a_(e,r){var t=Fx(e,r);return t.bookType="fods",t}var on=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function fc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Eo(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(da(e))}function Dx(e){for(var r=0,t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0;t<e.length;++t){var a=e[t],s=a.length;if(s<250)for(var o=0;o<s;++o)n[i++]=a[o];else n.set(a,i),i+=s}return n}function ic(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function IR(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,i=r+13;i>=r;--i)n=n*256+e[i];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function uf(e,r){var t=r.l,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r.l=t,n}function Ot(e){var r=0,t=e[r]&127;return e[r++]<128||(t|=(e[r]&127)<<7,e[r++]<128)||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128)||(t|=(e[r]&15)<<28),t}function vt(e){for(var r=[],t={l:0};t.l<e.length;){var n=t.l,i=uf(e,t),a=i&7;i=i/8|0;var s,o=t.l;switch(a){case 0:{for(;e[o++]>=128;);s=e[on](t.l,o),t.l=o}break;case 1:s=e[on](o,o+8),t.l=o+8;break;case 2:{var l=uf(e,t);s=e[on](t.l,t.l+l),t.l+=l}break;case 5:s=e[on](o,o+4),t.l=o+4;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:s,type:a};r[i]==null&&(r[i]=[]),r[i].push(c)}return r}function xf(e,r){return e?.map(function(t){return r(t.data)})||[]}function kR(e){for(var r,t=[],n={l:0};n.l<e.length;){var i=uf(e,n),a=vt(e[on](n.l,n.l+i));n.l+=i;var s={id:Ot(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=vt(o.data),c=Ot(l[3][0].data);s.messages.push({meta:l,data:e[on](n.l,n.l+c)}),n.l+=c}),(r=a[3])!=null&&r[0]&&(s.merge=Ot(a[3][0].data)>>>0>0),t.push(s)}return t}function AR(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t={l:0},n=uf(r,t),i=[],a=t.l;a<r.length;){var s=r[a]&3;if(s==0){var o=r[a++]>>2;if(o<60)++o;else{var l=o-59;o=r[a],l>1&&(o|=r[a+1]<<8),l>2&&(o|=r[a+2]<<16),l>3&&(o|=r[a+3]<<24),o>>>=0,o++,a+=l}i.push(r[on](a,a+o)),a+=o;continue}else{var c=0,u=0;if(s==1?(u=(r[a]>>2&7)+4,c=(r[a++]&224)<<3,c|=r[a++]):(u=(r[a++]>>2)+1,s==2?(c=r[a]|r[a+1]<<8,a+=2):(c=(r[a]|r[a+1]<<8|r[a+2]<<16|r[a+3]<<24)>>>0,a+=4)),c==0)throw new Error("Invalid offset 0");for(var f=i.length-1,h=c;f>=0&&h>=i[f].length;)h-=i[f].length,--f;if(f<0)if(h==0)h=i[f=0].length;else throw new Error("Invalid offset beyond length");if(u<h)i.push(i[f][on](i[f].length-h,i[f].length-h+u));else{for(h>0&&(i.push(i[f][on](i[f].length-h)),u-=h),++f;u>=i[f].length;)i.push(i[f]),u-=i[f].length,++f;u&&i.push(i[f][on](0,u))}i.length>25&&(i=[Dx(i)])}}for(var d=0,g=0;g<i.length;++g)d+=i[g].length;if(d!=n)throw new Error("Unexpected length: ".concat(d," != ").concat(n));return i}function OR(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push.apply(r,AR(n,e[on](t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:Dx(r)}var FR=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function Rx(e,r,t,n,i){var a,s,o,l,c=r&255,u=r>>8,f=u>=5?i:n;e:if(t&(u>4?8:4)&&e.t=="n"&&c==7){var h=(a=f[7])!=null&&a[0]?Ot(f[7][0].data):-1;if(h==-1)break e;var d=(s=f[15])!=null&&s[0]?Ot(f[15][0].data):-1,g=(o=f[16])!=null&&o[0]?Ot(f[16][0].data):-1,v=(l=f[40])!=null&&l[0]?Ot(f[40][0].data):-1,p=e.v,m=p;t:if(v){if(p==0){d=g=2;break t}p>=604800?d=1:p>=86400?d=2:p>=3600?d=4:p>=60?d=8:p>=1?d=16:d=32,Math.floor(p)!=p?g=32:p%60?g=16:p%3600?g=8:p%86400?g=4:p%604800&&(g=2),g<d&&(g=d)}if(d==-1||g==-1)break e;var x=[],_=[];d==1&&(m=p/604800,g==1?_.push('d"d"'):(m|=0,p-=604800*m),x.push(m+(h==2?" week"+(m==1?"":"s"):h==1?"w":""))),d<=2&&g>=2&&(m=p/86400,g>2&&(m|=0,p-=86400*m),_.push('d"d"'),x.push(m+(h==2?" day"+(m==1?"":"s"):h==1?"d":""))),d<=4&&g>=4&&(m=p/3600,g>4&&(m|=0,p-=3600*m),_.push((d>=4?"[h]":"h")+'"h"'),x.push(m+(h==2?" hour"+(m==1?"":"s"):h==1?"h":""))),d<=8&&g>=8&&(m=p/60,g>8&&(m|=0,p-=60*m),_.push((d>=8?"[m]":"m")+'"m"'),h==0?x.push((d==8&&g==8||m>=10?"":"0")+m):x.push(m+(h==2?" minute"+(m==1?"":"s"):h==1?"m":""))),d<=16&&g>=16&&(m=p,g>16&&(m|=0,p-=m),_.push((d>=16?"[s]":"s")+'"s"'),h==0?x.push((g==16&&d==16||m>=10?"":"0")+m):x.push(m+(h==2?" second"+(m==1?"":"s"):h==1?"s":""))),g>=32&&(m=Math.round(1e3*p),d<32&&_.push('.000"ms"'),h==0?x.push((m>=100?"":m>=10?"0":"00")+m):x.push(m+(h==2?" millisecond"+(m==1?"":"s"):h==1?"ms":""))),e.w=x.join(h==0?":":" "),e.z=_.join(h==0?'":"':" "),h==0&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function DR(e,r,t,n){var i=fc(e),a=i.getUint32(4,!0),s=-1,o=-1,l=-1,c=NaN,u=0,f=new Date(Date.UTC(2001,0,1)),h=t>1?12:8;a&2&&(l=i.getUint32(h,!0),h+=4),h+=ic(a&(t>1?3468:396))*4,a&512&&(s=i.getUint32(h,!0),h+=4),h+=ic(a&(t>1?12288:4096))*4,a&16&&(o=i.getUint32(h,!0),h+=4),a&32&&(c=i.getFloat64(h,!0),h+=8),a&64&&(f.setTime(f.getTime()+(u=i.getFloat64(h,!0))*1e3),h+=8),t>1&&(a=i.getUint32(8,!0)>>>16,a&255&&(l==-1&&(l=i.getUint32(h,!0)),h+=4));var d,g=e[t>=4?1:2];switch(g){case 0:return;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:r.sst[o]};break;case 5:n?.cellDates?d={t:"d",v:f}:d={t:"n",v:u/86400+35430,z:et[14]};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1){var v=r.rsst[s];d={t:"s",v:v.v},v.l&&(d.l={Target:v.l})}else throw new Error("Unsupported cell type ".concat(e[on](0,4)));break;default:throw new Error("Unsupported cell type ".concat(e[on](0,4)))}return l>-1&&Rx(d,g|t<<8,a,r.ofmt[l],r.nfmt[l]),g==7&&(d.v/=86400),d}function RR(e,r,t){var n=fc(e),i=n.getUint32(4,!0),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=-1,u=NaN,f=NaN,h=0,d=new Date(Date.UTC(2001,0,1)),g=-1,v=-1;a&1&&(u=IR(e,s),s+=16),a&2&&(f=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+(h=n.getFloat64(s,!0))*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4),s+=ic(a&480)*4,a&512&&(v=n.getUint32(s,!0),s+=4),s+=ic(a&1024)*4,a&2048&&(g=n.getUint32(s,!0),s+=4);var p,m=e[1];switch(m){case 0:p={t:"z"};break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:r.sst[l]};break;case 5:t?.cellDates?p={t:"d",v:d}:p={t:"n",v:h/86400+35430,z:et[14]};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1){var x=r.rsst[o];p={t:"s",v:x.v},x.l&&(p.l={Target:x.l})}else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e[on](0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e[on](0,4)))}if(s+=ic(a&4096)*4,a&516096&&(c==-1&&(c=n.getUint32(s,!0)),s+=4),a&524288){var _=n.getUint32(s,!0);s+=4,r.cmnt[_]&&(p.c=LR(r.cmnt[_]))}return c>-1&&Rx(p,m|1280,a>>13,r.ofmt[c],r.nfmt[c]),m==7&&(p.v/=86400),p}function MR(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return DR(e,r,e[0],t);case 5:return RR(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Qr(e){var r=vt(e);return Ot(r[1][0].data)}function _s(e,r){var t=vt(r.data),n=Ot(t[1][0].data),i=t[3],a=[];return(i||[]).forEach(function(s){var o,l,c=vt(s.data);if(c[1]){var u=Ot(c[1][0].data)>>>0;switch(n){case 1:a[u]=Eo(c[3][0].data);break;case 8:{var f=e[Qr(c[9][0].data)][0],h=vt(f.data),d=e[Qr(h[1][0].data)][0],g=Ot(d.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=vt(d.data),p={v:v[3].map(function(_){return Eo(_.data)}).join("")};a[u]=p;e:if((o=v?.[11])!=null&&o[0]){var m=(l=vt(v[11][0].data))==null?void 0:l[1];if(!m)break e;m.forEach(function(_){var w,D,U,F=vt(_.data);if((w=F[2])!=null&&w[0]){var R=e[Qr((D=F[2])==null?void 0:D[0].data)][0],M=Ot(R.meta[1][0].data);switch(M){case 2032:var W=vt(R.data);(U=W?.[2])!=null&&U[0]&&!p.l&&(p.l=Eo(W[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(M))}}})}}break;case 2:a[u]=vt(c[6][0].data);break;case 3:a[u]=vt(c[5][0].data);break;case 10:{var x=e[Qr(c[10][0].data)][0];a[u]=Mx(e,x.data)}break;default:throw n}}}),a}function NR(e,r){var t,n,i,a,s,o,l,c,u,f,h,d,g,v,p=vt(e),m=Ot(p[1][0].data)>>>0,x=Ot(p[2][0].data)>>>0,_=((n=(t=p[8])==null?void 0:t[0])==null?void 0:n.data)&&Ot(p[8][0].data)>0||!1,w,D;if((a=(i=p[7])==null?void 0:i[0])!=null&&a.data&&r!=0)w=(o=(s=p[7])==null?void 0:s[0])==null?void 0:o.data,D=(c=(l=p[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=p[4])==null?void 0:u[0])!=null&&f.data&&r!=1)w=(d=(h=p[4])==null?void 0:h[0])==null?void 0:d.data,D=(v=(g=p[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var U=_?4:1,F=fc(w),R=[],M=0;M<w.length/2;++M){var W=F.getUint16(M*2,!0);W<65535&&R.push([M,W])}if(R.length!=x)throw"Expected ".concat(x," cells, found ").concat(R.length);var B=[];for(M=0;M<R.length-1;++M)B[R[M][0]]=D[on](R[M][1]*U,R[M+1][1]*U);return R.length>=1&&(B[R[R.length-1][0]]=D[on](R[R.length-1][1]*U)),{R:m,cells:B}}function PR(e,r){var t,n=vt(r.data),i=-1;(t=n?.[7])!=null&&t[0]&&(Ot(n[7][0].data)>>>0?i=1:i=0);var a=xf(n[5],function(s){return NR(s,i)});return{nrows:Ot(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function Mx(e,r){var t,n,i,a,s,o,l,c,u,f,h={t:"",a:""},d=vt(r);if((n=(t=d?.[1])==null?void 0:t[0])!=null&&n.data&&(h.t=Eo((a=(i=d?.[1])==null?void 0:i[0])==null?void 0:a.data)||""),(o=(s=d?.[3])==null?void 0:s[0])!=null&&o.data){var g=e[Qr((c=(l=d?.[3])==null?void 0:l[0])==null?void 0:c.data)][0],v=vt(g.data);(f=(u=v[1])==null?void 0:u[0])!=null&&f.data&&(h.a=Eo(v[1][0].data))}return d?.[4]&&(h.replies=[],d[4].forEach(function(p){var m=e[Qr(p.data)][0];h.replies.push(Mx(e,m.data))})),h}function LR(e){var r=[];return r.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(t){r.push({t:t.t||"",a:t.a,T:!0})}),r}function BR(e,r,t,n){var i,a,s,o,l,c,u,f,h,d,g,v,p,m,x=vt(r.data),_={s:{r:0,c:0},e:{r:0,c:0}};if(_.e.r=(Ot(x[6][0].data)>>>0)-1,_.e.r<0)throw new Error("Invalid row varint ".concat(x[6][0].data));if(_.e.c=(Ot(x[7][0].data)>>>0)-1,_.e.c<0)throw new Error("Invalid col varint ".concat(x[7][0].data));t["!ref"]=wt(_);var w=t["!data"]!=null,D=t,U=vt(x[4][0].data),F=FR();(i=U[4])!=null&&i[0]&&(F.sst=_s(e,e[Qr(U[4][0].data)][0])),(a=U[6])!=null&&a[0]&&(F.fmla=_s(e,e[Qr(U[6][0].data)][0])),(s=U[11])!=null&&s[0]&&(F.ofmt=_s(e,e[Qr(U[11][0].data)][0])),(o=U[12])!=null&&o[0]&&(F.ferr=_s(e,e[Qr(U[12][0].data)][0])),(l=U[17])!=null&&l[0]&&(F.rsst=_s(e,e[Qr(U[17][0].data)][0])),(c=U[19])!=null&&c[0]&&(F.cmnt=_s(e,e[Qr(U[19][0].data)][0])),(u=U[22])!=null&&u[0]&&(F.nfmt=_s(e,e[Qr(U[22][0].data)][0]));var R=vt(U[3][0].data),M=0;if(!((f=U[9])!=null&&f[0]))throw"NUMBERS file missing row tree";var W=vt(U[9][0].data)[1].map(function(ae){return vt(ae.data)});if(W.forEach(function(ae){M=Ot(ae[1][0].data);var De=Ot(ae[2][0].data),re=R[1][De];if(!re)throw"NUMBERS missing tile "+De;var ge=vt(re.data),Oe=e[Qr(ge[2][0].data)][0],oe=Ot(Oe.meta[1][0].data);if(oe!=6002)throw new Error("6001 unexpected reference to ".concat(oe));var We=PR(e,Oe);We.data.forEach(function(le,Ie){le.forEach(function(Ee,lt){var Me=MR(Ee,F,n);Me&&(w?(D["!data"][M+Ie]||(D["!data"][M+Ie]=[]),D["!data"][M+Ie][lt]=Me):t[Dt(lt)+Ht(M+Ie)]=Me)})}),M+=We.nrows}),(h=U[13])!=null&&h[0]){var B=e[Qr(U[13][0].data)][0],V=Ot(B.meta[1][0].data);if(V!=6144)throw new Error("Expected merge type 6144, found ".concat(V));t["!merges"]=(d=vt(B.data))==null?void 0:d[1].map(function(ae){var De=vt(ae.data),re=fc(vt(De[1][0].data)[1][0].data),ge=fc(vt(De[2][0].data)[1][0].data);return{s:{r:re.getUint16(0,!0),c:re.getUint16(2,!0)},e:{r:re.getUint16(0,!0)+ge.getUint16(0,!0)-1,c:re.getUint16(2,!0)+ge.getUint16(2,!0)-1}}})}if(!((g=t["!merges"])!=null&&g.length)&&((v=x[47])!=null&&v[0])){var G=vt(x[47][0].data);if((p=G[2])!=null&&p[0]){var pe=vt(G[2][0].data);(m=pe[3])!=null&&m[0]&&(t["!merges"]=xf(pe[3],function(ae){var De,re,ge,Oe,oe,We=vt(ae),le=vt(We[2][0].data),Ie=vt(le[1][0].data);if((De=Ie[1])!=null&&De[0]){var Ee=vt(Ie[1][0].data),lt=Ot(Ee[1][0].data);if(lt==67){var Me=vt(Ee[40][0].data);if(!(!((re=Me[3])!=null&&re[0])||!((ge=Me[4])!=null&&ge[0]))){var qe=vt(Me[3][0].data),O=vt(Me[4][0].data),H=Ot(qe[1][0].data),L=(Oe=qe[2])!=null&&Oe[0]?Ot(qe[2][0].data):H,N=Ot(O[1][0].data),se=(oe=O[2])!=null&&oe[0]?Ot(O[2][0].data):N;return{s:{r:N,c:H},e:{r:se,c:L}}}}}}).filter(function(ae){return ae!=null}))}}}function VR(e,r,t){var n=vt(r.data),i={"!ref":"A1"};t?.dense&&(i["!data"]=[]);var a=e[Qr(n[2][0].data)],s=Ot(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return BR(e,a[0],i,t),i}function UR(e,r,t){var n,i=vt(r.data),a={name:(n=i[1])!=null&&n[0]?Eo(i[1][0].data):"",sheets:[]},s=xf(i[2],Qr);return s.forEach(function(o){e[o].forEach(function(l){var c=Ot(l.meta[1][0].data);c==6e3&&a.sheets.push(VR(e,l,t))})}),a}function $R(e,r,t){var n,i=rp();i.Workbook={WBProps:{date1904:!0}};var a=vt(r.data);if((n=a[2])!=null&&n[0])throw new Error("Keynote presentations are not supported");var s=xf(a[1],Qr);if(s.forEach(function(o){e[o].forEach(function(l){var c=Ot(l.meta[1][0].data);if(c==2){var u=UR(e,l,t);u.sheets.forEach(function(f,h){_c(i,f,h==0?u.name:u.name+"_"+h,!0)})}})}),i.SheetNames.length==0)throw new Error("Empty NUMBERS file");return i.bookType="numbers",i}function xd(e,r){var t,n,i,a,s,o,l,c={},u=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)&&h.content[0]==0){var d;try{d=OR(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var g;try{g=kR(d)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){c[v.id]=v.messages,u.push(v.id)})}}),!u.length)throw new Error("File has no messages");if((i=(n=(t=c?.[1])==null?void 0:t[0].meta)==null?void 0:n[1])!=null&&i[0].data&&Ot(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var f=((l=(o=(s=(a=c?.[1])==null?void 0:a[0])==null?void 0:s.meta)==null?void 0:o[1])==null?void 0:l[0].data)&&Ot(c[1][0].meta[1][0].data)==1&&c[1][0];if(f||u.forEach(function(h){c[h].forEach(function(d){var g=Ot(d.meta[1][0].data)>>>0;if(g==1)if(!f)f=d;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return $R(c,f,r)}function WR(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function ep(e){WR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function HR(e){return oa.WS.indexOf(e)>-1?"sheet":oa.CS&&e==oa.CS?"chart":oa.DS&&e==oa.DS?"dialog":oa.MS&&e==oa.MS?"macro":e&&e.length?e:"sheet"}function zR(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,HR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function jR(e,r,t,n,i,a,s,o){if(!(!e||!e["!legdrawel"])){var l=wo(e["!legdrawel"].Target,n),c=On(t,l,!0);c&&ZO(Xt(c),e,o||[])}}function GR(e,r,t,n,i,a,s,o,l,c,u,f){try{a[n]=Zl(On(e,t,!0),r);var h=Br(e,r),d;switch(o){case"sheet":d=XD(h,r,i,l,a[n],c,u,f);break;case"chart":if(d=QD(h,r,i,l,a[n],c,u,f),!d||!d["!drawel"])break;var g=wo(d["!drawel"].Target,r),v=Sd(g),p=YO(On(e,g,!0),Zl(On(e,v,!0),g)),m=wo(p,g),x=Sd(m);d=DD(On(e,m,!0),m,l,Zl(On(e,x,!0),m),c,d);break;case"macro":d=YD(h,r,i,l,a[n],c,u,f);break;case"dialog":d=ZD(h,r,i,l,a[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=d;var _=[],w=[];a&&a[n]&&mi(a[n]).forEach(function(D){var U="";if(a[n][D].Type==oa.CMNT){if(U=wo(a[n][D].Target,r),_=tR(Br(e,U,!0),U,l),!_||!_.length)return;Gv(d,_,!1)}a[n][D].Type==oa.TCMNT&&(U=wo(a[n][D].Target,r),w=w.concat(e3(Br(e,U,!0),l)))}),w&&w.length&&Gv(d,w,!0,l.people||[]),jR(d,o,e,r,i,l,c,_)}catch(D){if(l.WTF)throw D}}function hi(e){return e.charAt(0)=="/"?e.slice(1):e}function KR(e,r){if(x_(),r=r||{},ep(r),pi(e,"META-INF/manifest.xml")||pi(e,"objectdata.xml"))return i_(e,r);if(pi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xd<"u"){if(e.FileIndex)return xd(e,r);var t=Tt.utils.cfb_new();return _v(e).forEach(function(ae){XI(t,ae,S_(e,ae))}),xd(t,r)}throw new Error("Unsupported NUMBERS file")}if(!pi(e,"[Content_Types].xml")){if(pi(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(pi(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=Tt.find(e,"Index.zip");if(n)return r=Ur(r),delete r.type,typeof n.content=="string"&&(r.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(n.content)?Es(new Uint8Array(n.content),r):Es(n.content,r);throw new Error("Unsupported ZIP file")}var i=_v(e),a=G4(On(e,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Br(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Br(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!r.bookSheets&&!r.bookProps){if(tc=[],a.sst)try{tc=eR(Br(e,hi(a.sst)),a.sst,r)}catch(ae){if(r.WTF)throw ae}r.cellStyles&&a.themes.length&&(c=fx(On(e,a.themes[0].replace(/^\//,""),!0)||"",r)),a.style&&(u=JD(Br(e,hi(a.style)),a.style,c,r))}a.links.map(function(ae){try{var De=Zl(On(e,Sd(hi(ae))),ae);return nR(Br(e,hi(ae)),De,ae,r)}catch{}});var f=qD(Br(e,hi(a.workbooks[0])),a.workbooks[0],r),h={},d="";a.coreprops.length&&(d=Br(e,hi(a.coreprops[0]),!0),d&&(h=j_(d)),a.extprops.length!==0&&(d=Br(e,hi(a.extprops[0]),!0),d&&Q4(d,h,r)));var g={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(d=On(e,hi(a.custprops[0]),!0),d&&(g=Z4(d,r)));var v={};if((r.bookSheets||r.bookProps)&&(f.Sheets?o=f.Sheets.map(function(De){return De.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),r.bookProps&&(v.Props=h,v.Custprops=g),r.bookSheets&&typeof o<"u"&&(v.SheetNames=o),r.bookSheets?v.SheetNames:r.bookProps))return v;o={};var p={};r.bookDeps&&a.calcchain&&(p=rR(Br(e,hi(a.calcchain)),a.calcchain,r));var m=0,x={},_,w;{var D=f.Sheets;h.Worksheets=D.length,h.SheetNames=[];for(var U=0;U!=D.length;++U)h.SheetNames[U]=D[U].name}var F=s?"bin":"xml",R=a.workbooks[0].lastIndexOf("/"),M=(a.workbooks[0].slice(0,R+1)+"_rels/"+a.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");pi(e,M)||(M="xl/_rels/workbook."+F+".rels");var W=Zl(On(e,M,!0),M.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=iR(Br(e,hi(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=t3(Br(e,hi(a.people[0])),r)),W&&(W=zR(W,f.Sheets));var B=Br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var V="sheet";if(W&&W[m]?(_="xl/"+W[m][1].replace(/[\/]?xl\//,""),pi(e,_)||(_=W[m][1]),pi(e,_)||(_=M.replace(/_rels\/[\S\s]*$/,"")+W[m][1]),V=W[m][2]):(_="xl/worksheets/sheet"+(m+1-B)+"."+F,_=_.replace(/sheet0\./,"sheet.")),w=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var G=!1,pe=0;pe!=r.sheets.length;++pe)typeof r.sheets[pe]=="number"&&r.sheets[pe]==m&&(G=1),typeof r.sheets[pe]=="string"&&r.sheets[pe].toLowerCase()==h.SheetNames[m].toLowerCase()&&(G=1);if(!G)continue e}}GR(e,_,w,h.SheetNames[m],m,x,o,V,r,f,c,u)}return v={Directory:a,Workbook:f,Props:h,Custprops:g,Deps:p,Sheets:o,SheetNames:h.SheetNames,Strings:tc,Styles:u,Themes:c,SSF:Ur(et)},r&&r.bookFiles&&(e.files?(v.keys=i,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(ae,De){ae=ae.replace(/^Root Entry[\/]/,""),v.keys.push(ae),v.files[ae]=e.FileIndex[De]}))),r&&r.bookVBA&&(a.vba.length>0?v.vbaraw=Br(e,hi(a.vba[0]),!0):a.defaults&&a.defaults.bin===a3&&(v.vbaraw=Br(e,"xl/vbaProject.bin",!0))),v.bookType=s?"xlsb":"xlsx",v}function qR(e,r){var t=r||{},n="Workbook",i=Tt.find(e,n);try{if(n="/!DataSpaces/Version",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(jA(i.content),n="/!DataSpaces/DataSpaceMap",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=KA(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qA(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);QA(i.content)}catch{}if(n="/EncryptionInfo",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=YA(i.content);if(n="/EncryptedPackage",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function tp(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=qn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function XR(e,r){return Tt.find(e,"EncryptedPackage")?qR(e,r):Ix(e,r)}function QR(e,r){var t,n=e,i=r||{};return i.type||(i.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),t=T_(n,i),KR(t,i)}function Nx(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Id(e.slice(t),r);default:break e}return lc.to_workbook(e,r)}function YR(e,r){var t="",n=tp(e,r);switch(r.type){case"base64":t=qn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Ts(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Xt(t)),r.type="binary",Nx(t,r)}function ZR(e,r){var t=e;return r.type=="base64"&&(t=qn(t)),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer&&(t=new Uint8Array(e)),t=typeof _t<"u"?_t.utils.decode(1200,t.slice(2),"str"):xt&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&t instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(t.slice(2)):nI(t.slice(2)):c_(t.slice(2)),r.type="binary",Nx(t,r)}function JR(e){return e.match(/[^\x00-\x7F]/)?Kl(e):e}function yd(e,r,t,n){return n?(t.type="string",lc.to_workbook(e,t)):lc.to_workbook(r,t)}function Es(e,r){l_();var t=r||{};if(t.codepage&&typeof _t>"u"&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Es(new Uint8Array(e),(t=Ur(t),t.type="array",t));if(typeof Int8Array<"u"&&e instanceof Int8Array)return Es(new Uint8Array(e.buffer,e.byteOffset,e.length),t);typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Co={},t.dateNF&&(Co.dateNF=t.dateNF),t.type||(t.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=xt?"buffer":"binary",n=FI(e),typeof Uint8Array<"u"&&!xt&&(t.type="array")),t.type=="string"&&(a=!0,t.type="binary",t.codepage=65001,n=JR(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Ur(t),t.type="array",Es(Dd(n),t)}switch((i=tp(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return XR(Tt.read(n,t),t);break;case 9:if(i[1]<=8)return Ix(n,t);break;case 60:return Id(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return MA(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DA.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?QR(n,t):yd(e,n,t,a);case 239:return i[3]===60?Id(n,t):yd(e,n,t,a);case 255:if(i[1]===254)return ZR(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return ec.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return ec.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return jv.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return uO(n,t);break;case 10:case 13:case 32:return YR(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(i[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(i[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(i[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return OA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?jv.to_workbook(n,t):yd(e,n,t,a)}function eM(e,r,t,n,i,a,s){var o=Ht(t),l=s.defval,c=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),u=!0,f=e["!data"]!=null,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!f||e["!data"][t])for(var d=r.s.c;d<=r.e.c;++d){var g=f?(e["!data"][t]||[])[d]:e[n[d]+o];if(g==null||g.t===void 0){if(l===void 0)continue;a[d]!=null&&(h[a[d]]=l);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"b":case"n":if(!g.z||!Ai(g.z)||(v=Wa(v),typeof v=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(v=Is(new Date(v)));break;default:throw new Error("unrecognized type "+g.t)}if(a[d]!=null){if(v==null)if(g.t=="e"&&v===null)h[a[d]]=null;else if(l!==void 0)h[a[d]]=l;else if(c&&v===null)h[a[d]]=null;else continue;else h[a[d]]=(g.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:c)?v:za(g,v,s);v!=null&&(u=!1)}}return{row:h,isempty:u}}function Ad(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Or(u);break;case"number":l=Or(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=Ht(l.s.r),h=[],d=[],g=0,v=0,p=e["!data"]!=null,m=l.s.r,x=0,_={};p&&!e["!data"][m]&&(e["!data"][m]=[]);var w=c.skipHidden&&e["!cols"]||[],D=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(w[x]||{}).hidden)switch(h[x]=Dt(x),t=p?e["!data"][m][x]:e[h[x]+f],n){case 1:a[x]=x-l.s.c;break;case 2:a[x]=h[x];break;case 3:a[x]=c.header[x-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=za(t,null,c),v=_[s]||0,!v)_[s]=1;else{do o=s+"_"+v++;while(_[o]);_[s]=v,_[o]=1}a[x]=o}for(m=l.s.r+i;m<=l.e.r;++m)if(!(D[m]||{}).hidden){var U=eM(e,l,m,h,n,a,c);(U.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=U.row)}return d.length=g,d}var s_=/"/g;function tM(e,r,t,n,i,a,s,o,l){for(var c=!0,u=[],f="",h=Ht(t),d=e["!data"]!=null,g=d&&e["!data"][t]||[],v=r.s.c;v<=r.e.c;++v)if(n[v]){var p=d?g[v]:e[n[v]+h];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(l.rawNumbers&&p.t=="n"?p.v:za(p,null,l));for(var m=0,x=0;m!==f.length;++m)if((x=f.charCodeAt(m))===i||x===a||x===34||l.forceQuotes){f='"'+f.replace(s_,'""')+'"';break}f=="ID"&&o==0&&u.length==0&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(s_,'""')+'"')):f="";u.push(f)}if(l.strip)for(;u[u.length-1]==="";)--u.length;return l.blankrows===!1&&c?null:u.join(s)}function Px(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";for(var i=Or(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c="",u=[],f=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],d=i.s.c;d<=i.e.c;++d)(f[d]||{}).hidden||(u[d]=Dt(d));for(var g=0,v=i.s.r;v<=i.e.r;++v)(h[v]||{}).hidden||(c=tM(e,i,v,u,s,l,a,g,n),c!=null&&(c||n.blankrows!==!1)&&t.push((g++?o:"")+c));return t.join("")}function rM(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Px(e,r);if(typeof _t>"u"||r.type=="string")return t;var n=_t.utils.encode(1200,t,"str");return"\xFF\xFE"+n}function nM(e,r){var t="",n,i="";if(e==null||e["!ref"]==null)return[];var a=Or(e["!ref"]),s="",o=[],l,c=[],u=e["!data"]!=null;for(l=a.s.c;l<=a.e.c;++l)o[l]=Dt(l);for(var f=a.s.r;f<=a.e.r;++f)for(s=Ht(f),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+s,n=u?(e["!data"][f]||[])[l]:e[t],i="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;i=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)i=n.f;else{if(r&&r.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)i=""+n.v;else if(n.t=="b")i=n.v?"TRUE":"FALSE";else if(n.w!==void 0)i="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?i="'"+n.v:i=""+n.v}}c[c.length]=t+"="+i}return c}function Lx(e,r,t){var n=t||{},i=e?e["!data"]!=null:n.dense;Ar!=null&&i==null&&(i=Ar);var a=+!n.skipHeader,s=e||{};!e&&i&&(s["!data"]=[]);var o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?wn(n.origin):n.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+r.length-1+a}};if(s["!ref"]){var f=Or(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+r.length-1+a)}else o==-1&&(o=0,u.e.r=r.length-1+a);var h=n.header||[],d=0,g=[];r.forEach(function(p,m){i&&!s["!data"][o+m+a]&&(s["!data"][o+m+a]=[]),i&&(g=s["!data"][o+m+a]),mi(p).forEach(function(x){(d=h.indexOf(x))==-1&&(h[d=h.length]=x);var _=p[x],w="z",D="",U=i?"":Dt(l+d)+Ht(o+m+a),F=i?g[l+d]:s[U];_&&typeof _=="object"&&!(_ instanceof Date)?i?g[l+d]=_:s[U]=_:(typeof _=="number"?w="n":typeof _=="boolean"?w="b":typeof _=="string"?w="s":_ instanceof Date?(w="d",n.UTC||(_=ff(_)),n.cellDates||(w="n",_=jr(_)),D=F!=null&&F.z&&Ai(F.z)?F.z:n.dateNF||et[14]):_===null&&n.nullError&&(w="e",_=0),F?(F.t=w,F.v=_,delete F.w,delete F.R,D&&(F.z=D)):i?g[l+d]=F={t:w,v:_}:s[U]=F={t:w,v:_},D&&(F.z=D))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var v=Ht(o);if(i&&!s["!data"][o]&&(s["!data"][o]=[]),a)for(d=0;d<h.length;++d)i?s["!data"][o][d+l]={t:"s",v:h[d]}:s[Dt(d+l)+v]={t:"s",v:h[d]};return s["!ref"]=wt(u),s}function iM(e,r){return Lx(null,e,r)}function hc(e,r,t){if(typeof r=="string"){if(e["!data"]!=null){var n=wn(r);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?hc(e,Ft(r)):hc(e,Dt(t||0)+Ht(r))}function aM(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function rp(e,r){var t={SheetNames:[],Sheets:{}};return e&&_c(t,e,r||"Sheet1"),t}function _c(e,r,t,n){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0&&t.length<32){var a=t.match(/\d+$/);i=a&&+a[0]||0;var s=a&&t.slice(0,a.index)||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=s+i)!=-1;++i);}if(UD(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function sM(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=aM(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function oM(e,r){return e.z=r,e}function Bx(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function lM(e,r,t){return Bx(e,"#"+r,t)}function cM(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function uM(e,r,t,n){for(var i=typeof r!="string"?r:Or(r),a=typeof r=="string"?r:wt(r),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=hc(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=t,n&&(l.D=!0))}var c=As(e["!ref"]);return c.s.r>i.s.r&&(c.s.r=i.s.r),c.s.c>i.s.c&&(c.s.c=i.s.c),c.e.r<i.e.r&&(c.e.r=i.e.r),c.e.c<i.e.c&&(c.e.c=i.e.c),e["!ref"]=wt(c),e}var Rs={encode_col:Dt,encode_row:Ht,encode_cell:Ft,encode_range:wt,decode_col:jd,decode_row:zd,split_cell:C4,decode_cell:wn,decode_range:As,format_cell:za,sheet_new:S4,sheet_add_aoa:U_,sheet_add_json:Lx,sheet_add_dom:kx,aoa_to_sheet:Ao,json_to_sheet:iM,table_to_sheet:Ax,table_to_book:ER,sheet_to_csv:Px,sheet_to_txt:rM,sheet_to_json:Ad,sheet_to_html:CR,sheet_to_formulae:nM,sheet_to_row_object_array:Ad,sheet_get_cell:hc,book_new:rp,book_append_sheet:_c,book_set_sheet_visibility:sM,cell_set_number_format:oM,cell_set_hyperlink:Bx,cell_set_internal_link:lM,cell_add_comment:cM,sheet_set_array_formula:uM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var yU=o_.version;var yf=class{dbKey;title;importance=0;constructor(r){Object.assign(this,r)}},xc=class{workbook;constructor(r){r&&Object.assign(this,r)}get_sheet_names(){return this.workbook?this.workbook.SheetNames:[]}get_primary_sheet_name(){if(this.primarySheetName)return this.primarySheetName;if(this.workbook)return this.workbook.SheetNames[0]}get_primary_sheet(){if(!this.workbook){console.warn("get_primary_sheet(): No workbook found");return}let r=this.get_primary_sheet_name();if(r){if(r in this.workbook.Sheets)return this.workbook.Sheets[r];console.warn(`get_primary_sheet(): sheet ${r} not found`);return}else{console.warn("get_primary_sheet(): No sheet name found");return}}parse_headers(){let r=new Map,t=this.get_primary_sheet();if(!t)return console.warn("parse_headers(): No sheet found"),r;let n=Rs.decode_range(t["!ref"]),i=n.s.r;for(let a=n.s.c;a<=n.e.c;++a){let s=Rs.encode_cell({r:i,c:a}),o=t[s];if(!o)continue;let l=o.v;r.set(l,a)}return this.header2colIndex=r,r}};function Ux(e,r){let t=new Map,n=new Map,i=new Set;for(let a of e)for(let s=0;s<r.length;s++)if(!i.has(r[s])&&r[s].toLowerCase().startsWith(a.toLowerCase())){t.set(a,r[s]),n.set(a,s),i.add(r[s]);break}return{dbkey2header:t,dbkey2headerIndex:n}}var wf=(()=>{class e{autofocus=!1;focused=!1;platformId=$e(Er);document=$e(Ut);host=$e(qt);ngAfterContentChecked(){this.autofocus===!1?this.host.nativeElement.removeAttribute("autofocus"):this.host.nativeElement.setAttribute("autofocus",!0),this.focused||this.autoFocus()}ngAfterViewChecked(){this.focused||this.autoFocus()}autoFocus(){qr(this.platformId)&&this.autofocus&&setTimeout(()=>{let t=J.getFocusableElements(this.host?.nativeElement);t.length===0&&this.host.nativeElement.focus(),t.length>0&&t[0].focus(),this.focused=!0})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Mr({type:e,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:[2,"autofocus","autofocus",Se]},standalone:!0,features:[Qt]})}return e})(),$x=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({})}return e})();var yc=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["SpinnerIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var hM=["*"],Wx=e=>({class:e});function dM(e,r){e&1&&st(0)}function pM(e,r){if(e&1&&ue(0,"span",8),e&2){let t=P(3);b("ngClass",t.iconClass()),ee("aria-hidden",!0)("data-pc-section","loadingicon")}}function mM(e,r){if(e&1&&ue(0,"SpinnerIcon",9),e&2){let t=P(3);b("styleClass",t.spinnerIconClass())("spin",!0),ee("aria-hidden",!0)("data-pc-section","loadingicon")}}function gM(e,r){if(e&1&&(Ye(0),Y(1,pM,1,3,"span",6)(2,mM,1,4,"SpinnerIcon",7),Ze()),e&2){let t=P(2);S(),b("ngIf",t.loadingIcon),S(),b("ngIf",!t.loadingIcon)}}function vM(e,r){}function _M(e,r){if(e&1&&Y(0,vM,0,0,"ng-template",10),e&2){let t=P(2);b("ngIf",t.loadingIconTemplate)}}function xM(e,r){if(e&1&&(Ye(0),Y(1,gM,3,2,"ng-container",2)(2,_M,1,1,null,5),Ze()),e&2){let t=P();S(),b("ngIf",!t.loadingIconTemplate),S(),b("ngTemplateOutlet",t.loadingIconTemplate)("ngTemplateOutletContext",gt(3,Wx,t.iconClass()))}}function yM(e,r){if(e&1&&ue(0,"span",8),e&2){let t=P(2);b("ngClass",t.iconClass()),ee("data-pc-section","icon")}}function wM(e,r){}function bM(e,r){if(e&1&&Y(0,wM,0,0,"ng-template",10),e&2){let t=P(2);b("ngIf",!t.icon&&t.iconTemplate)}}function CM(e,r){if(e&1&&(Ye(0),Y(1,yM,1,2,"span",6)(2,bM,1,1,null,5),Ze()),e&2){let t=P();S(),b("ngIf",t.icon&&!t.iconTemplate),S(),b("ngTemplateOutlet",t.iconTemplate)("ngTemplateOutletContext",gt(3,Wx,t.iconClass()))}}function EM(e,r){if(e&1&&(z(0,"span",11),Ct(1),j()),e&2){let t=P();ee("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),S(),Tr(t.label)}}function SM(e,r){if(e&1&&(z(0,"span",8),Ct(1),j()),e&2){let t=P();Ve(t.badgeClass),b("ngClass",t.badgeStyleClass()),ee("data-pc-section","badge"),S(),Tr(t.badge)}}var qa={button:"p-button",component:"p-component",iconOnly:"p-button-icon-only",disabled:"p-disabled",loading:"p-button-loading",labelOnly:"p-button-loading-label-only"},Hx=(()=>{class e{el;document;iconPos="left";loadingIcon;get label(){return this._label}set label(t){this._label=t,this.initialized&&(this.updateLabel(),this.updateIcon(),this.setStyleClass())}get icon(){return this._icon}set icon(t){this._icon=t,this.initialized&&(this.updateIcon(),this.setStyleClass())}get loading(){return this._loading}set loading(t){this._loading=t,this.initialized&&(this.updateIcon(),this.setStyleClass())}severity;raised=!1;rounded=!1;text=!1;outlined=!1;size=null;plain=!1;_label;_icon;_loading=!1;initialized;get htmlElement(){return this.el.nativeElement}_internalClasses=Object.values(qa);constructor(t,n){this.el=t,this.document=n}ngAfterViewInit(){J.addMultipleClasses(this.htmlElement,this.getStyleClass().join(" ")),this.createIcon(),this.createLabel(),this.initialized=!0}getStyleClass(){let t=[qa.button,qa.component];return this.icon&&!this.label&&Je.isEmpty(this.htmlElement.textContent)&&t.push(qa.iconOnly),this.loading&&(t.push(qa.disabled,qa.loading),!this.icon&&this.label&&t.push(qa.labelOnly),this.icon&&!this.label&&!Je.isEmpty(this.htmlElement.textContent)&&t.push(qa.iconOnly)),this.text&&t.push("p-button-text"),this.severity&&t.push(`p-button-${this.severity}`),this.plain&&t.push("p-button-plain"),this.raised&&t.push("p-button-raised"),this.size&&t.push(`p-button-${this.size}`),this.outlined&&t.push("p-button-outlined"),this.rounded&&t.push("p-button-rounded"),this.size==="small"&&t.push("p-button-sm"),this.size==="large"&&t.push("p-button-lg"),t}setStyleClass(){let t=this.getStyleClass();this.htmlElement.classList.remove(...this._internalClasses),this.htmlElement.classList.add(...t)}createLabel(){if(!J.findSingle(this.htmlElement,".p-button-label")&&this.label){let n=this.document.createElement("span");this.icon&&!this.label&&n.setAttribute("aria-hidden","true"),n.className="p-button-label",n.appendChild(this.document.createTextNode(this.label)),this.htmlElement.appendChild(n)}}createIcon(){if(!J.findSingle(this.htmlElement,".p-button-icon")&&(this.icon||this.loading)){let n=this.document.createElement("span");n.className="p-button-icon",n.setAttribute("aria-hidden","true");let i=this.label?"p-button-icon-"+this.iconPos:null;i&&J.addClass(n,i);let a=this.getIconClass();a&&J.addMultipleClasses(n,a),this.htmlElement.insertBefore(n,this.htmlElement.firstChild)}}updateLabel(){let t=J.findSingle(this.htmlElement,".p-button-label");if(!this.label){t&&this.htmlElement.removeChild(t);return}t?t.textContent=this.label:this.createLabel()}updateIcon(){let t=J.findSingle(this.htmlElement,".p-button-icon"),n=J.findSingle(this.htmlElement,".p-button-label");t?this.iconPos?t.className="p-button-icon "+(n?"p-button-icon-"+this.iconPos:"")+" "+this.getIconClass():t.className="p-button-icon "+this.getIconClass():this.createIcon()}getIconClass(){return this.loading?"p-button-loading-icon pi-spin "+(this.loadingIcon??"pi pi-spinner"):this.icon||"p-hidden"}ngOnDestroy(){this.initialized=!1}static \u0275fac=function(n){return new(n||e)(ce(qt),ce(Ut))};static \u0275dir=Mr({type:e,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading",severity:"severity",raised:[2,"raised","raised",Se],rounded:[2,"rounded","rounded",Se],text:[2,"text","text",Se],outlined:[2,"outlined","outlined",Se],size:"size",plain:[2,"plain","plain",Se]},standalone:!0,features:[Qt]})}return e})(),Ms=(()=>{class e{el;type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;style;styleClass;badgeClass;ariaLabel;autofocus;onClick=new Be;onFocus=new Be;onBlur=new Be;contentTemplate;loadingIconTemplate;iconTemplate;templates;constructor(t){this.el=t}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[n])=>t+` ${n}`,"p-button-loading-icon")}iconClass(){let t={"p-button-icon":!0,"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label};return this.loading?t[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]=!0:this.icon&&(t[this.icon]=!0),t}get buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&this.iconPos==="left","p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large","p-button-plain":this.plain,[`${this.styleClass}`]:this.styleClass}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&String(this.badge).length===1}}focus(){this.el.nativeElement.firstChild.focus()}static \u0275fac=function(n){return new(n||e)(ce(qt))};static \u0275cmp=Fe({type:e,selectors:[["p-button"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(n,i){n&2&&Ra("p-disabled",i.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[2,"disabled","disabled",Se],loading:[2,"loading","loading",Se],loadingIcon:"loadingIcon",raised:[2,"raised","raised",Se],rounded:[2,"rounded","rounded",Se],text:[2,"text","text",Se],plain:[2,"plain","plain",Se],severity:"severity",outlined:[2,"outlined","outlined",Se],link:[2,"link","link",Se],tabindex:[2,"tabindex","tabindex",tr],size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel",autofocus:[2,"autofocus","autofocus",Se]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},standalone:!0,features:[Qt,ot],ngContentSelectors:hM,decls:7,vars:14,consts:[["pRipple","","pAutoFocus","",3,"click","focus","blur","ngStyle","disabled","ngClass","autofocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[3,"ngIf"],[1,"p-button-label"]],template:function(n,i){n&1&&(Pr(),z(0,"button",0),Pe("click",function(s){return i.onClick.emit(s)})("focus",function(s){return i.onFocus.emit(s)})("blur",function(s){return i.onBlur.emit(s)}),xr(1),Y(2,dM,1,0,"ng-container",1)(3,xM,3,5,"ng-container",2)(4,CM,3,5,"ng-container",2)(5,EM,2,3,"span",3)(6,SM,2,5,"span",4),j()),n&2&&(b("ngStyle",i.style)("disabled",i.disabled||i.loading)("ngClass",i.buttonClass)("autofocus",i.autofocus),ee("type",i.type)("aria-label",i.ariaLabel)("data-pc-name","button")("data-pc-section","root")("tabindex",i.tabindex),S(2),b("ngTemplateOutlet",i.contentTemplate),S(),b("ngIf",i.loading),S(),b("ngIf",!i.loading),S(),b("ngIf",!i.contentTemplate&&i.label),S(),b("ngIf",!i.contentTemplate&&i.badge))},dependencies:[yr,wr,or,dr,fi,wf,yc],encapsulation:2,changeDetection:0})}return e})(),Ns=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Ms,lr]})}return e})();var bf=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr]})}return e})();var ip=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["PlusIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var ap=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["UploadIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var ma=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["CheckIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"path",1),j()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return e})();var Oo=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[Lt,ot],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1)(3,"path",2)(4,"path",3),j(),z(5,"defs")(6,"clipPath",4),ue(7,"rect",5),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(5),b("id",i.pathId))},encapsulation:2})}return e})();var Fo=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["InfoCircleIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var Do=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["TimesCircleIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var TM=(e,r)=>({showTransitionParams:e,hideTransitionParams:r}),IM=e=>({value:"visible",params:e});function kM(e,r){if(e&1&&ue(0,"span"),e&2){let t=P().$implicit;Ve("p-message-icon pi "+t.icon),ee("data-pc-section","icon")}}function AM(e,r){e&1&&ue(0,"CheckIcon"),e&2&&ee("data-pc-section","icon")}function OM(e,r){e&1&&ue(0,"InfoCircleIcon"),e&2&&ee("data-pc-section","icon")}function FM(e,r){e&1&&ue(0,"TimesCircleIcon"),e&2&&ee("data-pc-section","icon")}function DM(e,r){e&1&&ue(0,"ExclamationTriangleIcon"),e&2&&ee("data-pc-section","icon")}function RM(e,r){if(e&1&&(z(0,"span",10),Ye(1),Y(2,AM,1,1,"CheckIcon",11)(3,OM,1,1,"InfoCircleIcon",11)(4,FM,1,1,"TimesCircleIcon",11)(5,DM,1,1,"ExclamationTriangleIcon",11),Ze(),j()),e&2){let t=P().$implicit;S(2),b("ngIf",t.severity==="success"),S(),b("ngIf",t.severity==="info"),S(),b("ngIf",t.severity==="error"),S(),b("ngIf",t.severity==="warn")}}function MM(e,r){if(e&1&&ue(0,"span",14),e&2){let t=P(2).$implicit;b("innerHTML",t.summary,th),ee("data-pc-section","summary")}}function NM(e,r){if(e&1&&ue(0,"span",15),e&2){let t=P(2).$implicit;b("innerHTML",t.detail,th),ee("data-pc-section","detail")}}function PM(e,r){if(e&1&&(Ye(0),Y(1,MM,1,2,"span",12)(2,NM,1,2,"span",13),Ze()),e&2){let t=P().$implicit;S(),b("ngIf",t.summary),S(),b("ngIf",t.detail)}}function LM(e,r){if(e&1&&(z(0,"span",18),Ct(1),j()),e&2){let t=P(2).$implicit;ee("data-pc-section","summary"),S(),Tr(t.summary)}}function BM(e,r){if(e&1&&(z(0,"span",19),Ct(1),j()),e&2){let t=P(2).$implicit;ee("data-pc-section","detail"),S(),Tr(t.detail)}}function VM(e,r){if(e&1&&Y(0,LM,2,2,"span",16)(1,BM,2,2,"span",17),e&2){let t=P().$implicit;b("ngIf",t.summary),S(),b("ngIf",t.detail)}}function UM(e,r){if(e&1){let t=nt();z(0,"button",20),Pe("click",function(){_e(t);let i=P().index,a=P(2);return xe(a.removeMessage(i))}),ue(1,"TimesIcon",21),j()}if(e&2){let t=P(3);ee("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),S(),b("styleClass","p-message-close-icon"),ee("data-pc-section","closeicon")}}function $M(e,r){if(e&1&&(z(0,"div",5)(1,"div",6),Y(2,kM,1,3,"span",7)(3,RM,6,4,"span",8)(4,PM,3,2,"ng-container",3)(5,VM,2,2,"ng-template",null,1,rn)(7,UM,2,4,"button",9),j()()),e&2){let t,n=r.$implicit,i=sr(6),a=P(2);Ve("p-message p-message-"+n.severity),b("@messageAnimation",gt(13,IM,Hr(10,TM,a.showTransitionOptions,a.hideTransitionOptions))),S(),ee("data-pc-section","wrapper")("id",n.id||null),S(),b("ngIf",n.icon),S(),b("ngIf",!n.icon),S(),b("ngIf",!a.escape)("ngIfElse",i),S(3),b("ngIf",a.closable&&((t=n.closable)!==null&&t!==void 0?t:!0))}}function WM(e,r){if(e&1&&(Ye(0),Y(1,$M,8,15,"div",4),Ze()),e&2){let t=P();S(),b("ngForOf",t.messages)}}function HM(e,r){e&1&&st(0)}function zM(e,r){if(e&1&&(z(0,"div",22)(1,"div",6),Y(2,HM,1,0,"ng-container",23),j()()),e&2){let t=P();b("ngClass","p-message p-message-"+t.severity),S(2),b("ngTemplateOutlet",t.contentTemplate)}}var zx=(()=>{class e{messageService;el;cd;config;set value(t){this.messages=t,this.startMessageLifes(this.messages)}closable=!0;style;styleClass;enableService=!0;key;escape=!0;severity;showTransitionOptions="300ms ease-out";hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)";valueChange=new Be;onClose=new Be;templates;messages;messageSubscription;clearSubscription;timerSubscriptions=[];contentTemplate;constructor(t,n,i,a){this.messageService=t,this.el=n,this.cd=i,this.config=a}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;default:this.contentTemplate=t.template;break}}),this.messageService&&this.enableService&&!this.contentTemplate&&(this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t){Array.isArray(t)||(t=[t]);let n=t.filter(i=>this.key===i.key);this.messages=this.messages?[...this.messages,...n]:[...n],this.startMessageLifes(n),this.cd.markForCheck()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()}))}hasMessages(){let t=this.el.nativeElement.parentElement;return t&&t.offsetParent?this.contentTemplate!=null||this.messages&&this.messages.length>0:!1}clear(){this.messages=[],this.valueChange.emit(this.messages)}removeMessage(t){let n=this.messages[t];this.messages=this.messages?.filter((i,a)=>a!==t),n&&this.onClose.emit(n),this.valueChange.emit(this.messages)}get icon(){let t=this.severity||(this.hasMessages()?this.messages[0].severity:null);if(this.hasMessages())switch(t){case"success":return"pi-check";case"info":return"pi-info-circle";case"error":return"pi-times";case"warn":return"pi-exclamation-triangle";default:return"pi-info-circle"}return null}get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.timerSubscriptions?.forEach(t=>t.unsubscribe())}startMessageLifes(t){t?.forEach(n=>n.life&&this.startMessageLife(n))}startMessageLife(t){let n=lg(t.life).subscribe(()=>{this.messages=this.messages?.filter(i=>i!==t),this.timerSubscriptions=this.timerSubscriptions?.filter(i=>i!==n),this.valueChange.emit(this.messages),this.cd.markForCheck()});this.timerSubscriptions.push(n)}static \u0275fac=function(n){return new(n||e)(ce(Ba,8),ce(qt),ce(hr),ce(an))};static \u0275cmp=Fe({type:e,selectors:[["p-messages"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:"value",closable:[2,"closable","closable",Se],style:"style",styleClass:"styleClass",enableService:[2,"enableService","enableService",Se],key:"key",escape:[2,"escape","escape",Se],severity:"severity",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{valueChange:"valueChange",onClose:"onClose"},features:[Qt],decls:4,vars:8,consts:[["staticMessage",""],["escapeOut",""],["role","alert",1,"p-messages","p-component",3,"ngStyle"],[4,"ngIf","ngIfElse"],["role","alert",3,"class",4,"ngFor","ngForOf"],["role","alert"],[1,"p-message-wrapper"],[3,"class",4,"ngIf"],["class","p-message-icon",4,"ngIf"],["class","p-message-close p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-message-icon"],[4,"ngIf"],["class","p-message-summary",3,"innerHTML",4,"ngIf"],["class","p-message-detail",3,"innerHTML",4,"ngIf"],[1,"p-message-summary",3,"innerHTML"],[1,"p-message-detail",3,"innerHTML"],["class","p-message-summary",4,"ngIf"],["class","p-message-detail",4,"ngIf"],[1,"p-message-summary"],[1,"p-message-detail"],["type","button","pRipple","",1,"p-message-close","p-link",3,"click"],[3,"styleClass"],["role","alert",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(n,i){if(n&1&&(z(0,"div",2),Y(1,WM,2,1,"ng-container",3)(2,zM,3,2,"ng-template",null,0,rn),j()),n&2){let a=sr(3);Ve(i.styleClass),b("ngStyle",i.style),ee("aria-atomic",!0)("aria-live","assertive")("data-pc-name","message"),S(),b("ngIf",!i.contentTemplate)("ngIfElse",a)}},dependencies:()=>[dr,oi,yr,wr,or,fi,ma,Fo,Do,Oo,In],styles:[`@layer primeng{.p-message-wrapper{display:flex;align-items:center}.p-message-close{display:flex;align-items:center;justify-content:center;flex:none}.p-message-close.p-link{margin-left:auto;overflow:hidden;position:relative}.p-messages .p-message.ng-animating{overflow:hidden}}
`],encapsulation:2,data:{animation:[ds("messageAnimation",[$i(":enter",[Ui({opacity:0,transform:"translateY(-25%)"}),ra("{{showTransitionParams}}")]),$i(":leave",[ra("{{hideTransitionParams}}",Ui({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0})}return e})(),sp=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,Hi,ma,Fo,Do,Oo,In]})}return e})();var GM=(e,r)=>({"p-progressbar p-component":!0,"p-progressbar-determinate":e,"p-progressbar-indeterminate":r}),KM=(e,r)=>({width:e,display:"flex",background:r}),qM=e=>({$implicit:e}),XM=e=>({display:e}),QM=e=>({background:e});function YM(e,r){if(e&1&&(z(0,"div",7),Ct(1),j()),e&2){let t=P(2);b("ngStyle",gt(4,XM,t.value!=null&&t.value!==0?"flex":"none")),ee("data-pc-section","label"),S(),Dg(" ",t.value,"",t.unit," ")}}function ZM(e,r){e&1&&st(0)}function JM(e,r){if(e&1&&(z(0,"div",3)(1,"div",4),Y(2,YM,2,6,"div",5)(3,ZM,1,0,"ng-container",6),j()()),e&2){let t=P();b("ngStyle",Hr(5,KM,t.value+"%",t.color)),ee("data-pc-section","value"),S(2),b("ngIf",t.showValue&&!t.contentTemplate),S(),b("ngTemplateOutlet",t.contentTemplate)("ngTemplateOutletContext",gt(8,qM,t.value))}}function e8(e,r){if(e&1&&(z(0,"div",8),ue(1,"div",3),j()),e&2){let t=P();ee("data-pc-section","container"),S(),b("ngStyle",gt(3,QM,t.color)),ee("data-pc-section","value")}}var jx=(()=>{class e{value;showValue=!0;styleClass;style;unit="%";mode="determinate";color;templates;contentTemplate;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;default:this.contentTemplate=t.template}})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["p-progressBar"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:[2,"value","value",tr],showValue:[2,"showValue","showValue",Se],styleClass:"styleClass",style:"style",unit:"unit",mode:"mode",color:"color"},features:[Qt],decls:3,vars:14,consts:[["role","progressbar",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate",3,"ngStyle",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",3,"ngStyle"],[1,"p-progressbar-label"],[3,"ngStyle",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngStyle"],[1,"p-progressbar-indeterminate-container"]],template:function(n,i){n&1&&(z(0,"div",0),Y(1,JM,4,10,"div",1)(2,e8,2,5,"div",2),j()),n&2&&(Ve(i.styleClass),b("ngStyle",i.style)("ngClass",Hr(11,GM,i.mode==="determinate",i.mode==="indeterminate")),ee("aria-valuemin",0)("aria-valuenow",i.value)("aria-valuemax",100)("data-pc-name","progressbar")("data-pc-section","root"),S(),b("ngIf",i.mode==="determinate"),S(),b("ngIf",i.mode==="indeterminate"))},dependencies:[dr,yr,wr,or],styles:[`@layer primeng{.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;-webkit-animation-delay:1.15s;animation-delay:1.15s}}@-webkit-keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@-webkit-keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}
`],encapsulation:2,changeDetection:0})}return e})(),op=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et]})}return e})();var r8=["advancedfileinput"],n8=["basicfileinput"],i8=["content"],a8=(e,r,t,n,i)=>({$implicit:e,uploadedFiles:r,chooseCallback:t,clearCallback:n,uploadCallback:i}),s8=(e,r,t,n,i,a,s,o)=>({$implicit:e,uploadedFiles:r,chooseCallback:t,clearCallback:n,removeUploadedFileCallback:i,removeFileCallback:a,progress:s,messages:o}),o8=(e,r)=>({"p-focus":e,"p-disabled":r}),l8=(e,r,t,n)=>({"p-button p-component p-fileupload-choose":!0,"p-button-icon-only":e,"p-fileupload-choose-selected":r,"p-focus":t,"p-disabled":n});function c8(e,r){if(e&1&&ue(0,"span",21),e&2){let t=P(3);Ve(t.chooseIcon),b("ngClass","p-button-icon p-button-icon-left"),ee("aria-label",!0)("data-pc-section","chooseicon")}}function u8(e,r){e&1&&ue(0,"PlusIcon",24),e&2&&(b("styleClass","p-button-icon p-button-icon-left"),ee("aria-label",!0)("data-pc-section","chooseicon"))}function f8(e,r){}function h8(e,r){e&1&&Y(0,f8,0,0,"ng-template")}function d8(e,r){if(e&1&&(z(0,"span",25),Y(1,h8,1,0,null,11),j()),e&2){let t=P(4);ee("aria-label",!0)("data-pc-section","chooseicon"),S(),b("ngTemplateOutlet",t.chooseIconTemplate)}}function p8(e,r){if(e&1&&(Ye(0),Y(1,u8,1,3,"PlusIcon",22)(2,d8,2,3,"span",23),Ze()),e&2){let t=P(3);S(),b("ngIf",!t.chooseIconTemplate),S(),b("ngIf",t.chooseIconTemplate)}}function m8(e,r){if(e&1&&ue(0,"span",28),e&2){let t=P(4);b("ngClass",t.uploadIcon),ee("aria-hidden",!0)}}function g8(e,r){e&1&&ue(0,"UploadIcon",24),e&2&&b("styleClass","p-button-icon p-button-icon-left")}function v8(e,r){}function _8(e,r){e&1&&Y(0,v8,0,0,"ng-template")}function x8(e,r){if(e&1&&(z(0,"span",25),Y(1,_8,1,0,null,11),j()),e&2){let t=P(5);ee("aria-hidden",!0),S(),b("ngTemplateOutlet",t.uploadIconTemplate)}}function y8(e,r){if(e&1&&(Ye(0),Y(1,g8,1,1,"UploadIcon",22)(2,x8,2,2,"span",23),Ze()),e&2){let t=P(4);S(),b("ngIf",!t.uploadIconTemplate),S(),b("ngIf",t.uploadIconTemplate)}}function w8(e,r){if(e&1){let t=nt();z(0,"p-button",26),Pe("onClick",function(){_e(t);let i=P(3);return xe(i.upload())}),Y(1,m8,1,2,"span",27)(2,y8,3,2,"ng-container",9),j()}if(e&2){let t=P(3);b("label",t.uploadButtonLabel)("disabled",!t.hasFiles()||t.isFileLimitExceeded())("styleClass",t.uploadStyleClass),S(),b("ngIf",t.uploadIcon),S(),b("ngIf",!t.uploadIcon)}}function b8(e,r){if(e&1&&ue(0,"span",28),e&2){let t=P(4);b("ngClass",t.cancelIcon)}}function C8(e,r){e&1&&ue(0,"TimesIcon",24),e&2&&(b("styleClass","p-button-icon p-button-icon-left"),ee("aria-hidden",!0))}function E8(e,r){}function S8(e,r){e&1&&Y(0,E8,0,0,"ng-template")}function T8(e,r){if(e&1&&(z(0,"span",25),Y(1,S8,1,0,null,11),j()),e&2){let t=P(5);ee("aria-hidden",!0),S(),b("ngTemplateOutlet",t.cancelIconTemplate)}}function I8(e,r){if(e&1&&(Ye(0),Y(1,C8,1,2,"TimesIcon",22)(2,T8,2,2,"span",23),Ze()),e&2){let t=P(4);S(),b("ngIf",!t.cancelIconTemplate),S(),b("ngIf",t.cancelIconTemplate)}}function k8(e,r){if(e&1){let t=nt();z(0,"p-button",26),Pe("onClick",function(){_e(t);let i=P(3);return xe(i.clear())}),Y(1,b8,1,1,"span",27)(2,I8,3,2,"ng-container",9),j()}if(e&2){let t=P(3);b("label",t.cancelButtonLabel)("disabled",!t.hasFiles()||t.uploading)("styleClass",t.cancelStyleClass),S(),b("ngIf",t.cancelIcon),S(),b("ngIf",!t.cancelIcon)}}function A8(e,r){if(e&1){let t=nt();Ye(0),z(1,"span",17),Pe("focus",function(){_e(t);let i=P(2);return xe(i.onFocus())})("blur",function(){_e(t);let i=P(2);return xe(i.onBlur())})("click",function(){_e(t);let i=P(2);return xe(i.choose())})("keydown.enter",function(){_e(t);let i=P(2);return xe(i.choose())}),z(2,"input",7,0),Pe("change",function(i){_e(t);let a=P(2);return xe(a.onFileSelect(i))}),j(),Y(4,c8,1,5,"span",18)(5,p8,3,2,"ng-container",9),z(6,"span",19),Ct(7),j()(),Y(8,w8,3,5,"p-button",20)(9,k8,3,5,"p-button",20),Ze()}if(e&2){let t=P(2);S(),Ve(t.chooseStyleClass),b("ngClass",Hr(16,o8,t.focus,t.disabled||t.isChooseDisabled())),ee("data-pc-section","choosebutton"),S(),b("multiple",t.multiple)("accept",t.accept)("disabled",t.disabled||t.isChooseDisabled()),ee("aria-label",t.browseFilesLabel)("title","")("data-pc-section","input"),S(2),b("ngIf",t.chooseIcon),S(),b("ngIf",!t.chooseIcon),S(),ee("data-pc-section","choosebuttonlabel"),S(),Tr(t.chooseButtonLabel),S(),b("ngIf",!t.auto&&t.showUploadButton),S(),b("ngIf",!t.auto&&t.showCancelButton)}}function O8(e,r){e&1&&st(0)}function F8(e,r){e&1&&st(0)}function D8(e,r){if(e&1&&ue(0,"p-progressBar",29),e&2){let t=P(2);b("value",t.progress)("showValue",!1)}}function R8(e,r){if(e&1){let t=nt();z(0,"div")(1,"img",35),Pe("error",function(i){_e(t);let a=P(5);return xe(a.imageError(i))}),j()()}if(e&2){let t=P().$implicit,n=P(4);S(),b("src",t.objectURL,Sg)("width",n.previewWidth)}}function M8(e,r){e&1&&ue(0,"TimesIcon")}function N8(e,r){}function P8(e,r){e&1&&Y(0,N8,0,0,"ng-template")}function L8(e,r){if(e&1){let t=nt();z(0,"div",32),Y(1,R8,2,2,"div",9),z(2,"div",33),Ct(3),j(),z(4,"div"),Ct(5),j(),z(6,"div")(7,"button",34),Pe("click",function(i){let a=_e(t).index,s=P(4);return xe(s.remove(i,a))}),Y(8,M8,1,0,"TimesIcon",9)(9,P8,1,0,null,11),j()()()}if(e&2){let t=r.$implicit,n=P(4);S(),b("ngIf",n.isImage(t)),S(2),Tr(t.name),S(2),Tr(n.formatSize(t.size)),S(2),Ve(n.removeStyleClass),b("disabled",n.uploading),S(),b("ngIf",!n.cancelIconTemplate),S(),b("ngTemplateOutlet",n.cancelIconTemplate)}}function B8(e,r){if(e&1&&(z(0,"div"),Y(1,L8,10,8,"div",31),j()),e&2){let t=P(3);S(),b("ngForOf",t.files)}}function V8(e,r){}function U8(e,r){if(e&1&&(z(0,"div"),Y(1,V8,0,0,"ng-template",36),j()),e&2){let t=P(3);S(),b("ngForOf",t.files)("ngForTemplate",t.fileTemplate)}}function $8(e,r){if(e&1&&(z(0,"div",30),Y(1,B8,2,1,"div",9)(2,U8,2,2,"div",9),j()),e&2){let t=P(2);S(),b("ngIf",!t.fileTemplate),S(),b("ngIf",t.fileTemplate)}}function W8(e,r){e&1&&st(0)}function H8(e,r){e&1&&st(0)}function z8(e,r){if(e&1&&(z(0,"div",37),Y(1,H8,1,0,"ng-container",11),j()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.emptyTemplate)}}function j8(e,r){if(e&1){let t=nt();z(0,"div",6)(1,"input",7,0),Pe("change",function(i){_e(t);let a=P();return xe(a.onFileSelect(i))}),j(),z(3,"div",8),Y(4,A8,10,19,"ng-container",9)(5,O8,1,0,"ng-container",10)(6,F8,1,0,"ng-container",11),j(),z(7,"div",12,1),Pe("dragenter",function(i){_e(t);let a=P();return xe(a.onDragEnter(i))})("dragleave",function(i){_e(t);let a=P();return xe(a.onDragLeave(i))})("drop",function(i){_e(t);let a=P();return xe(a.onDrop(i))}),Y(9,D8,1,2,"p-progressBar",13),ue(10,"p-messages",14),Y(11,$8,3,2,"div",15)(12,W8,1,0,"ng-container",10)(13,z8,2,1,"div",16),j()()}if(e&2){let t=P();Ve(t.styleClass),b("ngClass","p-fileupload p-fileupload-advanced p-component")("ngStyle",t.style),ee("data-pc-name","fileupload")("data-pc-section","root"),S(),Og("display","none"),b("multiple",t.multiple)("accept",t.accept)("disabled",t.disabled||t.isChooseDisabled()),ee("aria-label",t.browseFilesLabel)("title","")("data-pc-section","input"),S(2),ee("data-pc-section","buttonbar"),S(),b("ngIf",!t.headerTemplate),S(),b("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",Rg(27,a8,t.files,t.uploadedFiles,t.choose.bind(t),t.clear.bind(t),t.upload.bind(t))),S(),b("ngTemplateOutlet",t.toolbarTemplate),S(),ee("data-pc-section","content"),S(2),b("ngIf",t.hasFiles()),S(),b("value",t.msgs)("enableService",!1),S(),b("ngIf",t.hasFiles()),S(),b("ngTemplateOutlet",t.contentTemplate)("ngTemplateOutletContext",Mg(33,s8,t.files,t.uploadedFiles,t.choose.bind(t),t.clear.bind(t),t.removeUploadedFile.bind(t),t.remove.bind(t),t.progress,t.msgs)),S(),b("ngIf",t.emptyTemplate&&!t.hasFiles()&&!t.hasUploadedFiles())}}function G8(e,r){if(e&1&&ue(0,"span",28),e&2){let t=P(3);b("ngClass",t.uploadIcon)}}function K8(e,r){e&1&&ue(0,"UploadIcon",24),e&2&&b("styleClass","p-button-icon p-button-icon-left")}function q8(e,r){}function X8(e,r){e&1&&Y(0,q8,0,0,"ng-template")}function Q8(e,r){if(e&1&&(z(0,"span",25),Y(1,X8,1,0,null,11),j()),e&2){let t=P(4);S(),b("ngTemplateOutlet",t.uploadIconTemplate)}}function Y8(e,r){if(e&1&&(Ye(0),Y(1,K8,1,1,"UploadIcon",22)(2,Q8,2,1,"span",23),Ze()),e&2){let t=P(3);S(),b("ngIf",!t.uploadIconTemplate),S(),b("ngIf",t.uploadIconTemplate)}}function Z8(e,r){if(e&1&&(Ye(0),Y(1,G8,1,1,"span",27)(2,Y8,3,2,"ng-container",9),Ze()),e&2){let t=P(2);S(),b("ngIf",t.uploadIcon),S(),b("ngIf",!t.uploadIcon)}}function J8(e,r){if(e&1&&ue(0,"span",44),e&2){let t=P(3);b("ngClass",t.chooseIcon)}}function e6(e,r){e&1&&ue(0,"PlusIcon",24),e&2&&(b("styleClass","p-button-icon p-button-icon-left pi"),ee("aria-hidden",!0)("data-pc-section","uploadicon"))}function t6(e,r){}function r6(e,r){e&1&&Y(0,t6,0,0,"ng-template")}function n6(e,r){if(e&1&&(z(0,"span",46),Y(1,r6,1,0,null,11),j()),e&2){let t=P(4);ee("aria-hidden",!0)("data-pc-section","uploadicon"),S(),b("ngTemplateOutlet",t.chooseIconTemplate)}}function i6(e,r){if(e&1&&(Ye(0),Y(1,e6,1,3,"PlusIcon",22)(2,n6,2,3,"span",45),Ze()),e&2){let t=P(3);S(),b("ngIf",!t.chooseIconTemplate),S(),b("ngIf",t.chooseIconTemplate)}}function a6(e,r){if(e&1&&Y(0,J8,1,1,"span",43)(1,i6,3,2,"ng-container",9),e&2){let t=P(2);b("ngIf",t.chooseIcon),S(),b("ngIf",!t.chooseIcon)}}function s6(e,r){if(e&1&&(z(0,"span",19),Ct(1),j()),e&2){let t=P(2);ee("data-pc-section","label"),S(),Tr(t.basicButtonLabel)}}function o6(e,r){if(e&1){let t=nt();z(0,"input",47,3),Pe("change",function(i){_e(t);let a=P(2);return xe(a.onFileSelect(i))})("focus",function(){_e(t);let i=P(2);return xe(i.onFocus())})("blur",function(){_e(t);let i=P(2);return xe(i.onBlur())}),j()}if(e&2){let t=P(2);b("accept",t.accept)("multiple",t.multiple)("disabled",t.disabled),ee("aria-label",t.browseFilesLabel)("data-pc-section","input")}}function l6(e,r){if(e&1){let t=nt();z(0,"div",38),ue(1,"p-messages",14),z(2,"span",39),Pe("click",function(){_e(t);let i=P();return xe(i.onBasicUploaderClick())})("keydown",function(i){_e(t);let a=P();return xe(a.onBasicKeydown(i))}),Y(3,Z8,3,2,"ng-container",40)(4,a6,2,2,"ng-template",null,2,rn)(6,s6,2,2,"span",41)(7,o6,2,5,"input",42),j()()}if(e&2){let t=sr(5),n=P();ee("data-pc-name","fileupload"),S(),b("value",n.msgs)("enableService",!1),S(),Ve(n.styleClass),b("ngClass",cu(12,l8,!n.basicButtonLabel,n.hasFiles(),n.focus,n.disabled))("ngStyle",n.style),ee("data-pc-section","choosebutton"),S(),b("ngIf",n.hasFiles()&&!n.auto)("ngIfElse",t),S(3),b("ngIf",n.basicButtonLabel),S(),b("ngIf",!n.hasFiles())}}var Gx=(()=>{class e{document;platformId;renderer;el;sanitizer;zone;http;cd;config;name;url;method="post";multiple;accept;disabled;auto;withCredentials;maxFileSize;invalidFileSizeMessageSummary="{0}: Invalid file size, ";invalidFileSizeMessageDetail="maximum upload size is {0}.";invalidFileTypeMessageSummary="{0}: Invalid file type, ";invalidFileTypeMessageDetail="allowed file types: {0}.";invalidFileLimitMessageDetail="limit is {0} at most.";invalidFileLimitMessageSummary="Maximum number of files exceeded, ";style;styleClass;previewWidth=50;chooseLabel;uploadLabel;cancelLabel;chooseIcon;uploadIcon;cancelIcon;showUploadButton=!0;showCancelButton=!0;mode="advanced";headers;customUpload;fileLimit;uploadStyleClass;cancelStyleClass;removeStyleClass;chooseStyleClass;onBeforeUpload=new Be;onSend=new Be;onUpload=new Be;onError=new Be;onClear=new Be;onRemove=new Be;onSelect=new Be;onProgress=new Be;uploadHandler=new Be;onImageError=new Be;onRemoveUploadedFile=new Be;templates;advancedFileInput;basicFileInput;content;set files(t){this._files=[];for(let n=0;n<t.length;n++){let i=t[n];this.validate(i)&&(this.isImage(i)&&(i.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(t[n]))),this._files.push(t[n]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}_files=[];progress=0;dragHighlight;msgs;fileTemplate;headerTemplate;contentTemplate;toolbarTemplate;chooseIconTemplate;uploadIconTemplate;cancelIconTemplate;emptyTemplate;uploadedFileCount=0;focus;uploading;duplicateIEEvent;translationSubscription;dragOverListener;uploadedFiles=[];fileUploadSubcription;constructor(t,n,i,a,s,o,l,c,u){this.document=t,this.platformId=n,this.renderer=i,this.el=a,this.sanitizer=s,this.zone=o,this.http=l,this.cd=c,this.config=u}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"file":this.fileTemplate=t.template;break;case"content":this.contentTemplate=t.template;break;case"toolbar":this.toolbarTemplate=t.template;break;case"chooseicon":this.chooseIconTemplate=t.template;break;case"uploadicon":this.uploadIconTemplate=t.template;break;case"cancelicon":this.cancelIconTemplate=t.template;break;case"empty":this.emptyTemplate=t.template;break;default:this.fileTemplate=t.template;break}})}ngOnInit(){this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}ngAfterViewInit(){qr(this.platformId)&&this.mode==="advanced"&&this.zone.runOutsideAngular(()=>{this.content&&(this.dragOverListener=this.renderer.listen(this.content.nativeElement,"dragover",this.onDragOver.bind(this)))})}getTranslation(t){return this.config.getTranslation(t)}choose(){this.advancedFileInput?.nativeElement.click()}onFileSelect(t){if(t.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.msgs=[],this.multiple||(this.files=[]);let n=t.dataTransfer?t.dataTransfer.files:t.target.files;for(let i=0;i<n.length;i++){let a=n[i];this.isFileSelected(a)||this.validate(a)&&(this.isImage(a)&&(a.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(n[i]))),this.files.push(n[i]))}this.onSelect.emit({originalEvent:t,files:n,currentFiles:this.files}),this.checkFileLimit(n),this.hasFiles()&&this.auto&&(this.mode!=="advanced"||!this.isFileLimitExceeded())&&this.upload(),t.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(t){for(let n of this.files)if(n.name+n.type+n.size===t.name+t.type+t.size)return!0;return!1}isIE11(){if(qr(this.platformId))return!!this.document.defaultView.MSInputMethodContext&&!!this.document.documentMode}validate(t){return this.msgs=this.msgs||[],this.accept&&!this.isFileTypeValid(t)?(this.msgs.push({severity:"error",summary:this.invalidFileTypeMessageSummary.replace("{0}",t.name),detail:this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}),!1):this.maxFileSize&&t.size>this.maxFileSize?(this.msgs.push({severity:"error",summary:this.invalidFileSizeMessageSummary.replace("{0}",t.name),detail:this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}),!1):!0}isFileTypeValid(t){let n=this.accept?.split(",").map(i=>i.trim());for(let i of n)if(this.isWildcard(i)?this.getTypeClass(t.type)===this.getTypeClass(i):t.type==i||this.getFileExtension(t).toLowerCase()===i.toLowerCase())return!0;return!1}getTypeClass(t){return t.substring(0,t.indexOf("/"))}isWildcard(t){return t.indexOf("*")!==-1}getFileExtension(t){return"."+t.name.split(".").pop()}isImage(t){return/^image\//.test(t.type)}onImageLoad(t){window.URL.revokeObjectURL(t.src)}upload(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let t=new FormData;this.onBeforeUpload.emit({formData:t});for(let n=0;n<this.files.length;n++)t.append(this.name,this.files[n],this.files[n].name);this.cancelUploadRequest(),this.fileUploadSubcription=this.http.request(this.method,this.url,{body:t,headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(n=>{switch(n.type){case li.Sent:this.onSend.emit({originalEvent:n,formData:t});break;case li.Response:this.uploading=!1,this.progress=0,n.status>=200&&n.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:n,files:this.files})):this.onError.emit({files:this.files}),this.uploadedFiles.push(...this.files),this.clear();break;case li.UploadProgress:{n.loaded&&(this.progress=Math.round(n.loaded*100/n.total)),this.onProgress.emit({originalEvent:n,progress:this.progress});break}}this.cd.markForCheck()},n=>{this.uploading=!1,this.onError.emit({files:this.files,error:n})})}}clear(){this.files=[],this.uploadedFileCount=0,this.cancelUploadRequest(),this.onClear.emit(),this.clearInputElement(),this.cd.markForCheck()}remove(t,n){this.cancelUploadRequest(),this.clearInputElement(),this.onRemove.emit({originalEvent:t,file:this.files[n]}),this.files.splice(n,1),this.checkFileLimit(this.files)}removeUploadedFile(t){let n=this.uploadedFiles.splice(t,1)[0];this.uploadedFiles=[...this.uploadedFiles],this.onRemoveUploadedFile.emit({file:n,files:this.uploadedFiles})}cancelUploadRequest(){this.fileUploadSubcription&&(this.fileUploadSubcription.unsubscribe(),this.fileUploadSubcription=void 0)}isFileLimitExceeded(){let n=this.auto?this.files.length:this.files.length+this.uploadedFileCount;return this.fileLimit&&this.fileLimit<=n&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<n}isChooseDisabled(){return this.auto?this.fileLimit&&this.fileLimit<=this.files.length:this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(t){this.msgs??=[];let n=this.msgs.length>0&&this.fileLimit<t.length;(this.isFileLimitExceeded()||n)&&this.msgs.push({severity:"error",summary:this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString()),detail:this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())})}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}hasUploadedFiles(){return this.uploadedFiles&&this.uploadedFiles.length>0}onDragEnter(t){this.disabled||(t.stopPropagation(),t.preventDefault())}onDragOver(t){this.disabled||(J.addClass(this.content?.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,t.stopPropagation(),t.preventDefault())}onDragLeave(t){this.disabled||J.removeClass(this.content?.nativeElement,"p-fileupload-highlight")}onDrop(t){if(!this.disabled){J.removeClass(this.content?.nativeElement,"p-fileupload-highlight"),t.stopPropagation(),t.preventDefault();let n=t.dataTransfer?t.dataTransfer.files:t.target.files;(this.multiple||n&&n.length===1)&&this.onFileSelect(t)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(t){let a=this.getTranslation(Si.FILE_SIZE_TYPES);if(t===0)return`0 ${a[0]}`;let s=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,s)).toFixed(3)} ${a[s]}`}onBasicUploaderClick(){this.hasFiles()?this.upload():this.basicFileInput?.nativeElement.click()}onBasicKeydown(t){switch(t.code){case"Space":case"Enter":this.onBasicUploaderClick(),t.preventDefault();break}}imageError(t){this.onImageError.emit(t)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(Si.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(Si.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(Si.CANCEL)}get browseFilesLabel(){return this.config.getTranslation(Si.ARIA)[Si.BROWSE_FILES]}ngOnDestroy(){this.content&&this.content.nativeElement&&this.dragOverListener&&(this.dragOverListener(),this.dragOverListener=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||e)(ce(Ut),ce(Er),ce(Nr),ce(qt),ce(bh),ce(fr),ce(xl),ce(hr),ce(an))};static \u0275cmp=Fe({type:e,selectors:[["p-fileUpload"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(At(r8,5),At(n8,5),At(i8,5)),n&2){let a;je(a=Ge())&&(i.advancedFileInput=a.first),je(a=Ge())&&(i.basicFileInput=a.first),je(a=Ge())&&(i.content=a.first)}},hostAttrs:[1,"p-element"],inputs:{name:"name",url:"url",method:"method",multiple:[2,"multiple","multiple",Se],accept:"accept",disabled:[2,"disabled","disabled",Se],auto:[2,"auto","auto",Se],withCredentials:[2,"withCredentials","withCredentials",Se],maxFileSize:[2,"maxFileSize","maxFileSize",tr],invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:[2,"previewWidth","previewWidth",tr],chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:[2,"showUploadButton","showUploadButton",Se],showCancelButton:[2,"showCancelButton","showCancelButton",Se],mode:"mode",headers:"headers",customUpload:[2,"customUpload","customUpload",Se],fileLimit:[2,"fileLimit","fileLimit",t=>tr(t,null)],uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError",onRemoveUploadedFile:"onRemoveUploadedFile"},features:[Qt],decls:2,vars:2,consts:[["advancedfileinput",""],["content",""],["chooseSection",""],["basicfileinput",""],[3,"ngClass","ngStyle","class",4,"ngIf"],["class","p-fileupload p-fileupload-basic p-component",4,"ngIf"],[3,"ngClass","ngStyle"],["type","file",3,"change","multiple","accept","disabled"],[1,"p-fileupload-buttonbar"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"p-fileupload-content",3,"dragenter","dragleave","drop"],[3,"value","showValue",4,"ngIf"],[3,"value","enableService"],["class","p-fileupload-files",4,"ngIf"],["class","p-fileupload-empty",4,"ngIf"],["pRipple","","tabindex","0",1,"p-button","p-component","p-fileupload-choose",3,"focus","blur","click","keydown.enter","ngClass"],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],["type","button",3,"label","disabled","styleClass","onClick",4,"ngIf"],[3,"ngClass"],[3,"styleClass",4,"ngIf"],["class","p-button-icon p-button-icon-left",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon","p-button-icon-left"],["type","button",3,"onClick","label","disabled","styleClass"],["class","p-button-icon p-button-icon-left",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left",3,"ngClass"],[3,"value","showValue"],[1,"p-fileupload-files"],["class","p-fileupload-row",4,"ngFor","ngForOf"],[1,"p-fileupload-row"],[1,"p-fileupload-filename"],["type","button","pButton","",1,"p-button-icon-only",3,"click","disabled"],[3,"error","src","width"],["ngFor","",3,"ngForOf","ngForTemplate"],[1,"p-fileupload-empty"],[1,"p-fileupload","p-fileupload-basic","p-component"],["tabindex","0","pRipple","",3,"click","keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],["class","p-button-label",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur",4,"ngIf"],["class","p-button-icon p-button-icon-left pi",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass"],["class","p-button-icon p-button-icon-left pi",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi"],["type","file",3,"change","focus","blur","accept","multiple","disabled"]],template:function(n,i){n&1&&Y(0,j8,14,42,"div",4)(1,l6,8,17,"div",5),n&2&&(b("ngIf",i.mode==="advanced"),S(),b("ngIf",i.mode==="basic"))},dependencies:()=>[dr,oi,yr,wr,or,Hx,Ms,jx,zx,fi,ip,ap,In],styles:[`@layer primeng{.p-fileupload-content{position:relative}.p-fileupload-row{display:flex;align-items:center}.p-fileupload-row>div{flex:1 1 auto;width:25%}.p-fileupload-row>div:last-child{text-align:right}.p-fileupload-content .p-progressbar{width:100%;position:absolute;top:0;left:0}.p-button.p-fileupload-choose{position:relative;overflow:hidden}.p-button.p-fileupload-choose input[type=file],.p-fileupload-choose.p-fileupload-choose-selected input[type=file]{display:none}.p-fluid .p-fileupload .p-button{width:auto}.p-fileupload-filename{word-break:break-all}}
`],encapsulation:2,changeDetection:0})}return e})(),Kx=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr,Ns,op,sp,Hi,ip,ap,In,lr,Ns,op,sp]})}return e})();var ty=(()=>{let r=class r{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=a=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};r.\u0275fac=function(i){return new(i||r)(ce(Nr),ce(qt))},r.\u0275dir=Mr({type:r});let e=r;return e})(),u6=(()=>{let r=class r extends ty{};r.\u0275fac=(()=>{let n;return function(a){return(n||(n=Pt(r)))(a||r)}})(),r.\u0275dir=Mr({type:r,features:[Lt]});let e=r;return e})(),Po=new Kt("");var f6={provide:Po,useExisting:ea(()=>ry),multi:!0};function h6(){let e=ao()?ao().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var d6=new Kt(""),ry=(()=>{let r=class r extends ty{constructor(n,i,a){super(n,i),this._compositionMode=a,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!h6())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};r.\u0275fac=function(i){return new(i||r)(ce(Nr),ce(qt),ce(d6,8))},r.\u0275dir=Mr({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,a){i&1&&Pe("input",function(o){return a._handleInput(o.target.value)})("blur",function(){return a.onTouched()})("compositionstart",function(){return a._compositionStart()})("compositionend",function(o){return a._compositionEnd(o.target.value)})},features:[ta([f6]),Lt]});let e=r;return e})();var p6=new Kt(""),m6=new Kt("");function ny(e){return e!=null}function iy(e){return fu(e)?Tn(e):e}function ay(e){let r={};return e.forEach(t=>{r=t!=null?ie(ie({},r),t):r}),Object.keys(r).length===0?null:r}function sy(e,r){return r.map(t=>t(e))}function g6(e){return!e.validate}function oy(e){return e.map(r=>g6(r)?r:t=>r.validate(t))}function v6(e){if(!e)return null;let r=e.filter(ny);return r.length==0?null:function(t){return ay(sy(t,r))}}function ly(e){return e!=null?v6(oy(e)):null}function _6(e){if(!e)return null;let r=e.filter(ny);return r.length==0?null:function(t){let n=sy(t,r).map(iy);return og(n).pipe(Ue(ay))}}function cy(e){return e!=null?_6(oy(e)):null}function qx(e,r){return e===null?[r]:Array.isArray(e)?[...e,r]:[e,r]}function x6(e){return e._rawValidators}function y6(e){return e._rawAsyncValidators}function lp(e){return e?Array.isArray(e)?e:[e]:[]}function Ef(e,r){return Array.isArray(e)?e.includes(r):e===r}function Xx(e,r){let t=lp(r);return lp(e).forEach(i=>{Ef(t,i)||t.push(i)}),t}function Qx(e,r){return lp(r).filter(t=>!Ef(e,t))}var Sf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(r){this._rawValidators=r||[],this._composedValidatorFn=ly(this._rawValidators)}_setAsyncValidators(r){this._rawAsyncValidators=r||[],this._composedAsyncValidatorFn=cy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(r){this._onDestroyCallbacks.push(r)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(r=>r()),this._onDestroyCallbacks=[]}reset(r=void 0){this.control&&this.control.reset(r)}hasError(r,t){return this.control?this.control.hasError(r,t):!1}getError(r,t){return this.control?this.control.getError(r,t):null}},cp=class extends Sf{get formDirective(){return null}get path(){return null}},Ps=class extends Sf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},up=class{constructor(r){this._cd=r}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},w6={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},SW=ze(ie({},w6),{"[class.ng-submitted]":"isSubmitted"}),uy=(()=>{let r=class r extends up{constructor(n){super(n)}};r.\u0275fac=function(i){return new(i||r)(ce(Ps,2))},r.\u0275dir=Mr({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,a){i&2&&Ra("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)},features:[Lt]});let e=r;return e})();var wc="VALID",Cf="INVALID",Ro="PENDING",bc="DISABLED",No=class{},Tf=class extends No{constructor(r,t){super(),this.value=r,this.source=t}},Cc=class extends No{constructor(r,t){super(),this.pristine=r,this.source=t}},Ec=class extends No{constructor(r,t){super(),this.touched=r,this.source=t}},Mo=class extends No{constructor(r,t){super(),this.status=r,this.source=t}};function b6(e){return(If(e)?e.validators:e)||null}function C6(e){return Array.isArray(e)?ly(e):e||null}function E6(e,r){return(If(r)?r.asyncValidators:e)||null}function S6(e){return Array.isArray(e)?cy(e):e||null}function If(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}var fp=class{constructor(r,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=si(()=>this.statusReactive()),this.statusReactive=Sr(void 0),this._pristine=si(()=>this.pristineReactive()),this.pristineReactive=Sr(!0),this._touched=si(()=>this.touchedReactive()),this.touchedReactive=Sr(!1),this._events=new Rt,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(r),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(r){this._rawValidators=this._composedValidatorFn=r}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(r){this._rawAsyncValidators=this._composedAsyncValidatorFn=r}get parent(){return this._parent}get status(){return hs(this.statusReactive)}set status(r){hs(()=>this.statusReactive.set(r))}get valid(){return this.status===wc}get invalid(){return this.status===Cf}get pending(){return this.status==Ro}get disabled(){return this.status===bc}get enabled(){return this.status!==bc}get pristine(){return hs(this.pristineReactive)}set pristine(r){hs(()=>this.pristineReactive.set(r))}get dirty(){return!this.pristine}get touched(){return hs(this.touchedReactive)}set touched(r){hs(()=>this.touchedReactive.set(r))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(r){this._assignValidators(r)}setAsyncValidators(r){this._assignAsyncValidators(r)}addValidators(r){this.setValidators(Xx(r,this._rawValidators))}addAsyncValidators(r){this.setAsyncValidators(Xx(r,this._rawAsyncValidators))}removeValidators(r){this.setValidators(Qx(r,this._rawValidators))}removeAsyncValidators(r){this.setAsyncValidators(Qx(r,this._rawAsyncValidators))}hasValidator(r){return Ef(this._rawValidators,r)}hasAsyncValidator(r){return Ef(this._rawAsyncValidators,r)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(r={}){let t=this.touched===!1;this.touched=!0;let n=r.sourceControl??this;this._parent&&!r.onlySelf&&this._parent.markAsTouched(ze(ie({},r),{sourceControl:n})),t&&r.emitEvent!==!1&&this._events.next(new Ec(!0,n))}markAllAsTouched(r={}){this.markAsTouched({onlySelf:!0,emitEvent:r.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(r))}markAsUntouched(r={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=r.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:r.emitEvent,sourceControl:n})}),this._parent&&!r.onlySelf&&this._parent._updateTouched(r,n),t&&r.emitEvent!==!1&&this._events.next(new Ec(!1,n))}markAsDirty(r={}){let t=this.pristine===!0;this.pristine=!1;let n=r.sourceControl??this;this._parent&&!r.onlySelf&&this._parent.markAsDirty(ze(ie({},r),{sourceControl:n})),t&&r.emitEvent!==!1&&this._events.next(new Cc(!1,n))}markAsPristine(r={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=r.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:r.emitEvent})}),this._parent&&!r.onlySelf&&this._parent._updatePristine(r,n),t&&r.emitEvent!==!1&&this._events.next(new Cc(!0,n))}markAsPending(r={}){this.status=Ro;let t=r.sourceControl??this;r.emitEvent!==!1&&(this._events.next(new Mo(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!r.onlySelf&&this._parent.markAsPending(ze(ie({},r),{sourceControl:t}))}disable(r={}){let t=this._parentMarkedDirty(r.onlySelf);this.status=bc,this.errors=null,this._forEachChild(i=>{i.disable(ze(ie({},r),{onlySelf:!0}))}),this._updateValue();let n=r.sourceControl??this;r.emitEvent!==!1&&(this._events.next(new Tf(this.value,n)),this._events.next(new Mo(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ze(ie({},r),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(r={}){let t=this._parentMarkedDirty(r.onlySelf);this.status=wc,this._forEachChild(n=>{n.enable(ze(ie({},r),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent}),this._updateAncestors(ze(ie({},r),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(r,t){this._parent&&!r.onlySelf&&(this._parent.updateValueAndValidity(r),r.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(r){this._parent=r}getRawValue(){return this.value}updateValueAndValidity(r={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===wc||this.status===Ro)&&this._runAsyncValidator(n,r.emitEvent)}let t=r.sourceControl??this;r.emitEvent!==!1&&(this._events.next(new Tf(this.value,t)),this._events.next(new Mo(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!r.onlySelf&&this._parent.updateValueAndValidity(ze(ie({},r),{sourceControl:t}))}_updateTreeValidity(r={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(r)),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?bc:wc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(r,t){if(this.asyncValidator){this.status=Ro,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=iy(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:r})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let r=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,r}return!1}setErrors(r,t={}){this.errors=r,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(r){let t=r;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(r,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[r]:null}hasError(r,t){return!!this.getError(r,t)}get root(){let r=this;for(;r._parent;)r=r._parent;return r}_updateControlsErrors(r,t,n){this.status=this._calculateStatus(),r&&this.statusChanges.emit(this.status),(r||n)&&this._events.next(new Mo(this.status,t)),this._parent&&this._parent._updateControlsErrors(r,t,n)}_initObservables(){this.valueChanges=new Be,this.statusChanges=new Be}_calculateStatus(){return this._allControlsDisabled()?bc:this.errors?Cf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ro)?Ro:this._anyControlsHaveStatus(Cf)?Cf:wc}_anyControlsHaveStatus(r){return this._anyControls(t=>t.status===r)}_anyControlsDirty(){return this._anyControls(r=>r.dirty)}_anyControlsTouched(){return this._anyControls(r=>r.touched)}_updatePristine(r,t){let n=!this._anyControlsDirty(),i=this.pristine!==n;this.pristine=n,this._parent&&!r.onlySelf&&this._parent._updatePristine(r,t),i&&this._events.next(new Cc(this.pristine,t))}_updateTouched(r={},t){this.touched=this._anyControlsTouched(),this._events.next(new Ec(this.touched,t)),this._parent&&!r.onlySelf&&this._parent._updateTouched(r,t)}_registerOnCollectionChange(r){this._onCollectionChange=r}_setUpdateStrategy(r){If(r)&&r.updateOn!=null&&(this._updateOn=r.updateOn)}_parentMarkedDirty(r){let t=this._parent&&this._parent.dirty;return!r&&!!t&&!this._parent._anyControlsDirty()}_find(r){return null}_assignValidators(r){this._rawValidators=Array.isArray(r)?r.slice():r,this._composedValidatorFn=C6(this._rawValidators)}_assignAsyncValidators(r){this._rawAsyncValidators=Array.isArray(r)?r.slice():r,this._composedAsyncValidatorFn=S6(this._rawAsyncValidators)}};var fy=new Kt("CallSetDisabledState",{providedIn:"root",factory:()=>hp}),hp="always";function T6(e,r){return[...r.path,e]}function I6(e,r,t=hp){A6(e,r),r.valueAccessor.writeValue(e.value),(e.disabled||t==="always")&&r.valueAccessor.setDisabledState?.(e.disabled),O6(e,r),D6(e,r),F6(e,r),k6(e,r)}function Yx(e,r){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(r)})}function k6(e,r){if(r.valueAccessor.setDisabledState){let t=n=>{r.valueAccessor.setDisabledState(n)};e.registerOnDisabledChange(t),r._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}function A6(e,r){let t=x6(e);r.validator!==null?e.setValidators(qx(t,r.validator)):typeof t=="function"&&e.setValidators([t]);let n=y6(e);r.asyncValidator!==null?e.setAsyncValidators(qx(n,r.asyncValidator)):typeof n=="function"&&e.setAsyncValidators([n]);let i=()=>e.updateValueAndValidity();Yx(r._rawValidators,i),Yx(r._rawAsyncValidators,i)}function O6(e,r){r.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&hy(e,r)})}function F6(e,r){r.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&hy(e,r),e.updateOn!=="submit"&&e.markAsTouched()})}function hy(e,r){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),r.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function D6(e,r){let t=(n,i)=>{r.valueAccessor.writeValue(n),i&&r.viewToModelUpdate(n)};e.registerOnChange(t),r._registerOnDestroy(()=>{e._unregisterOnChange(t)})}function R6(e,r){if(!e.hasOwnProperty("model"))return!1;let t=e.model;return t.isFirstChange()?!0:!Object.is(r,t.currentValue)}function M6(e){return Object.getPrototypeOf(e.constructor)===u6}function N6(e,r){if(!r)return null;Array.isArray(r);let t,n,i;return r.forEach(a=>{a.constructor===ry?t=a:M6(a)?n=a:i=a}),i||n||t||null}function Zx(e,r){let t=e.indexOf(r);t>-1&&e.splice(t,1)}function Jx(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var P6=class extends fp{constructor(r=null,t,n){super(b6(t),E6(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(r),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),If(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Jx(r)?this.defaultValue=r.value:this.defaultValue=r)}setValue(r,t={}){this.value=this._pendingValue=r,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(r,t={}){this.setValue(r,t)}reset(r=this.defaultValue,t={}){this._applyFormState(r),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(r){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(r){this._onChange.push(r)}_unregisterOnChange(r){Zx(this._onChange,r)}registerOnDisabledChange(r){this._onDisabledChange.push(r)}_unregisterOnDisabledChange(r){Zx(this._onDisabledChange,r)}_forEachChild(r){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(r){Jx(r)?(this.value=this._pendingValue=r.value,r.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=r}};var L6={provide:Ps,useExisting:ea(()=>Sc)},ey=Promise.resolve(),Sc=(()=>{let r=class r extends Ps{constructor(n,i,a,s,o,l){super(),this._changeDetectorRef=o,this.callSetDisabledState=l,this.control=new P6,this._registered=!1,this.name="",this.update=new Be,this._parent=n,this._setValidators(i),this._setAsyncValidators(a),this.valueAccessor=N6(this,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),R6(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){I6(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){ey.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,a=i!==0&&Se(i);ey.then(()=>{a&&!this.control.disabled?this.control.disable():!a&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?T6(n,this._parent):[n]}};r.\u0275fac=function(i){return new(i||r)(ce(cp,9),ce(p6,10),ce(m6,10),ce(Po,10),ce(hr,8),ce(fy,8))},r.\u0275dir=Mr({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ta([L6]),Lt,Da]});let e=r;return e})();var B6=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=ct({});let e=r;return e})();var dy=(()=>{let r=class r{static withConfig(n){return{ngModule:r,providers:[{provide:fy,useValue:n.callSetDisabledState??hp}]}}};r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=ct({imports:[B6]});let e=r;return e})();var V6=["overlay"],U6=["content"],$6=["*"],W6=(e,r,t,n,i,a,s,o,l,c,u,f,h,d)=>({"p-overlay p-component":!0,"p-overlay-modal p-component-overlay p-component-overlay-enter":e,"p-overlay-center":r,"p-overlay-top":t,"p-overlay-top-start":n,"p-overlay-top-end":i,"p-overlay-bottom":a,"p-overlay-bottom-start":s,"p-overlay-bottom-end":o,"p-overlay-left":l,"p-overlay-left-start":c,"p-overlay-left-end":u,"p-overlay-right":f,"p-overlay-right-start":h,"p-overlay-right-end":d}),H6=(e,r,t)=>({showTransitionParams:e,hideTransitionParams:r,transform:t}),z6=e=>({value:"visible",params:e}),j6=e=>({mode:e}),G6=e=>({$implicit:e});function K6(e,r){e&1&&st(0)}function q6(e,r){if(e&1){let t=nt();z(0,"div",3,1),Pe("click",function(i){_e(t);let a=P(2);return xe(a.onOverlayContentClick(i))})("@overlayContentAnimation.start",function(i){_e(t);let a=P(2);return xe(a.onOverlayContentAnimationStart(i))})("@overlayContentAnimation.done",function(i){_e(t);let a=P(2);return xe(a.onOverlayContentAnimationDone(i))}),xr(2),Y(3,K6,1,0,"ng-container",4),j()}if(e&2){let t=P(2);Ve(t.contentStyleClass),b("ngStyle",t.contentStyle)("ngClass","p-overlay-content")("@overlayContentAnimation",gt(11,z6,io(7,H6,t.showTransitionOptions,t.hideTransitionOptions,t.transformOptions[t.modal?t.overlayResponsiveDirection:"default"]))),S(3),b("ngTemplateOutlet",t.contentTemplate)("ngTemplateOutletContext",gt(15,G6,gt(13,j6,t.overlayMode)))}}function X6(e,r){if(e&1){let t=nt();z(0,"div",3,0),Pe("click",function(){_e(t);let i=P();return xe(i.onOverlayClick())}),Y(2,q6,4,17,"div",2),j()}if(e&2){let t=P();Ve(t.styleClass),b("ngStyle",t.style)("ngClass",Ng(5,W6,[t.modal,t.modal&&t.overlayResponsiveDirection==="center",t.modal&&t.overlayResponsiveDirection==="top",t.modal&&t.overlayResponsiveDirection==="top-start",t.modal&&t.overlayResponsiveDirection==="top-end",t.modal&&t.overlayResponsiveDirection==="bottom",t.modal&&t.overlayResponsiveDirection==="bottom-start",t.modal&&t.overlayResponsiveDirection==="bottom-end",t.modal&&t.overlayResponsiveDirection==="left",t.modal&&t.overlayResponsiveDirection==="left-start",t.modal&&t.overlayResponsiveDirection==="left-end",t.modal&&t.overlayResponsiveDirection==="right",t.modal&&t.overlayResponsiveDirection==="right-start",t.modal&&t.overlayResponsiveDirection==="right-end"])),S(2),b("ngIf",t.visible)}}var Q6={provide:Po,useExisting:ea(()=>dp),multi:!0},Y6=lh([Ui({transform:"{{transform}}",opacity:0}),ra("{{showTransitionParams}}")]),Z6=lh([ra("{{hideTransitionParams}}",Ui({transform:"{{transform}}",opacity:0}))]),dp=(()=>{class e{document;platformId;el;renderer;config;overlayService;cd;zone;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.modalVisible&&(this.modalVisible=!0)}get mode(){return this._mode||this.overlayOptions?.mode}set mode(t){this._mode=t}get style(){return Je.merge(this._style,this.modal?this.overlayResponsiveOptions?.style:this.overlayOptions?.style)}set style(t){this._style=t}get styleClass(){return Je.merge(this._styleClass,this.modal?this.overlayResponsiveOptions?.styleClass:this.overlayOptions?.styleClass)}set styleClass(t){this._styleClass=t}get contentStyle(){return Je.merge(this._contentStyle,this.modal?this.overlayResponsiveOptions?.contentStyle:this.overlayOptions?.contentStyle)}set contentStyle(t){this._contentStyle=t}get contentStyleClass(){return Je.merge(this._contentStyleClass,this.modal?this.overlayResponsiveOptions?.contentStyleClass:this.overlayOptions?.contentStyleClass)}set contentStyleClass(t){this._contentStyleClass=t}get target(){let t=this._target||this.overlayOptions?.target;return t===void 0?"@prev":t}set target(t){this._target=t}get appendTo(){return this._appendTo||this.overlayOptions?.appendTo}set appendTo(t){this._appendTo=t}get autoZIndex(){let t=this._autoZIndex||this.overlayOptions?.autoZIndex;return t===void 0?!0:t}set autoZIndex(t){this._autoZIndex=t}get baseZIndex(){let t=this._baseZIndex||this.overlayOptions?.baseZIndex;return t===void 0?0:t}set baseZIndex(t){this._baseZIndex=t}get showTransitionOptions(){let t=this._showTransitionOptions||this.overlayOptions?.showTransitionOptions;return t===void 0?".12s cubic-bezier(0, 0, 0.2, 1)":t}set showTransitionOptions(t){this._showTransitionOptions=t}get hideTransitionOptions(){let t=this._hideTransitionOptions||this.overlayOptions?.hideTransitionOptions;return t===void 0?".1s linear":t}set hideTransitionOptions(t){this._hideTransitionOptions=t}get listener(){return this._listener||this.overlayOptions?.listener}set listener(t){this._listener=t}get responsive(){return this._responsive||this.overlayOptions?.responsive}set responsive(t){this._responsive=t}get options(){return this._options}set options(t){this._options=t}visibleChange=new Be;onBeforeShow=new Be;onShow=new Be;onBeforeHide=new Be;onHide=new Be;onAnimationStart=new Be;onAnimationDone=new Be;templates;overlayViewChild;contentViewChild;contentTemplate;_visible=!1;_mode;_style;_styleClass;_contentStyle;_contentStyleClass;_target;_appendTo;_autoZIndex;_baseZIndex;_showTransitionOptions;_hideTransitionOptions;_listener;_responsive;_options;modalVisible=!1;isOverlayClicked=!1;isOverlayContentClicked=!1;scrollHandler;documentClickListener;documentResizeListener;documentKeyboardListener;window;transformOptions={default:"scaleY(0.8)",center:"scale(0.7)",top:"translate3d(0px, -100%, 0px)","top-start":"translate3d(0px, -100%, 0px)","top-end":"translate3d(0px, -100%, 0px)",bottom:"translate3d(0px, 100%, 0px)","bottom-start":"translate3d(0px, 100%, 0px)","bottom-end":"translate3d(0px, 100%, 0px)",left:"translate3d(-100%, 0px, 0px)","left-start":"translate3d(-100%, 0px, 0px)","left-end":"translate3d(-100%, 0px, 0px)",right:"translate3d(100%, 0px, 0px)","right-start":"translate3d(100%, 0px, 0px)","right-end":"translate3d(100%, 0px, 0px)"};get modal(){if(qr(this.platformId))return this.mode==="modal"||this.overlayResponsiveOptions&&this.window?.matchMedia(this.overlayResponsiveOptions.media?.replace("@media","")||`(max-width: ${this.overlayResponsiveOptions.breakpoint})`).matches}get overlayMode(){return this.mode||(this.modal?"modal":"overlay")}get overlayOptions(){return ie(ie({},this.config?.overlayOptions),this.options)}get overlayResponsiveOptions(){return ie(ie({},this.overlayOptions?.responsive),this.responsive)}get overlayResponsiveDirection(){return this.overlayResponsiveOptions?.direction||"center"}get overlayEl(){return this.overlayViewChild?.nativeElement}get contentEl(){return this.contentViewChild?.nativeElement}get targetEl(){return J.getTargetElement(this.target,this.el?.nativeElement)}constructor(t,n,i,a,s,o,l,c){this.document=t,this.platformId=n,this.el=i,this.renderer=a,this.config=s,this.overlayService=o,this.cd=l,this.zone=c,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}show(t,n=!1){this.onVisibleChange(!0),this.handleEvents("onShow",{overlay:t||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),n&&J.focus(this.targetEl),this.modal&&J.addClass(this.document?.body,"p-overflow-hidden")}hide(t,n=!1){if(this.visible)this.onVisibleChange(!1),this.handleEvents("onHide",{overlay:t||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),n&&J.focus(this.targetEl),this.modal&&J.removeClass(this.document?.body,"p-overflow-hidden");else return}alignOverlay(){!this.modal&&J.alignOverlay(this.overlayEl,this.targetEl,this.appendTo)}onVisibleChange(t){this._visible=t,this.visibleChange.emit(t)}onOverlayClick(){this.isOverlayClicked=!0}onOverlayContentClick(t){this.overlayService.add({originalEvent:t,target:this.targetEl}),this.isOverlayContentClicked=!0}onOverlayContentAnimationStart(t){switch(t.toState){case"visible":this.handleEvents("onBeforeShow",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.autoZIndex&&ui.set(this.overlayMode,this.overlayEl,this.baseZIndex+this.config?.zIndex[this.overlayMode]),J.appendOverlay(this.overlayEl,this.appendTo==="body"?this.document.body:this.appendTo,this.appendTo),this.alignOverlay();break;case"void":this.handleEvents("onBeforeHide",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.modal&&J.addClass(this.overlayEl,"p-component-overlay-leave");break}this.handleEvents("onAnimationStart",t)}onOverlayContentAnimationDone(t){let n=this.overlayEl||t.element.parentElement;switch(t.toState){case"visible":this.visible&&this.show(n,!0),this.bindListeners();break;case"void":if(!this.visible){this.hide(n,!0),this.modalVisible=!1,this.unbindListeners(),J.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),ui.clear(n),this.cd.markForCheck();break}}this.handleEvents("onAnimationDone",t)}handleEvents(t,n){this[t].emit(n),this.options&&this.options[t]&&this.options[t](n),this.config?.overlayOptions&&(this.config?.overlayOptions)[t]&&(this.config?.overlayOptions)[t](n)}bindListeners(){this.unbindListeners(),this.bindScrollListener(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindDocumentKeyboardListener()}unbindListeners(){this.unbindScrollListener(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindDocumentKeyboardListener()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new _o(this.targetEl,t=>{(this.listener?this.listener(t,{type:"scroll",mode:this.overlayMode,valid:!0}):!0)&&this.hide(t,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.document,"click",t=>{let i=!(this.targetEl&&(this.targetEl.isSameNode(t.target)||!this.isOverlayClicked&&this.targetEl.contains(t.target)))&&!this.isOverlayContentClicked;(this.listener?this.listener(t,{type:"outside",mode:this.overlayMode,valid:t.which!==3&&i}):i)&&this.hide(t),this.isOverlayClicked=this.isOverlayContentClicked=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener||(this.documentResizeListener=this.renderer.listen(this.window,"resize",t=>{(this.listener?this.listener(t,{type:"resize",mode:this.overlayMode,valid:!J.isTouchDevice()}):!J.isTouchDevice())&&this.hide(t,!0)}))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindDocumentKeyboardListener(){this.documentKeyboardListener||this.zone.runOutsideAngular(()=>{this.documentKeyboardListener=this.renderer.listen(this.window,"keydown",t=>{if(this.overlayOptions.hideOnEscape===!1||t.code!=="Escape")return;(this.listener?this.listener(t,{type:"keydown",mode:this.overlayMode,valid:!J.isTouchDevice()}):!J.isTouchDevice())&&this.zone.run(()=>{this.hide(t,!0)})})})}unbindDocumentKeyboardListener(){this.documentKeyboardListener&&(this.documentKeyboardListener(),this.documentKeyboardListener=null)}ngOnDestroy(){this.hide(this.overlayEl,!0),this.overlayEl&&(J.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),ui.clear(this.overlayEl)),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindListeners()}static \u0275fac=function(n){return new(n||e)(ce(Ut),ce(Er),ce(qt),ce(Nr),ce(an),ce(ev),ce(hr),ce(fr))};static \u0275cmp=Fe({type:e,selectors:[["p-overlay"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(At(V6,5),At(U6,5)),n&2){let a;je(a=Ge())&&(i.overlayViewChild=a.first),je(a=Ge())&&(i.contentViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{visible:"visible",mode:"mode",style:"style",styleClass:"styleClass",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",target:"target",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",listener:"listener",responsive:"responsive",options:"options"},outputs:{visibleChange:"visibleChange",onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onAnimationStart:"onAnimationStart",onAnimationDone:"onAnimationDone"},features:[ta([Q6])],ngContentSelectors:$6,decls:1,vars:1,consts:[["overlay",""],["content",""],[3,"ngStyle","class","ngClass","click",4,"ngIf"],[3,"click","ngStyle","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){n&1&&(Pr(),Y(0,X6,3,20,"div",2)),n&2&&b("ngIf",i.modalVisible)},dependencies:[dr,yr,wr,or],styles:[`@layer primeng{.p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}}
`],encapsulation:2,data:{animation:[ds("overlayContentAnimation",[$i(":enter",[ch(Y6)]),$i(":leave",[ch(Z6)])])]},changeDetection:0})}return e})(),pp=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr,lr]})}return e})();var e5=["element"],t5=["content"],r5=["*"],n5=(e,r,t)=>({"p-scroller":!0,"p-scroller-inline":e,"p-both-scroll":r,"p-horizontal-scroll":t}),mp=(e,r)=>({$implicit:e,options:r}),i5=e=>({"p-scroller-loading":e}),a5=e=>({"p-component-overlay":e}),s5=e=>({numCols:e}),my=e=>({options:e}),o5=()=>({styleClass:"p-scroller-loading-icon"}),l5=(e,r)=>({rows:e,columns:r});function c5(e,r){e&1&&st(0)}function u5(e,r){if(e&1&&(Ye(0),Y(1,c5,1,0,"ng-container",10),Ze()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.contentTemplate)("ngTemplateOutletContext",Hr(2,mp,t.loadedItems,t.getContentOptions()))}}function f5(e,r){e&1&&st(0)}function h5(e,r){if(e&1&&(Ye(0),Y(1,f5,1,0,"ng-container",10),Ze()),e&2){let t=r.$implicit,n=r.index,i=P(3);S(),b("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",Hr(2,mp,t,i.getOptions(n)))}}function d5(e,r){if(e&1&&(z(0,"div",11,3),Y(2,h5,2,5,"ng-container",12),j()),e&2){let t=P(2);b("ngClass",gt(5,i5,t.d_loading))("ngStyle",t.contentStyle),ee("data-pc-section","content"),S(2),b("ngForOf",t.loadedItems)("ngForTrackBy",t._trackBy||t.index)}}function p5(e,r){if(e&1&&ue(0,"div",13),e&2){let t=P(2);b("ngStyle",t.spacerStyle),ee("data-pc-section","spacer")}}function m5(e,r){e&1&&st(0)}function g5(e,r){if(e&1&&(Ye(0),Y(1,m5,1,0,"ng-container",10),Ze()),e&2){let t=r.index,n=P(4);S(),b("ngTemplateOutlet",n.loaderTemplate)("ngTemplateOutletContext",gt(4,my,n.getLoaderOptions(t,n.both&&gt(2,s5,n._numItemsInViewport.cols))))}}function v5(e,r){if(e&1&&(Ye(0),Y(1,g5,2,6,"ng-container",15),Ze()),e&2){let t=P(3);S(),b("ngForOf",t.loaderArr)}}function _5(e,r){e&1&&st(0)}function x5(e,r){if(e&1&&(Ye(0),Y(1,_5,1,0,"ng-container",10),Ze()),e&2){let t=P(4);S(),b("ngTemplateOutlet",t.loaderIconTemplate)("ngTemplateOutletContext",gt(3,my,fs(2,o5)))}}function y5(e,r){e&1&&ue(0,"SpinnerIcon",16),e&2&&(b("styleClass","p-scroller-loading-icon pi-spin"),ee("data-pc-section","loadingIcon"))}function w5(e,r){if(e&1&&Y(0,x5,2,5,"ng-container",6)(1,y5,1,2,"ng-template",null,5,rn),e&2){let t=sr(2),n=P(3);b("ngIf",n.loaderIconTemplate)("ngIfElse",t)}}function b5(e,r){if(e&1&&(z(0,"div",14),Y(1,v5,2,1,"ng-container",6)(2,w5,3,2,"ng-template",null,4,rn),j()),e&2){let t=sr(3),n=P(2);b("ngClass",gt(4,a5,!n.loaderTemplate)),ee("data-pc-section","loader"),S(),b("ngIf",n.loaderTemplate)("ngIfElse",t)}}function C5(e,r){if(e&1){let t=nt();Ye(0),z(1,"div",7,1),Pe("scroll",function(i){_e(t);let a=P();return xe(a.onContainerScroll(i))}),Y(3,u5,2,5,"ng-container",6)(4,d5,3,7,"ng-template",null,2,rn)(6,p5,1,2,"div",8)(7,b5,4,6,"div",9),j(),Ze()}if(e&2){let t=sr(5),n=P();S(),Ve(n._styleClass),b("ngStyle",n._style)("ngClass",io(12,n5,n.inline,n.both,n.horizontal)),ee("id",n._id)("tabindex",n.tabindex)("data-pc-name","scroller")("data-pc-section","root"),S(2),b("ngIf",n.contentTemplate)("ngIfElse",t),S(3),b("ngIf",n._showSpacer),S(),b("ngIf",!n.loaderDisabled&&n._showLoader&&n.d_loading)}}function E5(e,r){e&1&&st(0)}function S5(e,r){if(e&1&&(Ye(0),Y(1,E5,1,0,"ng-container",10),Ze()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.contentTemplate)("ngTemplateOutletContext",Hr(5,mp,t.items,Hr(2,l5,t._items,t.loadedColumns)))}}function T5(e,r){if(e&1&&(xr(0),Y(1,S5,2,8,"ng-container",17)),e&2){let t=P();S(),b("ngIf",t.contentTemplate)}}var gy=(()=>{class e{document;platformId;renderer;cd;zone;get id(){return this._id}set id(t){this._id=t}get style(){return this._style}set style(t){this._style=t}get styleClass(){return this._styleClass}set styleClass(t){this._styleClass=t}get tabindex(){return this._tabindex}set tabindex(t){this._tabindex=t}get items(){return this._items}set items(t){this._items=t}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=t}get scrollHeight(){return this._scrollHeight}set scrollHeight(t){this._scrollHeight=t}get scrollWidth(){return this._scrollWidth}set scrollWidth(t){this._scrollWidth=t}get orientation(){return this._orientation}set orientation(t){this._orientation=t}get step(){return this._step}set step(t){this._step=t}get delay(){return this._delay}set delay(t){this._delay=t}get resizeDelay(){return this._resizeDelay}set resizeDelay(t){this._resizeDelay=t}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=t}get inline(){return this._inline}set inline(t){this._inline=t}get lazy(){return this._lazy}set lazy(t){this._lazy=t}get disabled(){return this._disabled}set disabled(t){this._disabled=t}get loaderDisabled(){return this._loaderDisabled}set loaderDisabled(t){this._loaderDisabled=t}get columns(){return this._columns}set columns(t){this._columns=t}get showSpacer(){return this._showSpacer}set showSpacer(t){this._showSpacer=t}get showLoader(){return this._showLoader}set showLoader(t){this._showLoader=t}get numToleratedItems(){return this._numToleratedItems}set numToleratedItems(t){this._numToleratedItems=t}get loading(){return this._loading}set loading(t){this._loading=t}get autoSize(){return this._autoSize}set autoSize(t){this._autoSize=t}get trackBy(){return this._trackBy}set trackBy(t){this._trackBy=t}get options(){return this._options}set options(t){this._options=t,t&&typeof t=="object"&&Object.entries(t).forEach(([n,i])=>this[`_${n}`]!==i&&(this[`_${n}`]=i))}onLazyLoad=new Be;onScroll=new Be;onScrollIndexChange=new Be;elementViewChild;contentViewChild;templates;_id;_style;_styleClass;_tabindex=0;_items;_itemSize=0;_scrollHeight;_scrollWidth;_orientation="vertical";_step=0;_delay=0;_resizeDelay=10;_appendOnly=!1;_inline=!1;_lazy=!1;_disabled=!1;_loaderDisabled=!1;_columns;_showSpacer=!0;_showLoader=!1;_numToleratedItems;_loading;_autoSize=!1;_trackBy;_options;d_loading=!1;d_numToleratedItems;contentEl;contentTemplate;itemTemplate;loaderTemplate;loaderIconTemplate;first=0;last=0;page=0;isRangeChanged=!1;numItemsInViewport=0;lastScrollPos=0;lazyLoadState={};loaderArr=[];spacerStyle={};contentStyle={};scrollTimeout;resizeTimeout;initialized=!1;windowResizeListener;defaultWidth;defaultHeight;defaultContentWidth;defaultContentHeight;get vertical(){return this._orientation==="vertical"}get horizontal(){return this._orientation==="horizontal"}get both(){return this._orientation==="both"}get loadedItems(){return this._items&&!this.d_loading?this.both?this._items.slice(this._appendOnly?0:this.first.rows,this.last.rows).map(t=>this._columns?t:t.slice(this._appendOnly?0:this.first.cols,this.last.cols)):this.horizontal&&this._columns?this._items:this._items.slice(this._appendOnly?0:this.first,this.last):[]}get loadedRows(){return this.d_loading?this._loaderDisabled?this.loaderArr:[]:this.loadedItems}get loadedColumns(){return this._columns&&(this.both||this.horizontal)?this.d_loading&&this._loaderDisabled?this.both?this.loaderArr[0]:this.loaderArr:this._columns.slice(this.both?this.first.cols:this.first,this.both?this.last.cols:this.last):this._columns}constructor(t,n,i,a,s){this.document=t,this.platformId=n,this.renderer=i,this.cd=a,this.zone=s}ngOnInit(){this.setInitialState()}ngOnChanges(t){let n=!1;if(t.loading){let{previousValue:i,currentValue:a}=t.loading;this.lazy&&i!==a&&a!==this.d_loading&&(this.d_loading=a,n=!0)}if(t.orientation&&(this.lastScrollPos=this.both?{top:0,left:0}:0),t.numToleratedItems){let{previousValue:i,currentValue:a}=t.numToleratedItems;i!==a&&a!==this.d_numToleratedItems&&(this.d_numToleratedItems=a)}if(t.options){let{previousValue:i,currentValue:a}=t.options;this.lazy&&i?.loading!==a?.loading&&a?.loading!==this.d_loading&&(this.d_loading=a.loading,n=!0),i?.numToleratedItems!==a?.numToleratedItems&&a?.numToleratedItems!==this.d_numToleratedItems&&(this.d_numToleratedItems=a.numToleratedItems)}this.initialized&&!n&&(t.items?.previousValue?.length!==t.items?.currentValue?.length||t.itemSize||t.scrollHeight||t.scrollWidth)&&(this.init(),this.calculateAutoSize())}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;case"item":this.itemTemplate=t.template;break;case"loader":this.loaderTemplate=t.template;break;case"loadericon":this.loaderIconTemplate=t.template;break;default:this.itemTemplate=t.template;break}})}ngAfterViewInit(){Promise.resolve().then(()=>{this.viewInit()})}ngAfterViewChecked(){this.initialized||this.viewInit()}ngOnDestroy(){this.unbindResizeListener(),this.contentEl=null,this.initialized=!1}viewInit(){qr(this.platformId)&&!this.initialized&&J.isVisible(this.elementViewChild?.nativeElement)&&(this.setInitialState(),this.setContentEl(this.contentEl),this.init(),this.calculateAutoSize(),this.defaultWidth=J.getWidth(this.elementViewChild?.nativeElement),this.defaultHeight=J.getHeight(this.elementViewChild?.nativeElement),this.defaultContentWidth=J.getWidth(this.contentEl),this.defaultContentHeight=J.getHeight(this.contentEl),this.initialized=!0)}init(){this._disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize(),this.bindResizeListener(),this.cd.detectChanges())}setContentEl(t){this.contentEl=t||this.contentViewChild?.nativeElement||J.findSingle(this.elementViewChild?.nativeElement,".p-scroller-content")}setInitialState(){this.first=this.both?{rows:0,cols:0}:0,this.last=this.both?{rows:0,cols:0}:0,this.numItemsInViewport=this.both?{rows:0,cols:0}:0,this.lastScrollPos=this.both?{top:0,left:0}:0,this.d_loading=this._loading||!1,this.d_numToleratedItems=this._numToleratedItems,this.loaderArr=[],this.spacerStyle={},this.contentStyle={}}getElementRef(){return this.elementViewChild}getPageByFirst(t){return Math.floor(((t??this.first)+this.d_numToleratedItems*4)/(this._step||1))}isPageChanged(t){return this._step?this.page!==this.getPageByFirst(t??this.first):!0}scrollTo(t){this.elementViewChild?.nativeElement?.scrollTo(t)}scrollToIndex(t,n="auto"){if(this.both?t.every(a=>a>-1):t>-1){let a=this.first,{scrollTop:s=0,scrollLeft:o=0}=this.elementViewChild?.nativeElement,{numToleratedItems:l}=this.calculateNumItems(),c=this.getContentPosition(),u=this.itemSize,f=(m=0,x)=>m<=x?0:m,h=(m,x,_)=>m*x+_,d=(m=0,x=0)=>this.scrollTo({left:m,top:x,behavior:n}),g=this.both?{rows:0,cols:0}:0,v=!1,p=!1;this.both?(g={rows:f(t[0],l[0]),cols:f(t[1],l[1])},d(h(g.cols,u[1],c.left),h(g.rows,u[0],c.top)),p=this.lastScrollPos.top!==s||this.lastScrollPos.left!==o,v=g.rows!==a.rows||g.cols!==a.cols):(g=f(t,l),this.horizontal?d(h(g,u,c.left),s):d(o,h(g,u,c.top)),p=this.lastScrollPos!==(this.horizontal?o:s),v=g!==a),this.isRangeChanged=v,p&&(this.first=g)}}scrollInView(t,n,i="auto"){if(n){let{first:a,viewport:s}=this.getRenderedRange(),o=(u=0,f=0)=>this.scrollTo({left:u,top:f,behavior:i}),l=n==="to-start",c=n==="to-end";if(l){if(this.both)s.first.rows-a.rows>t[0]?o(s.first.cols*this._itemSize[1],(s.first.rows-1)*this._itemSize[0]):s.first.cols-a.cols>t[1]&&o((s.first.cols-1)*this._itemSize[1],s.first.rows*this._itemSize[0]);else if(s.first-a>t){let u=(s.first-1)*this._itemSize;this.horizontal?o(u,0):o(0,u)}}else if(c){if(this.both)s.last.rows-a.rows<=t[0]+1?o(s.first.cols*this._itemSize[1],(s.first.rows+1)*this._itemSize[0]):s.last.cols-a.cols<=t[1]+1&&o((s.first.cols+1)*this._itemSize[1],s.first.rows*this._itemSize[0]);else if(s.last-a<=t+1){let u=(s.first+1)*this._itemSize;this.horizontal?o(u,0):o(0,u)}}}else this.scrollToIndex(t,i)}getRenderedRange(){let t=(a,s)=>s||a?Math.floor(a/(s||a)):0,n=this.first,i=0;if(this.elementViewChild?.nativeElement){let{scrollTop:a,scrollLeft:s}=this.elementViewChild.nativeElement;if(this.both)n={rows:t(a,this._itemSize[0]),cols:t(s,this._itemSize[1])},i={rows:n.rows+this.numItemsInViewport.rows,cols:n.cols+this.numItemsInViewport.cols};else{let o=this.horizontal?s:a;n=t(o,this._itemSize),i=n+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:n,last:i}}}calculateNumItems(){let t=this.getContentPosition(),n=(this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetWidth-t.left:0)||0,i=(this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetHeight-t.top:0)||0,a=(c,u)=>u||c?Math.ceil(c/(u||c)):0,s=c=>Math.ceil(c/2),o=this.both?{rows:a(i,this._itemSize[0]),cols:a(n,this._itemSize[1])}:a(this.horizontal?n:i,this._itemSize),l=this.d_numToleratedItems||(this.both?[s(o.rows),s(o.cols)]:s(o));return{numItemsInViewport:o,numToleratedItems:l}}calculateOptions(){let{numItemsInViewport:t,numToleratedItems:n}=this.calculateNumItems(),i=(o,l,c,u=!1)=>this.getLast(o+l+(o<c?2:3)*c,u),a=this.first,s=this.both?{rows:i(this.first.rows,t.rows,n[0]),cols:i(this.first.cols,t.cols,n[1],!0)}:i(this.first,t,n);this.last=s,this.numItemsInViewport=t,this.d_numToleratedItems=n,this.showLoader&&(this.loaderArr=this.both?Array.from({length:t.rows}).map(()=>Array.from({length:t.cols})):Array.from({length:t})),this._lazy&&Promise.resolve().then(()=>{this.lazyLoadState={first:this._step?this.both?{rows:0,cols:a.cols}:0:a,last:Math.min(this._step?this._step:this.last,this.items.length)},this.handleEvents("onLazyLoad",this.lazyLoadState)})}calculateAutoSize(){this._autoSize&&!this.d_loading&&Promise.resolve().then(()=>{if(this.contentEl){this.contentEl.style.minHeight=this.contentEl.style.minWidth="auto",this.contentEl.style.position="relative",this.elementViewChild.nativeElement.style.contain="none";let[t,n]=[J.getWidth(this.contentEl),J.getHeight(this.contentEl)];t!==this.defaultContentWidth&&(this.elementViewChild.nativeElement.style.width=""),n!==this.defaultContentHeight&&(this.elementViewChild.nativeElement.style.height="");let[i,a]=[J.getWidth(this.elementViewChild.nativeElement),J.getHeight(this.elementViewChild.nativeElement)];(this.both||this.horizontal)&&(this.elementViewChild.nativeElement.style.width=i<this.defaultWidth?i+"px":this._scrollWidth||this.defaultWidth+"px"),(this.both||this.vertical)&&(this.elementViewChild.nativeElement.style.height=a<this.defaultHeight?a+"px":this._scrollHeight||this.defaultHeight+"px"),this.contentEl.style.minHeight=this.contentEl.style.minWidth="",this.contentEl.style.position="",this.elementViewChild.nativeElement.style.contain=""}})}getLast(t=0,n=!1){return this._items?Math.min(n?(this._columns||this._items[0]).length:this._items.length,t):0}getContentPosition(){if(this.contentEl){let t=getComputedStyle(this.contentEl),n=parseFloat(t.paddingLeft)+Math.max(parseFloat(t.left)||0,0),i=parseFloat(t.paddingRight)+Math.max(parseFloat(t.right)||0,0),a=parseFloat(t.paddingTop)+Math.max(parseFloat(t.top)||0,0),s=parseFloat(t.paddingBottom)+Math.max(parseFloat(t.bottom)||0,0);return{left:n,right:i,top:a,bottom:s,x:n+i,y:a+s}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}}setSize(){if(this.elementViewChild?.nativeElement){let t=this.elementViewChild.nativeElement.parentElement.parentElement,n=this._scrollWidth||`${this.elementViewChild.nativeElement.offsetWidth||t.offsetWidth}px`,i=this._scrollHeight||`${this.elementViewChild.nativeElement.offsetHeight||t.offsetHeight}px`,a=(s,o)=>this.elementViewChild.nativeElement.style[s]=o;this.both||this.horizontal?(a("height",i),a("width",n)):a("height",i)}}setSpacerSize(){if(this._scrollHeight!=="100%"&&this._items){let t=this.getContentPosition(),n=(i,a,s,o=0)=>this.spacerStyle=ze(ie({},this.spacerStyle),{[`${i}`]:(a||[]).length*s+o+"px"});this.both?(n("height",this._items,this._itemSize[0],t.y),n("width",this._columns||this._items[1],this._itemSize[1],t.x)):this.horizontal?n("width",this._columns||this._items,this._itemSize,t.x):n("height",this._items,this._itemSize,t.y)}}setContentPosition(t){if(this.contentEl&&!this._appendOnly){let n=t?t.first:this.first,i=(s,o)=>s*o,a=(s=0,o=0)=>this.contentStyle=ze(ie({},this.contentStyle),{transform:`translate3d(${s}px, ${o}px, 0)`});if(this.both)a(i(n.cols,this._itemSize[1]),i(n.rows,this._itemSize[0]));else{let s=i(n,this._itemSize);this.horizontal?a(s,0):a(0,s)}}}onScrollPositionChange(t){let n=t.target,i=this.getContentPosition(),a=(p,m)=>p?p>m?p-m:p:0,s=(p,m)=>m||p?Math.floor(p/(m||p)):0,o=(p,m,x,_,w,D)=>p<=w?w:D?x-_-w:m+w-1,l=(p,m,x,_,w,D,U)=>p<=D?0:Math.max(0,U?p<m?x:p-D:p>m?x:p-2*D),c=(p,m,x,_,w,D=!1)=>{let U=m+_+2*w;return p>=w&&(U+=w+1),this.getLast(U,D)},u=a(n.scrollTop,i.top),f=a(n.scrollLeft,i.left),h=this.both?{rows:0,cols:0}:0,d=this.last,g=!1,v=this.lastScrollPos;if(this.both){let p=this.lastScrollPos.top<=u,m=this.lastScrollPos.left<=f;if(!this._appendOnly||this._appendOnly&&(p||m)){let x={rows:s(u,this._itemSize[0]),cols:s(f,this._itemSize[1])},_={rows:o(x.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],p),cols:o(x.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],m)};h={rows:l(x.rows,_.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],p),cols:l(x.cols,_.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],m)},d={rows:c(x.rows,h.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:c(x.cols,h.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},g=h.rows!==this.first.rows||d.rows!==this.last.rows||h.cols!==this.first.cols||d.cols!==this.last.cols||this.isRangeChanged,v={top:u,left:f}}}else{let p=this.horizontal?f:u,m=this.lastScrollPos<=p;if(!this._appendOnly||this._appendOnly&&m){let x=s(p,this._itemSize),_=o(x,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,m);h=l(x,_,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,m),d=c(x,h,this.last,this.numItemsInViewport,this.d_numToleratedItems),g=h!==this.first||d!==this.last||this.isRangeChanged,v=p}}return{first:h,last:d,isRangeChanged:g,scrollPos:v}}onScrollChange(t){let{first:n,last:i,isRangeChanged:a,scrollPos:s}=this.onScrollPositionChange(t);if(a){let o={first:n,last:i};if(this.setContentPosition(o),this.first=n,this.last=i,this.lastScrollPos=s,this.handleEvents("onScrollIndexChange",o),this._lazy&&this.isPageChanged(n)){let l={first:this._step?Math.min(this.getPageByFirst(n)*this._step,this.items.length-this._step):n,last:Math.min(this._step?(this.getPageByFirst(n)+1)*this._step:i,this.items.length)};(this.lazyLoadState.first!==l.first||this.lazyLoadState.last!==l.last)&&this.handleEvents("onLazyLoad",l),this.lazyLoadState=l}}}onContainerScroll(t){if(this.handleEvents("onScroll",{originalEvent:t}),this._delay&&this.isPageChanged()){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){let{isRangeChanged:n}=this.onScrollPositionChange(t);(n||(this._step?this.isPageChanged():!1))&&(this.d_loading=!0,this.cd.detectChanges())}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(t),this.d_loading&&this.showLoader&&(!this._lazy||this._loading===void 0)&&(this.d_loading=!1,this.page=this.getPageByFirst(),this.cd.detectChanges())},this._delay)}else!this.d_loading&&this.onScrollChange(t)}bindResizeListener(){qr(this.platformId)&&(this.windowResizeListener||this.zone.runOutsideAngular(()=>{let t=this.document.defaultView,n=J.isTouchDevice()?"orientationchange":"resize";this.windowResizeListener=this.renderer.listen(t,n,this.onWindowResize.bind(this))}))}unbindResizeListener(){this.windowResizeListener&&(this.windowResizeListener(),this.windowResizeListener=null)}onWindowResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{if(J.isVisible(this.elementViewChild?.nativeElement)){let[t,n]=[J.getWidth(this.elementViewChild?.nativeElement),J.getHeight(this.elementViewChild?.nativeElement)],[i,a]=[t!==this.defaultWidth,n!==this.defaultHeight];(this.both?i||a:this.horizontal?i:this.vertical?a:!1)&&this.zone.run(()=>{this.d_numToleratedItems=this._numToleratedItems,this.defaultWidth=t,this.defaultHeight=n,this.defaultContentWidth=J.getWidth(this.contentEl),this.defaultContentHeight=J.getHeight(this.contentEl),this.init(),this.calculateAutoSize()})}},this._resizeDelay)}handleEvents(t,n){return this.options&&this.options[t]?this.options[t](n):this[t].emit(n)}getContentOptions(){return{contentStyleClass:`p-scroller-content ${this.d_loading?"p-scroller-loading":""}`,items:this.loadedItems,getItemOptions:t=>this.getOptions(t),loading:this.d_loading,getLoaderOptions:(t,n)=>this.getLoaderOptions(t,n),itemSize:this._itemSize,rows:this.loadedRows,columns:this.loadedColumns,spacerStyle:this.spacerStyle,contentStyle:this.contentStyle,vertical:this.vertical,horizontal:this.horizontal,both:this.both}}getOptions(t){let n=(this._items||[]).length,i=this.both?this.first.rows+t:this.first+t;return{index:i,count:n,first:i===0,last:i===n-1,even:i%2===0,odd:i%2!==0}}getLoaderOptions(t,n){let i=this.loaderArr.length;return ie({index:t,count:i,first:t===0,last:t===i-1,even:t%2===0,odd:t%2!==0},n)}static \u0275fac=function(n){return new(n||e)(ce(Ut),ce(Er),ce(Nr),ce(hr),ce(fr))};static \u0275cmp=Fe({type:e,selectors:[["p-scroller"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(At(e5,5),At(t5,5)),n&2){let a;je(a=Ge())&&(i.elementViewChild=a.first),je(a=Ge())&&(i.contentViewChild=a.first)}},hostAttrs:[1,"p-scroller-viewport","p-element"],inputs:{id:"id",style:"style",styleClass:"styleClass",tabindex:"tabindex",items:"items",itemSize:"itemSize",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth",orientation:"orientation",step:"step",delay:"delay",resizeDelay:"resizeDelay",appendOnly:"appendOnly",inline:"inline",lazy:"lazy",disabled:"disabled",loaderDisabled:"loaderDisabled",columns:"columns",showSpacer:"showSpacer",showLoader:"showLoader",numToleratedItems:"numToleratedItems",loading:"loading",autoSize:"autoSize",trackBy:"trackBy",options:"options"},outputs:{onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange"},features:[Da],ngContentSelectors:r5,decls:3,vars:2,consts:[["disabledContainer",""],["element",""],["buildInContent",""],["content",""],["buildInLoader",""],["buildInLoaderIcon",""],[4,"ngIf","ngIfElse"],[3,"scroll","ngStyle","ngClass"],["class","p-scroller-spacer",3,"ngStyle",4,"ngIf"],["class","p-scroller-loader",3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-scroller-content",3,"ngClass","ngStyle"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-scroller-spacer",3,"ngStyle"],[1,"p-scroller-loader",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"styleClass"],[4,"ngIf"]],template:function(n,i){if(n&1&&(Pr(),Y(0,C5,8,16,"ng-container",6)(1,T5,2,1,"ng-template",null,0,rn)),n&2){let a=sr(2);b("ngIf",!i._disabled)("ngIfElse",a)}},dependencies:()=>[dr,oi,yr,wr,or,yc],styles:[`@layer primeng{p-scroller{flex:1;outline:0 none}.p-scroller{position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;outline:0 none}.p-scroller-content{position:absolute;top:0;left:0;min-height:100%;min-width:100%;will-change:transform}.p-scroller-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0;pointer-events:none}.p-scroller-loader{position:sticky;top:0;left:0;width:100%;height:100%}.p-scroller-loader.p-component-overlay{display:flex;align-items:center;justify-content:center}.p-scroller-loading-icon{scale:2}.p-scroller-inline .p-scroller-content{position:static}}
`],encapsulation:2})}return e})(),gp=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr,yc,lr]})}return e})();var vp=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["BlankIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:0,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg","v-bind","pti()"],["width","1","height","1","fill","currentColor","fill-opacity","0"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"rect",1),j())},encapsulation:2})}return e})();var _p=(()=>{class e extends rr{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["ChevronDownIcon"]],standalone:!0,features:[Lt,ot],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z","fill","currentColor"]],template:function(n,i){n&1&&(er(),z(0,"svg",0),ue(1,"path",1),j()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return e})();var xp=(()=>{class e extends rr{pathId;ngOnInit(){this.pathId="url(#"+br()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Pt(e)))(i||e)}})();static \u0275cmp=Fe({type:e,selectors:[["SearchIcon"]],standalone:!0,features:[Lt,ot],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M2.67602 11.0265C3.6661 11.688 4.83011 12.0411 6.02086 12.0411C6.81149 12.0411 7.59438 11.8854 8.32483 11.5828C8.87005 11.357 9.37808 11.0526 9.83317 10.6803L12.9769 13.8241C13.0323 13.8801 13.0983 13.9245 13.171 13.9548C13.2438 13.985 13.3219 14.0003 13.4007 14C13.4795 14.0003 13.5575 13.985 13.6303 13.9548C13.7031 13.9245 13.7691 13.8801 13.8244 13.8241C13.9367 13.7116 13.9998 13.5592 13.9998 13.4003C13.9998 13.2414 13.9367 13.089 13.8244 12.9765L10.6807 9.8328C11.053 9.37773 11.3573 8.86972 11.5831 8.32452C11.8857 7.59408 12.0414 6.81119 12.0414 6.02056C12.0414 4.8298 11.6883 3.66579 11.0268 2.67572C10.3652 1.68564 9.42494 0.913972 8.32483 0.45829C7.22472 0.00260857 6.01418 -0.116618 4.84631 0.115686C3.67844 0.34799 2.60568 0.921393 1.76369 1.76338C0.921698 2.60537 0.348296 3.67813 0.115991 4.84601C-0.116313 6.01388 0.00291375 7.22441 0.458595 8.32452C0.914277 9.42464 1.68595 10.3649 2.67602 11.0265ZM3.35565 2.0158C4.14456 1.48867 5.07206 1.20731 6.02086 1.20731C7.29317 1.20731 8.51338 1.71274 9.41304 2.6124C10.3127 3.51206 10.8181 4.73226 10.8181 6.00457C10.8181 6.95337 10.5368 7.88088 10.0096 8.66978C9.48251 9.45868 8.73328 10.0736 7.85669 10.4367C6.98011 10.7997 6.01554 10.8947 5.08496 10.7096C4.15439 10.5245 3.2996 10.0676 2.62869 9.39674C1.95778 8.72583 1.50089 7.87104 1.31579 6.94046C1.13068 6.00989 1.22568 5.04532 1.58878 4.16874C1.95187 3.29215 2.56675 2.54292 3.35565 2.0158Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&(er(),z(0,"svg",0)(1,"g"),ue(2,"path",1),j(),z(3,"defs")(4,"clipPath",2),ue(5,"rect",3),j()()()),n&2&&(Ve(i.getClassNames()),ee("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),S(),ee("clip-path",i.pathId),S(3),b("id",i.pathId))},encapsulation:2})}return e})();var Tc=e=>({height:e}),k5=(e,r,t)=>({"p-dropdown-item":!0,"p-highlight":e,"p-disabled":r,"p-focus":t}),yp=e=>({$implicit:e});function A5(e,r){e&1&&ue(0,"CheckIcon",4),e&2&&b("styleClass","p-dropdown-check-icon")}function O5(e,r){e&1&&ue(0,"BlankIcon",4),e&2&&b("styleClass","p-dropdown-blank-icon")}function F5(e,r){if(e&1&&(Ye(0),Y(1,A5,1,1,"CheckIcon",3)(2,O5,1,1,"BlankIcon",3),Ze()),e&2){let t=P();S(),b("ngIf",t.selected),S(),b("ngIf",!t.selected)}}function D5(e,r){if(e&1&&(z(0,"span"),Ct(1),j()),e&2){let t,n=P();S(),Tr((t=n.label)!==null&&t!==void 0?t:"empty")}}function R5(e,r){e&1&&st(0)}var M5=["container"],N5=["filter"],P5=["focusInput"],L5=["editableInput"],B5=["items"],V5=["scroller"],U5=["overlay"],$5=["firstHiddenFocusableEl"],W5=["lastHiddenFocusableEl"],H5=e=>({"max-height":e}),vy=e=>({options:e}),z5=e=>({"p-variant-filled":e}),_y=(e,r)=>({$implicit:e,options:r}),j5=()=>({});function G5(e,r){if(e&1&&(Ye(0),Ct(1),Ze()),e&2){let t=P(2);S(),Tr(t.label()==="p-emptylabel"?"\xA0":t.label())}}function K5(e,r){if(e&1&&st(0,25),e&2){let t=P(2);b("ngTemplateOutlet",t.selectedItemTemplate)("ngTemplateOutletContext",gt(2,yp,t.selectedOption))}}function q5(e,r){if(e&1&&(z(0,"span"),Ct(1),j()),e&2){let t=P(3);S(),Tr(t.label()==="p-emptylabel"?"\xA0":t.label())}}function X5(e,r){if(e&1&&Y(0,q5,2,1,"span",18),e&2){let t=P(2);b("ngIf",t.isSelectedOptionEmpty())}}function Q5(e,r){if(e&1){let t=nt();z(0,"span",23,3),Pe("focus",function(i){_e(t);let a=P();return xe(a.onInputFocus(i))})("blur",function(i){_e(t);let a=P();return xe(a.onInputBlur(i))})("keydown",function(i){_e(t);let a=P();return xe(a.onKeyDown(i))}),Y(2,G5,2,1,"ng-container",20)(3,K5,1,4,"ng-container",24)(4,X5,1,1,"ng-template",null,4,rn),j()}if(e&2){let t,n=sr(5),i=P();b("ngClass",i.inputClass)("pTooltip",i.tooltip)("tooltipPosition",i.tooltipPosition)("positionStyle",i.tooltipPositionStyle)("tooltipStyleClass",i.tooltipStyleClass)("autofocus",i.autofocus),ee("aria-disabled",i.disabled)("id",i.inputId)("aria-label",i.ariaLabel||(i.label()==="p-emptylabel"?void 0:i.label()))("aria-labelledby",i.ariaLabelledBy)("aria-haspopup","listbox")("aria-expanded",(t=i.overlayVisible)!==null&&t!==void 0?t:!1)("aria-controls",i.overlayVisible?i.id+"_list":null)("tabindex",i.disabled?-1:i.tabindex)("aria-activedescendant",i.focused?i.focusedOptionId:void 0)("aria-required",i.required)("required",i.required),S(2),b("ngIf",!i.selectedItemTemplate)("ngIfElse",n),S(),b("ngIf",i.selectedItemTemplate&&!i.isSelectedOptionEmpty())}}function Y5(e,r){if(e&1){let t=nt();z(0,"input",26,5),Pe("input",function(i){_e(t);let a=P();return xe(a.onEditableInput(i))})("keydown",function(i){_e(t);let a=P();return xe(a.onKeyDown(i))})("focus",function(i){_e(t);let a=P();return xe(a.onInputFocus(i))})("blur",function(i){_e(t);let a=P();return xe(a.onInputBlur(i))}),j()}if(e&2){let t=P();b("ngClass",t.inputClass)("disabled",t.disabled)("autofocus",t.autofocus),ee("id",t.inputId)("maxlength",t.maxlength)("placeholder",t.modelValue()===void 0||t.modelValue()===null?t.placeholder():void 0)("aria-label",t.ariaLabel||(t.label()==="p-emptylabel"?void 0:t.label()))("aria-activedescendant",t.focused?t.focusedOptionId:void 0)}}function Z5(e,r){if(e&1){let t=nt();z(0,"TimesIcon",29),Pe("click",function(i){_e(t);let a=P(2);return xe(a.clear(i))}),j()}e&2&&(b("styleClass","p-dropdown-clear-icon"),ee("data-pc-section","clearicon"))}function J5(e,r){}function eN(e,r){e&1&&Y(0,J5,0,0,"ng-template")}function tN(e,r){if(e&1){let t=nt();z(0,"span",30),Pe("click",function(i){_e(t);let a=P(2);return xe(a.clear(i))}),Y(1,eN,1,0,null,31),j()}if(e&2){let t=P(2);ee("data-pc-section","clearicon"),S(),b("ngTemplateOutlet",t.clearIconTemplate)}}function rN(e,r){if(e&1&&(Ye(0),Y(1,Z5,1,2,"TimesIcon",27)(2,tN,2,2,"span",28),Ze()),e&2){let t=P();S(),b("ngIf",!t.clearIconTemplate),S(),b("ngIf",t.clearIconTemplate)}}function nN(e,r){e&1&&st(0)}function iN(e,r){if(e&1&&(Ye(0),Y(1,nN,1,0,"ng-container",31),Ze()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.loadingIconTemplate)}}function aN(e,r){if(e&1&&ue(0,"span",34),e&2){let t=P(3);b("ngClass","p-dropdown-trigger-icon pi-spin "+t.loadingIcon)}}function sN(e,r){e&1&&ue(0,"span",35),e&2&&Ve("p-dropdown-trigger-icon pi pi-spinner pi-spin")}function oN(e,r){if(e&1&&(Ye(0),Y(1,aN,1,1,"span",32)(2,sN,1,2,"span",33),Ze()),e&2){let t=P(2);S(),b("ngIf",t.loadingIcon),S(),b("ngIf",!t.loadingIcon)}}function lN(e,r){if(e&1&&(Ye(0),Y(1,iN,2,1,"ng-container",18)(2,oN,3,2,"ng-container",18),Ze()),e&2){let t=P();S(),b("ngIf",t.loadingIconTemplate),S(),b("ngIf",!t.loadingIconTemplate)}}function cN(e,r){if(e&1&&ue(0,"span",39),e&2){let t=P(3);b("ngClass",t.dropdownIcon)}}function uN(e,r){e&1&&ue(0,"ChevronDownIcon",40),e&2&&b("styleClass","p-dropdown-trigger-icon")}function fN(e,r){if(e&1&&(Ye(0),Y(1,cN,1,1,"span",37)(2,uN,1,1,"ChevronDownIcon",38),Ze()),e&2){let t=P(2);S(),b("ngIf",t.dropdownIcon),S(),b("ngIf",!t.dropdownIcon)}}function hN(e,r){}function dN(e,r){e&1&&Y(0,hN,0,0,"ng-template")}function pN(e,r){if(e&1&&(z(0,"span",41),Y(1,dN,1,0,null,31),j()),e&2){let t=P(2);S(),b("ngTemplateOutlet",t.dropdownIconTemplate)}}function mN(e,r){if(e&1&&Y(0,fN,3,2,"ng-container",18)(1,pN,2,1,"span",36),e&2){let t=P();b("ngIf",!t.dropdownIconTemplate),S(),b("ngIf",t.dropdownIconTemplate)}}function gN(e,r){e&1&&st(0)}function vN(e,r){e&1&&st(0)}function _N(e,r){if(e&1&&(Ye(0),Y(1,vN,1,0,"ng-container",48),Ze()),e&2){let t=P(3);S(),b("ngTemplateOutlet",t.filterTemplate)("ngTemplateOutletContext",gt(2,vy,t.filterOptions))}}function xN(e,r){e&1&&ue(0,"SearchIcon",40),e&2&&b("styleClass","p-dropdown-filter-icon")}function yN(e,r){}function wN(e,r){e&1&&Y(0,yN,0,0,"ng-template")}function bN(e,r){if(e&1&&(z(0,"span",52),Y(1,wN,1,0,null,31),j()),e&2){let t=P(4);S(),b("ngTemplateOutlet",t.filterIconTemplate)}}function CN(e,r){if(e&1){let t=nt();z(0,"div",49)(1,"input",50,10),Pe("input",function(i){_e(t);let a=P(3);return xe(a.onFilterInputChange(i))})("keydown",function(i){_e(t);let a=P(3);return xe(a.onFilterKeyDown(i))})("blur",function(i){_e(t);let a=P(3);return xe(a.onFilterBlur(i))}),j(),Y(3,xN,1,1,"SearchIcon",38)(4,bN,2,1,"span",51),j()}if(e&2){let t=P(3);S(),b("value",t._filterValue()||"")("ngClass",gt(8,z5,t.variant==="filled"||t.config.inputStyle()==="filled")),ee("placeholder",t.filterPlaceholder)("aria-owns",t.id+"_list")("aria-label",t.ariaFilterLabel)("aria-activedescendant",t.focusedOptionId),S(2),b("ngIf",!t.filterIconTemplate),S(),b("ngIf",t.filterIconTemplate)}}function EN(e,r){if(e&1){let t=nt();z(0,"div",47),Pe("click",function(i){return _e(t),xe(i.stopPropagation())}),Y(1,_N,2,4,"ng-container",20)(2,CN,5,10,"ng-template",null,9,rn),j()}if(e&2){let t=sr(3),n=P(2);S(),b("ngIf",n.filterTemplate)("ngIfElse",t)}}function SN(e,r){e&1&&st(0)}function TN(e,r){if(e&1&&Y(0,SN,1,0,"ng-container",48),e&2){let t=r.$implicit,n=r.options;P(2);let i=sr(9);b("ngTemplateOutlet",i)("ngTemplateOutletContext",Hr(2,_y,t,n))}}function IN(e,r){e&1&&st(0)}function kN(e,r){if(e&1&&Y(0,IN,1,0,"ng-container",48),e&2){let t=r.options,n=P(4);b("ngTemplateOutlet",n.loaderTemplate)("ngTemplateOutletContext",gt(2,vy,t))}}function AN(e,r){e&1&&(Ye(0),Y(1,kN,1,4,"ng-template",54),Ze())}function ON(e,r){if(e&1){let t=nt();z(0,"p-scroller",53,11),Pe("onLazyLoad",function(i){_e(t);let a=P(2);return xe(a.onLazyLoad.emit(i))}),Y(2,TN,1,5,"ng-template",22)(3,AN,2,0,"ng-container",18),j()}if(e&2){let t=P(2);Fg(gt(8,Tc,t.scrollHeight)),b("items",t.visibleOptions())("itemSize",t.virtualScrollItemSize||t._itemSize)("autoSize",!0)("lazy",t.lazy)("options",t.virtualScrollOptions),S(3),b("ngIf",t.loaderTemplate)}}function FN(e,r){e&1&&st(0)}function DN(e,r){if(e&1&&(Ye(0),Y(1,FN,1,0,"ng-container",48),Ze()),e&2){P();let t=sr(9),n=P();S(),b("ngTemplateOutlet",t)("ngTemplateOutletContext",Hr(3,_y,n.visibleOptions(),fs(2,j5)))}}function RN(e,r){if(e&1&&(z(0,"span"),Ct(1),j()),e&2){let t=P(2).$implicit,n=P(3);S(),Tr(n.getOptionGroupLabel(t.optionGroup))}}function MN(e,r){e&1&&st(0)}function NN(e,r){if(e&1&&(Ye(0),z(1,"li",58),Y(2,RN,2,1,"span",18)(3,MN,1,0,"ng-container",48),j(),Ze()),e&2){let t=P(),n=t.$implicit,i=t.index,a=P().options,s=P(2);S(),b("ngStyle",gt(5,Tc,a.itemSize+"px")),ee("id",s.id+"_"+s.getOptionIndex(i,a)),S(),b("ngIf",!s.groupTemplate),S(),b("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",gt(7,yp,n.optionGroup))}}function PN(e,r){if(e&1){let t=nt();Ye(0),z(1,"p-dropdownItem",59),Pe("onClick",function(i){_e(t);let a=P().$implicit,s=P(3);return xe(s.onOptionSelect(i,a))})("onMouseEnter",function(i){_e(t);let a=P().index,s=P().options,o=P(2);return xe(o.onOptionMouseEnter(i,o.getOptionIndex(a,s)))}),j(),Ze()}if(e&2){let t=P(),n=t.$implicit,i=t.index,a=P().options,s=P(2);S(),b("id",s.id+"_"+s.getOptionIndex(i,a))("option",n)("checkmark",s.checkmark)("selected",s.isSelected(n))("label",s.getOptionLabel(n))("disabled",s.isOptionDisabled(n))("template",s.itemTemplate)("focused",s.focusedOptionIndex()===s.getOptionIndex(i,a))("ariaPosInset",s.getAriaPosInset(s.getOptionIndex(i,a)))("ariaSetSize",s.ariaSetSize)}}function LN(e,r){if(e&1&&Y(0,NN,4,9,"ng-container",18)(1,PN,2,10,"ng-container",18),e&2){let t=r.$implicit,n=P(3);b("ngIf",n.isOptionGroup(t)),S(),b("ngIf",!n.isOptionGroup(t))}}function BN(e,r){if(e&1&&(Ye(0),Ct(1),Ze()),e&2){let t=P(4);S(),Ma(" ",t.emptyFilterMessageLabel," ")}}function VN(e,r){e&1&&st(0,null,13)}function UN(e,r){if(e&1&&(z(0,"li",60),Y(1,BN,2,1,"ng-container",20)(2,VN,2,0,"ng-container",31),j()),e&2){let t=P().options,n=P(2);b("ngStyle",gt(4,Tc,t.itemSize+"px")),S(),b("ngIf",!n.emptyFilterTemplate&&!n.emptyTemplate)("ngIfElse",n.emptyFilter),S(),b("ngTemplateOutlet",n.emptyFilterTemplate||n.emptyTemplate)}}function $N(e,r){if(e&1&&(Ye(0),Ct(1),Ze()),e&2){let t=P(4);S(),Ma(" ",t.emptyMessageLabel," ")}}function WN(e,r){e&1&&st(0,null,14)}function HN(e,r){if(e&1&&(z(0,"li",60),Y(1,$N,2,1,"ng-container",20)(2,WN,2,0,"ng-container",31),j()),e&2){let t=P().options,n=P(2);b("ngStyle",gt(4,Tc,t.itemSize+"px")),S(),b("ngIf",!n.emptyTemplate)("ngIfElse",n.empty),S(),b("ngTemplateOutlet",n.emptyTemplate)}}function zN(e,r){if(e&1&&(z(0,"ul",55,12),Y(2,LN,2,2,"ng-template",56)(3,UN,3,6,"li",57)(4,HN,3,6,"li",57),j()),e&2){let t=r.$implicit,n=r.options,i=P(2);b("ngClass",n.contentStyleClass)("ngStyle",n.contentStyle),ee("id",i.id+"_list")("aria-label",i.listLabel),S(2),b("ngForOf",t),S(),b("ngIf",i.filterValue&&i.isEmpty()),S(),b("ngIf",!i.filterValue&&i.isEmpty())}}function jN(e,r){e&1&&st(0)}function GN(e,r){if(e&1){let t=nt();z(0,"div",42)(1,"span",43,6),Pe("focus",function(i){_e(t);let a=P();return xe(a.onFirstHiddenFocus(i))}),j(),Y(3,gN,1,0,"ng-container",31)(4,EN,4,2,"div",44),z(5,"div",45),Y(6,ON,4,10,"p-scroller",46)(7,DN,2,6,"ng-container",18)(8,zN,5,7,"ng-template",null,7,rn),j(),Y(10,jN,1,0,"ng-container",31),z(11,"span",43,8),Pe("focus",function(i){_e(t);let a=P();return xe(a.onLastHiddenFocus(i))}),j()()}if(e&2){let t=P();Ve(t.panelStyleClass),b("ngClass","p-dropdown-panel p-component")("ngStyle",t.panelStyle),S(),ee("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0),S(2),b("ngTemplateOutlet",t.headerTemplate),S(),b("ngIf",t.filter),S(),b("ngStyle",gt(16,H5,t.virtualScroll?"auto":t.scrollHeight||"auto")),S(),b("ngIf",t.virtualScroll),S(),b("ngIf",!t.virtualScroll),S(3),b("ngTemplateOutlet",t.footerTemplate),S(),ee("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0)}}var KN={provide:Po,useExisting:ea(()=>wp),multi:!0},qN=(()=>{class e{id;option;selected;focused;label;disabled;visible;itemSize;ariaPosInset;ariaSetSize;template;checkmark;onClick=new Be;onMouseEnter=new Be;ngOnInit(){}onOptionClick(t){this.onClick.emit(t)}onOptionMouseEnter(t){this.onMouseEnter.emit(t)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{id:"id",option:"option",selected:[2,"selected","selected",Se],focused:[2,"focused","focused",Se],label:"label",disabled:[2,"disabled","disabled",Se],visible:[2,"visible","visible",Se],itemSize:[2,"itemSize","itemSize",tr],ariaPosInset:"ariaPosInset",ariaSetSize:"ariaSetSize",template:"template",checkmark:[2,"checkmark","checkmark",Se]},outputs:{onClick:"onClick",onMouseEnter:"onMouseEnter"},features:[Qt],decls:4,vars:22,consts:[["role","option","pRipple","",3,"click","mouseenter","id","ngStyle","ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(n,i){n&1&&(z(0,"li",0),Pe("click",function(s){return i.onOptionClick(s)})("mouseenter",function(s){return i.onOptionMouseEnter(s)}),Y(1,F5,3,2,"ng-container",1)(2,D5,2,1,"span",1)(3,R5,1,0,"ng-container",2),j()),n&2&&(b("id",i.id)("ngStyle",gt(14,Tc,i.itemSize+"px"))("ngClass",io(16,k5,i.selected,i.disabled,i.focused)),ee("aria-label",i.label)("aria-setsize",i.ariaSetSize)("aria-posinset",i.ariaPosInset)("aria-selected",i.selected)("data-p-focused",i.focused)("data-p-highlight",i.selected)("data-p-disabled",i.disabled),S(),b("ngIf",i.checkmark),S(),b("ngIf",!i.template),S(),b("ngTemplateOutlet",i.template)("ngTemplateOutletContext",gt(20,yp,i.option)))},dependencies:()=>[dr,yr,wr,or,fi,vp,ma],encapsulation:2})}return e})(),wp=(()=>{class e{el;renderer;cd;zone;filterService;config;id;scrollHeight="200px";filter;name;style;panelStyle;styleClass;panelStyleClass;readonly;required;editable;appendTo;tabindex=0;set placeholder(t){this._placeholder.set(t)}get placeholder(){return this._placeholder.asReadonly()}loadingIcon;filterPlaceholder;filterLocale;variant="outlined";inputId;dataKey;filterBy;filterFields;autofocus;resetFilterOnHide=!1;checkmark=!1;dropdownIcon;loading=!1;optionLabel;optionValue;optionDisabled;optionGroupLabel="label";optionGroupChildren="items";autoDisplayFirst=!0;group;showClear;emptyFilterMessage="";emptyMessage="";lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;overlayOptions;ariaFilterLabel;ariaLabel;ariaLabelledBy;filterMatchMode="contains";maxlength;tooltip="";tooltipPosition="right";tooltipPositionStyle="absolute";tooltipStyleClass;focusOnHover=!1;selectOnFocus=!1;autoOptionFocus=!0;autofocusFilter=!0;get disabled(){return this._disabled}set disabled(t){t&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=t,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=t,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}_itemSize;get autoZIndex(){return this._autoZIndex}set autoZIndex(t){this._autoZIndex=t,console.warn("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_autoZIndex;get baseZIndex(){return this._baseZIndex}set baseZIndex(t){this._baseZIndex=t,console.warn("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_baseZIndex;get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(t){this._showTransitionOptions=t,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_showTransitionOptions;get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(t){this._hideTransitionOptions=t,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_hideTransitionOptions;get filterValue(){return this._filterValue()}set filterValue(t){setTimeout(()=>{this._filterValue.set(t)})}get options(){return this._options()}set options(t){Je.deepEquals(t,this._options())||this._options.set(t)}onChange=new Be;onFilter=new Be;onFocus=new Be;onBlur=new Be;onClick=new Be;onShow=new Be;onHide=new Be;onClear=new Be;onLazyLoad=new Be;containerViewChild;filterViewChild;focusInputViewChild;editableInputViewChild;itemsViewChild;scroller;overlayViewChild;firstHiddenFocusableElementOnOverlay;lastHiddenFocusableElementOnOverlay;templates;_disabled;itemsWrapper;itemTemplate;groupTemplate;loaderTemplate;selectedItemTemplate;headerTemplate;filterTemplate;footerTemplate;emptyFilterTemplate;emptyTemplate;dropdownIconTemplate;loadingIconTemplate;clearIconTemplate;filterIconTemplate;filterOptions;_options=Sr(null);_placeholder=Sr(void 0);modelValue=Sr(null);value;onModelChange=()=>{};onModelTouched=()=>{};hover;focused;overlayVisible;optionsChanged;panel;dimensionsUpdated;hoveredItem;selectedOptionUpdated;_filterValue=Sr(null);searchValue;searchIndex;searchTimeout;previousSearchChar;currentSearchChar;preventModelTouched;focusedOptionIndex=Sr(-1);labelId;listId;clicked=Sr(!1);get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Si.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(Si.EMPTY_FILTER_MESSAGE)}get isVisibleClearIcon(){return this.modelValue()!=null&&this.hasSelectedOption()&&this.showClear&&!this.disabled}get listLabel(){return this.config.getTranslation(Si.ARIA).listLabel}get containerClass(){return{"p-dropdown p-component p-inputwrapper":!0,"p-disabled":this.disabled,"p-dropdown-clearable":this.showClear&&!this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue()!==void 0&&this.modelValue()!==null&&!this.modelValue().length,"p-inputwrapper-focus":this.focused||this.overlayVisible,"p-variant-filled":this.variant==="filled"||this.config.inputStyle()==="filled","p-dropdown-open":this.overlayVisible}}get inputClass(){let t=this.label();return{"p-dropdown-label p-inputtext":!0,"p-placeholder":this.placeholder()&&t===this.placeholder(),"p-dropdown-label-empty":!this.editable&&!this.selectedItemTemplate&&(t==null||t==="p-emptylabel"||t.length===0)}}get panelClass(){return{"p-dropdown-panel p-component":!0,"p-input-filled":this.config.inputStyle()==="filled","p-ripple-disabled":this.config.ripple===!1}}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}visibleOptions=si(()=>{let t=this.getAllVisibleAndNonVisibleOptions();if(this._filterValue()){let i=!(this.filterBy||this.optionLabel)&&!this.filterFields&&!this.optionValue?this.options.filter(a=>a.label?a.label.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1:a.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1):this.filterService.filter(t,this.searchFields(),this._filterValue().trim(),this.filterMatchMode,this.filterLocale);if(this.group){let a=this.options||[],s=[];return a.forEach(o=>{let c=this.getOptionGroupChildren(o).filter(u=>i.includes(u));c.length>0&&s.push(ze(ie({},o),{[typeof this.optionGroupChildren=="string"?this.optionGroupChildren:"items"]:[...c]}))}),this.flatOptions(s)}return i}return t});label=si(()=>{let t=this.getAllVisibleAndNonVisibleOptions(),n=t.findIndex(i=>this.isOptionValueEqualsModelValue(i));return n!==-1?this.getOptionLabel(t[n]):this.placeholder()||"p-emptylabel"});filled=si(()=>typeof this.modelValue()=="string"?!!this.modelValue():this.label()!=="p-emptylabel"&&this.modelValue()!==void 0&&this.modelValue()!==null);selectedOption;editableInputValue=si(()=>this.getOptionLabel(this.selectedOption)||this.modelValue()||"");constructor(t,n,i,a,s,o){this.el=t,this.renderer=n,this.cd=i,this.zone=a,this.filterService=s,this.config=o,Vg(()=>{let l=this.modelValue(),c=this.visibleOptions();if(c&&Je.isNotEmpty(c)){let u=this.findSelectedOptionIndex();(u!==-1||l===void 0||typeof l=="string"&&l.length===0||this.isModelValueNotSet()||this.editable)&&(this.selectedOption=c[u])}Je.isEmpty(c)&&(l===void 0||this.isModelValueNotSet())&&Je.isNotEmpty(this.selectedOption)&&(this.selectedOption=null),l!==void 0&&this.editable&&this.updateEditableLabel(),this.cd.markForCheck()})}isModelValueNotSet(){return this.modelValue()===null&&!this.isOptionValueEqualsModelValue(this.selectedOption)}getAllVisibleAndNonVisibleOptions(){return this.group?this.flatOptions(this.options):this.options||[]}ngOnInit(){this.id=this.id||br(),this.autoUpdateModel(),this.filterBy&&(this.filterOptions={filter:t=>this.onFilterInputChange(t),reset:()=>this.resetFilter()})}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let t=J.findSingle(this.overlayViewChild?.overlayViewChild?.nativeElement,"li.p-highlight");t&&J.scrollInView(this.itemsWrapper,t),this.selectedOptionUpdated=!1}}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"item":this.itemTemplate=t.template;break;case"selectedItem":this.selectedItemTemplate=t.template;break;case"header":this.headerTemplate=t.template;break;case"filter":this.filterTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"emptyfilter":this.emptyFilterTemplate=t.template;break;case"empty":this.emptyTemplate=t.template;break;case"group":this.groupTemplate=t.template;break;case"loader":this.loaderTemplate=t.template;break;case"dropdownicon":this.dropdownIconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template;break;case"clearicon":this.clearIconTemplate=t.template;break;case"filtericon":this.filterIconTemplate=t.template;break;default:this.itemTemplate=t.template;break}})}flatOptions(t){return(t||[]).reduce((n,i,a)=>{n.push({optionGroup:i,group:!0,index:a});let s=this.getOptionGroupChildren(i);return s&&s.forEach(o=>n.push(o)),n},[])}autoUpdateModel(){if(this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption()&&(this.focusedOptionIndex.set(this.findFirstFocusedOptionIndex()),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()],!1)),this.autoDisplayFirst&&(this.modelValue()===null||this.modelValue()===void 0)&&!this.placeholder()){let t=this.findFirstOptionIndex();this.onOptionSelect(null,this.visibleOptions()[t],!1,!0)}}onOptionSelect(t,n,i=!0,a=!1){if(!this.isSelected(n)){let s=this.getOptionValue(n);this.updateModel(s,t),this.focusedOptionIndex.set(this.findSelectedOptionIndex()),a===!1&&this.onChange.emit({originalEvent:t,value:s})}i&&this.hide(!0)}onOptionMouseEnter(t,n){this.focusOnHover&&this.changeFocusedOptionIndex(t,n)}updateModel(t,n){this.value=t,this.onModelChange(t),this.modelValue.set(t),this.selectedOptionUpdated=!0}writeValue(t){this.filter&&this.resetFilter(),this.value=t,this.allowModelChange()&&this.onModelChange(t),this.modelValue.set(this.value),this.updateEditableLabel(),this.cd.markForCheck()}allowModelChange(){return this.autoDisplayFirst&&!this.placeholder()&&(this.modelValue()===void 0||this.modelValue()===null)&&!this.editable&&this.options&&this.options.length}isSelectedOptionEmpty(){return Je.isEmpty(this.selectedOption)}isSelected(t){return this.isValidOption(t)&&this.isOptionValueEqualsModelValue(t)}isOptionValueEqualsModelValue(t){return Je.equals(this.modelValue(),this.getOptionValue(t),this.equalityKey())}ngAfterViewInit(){this.editable&&this.updateEditableLabel(),this.updatePlaceHolderForFloatingLabel()}updatePlaceHolderForFloatingLabel(){if(this._placeholder()!==null&&this._placeholder()!==void 0)return;let t=this.el.nativeElement.parentElement,n=t?.classList.contains("p-float-label");if(t&&n&&!this.selectedOption){let i=t.querySelector("label");i&&this._placeholder.set(i.textContent)}}updateEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value=this.getOptionLabel(this.selectedOption)||this.modelValue()||"")}clearEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value="")}getOptionIndex(t,n){return this.virtualScrollerDisabled?t:n&&n.getItemOptions(t).index}getOptionLabel(t){return this.optionLabel!==void 0&&this.optionLabel!==null?Je.resolveFieldData(t,this.optionLabel):t&&t.label!==void 0?t.label:t}getOptionValue(t){return this.optionValue&&this.optionValue!==null?Je.resolveFieldData(t,this.optionValue):!this.optionLabel&&t&&t.value!==void 0?t.value:t}isOptionDisabled(t){return this.getOptionValue(this.modelValue())===this.getOptionValue(t)||this.getOptionLabel(this.modelValue()===this.getOptionLabel(t))&&t.disabled===!1?!1:this.optionDisabled?Je.resolveFieldData(t,this.optionDisabled):t&&t.disabled!==void 0?t.disabled:!1}getOptionGroupLabel(t){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null?Je.resolveFieldData(t,this.optionGroupLabel):t&&t.label!==void 0?t.label:t}getOptionGroupChildren(t){return this.optionGroupChildren!==void 0&&this.optionGroupChildren!==null?Je.resolveFieldData(t,this.optionGroupChildren):t.items}getAriaPosInset(t){return(this.optionGroupLabel?t-this.visibleOptions().slice(0,t).filter(n=>this.isOptionGroup(n)).length:t)+1}get ariaSetSize(){return this.visibleOptions().filter(t=>!this.isOptionGroup(t)).length}resetFilter(){this._filterValue.set(null),this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value="")}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}onContainerClick(t){this.disabled||this.readonly||this.loading||(this.focusInputViewChild?.nativeElement.focus({preventScroll:!0}),!(t.target.tagName==="INPUT"||t.target.getAttribute("data-pc-section")==="clearicon"||t.target.closest('[data-pc-section="clearicon"]'))&&((!this.overlayViewChild||!this.overlayViewChild.el.nativeElement.contains(t.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.onClick.emit(t),this.clicked.set(!0),this.cd.detectChanges()))}isEmpty(){return!this._options()||this.visibleOptions()&&this.visibleOptions().length===0}onEditableInput(t){let n=t.target.value;this.searchValue="",!this.searchOptions(t,n)&&this.focusedOptionIndex.set(-1),this.onModelChange(n),this.updateModel(n,t),setTimeout(()=>{this.onChange.emit({originalEvent:t,value:n})},1),!this.overlayVisible&&Je.isNotEmpty(n)&&this.show()}show(t){this.overlayVisible=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex();this.focusedOptionIndex.set(n),t&&J.focus(this.focusInputViewChild?.nativeElement),this.cd.markForCheck()}onOverlayAnimationStart(t){if(t.toState==="visible"){if(this.itemsWrapper=J.findSingle(this.overlayViewChild?.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.options&&this.options.length)if(this.virtualScroll){let n=this.modelValue()?this.focusedOptionIndex():-1;n!==-1&&this.scroller?.scrollToIndex(n)}else{let n=J.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");n&&n.scrollIntoView({block:"nearest",inline:"nearest"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&!this.editable&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(t)}t.toState==="void"&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(t))}hide(t){this.overlayVisible=!1,this.focusedOptionIndex.set(-1),this.clicked.set(!1),this.searchValue="",this.overlayOptions?.mode==="modal"&&J.unblockBodyScroll(),this.filter&&this.resetFilterOnHide&&this.resetFilter(),t&&(this.focusInputViewChild&&setTimeout(()=>{J.focus(this.focusInputViewChild?.nativeElement)}),this.editable&&this.editableInputViewChild&&setTimeout(()=>{J.focus(this.editableInputViewChild?.nativeElement)})),this.cd.markForCheck()}onInputFocus(t){if(this.disabled)return;this.focused=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(n),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit(t)}onInputBlur(t){this.focused=!1,this.onBlur.emit(t),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}onMouseDown(t){t.preventDefault()}onKeyDown(t,n){if(!(this.disabled||this.readonly||this.loading)){switch(t.code){case"ArrowDown":this.onArrowDownKey(t);break;case"ArrowUp":this.onArrowUpKey(t,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(t,this.editable);break;case"Delete":this.onDeleteKey(t);break;case"Home":this.onHomeKey(t,this.editable);break;case"End":this.onEndKey(t,this.editable);break;case"PageDown":this.onPageDownKey(t);break;case"PageUp":this.onPageUpKey(t);break;case"Space":this.onSpaceKey(t,n);break;case"Enter":case"NumpadEnter":this.onEnterKey(t);break;case"Escape":this.onEscapeKey(t);break;case"Tab":this.onTabKey(t);break;case"Backspace":this.onBackspaceKey(t,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!t.metaKey&&Je.isPrintableCharacter(t.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(t,t.key));break}this.clicked.set(!1)}}onFilterKeyDown(t){switch(t.code){case"ArrowDown":this.onArrowDownKey(t);break;case"ArrowUp":this.onArrowUpKey(t,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(t,!0);break;case"Home":this.onHomeKey(t,!0);break;case"End":this.onEndKey(t,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(t,!0);break;case"Escape":this.onEscapeKey(t);break;case"Tab":this.onTabKey(t,!0);break;default:break}}onFilterBlur(t){this.focusedOptionIndex.set(-1)}onArrowDownKey(t){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(t,this.findSelectedOptionIndex());else{let n=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(t,n)}t.preventDefault(),t.stopPropagation()}changeFocusedOptionIndex(t,n){if(this.focusedOptionIndex()!==n&&(this.focusedOptionIndex.set(n),this.scrollInView(),this.selectOnFocus)){let i=this.visibleOptions()[n];this.onOptionSelect(t,i,!1)}}get virtualScrollerDisabled(){return!this.virtualScroll}scrollInView(t=-1){let n=t!==-1?`${this.id}_${t}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let i=J.findSingle(this.itemsViewChild.nativeElement,`li[id="${n}"]`);i?i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(t!==-1?t:this.focusedOptionIndex())},0)}}hasSelectedOption(){return this.modelValue()!==void 0}isValidSelectedOption(t){return this.isValidOption(t)&&this.isSelected(t)}equalityKey(){return this.optionValue?null:this.dataKey}findFirstFocusedOptionIndex(){let t=this.findSelectedOptionIndex();return t<0?this.findFirstOptionIndex():t}findFirstOptionIndex(){return this.visibleOptions().findIndex(t=>this.isValidOption(t))}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(t=>this.isValidSelectedOption(t)):-1}findNextOptionIndex(t){let n=t<this.visibleOptions().length-1?this.visibleOptions().slice(t+1).findIndex(i=>this.isValidOption(i)):-1;return n>-1?n+t+1:t}findPrevOptionIndex(t){let n=t>0?Je.findLastIndex(this.visibleOptions().slice(0,t),i=>this.isValidOption(i)):-1;return n>-1?n:t}findLastOptionIndex(){return Je.findLastIndex(this.visibleOptions(),t=>this.isValidOption(t))}findLastFocusedOptionIndex(){let t=this.findSelectedOptionIndex();return t<0?this.findLastOptionIndex():t}isValidOption(t){return t!=null&&!(this.isOptionDisabled(t)||this.isOptionGroup(t))}isOptionGroup(t){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null&&t.optionGroup!==void 0&&t.optionGroup!==null&&t.group}onArrowUpKey(t,n=!1){if(t.altKey&&!n){if(this.focusedOptionIndex()!==-1){let i=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(t,i)}this.overlayVisible&&this.hide()}else{let i=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(t,i),!this.overlayVisible&&this.show()}t.preventDefault(),t.stopPropagation()}onArrowLeftKey(t,n=!1){n&&this.focusedOptionIndex.set(-1)}onDeleteKey(t){this.showClear&&(this.clear(t),t.preventDefault())}onHomeKey(t,n=!1){if(n){let i=t.currentTarget;t.shiftKey?i.setSelectionRange(0,i.value.length):(i.setSelectionRange(0,0),this.focusedOptionIndex.set(-1))}else this.changeFocusedOptionIndex(t,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();t.preventDefault()}onEndKey(t,n=!1){if(n){let i=t.currentTarget;if(t.shiftKey)i.setSelectionRange(0,i.value.length);else{let a=i.value.length;i.setSelectionRange(a,a),this.focusedOptionIndex.set(-1)}}else this.changeFocusedOptionIndex(t,this.findLastOptionIndex()),!this.overlayVisible&&this.show();t.preventDefault()}onPageDownKey(t){this.scrollInView(this.visibleOptions().length-1),t.preventDefault()}onPageUpKey(t){this.scrollInView(0),t.preventDefault()}onSpaceKey(t,n=!1){!this.editable&&!n&&this.onEnterKey(t)}onEnterKey(t,n=!1){if(!this.overlayVisible)this.focusedOptionIndex.set(-1),this.onArrowDownKey(t);else{if(this.focusedOptionIndex()!==-1){let i=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(t,i)}!n&&this.hide()}t.preventDefault()}onEscapeKey(t){this.overlayVisible&&this.hide(!0),t.preventDefault()}onTabKey(t,n=!1){if(!n)if(this.overlayVisible&&this.hasFocusableElements())J.focus(t.shiftKey?this.lastHiddenFocusableElementOnOverlay.nativeElement:this.firstHiddenFocusableElementOnOverlay.nativeElement),t.preventDefault();else{if(this.focusedOptionIndex()!==-1&&this.overlayVisible){let i=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(t,i)}this.overlayVisible&&this.hide(this.filter)}t.stopPropagation()}onFirstHiddenFocus(t){let n=t.relatedTarget===this.focusInputViewChild?.nativeElement?J.getFirstFocusableElement(this.overlayViewChild.el?.nativeElement,":not(.p-hidden-focusable)"):this.focusInputViewChild?.nativeElement;J.focus(n)}onLastHiddenFocus(t){let n=t.relatedTarget===this.focusInputViewChild?.nativeElement?J.getLastFocusableElement(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInputViewChild?.nativeElement;J.focus(n)}hasFocusableElements(){return J.getFocusableElements(this.overlayViewChild.overlayViewChild.nativeElement,':not([data-p-hidden-focusable="true"]):not([class="p-dropdown-items-wrapper"])').length>0}onBackspaceKey(t,n=!1){n&&!this.overlayVisible&&this.show()}searchFields(){return this.filterBy?.split(",")||this.filterFields||[this.optionLabel]}searchOptions(t,n){this.searchValue=(this.searchValue||"")+n;let i=-1,a=!1;return this.focusedOptionIndex()!==-1?(i=this.visibleOptions().slice(this.focusedOptionIndex()).findIndex(s=>this.isOptionMatched(s)),i=i===-1?this.visibleOptions().slice(0,this.focusedOptionIndex()).findIndex(s=>this.isOptionMatched(s)):i+this.focusedOptionIndex()):i=this.visibleOptions().findIndex(s=>this.isOptionMatched(s)),i!==-1&&(a=!0),i===-1&&this.focusedOptionIndex()===-1&&(i=this.findFirstFocusedOptionIndex()),i!==-1&&this.changeFocusedOptionIndex(t,i),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),a}isOptionMatched(t){return this.isValidOption(t)&&this.getOptionLabel(t).toString().toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))}onFilterInputChange(t){let n=t.target.value;this._filterValue.set(n),this.focusedOptionIndex.set(-1),this.onFilter.emit({originalEvent:t,filter:this._filterValue()}),!this.virtualScrollerDisabled&&this.scroller.scrollToIndex(0),setTimeout(()=>{this.overlayViewChild.alignOverlay()}),this.cd.markForCheck()}applyFocus(){this.editable?J.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():J.focus(this.focusInputViewChild?.nativeElement)}focus(){this.applyFocus()}clear(t){this.updateModel(null,t),this.clearEditableLabel(),this.onModelTouched(),this.onChange.emit({originalEvent:t,value:this.value}),this.onClear.emit(t),this.resetFilter()}static \u0275fac=function(n){return new(n||e)(ce(qt),ce(Nr),ce(hr),ce(fr),ce(J1),ce(an))};static \u0275cmp=Fe({type:e,selectors:[["p-dropdown"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(At(M5,5),At(N5,5),At(P5,5),At(L5,5),At(B5,5),At(V5,5),At(U5,5),At($5,5),At(W5,5)),n&2){let a;je(a=Ge())&&(i.containerViewChild=a.first),je(a=Ge())&&(i.filterViewChild=a.first),je(a=Ge())&&(i.focusInputViewChild=a.first),je(a=Ge())&&(i.editableInputViewChild=a.first),je(a=Ge())&&(i.itemsViewChild=a.first),je(a=Ge())&&(i.scroller=a.first),je(a=Ge())&&(i.overlayViewChild=a.first),je(a=Ge())&&(i.firstHiddenFocusableElementOnOverlay=a.first),je(a=Ge())&&(i.lastHiddenFocusableElementOnOverlay=a.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(n,i){n&2&&Ra("p-inputwrapper-filled",i.filled())("p-inputwrapper-focus",i.focused||i.overlayVisible)},inputs:{id:"id",scrollHeight:"scrollHeight",filter:[2,"filter","filter",Se],name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:[2,"readonly","readonly",Se],required:[2,"required","required",Se],editable:[2,"editable","editable",Se],appendTo:"appendTo",tabindex:[2,"tabindex","tabindex",tr],placeholder:"placeholder",loadingIcon:"loadingIcon",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",variant:"variant",inputId:"inputId",dataKey:"dataKey",filterBy:"filterBy",filterFields:"filterFields",autofocus:[2,"autofocus","autofocus",Se],resetFilterOnHide:[2,"resetFilterOnHide","resetFilterOnHide",Se],checkmark:[2,"checkmark","checkmark",Se],dropdownIcon:"dropdownIcon",loading:[2,"loading","loading",Se],optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:[2,"autoDisplayFirst","autoDisplayFirst",Se],group:[2,"group","group",Se],showClear:[2,"showClear","showClear",Se],emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:[2,"lazy","lazy",Se],virtualScroll:[2,"virtualScroll","virtualScroll",Se],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",tr],virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:[2,"maxlength","maxlength",tr],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",focusOnHover:[2,"focusOnHover","focusOnHover",Se],selectOnFocus:[2,"selectOnFocus","selectOnFocus",Se],autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",Se],autofocusFilter:[2,"autofocusFilter","autofocusFilter",Se],disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",filterValue:"filterValue",options:"options"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},features:[ta([KN]),Qt],decls:12,vars:20,consts:[["container",""],["elseBlock",""],["overlay",""],["focusInput",""],["defaultPlaceholder",""],["editableInput",""],["firstHiddenFocusableEl",""],["buildInItems",""],["lastHiddenFocusableEl",""],["builtInFilterElement",""],["filter",""],["scroller",""],["items",""],["emptyFilter",""],["empty",""],[3,"click","ngClass","ngStyle"],["role","combobox","pAutoFocus","",3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","autofocus","focus","blur","keydown",4,"ngIf"],["type","text","aria-haspopup","listbox","pAutoFocus","",3,"ngClass","disabled","autofocus","input","keydown","focus","blur",4,"ngIf"],[4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger",3,"mousedown"],[4,"ngIf","ngIfElse"],[3,"visibleChange","onAnimationStart","onHide","visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions"],["pTemplate","content"],["role","combobox","pAutoFocus","",3,"focus","blur","keydown","ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","autofocus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text","aria-haspopup","listbox","pAutoFocus","",3,"input","keydown","focus","blur","ngClass","disabled","autofocus"],[3,"styleClass","click",4,"ngIf"],["class","p-dropdown-clear-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-dropdown-clear-icon",3,"click"],[4,"ngTemplateOutlet"],["aria-hidden","true",3,"ngClass",4,"ngIf"],["aria-hidden","true",3,"class",4,"ngIf"],["aria-hidden","true",3,"ngClass"],["aria-hidden","true"],["class","p-dropdown-trigger-icon",4,"ngIf"],["class","p-dropdown-trigger-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-dropdown-trigger-icon",3,"ngClass"],[3,"styleClass"],[1,"p-dropdown-trigger-icon"],[3,"ngClass","ngStyle"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus"],["class","p-dropdown-header",3,"click",4,"ngIf"],["tabindex","0",1,"p-dropdown-items-wrapper",3,"ngStyle"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],[1,"p-dropdown-header",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-dropdown-filter-container"],["type","text","role","searchbox","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"input","keydown","blur","value","ngClass"],["class","p-dropdown-filter-icon",4,"ngIf"],[1,"p-dropdown-filter-icon"],[3,"onLazyLoad","items","itemSize","autoSize","lazy","options"],["pTemplate","loader"],["role","listbox",1,"p-dropdown-items",3,"ngClass","ngStyle"],["ngFor","",3,"ngForOf"],["class","p-dropdown-empty-message","role","option",3,"ngStyle",4,"ngIf"],["role","option",1,"p-dropdown-item-group",3,"ngStyle"],[3,"onClick","onMouseEnter","id","option","checkmark","selected","label","disabled","template","focused","ariaPosInset","ariaSetSize"],["role","option",1,"p-dropdown-empty-message",3,"ngStyle"]],template:function(n,i){if(n&1){let a=nt();z(0,"div",15,0),Pe("click",function(o){return _e(a),xe(i.onContainerClick(o))}),Y(2,Q5,6,20,"span",16)(3,Y5,2,8,"input",17)(4,rN,3,2,"ng-container",18),z(5,"div",19),Pe("mousedown",function(o){return _e(a),xe(i.onMouseDown(o))}),Y(6,lN,3,2,"ng-container",20)(7,mN,2,2,"ng-template",null,1,rn),j(),z(9,"p-overlay",21,2),pl("visibleChange",function(o){return _e(a),dl(i.overlayVisible,o)||(i.overlayVisible=o),xe(o)}),Pe("onAnimationStart",function(o){return _e(a),xe(i.onOverlayAnimationStart(o))})("onHide",function(){return _e(a),xe(i.hide())}),Y(11,GN,13,18,"ng-template",22),j()()}if(n&2){let a,s=sr(8);Ve(i.styleClass),b("ngClass",i.containerClass)("ngStyle",i.style),ee("id",i.id),S(2),b("ngIf",!i.editable),S(),b("ngIf",i.editable),S(),b("ngIf",i.isVisibleClearIcon),S(),ee("aria-expanded",(a=i.overlayVisible)!==null&&a!==void 0?a:!1)("data-pc-section","trigger"),S(),b("ngIf",i.loading)("ngIfElse",s),S(3),hl("visible",i.overlayVisible),b("options",i.overlayOptions)("target","@parent")("appendTo",i.appendTo)("autoZIndex",i.autoZIndex)("baseZIndex",i.baseZIndex)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}},dependencies:()=>[dr,oi,yr,wr,or,dp,mr,Uu,gy,wf,In,_p,xp,qN],styles:[`@layer primeng{.p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;opacity:0}input.p-dropdown-label{cursor:default}.p-dropdown .p-dropdown-panel{min-width:100%}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-item-group{cursor:auto}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}.p-float-label .p-dropdown .p-placeholder{opacity:0}}
`],encapsulation:2,changeDetection:0})}return e})(),xy=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,pp,lr,$u,Hi,gp,$x,In,_p,xp,vp,ma,pp,lr,gp]})}return e})();var QN=["*"],kf=(()=>{class e{style;styleClass;layout="horizontal";type="solid";align;containerClass(){return{"p-divider p-component":!0,"p-divider-horizontal":this.layout==="horizontal","p-divider-vertical":this.layout==="vertical","p-divider-solid":this.type==="solid","p-divider-dashed":this.type==="dashed","p-divider-dotted":this.type==="dotted","p-divider-left":this.layout==="horizontal"&&(!this.align||this.align==="left"),"p-divider-center":this.layout==="horizontal"&&this.align==="center"||this.layout==="vertical"&&(!this.align||this.align==="center"),"p-divider-right":this.layout==="horizontal"&&this.align==="right","p-divider-top":this.layout==="vertical"&&this.align==="top","p-divider-bottom":this.layout==="vertical"&&this.align==="bottom"}}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Fe({type:e,selectors:[["p-divider"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",layout:"layout",type:"type",align:"align"},ngContentSelectors:QN,decls:3,vars:6,consts:[["role","separator",3,"ngClass","ngStyle"],[1,"p-divider-content"]],template:function(n,i){n&1&&(Pr(),z(0,"div",0)(1,"div",1),xr(2),j()()),n&2&&(Ve(i.styleClass),b("ngClass",i.containerClass())("ngStyle",i.style),ee("aria-orientation",i.layout)("data-pc-name","divider"))},dependencies:[dr,or],styles:[`@layer primeng{.p-divider-horizontal{display:flex;width:100%;position:relative;align-items:center}.p-divider-horizontal:before{position:absolute;display:block;top:50%;left:0;width:100%;content:""}.p-divider-horizontal.p-divider-left{justify-content:flex-start}.p-divider-horizontal.p-divider-right{justify-content:flex-end}.p-divider-horizontal.p-divider-center{justify-content:center}.p-divider-content{z-index:1}.p-divider-vertical{min-height:100%;margin:0 1rem;display:flex;position:relative;justify-content:center}.p-divider-vertical:before{position:absolute;display:block;top:0;left:50%;height:100%;content:""}.p-divider-vertical.p-divider-top{align-items:flex-start}.p-divider-vertical.p-divider-center{align-items:center}.p-divider-vertical.p-divider-bottom{align-items:flex-end}.p-divider-solid.p-divider-horizontal:before{border-top-style:solid}.p-divider-solid.p-divider-vertical:before{border-left-style:solid}.p-divider-dashed.p-divider-horizontal:before{border-top-style:dashed}.p-divider-dashed.p-divider-vertical:before{border-left-style:dashed}.p-divider-dotted.p-divider-horizontal:before{border-top-style:dotted}.p-divider-dotted.p-divider-vertical:before{border-left-style:dotted}}
`],encapsulation:2,changeDetection:0})}return e})(),Af=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et]})}return e})();var wy=["container"],YN=e=>[e,"p-toast-message"],ZN=(e,r,t,n)=>({showTransformParams:e,hideTransformParams:r,showTransitionParams:t,hideTransitionParams:n}),JN=e=>({value:"visible",params:e}),eP=(e,r)=>({$implicit:e,closeFn:r}),tP=e=>({$implicit:e});function rP(e,r){e&1&&st(0)}function nP(e,r){if(e&1&&(Ye(0),Y(1,rP,1,0,"ng-container",4),Ze()),e&2){let t=P();S(),b("ngTemplateOutlet",t.headlessTemplate)("ngTemplateOutletContext",Hr(2,eP,t.message,t.onCloseIconClick))}}function iP(e,r){if(e&1&&ue(0,"span"),e&2){let t=P(3);Ve("p-toast-message-icon pi "+t.message.icon)}}function aP(e,r){e&1&&ue(0,"CheckIcon"),e&2&&ee("aria-hidden",!0)("data-pc-section","icon")}function sP(e,r){e&1&&ue(0,"InfoCircleIcon"),e&2&&ee("aria-hidden",!0)("data-pc-section","icon")}function oP(e,r){e&1&&ue(0,"TimesCircleIcon"),e&2&&ee("aria-hidden",!0)("data-pc-section","icon")}function lP(e,r){e&1&&ue(0,"ExclamationTriangleIcon"),e&2&&ee("aria-hidden",!0)("data-pc-section","icon")}function cP(e,r){if(e&1&&(z(0,"span",13),Ye(1),Y(2,aP,1,2,"CheckIcon",6)(3,sP,1,2,"InfoCircleIcon",6)(4,oP,1,2,"TimesCircleIcon",6)(5,lP,1,2,"ExclamationTriangleIcon",6),Ze(),j()),e&2){let t=P(3);ee("aria-hidden",!0)("data-pc-section","icon"),S(2),b("ngIf",t.message.severity==="success"),S(),b("ngIf",t.message.severity==="info"),S(),b("ngIf",t.message.severity==="error"),S(),b("ngIf",t.message.severity==="warn")}}function uP(e,r){if(e&1&&(Ye(0),Y(1,iP,1,2,"span",8)(2,cP,6,6,"span",9),z(3,"div",10)(4,"div",11),Ct(5),j(),z(6,"div",12),Ct(7),j()(),Ze()),e&2){let t=P(2);S(),b("ngIf",t.message.icon),S(),b("ngIf",!t.message.icon),S(),ee("data-pc-section","text"),S(),ee("data-pc-section","summary"),S(),Tr(t.message.summary),S(),ee("data-pc-section","detail"),S(),Tr(t.message.detail)}}function fP(e,r){e&1&&st(0)}function hP(e,r){if(e&1&&ue(0,"span"),e&2){let t=P(3);Ve("pt-1 text-base p-toast-message-icon pi "+t.message.closeIcon)}}function dP(e,r){e&1&&ue(0,"TimesIcon",16),e&2&&(b("styleClass","p-toast-icon-close-icon"),ee("aria-hidden",!0)("data-pc-section","closeicon"))}function pP(e,r){if(e&1){let t=nt();z(0,"button",14),Pe("click",function(i){_e(t);let a=P(2);return xe(a.onCloseIconClick(i))})("keydown.enter",function(i){_e(t);let a=P(2);return xe(a.onCloseIconClick(i))}),Y(1,hP,1,2,"span",8)(2,dP,1,3,"TimesIcon",15),j()}if(e&2){let t=P(2);ee("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),S(),b("ngIf",t.message.closeIcon),S(),b("ngIf",!t.message.closeIcon)}}function mP(e,r){if(e&1&&(z(0,"div",5),Y(1,uP,8,7,"ng-container",6)(2,fP,1,0,"ng-container",4)(3,pP,3,4,"button",7),j()),e&2){let t=P();b("ngClass",t.message==null?null:t.message.contentStyleClass),ee("data-pc-section","content"),S(),b("ngIf",!t.template),S(),b("ngTemplateOutlet",t.template)("ngTemplateOutletContext",gt(6,tP,t.message)),S(),b("ngIf",(t.message==null?null:t.message.closable)!==!1)}}function gP(e,r){if(e&1){let t=nt();z(0,"p-toastItem",3),Pe("onClose",function(i){_e(t);let a=P();return xe(a.onMessageClose(i))})("@toastAnimation.start",function(i){_e(t);let a=P();return xe(a.onAnimationStart(i))})("@toastAnimation.done",function(i){_e(t);let a=P();return xe(a.onAnimationEnd(i))}),j()}if(e&2){let t=r.$implicit,n=r.index,i=P();b("message",t)("index",n)("life",i.life)("template",i.template)("headlessTemplate",i.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",i.showTransformOptions)("hideTransformOptions",i.hideTransformOptions)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}}var vP=(()=>{class e{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new Be;containerViewChild;timeout;constructor(t,n){this.zone=t,this.config=n}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=t=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(n){return new(n||e)(ce(fr),ce(an))};static \u0275cmp=Fe({type:e,selectors:[["p-toastItem"]],viewQuery:function(n,i){if(n&1&&At(wy,5),n&2){let a;je(a=Ge())&&(i.containerViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",tr],life:[2,"life","life",tr],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[Qt],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(n,i){if(n&1){let a=nt();z(0,"div",2,0),Pe("mouseenter",function(){return _e(a),xe(i.onMouseEnter())})("mouseleave",function(){return _e(a),xe(i.onMouseLeave())}),Y(2,nP,2,5,"ng-container",3)(3,mP,4,8,"ng-template",null,1,rn),j()}if(n&2){let a=sr(4);Ve(i.message==null?null:i.message.styleClass),b("ngClass",gt(9,YN,"p-toast-message-"+(i.message==null?null:i.message.severity)))("@messageState",gt(16,JN,cu(11,ZN,i.showTransformOptions,i.hideTransformOptions,i.showTransitionOptions,i.hideTransitionOptions))),ee("id",i.message==null?null:i.message.id)("data-pc-name","toast")("data-pc-section","root"),S(2),b("ngIf",i.headlessTemplate)("ngIfElse",a)}},dependencies:()=>[dr,yr,wr,fi,ma,Fo,Do,Oo,In],encapsulation:2,data:{animation:[ds("messageState",[Hg("visible",Ui({transform:"translateY(0)",opacity:1})),$i("void => *",[Ui({transform:"{{showTransformParams}}",opacity:0}),ra("{{showTransitionParams}}")]),$i("* => void",[ra("{{hideTransitionParams}}",Ui({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return e})(),by=(()=>{class e{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new Be;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(t,n,i,a,s){this.document=t,this.renderer=n,this.messageService=i,this.cd=a,this.config=s}styleElement;id=br();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){let n=t.filter(i=>this.canAdd(i));this.add(n)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let n=this.key===t.key;return n&&this.preventOpenDuplicates&&(n=!this.containsMessage(this.messages,t)),n&&this.preventDuplicates&&(n=!this.containsMessage(this.messagesArchieve,t)),n}containsMessage(t,n){return t?t.find(i=>i.summary===n.summary&&i.detail==n.detail&&i.severity===n.severity)!=null:!1}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"message":this.template=t.template;break;case"headless":this.headlessTemplate=t.template;break;default:this.template=t.template;break}})}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){t.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&ui.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){t.toState==="void"&&this.autoZIndex&&Je.isEmpty(this.messages)&&ui.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",J.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let n in this.breakpoints){let i="";for(let a in this.breakpoints[n])i+=a+":"+this.breakpoints[n][a]+" !important;";t+=`
                    @media screen and (max-width: ${n}) {
                        .p-toast[${this.id}] {
                           ${i}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",t)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&ui.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(n){return new(n||e)(ce(Ut),ce(Nr),ce(Ba),ce(hr),ce(an))};static \u0275cmp=Fe({type:e,selectors:[["p-toast"]],contentQueries:function(n,i,a){if(n&1&&ar(a,mr,4),n&2){let s;je(s=Ge())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&At(wy,5),n&2){let a;je(a=Ge())&&(i.containerViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",Se],baseZIndex:[2,"baseZIndex","baseZIndex",tr],life:[2,"life","life",tr],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",Se],preventDuplicates:[2,"preventDuplicates","preventDuplicates",Se],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[Qt],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(n,i){n&1&&(z(0,"div",1,0),Y(2,gP,1,10,"p-toastItem",2),j()),n&2&&(Ve(i.styleClass),b("ngClass","p-toast-"+i._position)("ngStyle",i.style),S(2),b("ngForOf",i.messages))},dependencies:[dr,oi,or,vP],styles:[`@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}
`],encapsulation:2,data:{animation:[ds("toastAnimation",[$i(":enter, :leave",[jg("@*",zg())])])]},changeDetection:0})}return e})(),Cy=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,Hi,ma,Fo,Do,Oo,In,lr]})}return e})();var Ey={title:"Character QA Record",primaryKey:"uid",type:"object",version:5,properties:{name:{type:"string",title:"\u89D2\u8272\u540D\u5B57",description:"\u89D2\u8272\u540D\u5B57 (name)",importance:0},question:{type:"string",title:"\u95EE\u9898",description:"\u95EE\u9898 (question)",importance:110},answer:{type:"string",title:"\u56DE\u7B54",description:"\u56DE\u7B54 (answer)",importance:100},detail:{type:"string",title:"\u72B6\u6001\u63CF\u8FF0",description:"\u72B6\u6001\u63CF\u8FF0 (detail)",importance:99},emotion:{type:"string",title:"\u60C5\u7EEA",description:"\u60C5\u7EEA (emotion)",importance:98},facialExpression:{type:"string",title:"\u8868\u60C5",description:"\u8868\u60C5 (facialExpression)",importance:98},bodyAction:{type:"string",title:"\u52A8\u4F5C",description:"\u52A8\u4F5C (bodyAction)",importance:98},uid:{type:"string",format:"uuid",maxLength:50,title:"\u552F\u4E00\u6807\u8BC6",description:"\u552F\u4E00\u6807\u8BC6 (uid)",importance:0},custom_1:{type:"string",title:"\u81EA\u5B9A\u4E491",description:"\u81EA\u5B9A\u4E491 (custom_1)",importance:10},custom_2:{type:"string",title:"\u81EA\u5B9A\u4E492",description:"\u81EA\u5B9A\u4E492 (custom_2)",importance:10},custom_3:{type:"string",title:"\u81EA\u5B9A\u4E493",description:"\u81EA\u5B9A\u4E493 (custom_3)",importance:10},caseIndex:{type:"number",title:"\u5E8F\u53F7",description:"\u5E8F\u53F7 (index)",importance:5,uniqueItems:!0}},required:["question","answer","uid","caseIndex"],examples:[{name:"John Doe",question:"\u5B9D\u5B9D\uFF0C\u5988\u5988\u56DE\u6765\u4E86",answer:"\u5988\u5988\uFF01\u5988\u5988\uFF01",detail:"\u58F0\u97F3\u5F88\u5927\uFF0C\u5E72\u8106\uFF0C\u900F\u7740\u5174\u594B\u52B2\u3002\u5634\u89D2\u4E0A\u626C\uFF0C\u9732\u51FA\u5F88\u5927\u7684\u3001\u751C\u751C\u7684\u7B11\u3002\u773C\u775B\u5F2F\u5F2F\u7684\uFF0C\u95EA\u95EA\u7684\u671B\u7740\u5988\u5988\uFF0C\u7528\u773C\u795E\u8868\u8FBE\u4E86\u6253\u5FC3\u5E95\u7684\u5F00\u5FC3\u3002\u6CA1\u6709\u79BB\u5F00\u5EA7\u4F4D\uFF0C\u8BF4\u8BDD\u7684\u65F6\u5019\u671D\u7740\u524D\u65B9\u4F38\u51FA\u624B\uFF0C\u60F3\u8981\u62B1\u62B1\u7684\u6837\u5B50",emotion:"\u5FEB\u4E50",facialExpression:"\u7B11\u5BB9",bodyAction:"\u6325\u624B",other:"\u65E0",uid:"d3b07384-d9a0-4f5c-8b1d-4e4a3a1e5b5b",custom_1:"\u81EA\u5B9A\u4E49\u5B57\u6BB51",custom_2:"\u81EA\u5B9A\u4E49\u5B57\u6BB52",custom_3:"\u81EA\u5B9A\u4E49\u5B57\u6BB53",caseIndex:1}]};var Sy=Ey;function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ls(e)}function Ty(e,r){if(Ls(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(Ls(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Iy(e){var r=Ty(e,"string");return Ls(r)=="symbol"?r:r+""}function ky(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iy(n.key),n)}}function Dn(e,r,t){return r&&ky(e.prototype,r),t&&ky(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ay(e){return e[e.length-1]}function Of(e){return Array.isArray(e)?e.slice(0):[e]}function Oy(e,r){e=e.slice(0);for(var t=[];e.length;){var n=e.splice(0,r);t.push(n)}return t}function Lo(e){return Array.isArray(e)}function Fy(e){return e!=null}function Ff(e,r){var t=0,n=-1;for(var i of e){n=n+1;var a=r(i,n);if(a)t=t+1;else break}return t}function Qn(e,r){var t=r.length;if(t!==0){var n=e.length;e.length=n+r.length;for(var i=0;i<t;++i)e[n+i]=r[i]}}function _i(e){for(var r="",t=0;t<e.length;t++){var n=e[t];if(n==="-")return parseInt(r,10);r+=n}throw new Error("malformatted revision: "+e)}function En(e,r){var t=r?_i(r._rev)+1:1;return t+"-"+e}function Df(e){var r=e.split("."),t=r.length;return t===1?n=>n[e]:n=>{for(var i=n,a=0;a<t;++a){var s=r[a];if(i=i[s],typeof i>"u")return i}return i}}function It(e){return Object.assign({},e)}function Dy(e){return Object.keys(e)[0]}function Bo(e,r=!1){if(!e)return e;if(!r&&Array.isArray(e))return e.sort((n,i)=>typeof n=="string"&&typeof i=="string"?n.localeCompare(i):typeof n=="object"?1:-1).map(n=>Bo(n,r));if(typeof e=="object"&&!Array.isArray(e)){var t={};return Object.keys(e).sort((n,i)=>n.localeCompare(i)).forEach(n=>{t[n]=Bo(e[n],r)}),t}return e}function bp(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var r=new Array(e.length),t=r.length;t--;)r[t]=bp(e[t]);return r}var n={};for(var i in e)n[i]=bp(e[i]);return n}var cr=bp;function Yn(e,r,t){return Object.defineProperty(e,r,{get:function(){return t}}),t}var Ic=1;function Bn(){return{lwt:Ic}}function gr(){return""}function Ry(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function My(e,r,t){if(r.length!==t.length)return!1;for(var n=0,i=r.length;n<i;){var a=r[n],s=t[n];if(n++,a._rev!==s._rev||a[e]!==s[e])return!1}return!0}var bz=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});var Cz=Object.freeze(["prototype","__proto__","constructor"]);var yP="[native code] }",Ez=yP.length;var Xa=class e{constructor(r,t){r=this.words=r||[],this.sigBytes=t===void 0?r.length*4:t}toString(r){return(r||wP).stringify(this)}concat(r){if(this.clamp(),this.sigBytes%4)for(let t=0;t<r.sigBytes;t++){let n=r.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=n<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<r.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=r.words[t>>>2];return this.sigBytes+=r.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new e([...this.words])}},wP={stringify(e){let r=[];for(let t=0;t<e.sigBytes;t++){let n=e.words[t>>>2]>>>24-t%4*8&255;r.push((n>>>4).toString(16),(n&15).toString(16))}return r.join("")}};var bP={parse(e){let r=e.length,t=[];for(let n=0;n<r;n++)t[n>>>2]|=(e.charCodeAt(n)&255)<<24-n%4*8;return new Xa(t,r)}},CP={parse(e){return bP.parse(unescape(encodeURIComponent(e)))}},Cp=class{constructor(){this._data=new Xa,this._nDataBytes=0,this._minBufferSize=0,this.blockSize=512/32}reset(){this._data=new Xa,this._nDataBytes=0}_append(r){typeof r=="string"&&(r=CP.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes}_doProcessBlock(r,t){}_process(r){let t,n=this._data.sigBytes/(this.blockSize*4);r?n=Math.ceil(n):n=Math.max((n|0)-this._minBufferSize,0);let i=n*this.blockSize,a=Math.min(i*4,this._data.sigBytes);if(i){for(let s=0;s<i;s+=this.blockSize)this._doProcessBlock(this._data.words,s);t=this._data.words.splice(0,i),this._data.sigBytes-=a}return new Xa(t,a)}},Ep=class extends Cp{update(r){return this._append(r),this._process(),this}finalize(r){r&&this._append(r)}},Ny=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],EP=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Bs=[],Sp=class extends Ep{constructor(){super(...arguments),this._hash=new Xa([...Ny])}reset(){super.reset(),this._hash=new Xa([...Ny])}_doProcessBlock(r,t){let n=this._hash.words,i=n[0],a=n[1],s=n[2],o=n[3],l=n[4],c=n[5],u=n[6],f=n[7];for(let h=0;h<64;h++){if(h<16)Bs[h]=r[t+h]|0;else{let _=Bs[h-15],w=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,D=Bs[h-2],U=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;Bs[h]=w+Bs[h-7]+U+Bs[h-16]}let d=l&c^~l&u,g=i&a^i&s^a&s,v=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),p=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),m=f+p+d+EP[h]+Bs[h],x=v+g;f=u,u=c,c=l,l=o+m|0,o=s,s=a,a=i,i=m+x|0}n[0]=n[0]+i|0,n[1]=n[1]+a|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0,n[5]=n[5]+c|0,n[6]=n[6]+u|0,n[7]=n[7]+f|0}finalize(r){super.finalize(r);let t=this._nDataBytes*8,n=this._data.sigBytes*8;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[(n+64>>>9<<4)+14]=Math.floor(t/4294967296),this._data.words[(n+64>>>9<<4)+15]=t,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}};function Py(e){return new Sp().finalize(e).toString()}function SP(e){return Promise.resolve(Py(e))}function TP(e){return Z(this,null,function*(){var r=new TextEncoder().encode(e),t=yield crypto.subtle.digest("SHA-256",r),n=Array.prototype.map.call(new Uint8Array(t),i=>("00"+i.toString(16)).slice(-2)).join("");return n})}var IP=typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof crypto.subtle.digest=="function",Ly=IP?TP:SP;function By(){return new Promise(e=>setTimeout(e,0))}function Vy(e=0){return new Promise(r=>setTimeout(r,e))}function Uy(e){return e&&typeof e.then=="function"?e:Promise.resolve(e)}var kc=Promise.resolve(!0),un=Promise.resolve(!1),Ac=Promise.resolve(null),Gr=Promise.resolve();function Qa(e=1e4){return typeof requestIdleCallback=="function"?new Promise(r=>{requestIdleCallback(()=>r(),{timeout:e})}):Vy(0)}var Tp=Gr;function $y(e=void 0){return Tp=Tp.then(()=>Qa(e)),Tp}function Wy(e,r){return e.reduce((t,n)=>t.then(n),Promise.resolve(r))}var Hy=/\./g;var zy="abcdefghijklmnopqrstuvwxyz";function Fi(e=10){for(var r="",t=0;t<e;t++)r+=zy.charAt(Math.floor(Math.random()*zy.length));return r}function Rf(e){e+="";var r=e.charAt(0).toUpperCase();return r+e.substr(1)}function Vs(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function Gi(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var t,n;if(Array.isArray(e)){if(t=e.length,t!==r.length)return!1;for(n=t;n--!==0;)if(!Gi(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();var i=Object.keys(e);if(t=i.length,t!==Object.keys(r).length)return!1;for(n=t;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[n]))return!1;for(n=t;n--!==0;){var a=i[n];if(!Gi(e[a],r[a]))return!1}return!0}return e!==e&&r!==r}var kP=e=>{var r=typeof e;return e!==null&&(r==="object"||r==="function")},Ip=new Set(["__proto__","prototype","constructor"]),AP=new Set("0123456789");function OP(e){var r=[],t="",n="start",i=!1;for(var a of e)switch(a){case"\\":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");i&&(t+=a),n="property",i=!i;break}case".":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="property";break}if(i){i=!1,t+=a;break}if(Ip.has(t))return[];r.push(t),t="",n="property";break}case"[":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="index";break}if(i){i=!1,t+=a;break}if(n==="property"){if(Ip.has(t))return[];r.push(t),t=""}n="index";break}case"]":{if(n==="index"){r.push(Number.parseInt(t,10)),t="",n="indexEnd";break}if(n==="indexEnd")throw new Error("Invalid character after an index")}default:{if(n==="index"&&!AP.has(a))throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");n==="start"&&(n="property"),i&&(i=!1,t+="\\"),t+=a}}switch(i&&(t+="\\"),n){case"property":{if(Ip.has(t))return[];r.push(t);break}case"index":throw new Error("Index was not closed");case"start":{r.push("");break}}return r}function FP(e,r){if(typeof r!="number"&&Array.isArray(e)){var t=Number.parseInt(r,10);return Number.isInteger(t)&&e[t]===e[r]}return!1}function ga(e,r,t){if(Array.isArray(r)&&(r=r.join(".")),!r.includes(".")&&!r.includes("["))return e[r];if(!kP(e)||typeof r!="string")return t===void 0?e:t;var n=OP(r);if(n.length===0)return t;for(var i=0;i<n.length;i++){var a=n[i];if(FP(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return t;break}}return e===void 0?t:e}function Di(e,r){var t=e.get(r);if(typeof t>"u")throw new Error("missing value from map "+r);return t}function Rn(e,r,t,n){var i=e.get(r);return typeof i>"u"?(i=t(),e.set(r,i)):n&&n(i),i}function Bt(e){var r=e.split("-"),t="RxDB";return r.forEach(n=>{t+=Rf(n)}),t+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+t+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+t+`);
        `)}function jy(e){var r={name:e.name,message:e.message,rxdb:e.rxdb,parameters:e.parameters,extensions:e.extensions,code:e.code,url:e.url,stack:e.stack?e.stack.replace(/\n/g,` 
 `):void 0};return r}var kp=0;function Yt(){var e=Date.now();e=e+.01,e<=kp&&(e=kp+.01);var r=parseFloat(e.toFixed(2));return kp=r,r}function He(e,r){if(!e)throw r||(r=""),new Error("ensureNotFalsy() is falsy: "+r);return e}var Ki={bufferSize:1,refCount:!0};var Oc="15.32.0";function Ya(e,r){return Ya=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ya(e,r)}function Fc(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,Ya(e,r)}function Mf(e){return Mf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mf(e)}function Gy(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function Ap(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ap=function(){return!!e})()}function Ky(e,r,t){if(Ap())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,r);var i=new(e.bind.apply(e,n));return t&&Ya(i,t.prototype),i}function Dc(e){var r=typeof Map=="function"?new Map:void 0;return Dc=function(n){if(n===null||!Gy(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(r!==void 0){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return Ky(n,arguments,Mf(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ya(i,n)},Dc(e)}var ft={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return"RxDB Error-Code "+e+`.
        Error messages are not included in RxDB core to reduce build size.
        `}};function DP(e){var r="";return Object.keys(e).length===0||(r+=`Given parameters: {
`,r+=Object.keys(e).map(t=>{var n="[object Object]";try{t==="errors"?n=e[t].map(i=>JSON.stringify(i,Object.getOwnPropertyNames(i))):n=JSON.stringify(e[t],function(i,a){return a===void 0?null:a},2)}catch{}return t+":"+n}).join(`
`),r+="}"),r}function qy(e,r,t){return"RxError ("+r+`):
`+e+`
`+DP(t)}var RP=function(e){function r(n,i,a={}){var s,o=qy(i,n,a);return s=e.call(this,o)||this,s.code=n,s.message=o,s.url=Op(n),s.parameters=a,s.rxdb=!0,s}Fc(r,e);var t=r.prototype;return t.toString=function(){return this.message},Dn(r,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}(Dc(Error)),MP=function(e){function r(n,i,a={}){var s,o=qy(i,n,a);return s=e.call(this,o)||this,s.code=n,s.message=o,s.url=Op(n),s.parameters=a,s.rxdb=!0,s}Fc(r,e);var t=r.prototype;return t.toString=function(){return this.message},Dn(r,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}(Dc(TypeError));function Op(e){return"https://rxdb.info/errors.html?console=errors#"+e}function Xy(e){return`
 You can find out more about this error here: `+Op(e)+" "}function Te(e,r){return new RP(e,ft.tunnelErrorMessage(e)+Xy(e),r)}function fn(e,r){return new MP(e,ft.tunnelErrorMessage(e)+Xy(e),r)}function Us(e){return e&&e.status===409?e:!1}var NP={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function Qy(e){return Te("COL20",{name:NP[e.status],document:e.documentId,writeError:e})}var Vo={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],postCleanup:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function $r(e,r){Vo[e].length>0&&Vo[e].forEach(t=>t(r))}function Za(e,r){return Promise.all(Vo[e].map(t=>t(r)))}function xi(e,r){var t=r;t=t.replace(Hy,".properties."),t="properties."+t,t=Vs(t);var n=ga(e,t);return n}function Yy(e,r,t){if(typeof r.primaryKey=="string")return t;var n=Ri(r,t),i=t[e];if(i&&i!==n)throw Te("DOC19",{args:{documentData:t,existingPrimary:i,newPrimary:n},schema:r});return t[e]=n,t}function Kr(e){return typeof e=="string"?e:e.key}function Zy(e){var r=Kr(e.primaryKey),t=xi(e,r);return He(t.maxLength)}function Ri(e,r){if(typeof e.primaryKey=="string")return r[e.primaryKey];var t=e.primaryKey;return t.fields.map(n=>{var i=ga(r,n);if(typeof i>"u")throw Te("DOC18",{args:{field:n,documentData:r}});return i}).join(t.separator)}function Jy(e){var r=Bo(e,!0);return r}function PP(e){return["_deleted",e]}function Ja(e){e=It(e);var r=Kr(e.primaryKey);e.properties=It(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=LP,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var t=Fp(e);Qn(e.required,t),e.required=e.required.filter(a=>!a.includes(".")).filter((a,s,o)=>o.indexOf(a)===s),e.version=e.version||0;var n=e.indexes.map(a=>{var s=Lo(a)?a.slice(0):[a];return s.includes(r)||s.push(r),s[0]!=="_deleted"&&s.unshift("_deleted"),s});n.length===0&&n.push(PP(r)),n.push(["_meta.lwt",r]),e.internalIndexes&&e.internalIndexes.map(a=>{n.push(a)});var i=new Set;return n.filter(a=>{var s=a.join(",");return i.has(s)?!1:(i.add(s),!0)}),e.indexes=n,e}var LP={type:"object",properties:{lwt:{type:"number",minimum:Ic,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function Fp(e){var r=Object.keys(e.properties).filter(n=>e.properties[n].final),t=Kr(e.primaryKey);return r.push(t),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(n=>r.push(n)),r}function ew(e,r){for(var t=Object.keys(e.defaultValues),n=0;n<t.length;++n){var i=t[n];(!Object.prototype.hasOwnProperty.call(r,i)||typeof r[i]>"u")&&(r[i]=e.defaultValues[i])}return r}var Dp=function(){function e(t,n){this.jsonSchema=t,this.hashFunction=n,this.indexes=BP(this.jsonSchema),this.primaryPath=Kr(this.jsonSchema.primaryKey),this.finalFields=Fp(this.jsonSchema)}var r=e.prototype;return r.validateChange=function(n,i){this.finalFields.forEach(a=>{if(!Gi(n[a],i[a]))throw Te("DOC9",{dataBefore:n,dataAfter:i,fieldName:a,schema:this.jsonSchema})})},r.getDocumentPrototype=function(){var n={},i=xi(this.jsonSchema,"");return Object.keys(i).forEach(a=>{var s=a;n.__defineGetter__(a,function(){if(!(!this.get||typeof this.get!="function")){var o=this.get(s);return o}}),Object.defineProperty(n,a+"$",{get:function(){return this.get$(s)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"$$",{get:function(){return this.get$$(s)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"_",{get:function(){return this.populate(s)},enumerable:!1,configurable:!1})}),Yn(this,"getDocumentPrototype",()=>n),n},r.getPrimaryOfDocumentData=function(n){return Ri(this.jsonSchema,n)},Dn(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var t={};return Object.entries(this.jsonSchema.properties).filter(([,n])=>Object.prototype.hasOwnProperty.call(n,"default")).forEach(([n,i])=>t[n]=i.default),Yn(this,"defaultValues",t)}},{key:"hash",get:function(){return Yn(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function BP(e){return(e.indexes||[]).map(r=>Lo(r)?r:[r])}function tw(e){var r=e.version?e.version:0,t=0;return new Array(r).fill(0).map(()=>t++)}function rw(e,r,t=!0){t&&$r("preCreateRxSchema",e);var n=Ja(e);n=Jy(n),ft.deepFreezeWhenDevMode(n);var i=new Dp(n,r);return $r("createRxSchema",i),i}function Nf(e){return e.documentData?e.documentData:e.previousDocumentData}function nw(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:ft.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}function Pf(e){return e[e.length-1]}function VP(e){let r=typeof e;return e!==null&&(r==="object"||r==="function")}function Rp(e,r,t){if(Array.isArray(r)&&(r=r.join(".")),!VP(e)||typeof r!="string")return t===void 0?e:t;let n=r.split(".");if(n.length===0)return t;for(let i=0;i<n.length;i++){let a=n[i];if(UP(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return t;break}}return e===void 0?t:e}function UP(e,r){if(typeof r!="number"&&Array.isArray(e)){let t=Number.parseInt(r,10);return Number.isInteger(t)&&e[t]===e[r]}return!1}var Mp=e=>!!e.queryParams.limit,iw=e=>e.queryParams.limit===1,aw=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),sw=e=>e.changeEvent.operation==="DELETE",ow=e=>e.changeEvent.operation==="INSERT",lw=e=>e.changeEvent.operation==="UPDATE",cw=e=>Mp(e)&&e.previousResults.length>=e.queryParams.limit,uw=e=>{let r=e.queryParams.sortFields,t=e.changeEvent.previous,n=e.changeEvent.doc;if(!n)return!1;if(!t)return!0;for(let i=0;i<r.length;i++){let a=r[i],s=Rp(t,a),o=Rp(n,a);if(s!==o)return!0}return!1},fw=e=>{let r=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(r);{let t=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][t]===r)return!0;return!1}},hw=e=>{let r=e.previousResults[0];return!!(r&&r[e.queryParams.primaryKey]===e.changeEvent.id)},dw=e=>{let r=Pf(e.previousResults);return!!(r&&r[e.queryParams.primaryKey]===e.changeEvent.id)},pw=e=>{let r=e.changeEvent.previous;if(!r)return!1;let t=e.previousResults[0];return t?t[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(r,t)<0:!1},mw=e=>{let r=e.changeEvent.previous;if(!r)return!1;let t=Pf(e.previousResults);return t?t[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(r,t)>0:!1},gw=e=>{let r=e.changeEvent.doc;if(!r)return!1;let t=e.previousResults[0];return t?t[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(r,t)<0:!1},vw=e=>{let r=e.changeEvent.doc;if(!r)return!1;let t=Pf(e.previousResults);return t?t[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(r,t)>0:!1},_w=e=>{let r=e.changeEvent.previous;return r?e.queryParams.queryMatcher(r):!1},xw=e=>{let r=e.changeEvent.doc;return r?e.queryParams.queryMatcher(r):!1},yw=e=>e.previousResults.length===0;var ww={0:ow,1:lw,2:sw,3:Mp,4:iw,5:aw,6:yw,7:cw,8:hw,9:dw,10:uw,11:fw,12:pw,13:mw,14:gw,15:vw,16:_w,17:xw};function Lf(e,r,t,n){var i=e.length,a=i-1,s=0;if(i===0)return e.push(r),0;for(var o;n<=a;)s=n+(a-n>>1),o=e[s],t(o,r)<=0?n=s+1:a=s-1;return t(o,r)<=0&&s++,e.splice(s,0,r),s}var bw=e=>{},Bf=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},Vf=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},Uf=e=>{let r=e.previousResults.shift();e.keyDocumentMap&&r&&e.keyDocumentMap.delete(r[e.queryParams.primaryKey])},$f=e=>{let r=e.previousResults.pop();e.keyDocumentMap&&r&&e.keyDocumentMap.delete(r[e.queryParams.primaryKey])},Cw=e=>{Uf(e),Vf(e)},Ew=e=>{$f(e),Bf(e)},Sw=e=>{Uf(e),Bf(e)},Tw=e=>{$f(e),Vf(e)},Np=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);let r=e.queryParams.primaryKey,t=e.previousResults;for(let n=0;n<t.length;n++)if(t[n][r]===e.changeEvent.id){t.splice(n,1);break}},Iw=e=>{let r=e.changeEvent.doc,t=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][t]===e.changeEvent.id){n[i]=r,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,r);break}},kw=e=>{let r={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(r),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(r._id,r))},Pp=e=>{let r=e.changeEvent.id,t=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(r))return;e.keyDocumentMap.set(r,t)}else if(e.previousResults.find(i=>i[e.queryParams.primaryKey]===r))return;Lf(e.previousResults,t,e.queryParams.sortComparator,0)},Aw=e=>{Np(e),Pp(e)},Ow=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},Fw=e=>{throw new Error("Action unknownAction should never be called")};var Dw=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],Rw={doNothing:bw,insertFirst:Bf,insertLast:Vf,removeFirstItem:Uf,removeLastItem:$f,removeFirstInsertLast:Cw,removeLastInsertFirst:Ew,removeFirstInsertFirst:Sw,removeLastInsertLast:Tw,removeExisting:Np,replaceExisting:Iw,alwaysWrong:kw,insertAtSortPosition:Pp,removeExistingAndInsertAtSortPosition:Aw,runFullQueryAgain:Ow,unknownAction:Fw};function Wf(e){return e.charCodeAt(0)-40}function Mw(e){return e?"1":"0"}function $P(e=6){let r="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;for(let i=0;i<e;i++)r+=t.charAt(Math.floor(Math.random()*n));return r}var Nj=$P(4);function Lp(e,r){let t=[];for(let n=0,i=e.length;n<i;n+=r)t.push(e.substring(n,n+r));return t}function Nw(e){let r=new Map,n=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,i=e.substring(2,n),a=Lp(i,2);for(let v=0;v<a.length;v++){let p=a[v],m=p.charAt(0),x=Wf(p.charAt(1));r.set(m,x)}let s=e.substring(n,e.length-3),o=Lp(s,4);for(let v=0;v<o.length;v++){let p=o[v],m=p.charAt(0),x=p.charAt(1),_=p.charAt(2),w=Wf(p.charAt(3));if(!r.has(x))throw new Error("missing node with id "+x);if(!r.has(_))throw new Error("missing node with id "+_);let D=r.get(x),U=r.get(_),F={l:w,0:D,1:U};r.set(m,F)}let l=e.slice(-3),c=l.charAt(0),u=l.charAt(1),f=Wf(l.charAt(2)),h=r.get(c),d=r.get(u);return{l:f,0:h,1:d}}function Pw(e,r,t){let n=e,i=e.l;for(;;){let a=r[i](t),s=Mw(a);if(n=n[s],typeof n=="number"||typeof n=="string")return n;i=n.l}}var WP="14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9\x7Fae9\xA1bf9\xA2bq9\xA3cg9\xA4ck9\xA5cn9\xA6nd9\xA7np9\xA8nq9\xA9nf9\xAAng9\xABnm9\xACnk9\xADmr9\xAEms9\xAFmt9\xB0mj9\xB1mk9\xB2ml9\xB3mn9\xB4mc8\xB5\xB3{8\xB6\xAF}8\xB7\xB0\xA48\xB8\xB3\xA78\xB9mn8\xBA\xB3\xAB8\xBB\xB3m8\xBCm\xB44\xBDz\xB24\xBE\xB3w4\xBFz\xB54\xC0\xAF\xB64\xC1\xB0\xB74\xC2\xB3\xBA4\xC3\xB3\xB84\xC4m\xB94\xC5v\xA47\xC6yn7\xC7\xC0\xC17\xC8~\x7F7\xC9\xA5\xA47\xCA\xC3\xC47\xCB\xA8n7\xCC\xBA\xB97\xCD\xAD\xB07\xCE\xAEm7\xCF\xAF\xB07\xD0\xB1m7\xD1\xB3m7\xD2\xBCm5\xD3\xC4m5\xD4\xB9m5\xD5\xBD\xB05\xD6\xBEm5\xD7\xBF\xB05\xD8\xC7\xCF5\xD9\xC2m5\xDA\xCA\xD15\xDB\xB1m5\xDC\xBAm5\xDD\xCC\xD15\xDE\xD5\xCD2\xDF|\x7F2\xE0\xA1u2\xE1\xA3\xC52\xE2\xD6\xCE2\xE3\xA6\xC62\xE4\xA9x2\xE5\xAA\xC62\xE6\xD7\xD82\xE7|\xC82\xE8\xA1\xA22\xE9\xA3\xC92\xEA\xA4\xA52\xEB\xD9\xDA2\xEC\xA6\xCB2\xED\xA9n2\xEE\xAAn2\xEF\xDB\xD02\xF0\xDC\xDD2\xF1\xACn2\xF2\xD2\xD3/\xF3an/\xF4bn/\xF5cn/\xF6\xDE\xE2/\xF7\xDF\xE3/\xF8\xE0\xE4/\xF9\xE1\xE5/\xFA\xE6\xEB/\xFB\xE7\xEC/\xFC\xE8\xED/\xFD\xE9\xEE/\xFE\xCD\xCE/\xFF\xCF\xD1/\u0100\xF2\xD4,\u0101cn,\u0102\xF6\xEF,\u0103\xA4\xF1,\u0104\xFA\xF0,\u0105\xEA\xF1,\u0106\xFE\xD0,\u0107\xFF\xD1,\u0108ac0\u0109bc0\u010A\xF3\xF50\u010B\xF4\u01010\u010C\xDF\xE10\u010D\xE0\xA40\u010E\xE7\xE90\u010F\xE8\xEA0\u0110\xF7\xF90\u0111\xF8\u01030\u0112\xFB\xFD0\u0113\xFC\u01050\u0114m\xD2-\u0115m\u0100-\u0116\xDE\xE6-\u0117\u010C\u010E-\u0118\u010D\u010F-\u0119\u0102\u0104-\u011A\u0110\u0112-\u011B\u0111\u0113-\u011C\xB2\xBB-\u011D\xCD\xCF-\u011E\u0106\u0107-\u011F\xB2\xB3-\u0120\u0114\u01083\u0121\u0115\u010A3\u0122\u0116\u01173\u0123\u0119\u011A3\u0124\u0122\u011D(\u0125\u011C\u011F(\u0126\u0123\u011E(\u0127\u0120\u0121+\u0128\u0109\u010B+\u0129\u0124\u0126+\u012A\u0118\u011B+\u012B\u0127\u01281\u012C\u0129\u012A1\u012D\u012C\u012B*\u012E\u0125m*\u012D\u012E.",Bp;function HP(){return Bp||(Bp=Nw(WP)),Bp}var Lw=e=>Pw(HP(),ww,e);function Bw(e){let r=Lw(e);return Dw[r]}function Vw(e,r,t,n,i){let a=Rw[e];return a({queryParams:r,changeEvent:t,previousResults:n,keyDocumentMap:i}),n}var Mi="\uFFFF",qi=Number.MIN_SAFE_INTEGER;function Uw(e,r){var t=r.selector,n=e.indexes?e.indexes.slice(0):[];r.index&&(n=[r.index]);var i=!!r.sort.find(u=>Object.values(u)[0]==="desc"),a=new Set;Object.keys(t).forEach(u=>{var f=xi(e,u);f&&f.type==="boolean"&&Object.prototype.hasOwnProperty.call(t[u],"$eq")&&a.add(u)});var s=r.sort.map(u=>Object.keys(u)[0]),o=s.filter(u=>!a.has(u)).join(","),l=-1,c;if(n.forEach(u=>{var f=!0,h=!0,d=u.map(x=>{var _=t[x],w=_?Object.keys(_):[],D={};if(!_||!w.length){var U=h?qi:Mi;D={startKey:U,endKey:f?Mi:qi,inclusiveStart:!0,inclusiveEnd:!0}}else w.forEach(F=>{if(Hf.has(F)){var R=_[F],M=KP(F,R);D=Object.assign(D,M)}});return typeof D.startKey>"u"&&(D.startKey=qi),typeof D.endKey>"u"&&(D.endKey=Mi),typeof D.inclusiveStart>"u"&&(D.inclusiveStart=!0),typeof D.inclusiveEnd>"u"&&(D.inclusiveEnd=!0),h&&!D.inclusiveStart&&(h=!1),f&&!D.inclusiveEnd&&(f=!1),D}),g=d.map(x=>x.startKey),v=d.map(x=>x.endKey),p={index:u,startKeys:g,endKeys:v,inclusiveEnd:f,inclusiveStart:h,sortSatisfiedByIndex:!i&&o===u.filter(x=>!a.has(x)).join(","),selectorSatisfiedByIndex:GP(u,r.selector,g,v)},m=qP(e,r,p);(m>=l||r.index)&&(l=m,c=p)}),!c)throw Te("SNH",{query:r});return c}var Hf=new Set(["$eq","$gt","$gte","$lt","$lte"]),zP=new Set(["$eq","$gt","$gte"]),jP=new Set(["$eq","$lt","$lte"]);function GP(e,r,t,n){var i=Object.entries(r),a=i.find(([F,R])=>{if(!e.includes(F))return!0;var M=Object.entries(R).find(([W,B])=>!Hf.has(W));return M});if(a||r.$and||r.$or)return!1;var s=[],o=new Set;for(var[l,c]of Object.entries(r)){if(!e.includes(l))return!1;var u=Object.keys(c).filter(F=>zP.has(F));if(u.length>1)return!1;var f=u[0];if(f&&o.add(l),f!=="$eq"){if(s.length>0)return!1;s.push(f)}}var h=[],d=new Set;for(var[g,v]of Object.entries(r)){if(!e.includes(g))return!1;var p=Object.keys(v).filter(F=>jP.has(F));if(p.length>1)return!1;var m=p[0];if(m&&d.add(g),m!=="$eq"){if(h.length>0)return!1;h.push(m)}}var x=0;for(var _ of e){for(var w of[o,d]){if(!w.has(_)&&w.size>0)return!1;w.delete(_)}var D=t[x],U=n[x];if(D!==U&&o.size>0&&d.size>0)return!1;x++}return!0}function KP(e,r){switch(e){case"$eq":return{startKey:r,endKey:r,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:r,inclusiveEnd:!0};case"$gte":return{startKey:r,inclusiveStart:!0};case"$lt":return{endKey:r,inclusiveEnd:!1};case"$gt":return{startKey:r,inclusiveStart:!1};default:throw new Error("SNH")}}function qP(e,r,t){var n=0,i=u=>{u>0&&(n=n+u)},a=10,s=Ff(t.startKeys,u=>u!==qi&&u!==Mi);i(s*a);var o=Ff(t.startKeys,u=>u!==Mi&&u!==qi);i(o*a);var l=Ff(t.startKeys,(u,f)=>u===t.endKeys[f]);i(l*a*1.5);var c=t.sortSatisfiedByIndex?5:0;return i(c),n}var hn=class extends Error{},qf=2147483647,Xf=-2147483648,Wp=Number.MAX_SAFE_INTEGER,Hp=Number.MIN_SAFE_INTEGER,$s=Symbol("missing"),zw=Object.freeze(new Error("mingo: cycle detected while processing object/array")),XP="[object Object]",QP=/^\[object ([a-zA-Z0-9]+)\]$/,Qf=e=>{let r=tL(e),t=0,n=r.length;for(;n;)t=(t<<5)-t^r.charCodeAt(--n);return t>>>0},jw=new Set(["null","undefined","boolean","number","string","date","regexp"]),YP={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},Wr=(e,r)=>{e===$s&&(e=void 0),r===$s&&(r=void 0);let[t,n]=[e,r].map(i=>YP[es(i).toLowerCase()]);return t!==n?t-n:t===1||t===2||t===6?e<r?-1:e>r?1:0:Jn(e,r)?0:e<r?-1:e>r?1:0};function Ce(e,r){if(!e)throw new hn(r)}var es=e=>QP.exec(Object.prototype.toString.call(e))[1],Rc=e=>typeof e=="boolean",Nt=e=>typeof e=="string";var bt=e=>!isNaN(e)&&typeof e=="number";var tt=Array.isArray,kt=e=>{if(!e)return!1;let r=Object.getPrototypeOf(e);return(r===Object.prototype||r===null)&&XP===Object.prototype.toString.call(e)},Mc=e=>e===Object(e),$o=e=>e instanceof Date,Wo=e=>e instanceof RegExp,Yf=e=>typeof e=="function",ke=e=>e==null,Xi=(e,r)=>e.includes(r),Zf=(e,r)=>!Xi(e,r),Qi=(e,r=!0)=>!!e||r&&e==="",Zn=e=>ke(e)||Nt(e)&&!e||e instanceof Array&&e.length===0||kt(e)&&Object.keys(e).length===0,$w=e=>e===$s,va=e=>e instanceof Array?e:[e],Vn=(e,r)=>!!e&&Object.prototype.hasOwnProperty.call(e,r),zp=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),ZP=[$o,Wo,zp],Up=(e,r)=>{if(ke(e))return e;if(r.has(e))throw zw;let t=e.constructor;if(ZP.some(n=>n(e)))return new t(e);try{if(r.add(e),tt(e))return e.map(n=>Up(n,r));if(kt(e)){let n={};for(let i in e)n[i]=Up(e[i],r);return n}}finally{r.delete(e)}return e},Jf=e=>Up(e,new Set),JP=(e,r)=>kt(e)&&kt(r)||tt(e)&&tt(r);function jf(e,r,t){if(t=t||{flatten:!1},$w(e)||ke(e))return r;if($w(r)||ke(r))return e;if(!JP(e,r)){if(t.skipValidation)return r||e;throw Error("mismatched types. must both be array or object")}if(t.skipValidation=!0,tt(e)){let n=e,i=r;if(t.flatten){let a=0,s=0;for(;a<n.length&&s<i.length;)n[a]=jf(n[a++],i[s++],t);for(;s<i.length;)n.push(r[s++])}else yi(n,i)}else for(let n in r)e[n]=jf(e[n],r[n],t);return e}function Ww(e,r=Qf){let t=new Map;return e.forEach((n,i)=>{let a=e0(n,r);t.has(a)?t.get(a).some(s=>Jn(e[s],n))||t.get(a).push(i):t.set(a,[i])}),t}function Ws(e,r=Qf){if(e.some(o=>o.length==0))return[];if(e.length===1)return Array.from(e);let t=Gw(e.map((o,l)=>[l,o.length]),o=>o[1]),n=e[t[0][0]],i=Ww(n,r),a=new Map,s=new Array;return i.forEach((o,l)=>{let c=o.map(d=>n[d]),u=c.map(d=>0),f=c.map(d=>[t[0][0],0]),h=!1;for(let d=1;d<e.length;d++){let[g,v]=t[d],p=e[g];if(a.has(d)||a.set(d,Ww(p)),a.get(d).has(l)){let m=a.get(d).get(l).map(x=>p[x]);h=c.map((x,_)=>m.some((w,D)=>{let U=u[_];return Jn(x,w)&&(u[_]++,g<f[_][0]&&(f[_]=[g,a.get(d).get(l)[D]])),U<u[_]})).some(Boolean)}if(!h)return}h&&yi(s,u.map((d,g)=>d===e.length-1?[c[g],f[g]]:$s).filter(d=>d!==$s))}),s.sort((o,l)=>{let[c,[u,f]]=o,[h,[d,g]]=l,v=Wr(u,d);return v!==0?v:Wr(f,g)}).map(o=>o[0])}function jp(e,r=0){let t=new Array;function n(i,a){for(let s=0,o=i.length;s<o;s++)tt(i[s])&&(a>0||a<0)?n(i[s],Math.max(-1,a-1)):t.push(i[s])}return n(e,r),t}var eL=e=>{let[r,t]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],n=r;for(;!t.length&&r!==Object.prototype&&r!==Array.prototype;)n=r,t=Object.getOwnPropertyNames(r),r=Object.getPrototypeOf(r);let i={};return t.forEach(a=>i[a]=e[a]),[i,n]};function Jn(e,r){if(e===r||Object.is(e,r))return!0;let t=!!e&&e.constructor||e;if(e===null||r===null||e===void 0||r===void 0||t!==r.constructor||t===Function)return!1;if(t===Array||t===Object){let a=Object.keys(e),s=Object.keys(r);if(a.length!==s.length||new Set([...a,...s]).size!=a.length)return!1;for(let o of a)if(!Jn(e[o],r[o]))return!1;return!0}let n=Object.getPrototypeOf(e);return(zp(e)||n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))&&e.toString()===r.toString()}var zf=(e,r)=>{if(e===null)return"null";if(e===void 0)return"undefined";let t=e.constructor;switch(t){case RegExp:case Number:case Boolean:case Function:case Symbol:return e.toString();case String:return JSON.stringify(e);case Date:return e.toISOString()}if(zp(e))return t.name+"["+e.toString()+"]";if(r.has(e))throw zw;try{if(r.add(e),tt(e))return"["+e.map(s=>zf(s,r)).join(",")+"]";if(t===Object)return"{"+Object.keys(e).sort().map(s=>s+":"+zf(e[s],r)).join(",")+"}";let n=Object.getPrototypeOf(e);if(n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))return t.name+"("+JSON.stringify(e.toString())+")";let[i,a]=eL(e);return t.name+zf(i,r)}finally{r.delete(e)}},tL=e=>zf(e,new Set);function e0(e,r){return r=r||Qf,ke(e)?null:r(e).toString()}function Gw(e,r,t=Wr){if(Zn(e))return e;let n=new Array,i=new Array;for(let a=0;a<e.length;a++){let s=e[a],o=r(s,a);ke(o)?i.push(s):n.push([o,s])}return n.sort((a,s)=>t(a[0],s[0])),yi(i,n.map(a=>a[1]))}function t0(e,r,t=Qf){if(e.length<1)return new Map;let n=new Map,i=new Map;for(let a=0;a<e.length;a++){let s=e[a],o=r(s,a),l=e0(o,t);if(l===null)i.has(null)?i.get(null).push(s):i.set(null,[s]);else{let c=n.has(l)?n.get(l).find(u=>Jn(u,o)):null;ke(c)?(i.set(o,[s]),n.has(l)?n.get(l).push(o):n.set(l,[o])):i.get(c).push(s)}}return i}var Vp=5e4;function yi(e,...r){return e instanceof Array?r.reduce((t,n)=>{let i=Math.ceil(n.length/Vp),a=0;for(;i-- >0;)Array.prototype.push.apply(t,n.slice(a,a+Vp)),a+=Vp;return t},e):r.filter(Mc).reduce((t,n)=>(Object.assign(t,n),t),e)}function $p(e,r){return Mc(e)?e[r]:void 0}function rL(e,r){if(r<1)return e;for(;r--&&e.length===1;)e=e[0];return e}function _a(e,r,t){let n=0;function i(s,o){let l=s;for(let c=0;c<o.length;c++){let u=o[c];if(/^\d+$/.exec(u)===null&&l instanceof Array){if(c===0&&n>0)break;n+=1;let h=o.slice(c);l=l.reduce((d,g)=>{let v=i(g,h);return v!==void 0&&d.push(v),d},[]);break}else l=$p(l,u);if(l===void 0)break}return l}let a=jw.has(es(e).toLowerCase())?e:i(e,r.split("."));return a instanceof Array&&t?.unwrapArray?rL(a,n):a}function Uo(e,r,t){let n=r.split("."),i=n[0],a=n.slice(1).join("."),s=/^\d+$/.exec(i)!==null,o=n.length>1,l,c;if(e instanceof Array)if(s)l=$p(e,Number(i)),o&&(l=Uo(l,a,t)),l=[l];else{l=[];for(let u of e)c=Uo(u,r,t),t?.preserveMissing?(c===void 0&&(c=$s),l.push(c)):c!==void 0&&l.push(c)}else{if(c=$p(e,i),o&&(c=Uo(c,a,t)),c===void 0)return;l=t?.preserveKeys?ie({},e):{},l[i]=c}return l}function Gf(e){if(e instanceof Array)for(let r=e.length-1;r>=0;r--)e[r]===$s?e.splice(r,1):Gf(e[r]);else if(kt(e))for(let r in e)Vn(e,r)&&Gf(e[r])}var Hw=/^\d+$/;function Kf(e,r,t,n){let i=r.split("."),a=i[0],s=i.slice(1).join(".");if(i.length===1)(kt(e)||tt(e)&&Hw.test(a))&&t(e,a);else{n?.buildGraph&&ke(e[a])&&(e[a]={});let o=e[a];if(!o)return;let l=!!(i.length>1&&Hw.test(i[1]));o instanceof Array&&n?.descendArray&&!l?o.forEach(c=>Kf(c,s,t,n)):Kf(o,s,t,n)}}function r0(e,r,t){Kf(e,r,(n,i)=>{n[i]=Yf(t)?t(n[i]):t},{buildGraph:!0})}function Nc(e,r,t){Kf(e,r,(n,i)=>{if(n instanceof Array){if(/^\d+$/.test(i))n.splice(parseInt(i),1);else if(t&&t.descendArray)for(let a of n)kt(a)&&delete a[i]}else kt(n)&&delete n[i]},t)}var nL=/^\$[a-zA-Z0-9_]+$/;function Ni(e){return nL.test(e)}function n0(e){if(jw.has(es(e).toLowerCase()))return Wo(e)?{$regex:e}:{$eq:e};if(Mc(e)){if(!Object.keys(e).some(Ni))return{$eq:e};if(Vn(e,"$regex")){let t=ie({},e);return t.$regex=new RegExp(e.$regex,e.$options),delete t.$options,t}}return e}var zs=(e=>(e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF",e))(zs||{}),vr=class e{constructor(r,t,n,i=Date.now()){this._opts=r,this._root=t,this._local=n,this.timestamp=i,this.update(t,n)}static init(r,t,n){return r instanceof e?new e(r._opts,ke(r.root)?t:r.root,Object.assign({},r.local,n)):new e(r,t,n)}update(r,t){return this._root=r,this._local=t&&Object.assign({},t,{variables:Object.assign({},this._local?.variables,t?.variables)}),this}getOptions(){return Object.freeze(ze(ie({},this._opts),{context:Ho.from(this._opts.context)}))}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){return this._opts?.collation}get processingMode(){return this._opts?.processingMode||"CLONE_OFF"}get useStrictMode(){return this._opts?.useStrictMode}get scriptEnabled(){return this._opts?.scriptEnabled}get useGlobalContext(){return this._opts?.useGlobalContext}get hashFunction(){return this._opts?.hashFunction}get collectionResolver(){return this._opts?.collectionResolver}get jsonSchemaValidator(){return this._opts?.jsonSchemaValidator}get variables(){return this._opts?.variables}get context(){return this._opts?.context}};function zo(e){return e instanceof vr?e.getOptions():Object.freeze(ze(ie({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:"CLONE_OFF"},e),{context:e?.context?Ho.from(e?.context):Ho.init({})}))}var Li=(e=>(e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window",e))(Li||{}),Ho=class e{constructor(r){this.operators={accumulator:{},expression:{},pipeline:{},projection:{},query:{},window:{}};for(let[t,n]of Object.entries(r))this.addOperators(t,n)}static init(r={}){return new e(r)}static from(r){return new e(r.operators)}addOperators(r,t){for(let[n,i]of Object.entries(t))this.getOperator(r,n)||(this.operators[r][n]=i);return this}addAccumulatorOps(r){return this.addOperators("accumulator",r)}addExpressionOps(r){return this.addOperators("expression",r)}addQueryOps(r){return this.addOperators("query",r)}addPipelineOps(r){return this.addOperators("pipeline",r)}addProjectionOps(r){return this.addOperators("projection",r)}addWindowOps(r){return this.addOperators("window",r)}getOperator(r,t){return r in this.operators&&this.operators[r][t]||null}},Hs=Ho.init();function qp(e,r){for(let[t,n]of Object.entries(r)){Ce(Yf(n)&&Ni(t),`'${t}' is not a valid operator`);let i=Pi(e,t,null);Ce(!i||n===i,`${t} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":Hs.addAccumulatorOps(r);break;case"expression":Hs.addExpressionOps(r);break;case"pipeline":Hs.addPipelineOps(r);break;case"projection":Hs.addProjectionOps(r);break;case"query":Hs.addQueryOps(r);break;case"window":Hs.addWindowOps(r);break}}function Pi(e,r,t){let{context:n,useGlobalContext:i}=t||{},a=n?n.getOperator(e,r):null;return!a&&i?Hs.getOperator(e,r):a}var Kw={$$ROOT(e,r,t){return t.root},$$CURRENT(e,r,t){return e},$$REMOVE(e,r,t){},$$NOW(e,r,t){return new Date(t.timestamp)}},Gp={$$KEEP(e,r,t){return e},$$PRUNE(e,r,t){},$$DESCEND(e,r,t){if(!Vn(r,"$cond"))return e;let n;for(let[i,a]of Object.entries(e))if(Mc(a)){if(a instanceof Array){let s=[];for(let o of a)kt(o)&&(o=Kp(o,r,t.update(o))),ke(o)||s.push(o);n=s}else n=Kp(a,r,t.update(a));ke(n)?delete e[i]:e[i]=n}return e}};function ne(e,r,t,n){let i=vr.init(n,e);if(t=t||"",Ni(t)){let a=Pi("expression",t,n);if(a)return a(e,r,i);let s=Pi("accumulator",t,n);if(s)return e instanceof Array||(e=ne(e,r,null,i),r=null),Ce(e instanceof Array,`'${t}' target must be an array.`),s(e,r,i.update(null,i.local));throw new hn(`operator '${t}' is not registered`)}if(Nt(r)&&r.length>0&&r[0]==="$"){if(Vn(Gp,r))return r;let a=i.root,s=r.split(".");if(Vn(Kw,s[0]))a=Kw[s[0]](e,null,i),r=r.slice(s[0].length+1);else if(s[0].slice(0,2)==="$$"){a=Object.assign({},i.variables,{this:e},i.local?.variables);let o=s[0].slice(2);Ce(Vn(a,o),`Use of undefined variable: ${o}`),r=r.slice(2)}else r=r.slice(1);return r===""?a:_a(a,r)}if(tt(r))return r.map(a=>ne(e,a,null,i));if(kt(r)){let a={};for(let[s,o]of Object.entries(r))if(a[s]=ne(e,o,s,i),["expression","accumulator"].some(l=>!!Pi(l,s,n)))return Ce(Object.keys(r).length===1,"Invalid aggregation expression '"+JSON.stringify(r)+"'"),a[s];return a}return r}function Kp(e,r,t){let n=ne(e,r,null,t);return Vn(Gp,n)?Gp[n](e,r,t):n}function ei(e){return e instanceof Pc?e:new Pc(e)}function i0(...e){let r=0;return ei(()=>{for(;r<e.length;){let t=e[r].next();if(!t.done)return t;r++}return{done:!0}})}function iL(e){return!!e&&typeof e=="object"&&e?.next instanceof Function}function aL(e,r){let t=e.slice(r+1);e.splice(r),Array.prototype.push.apply(e,t)}var Xp=new Error;function sL(e,r,t){let n=!1,i=-1,a=0;return function(s){try{e:for(;!n;){let o=e();i++;let l=-1,c=r.length,u=!1;for(;++l<c;){let f=r[l];switch(f.action){case 0:o=f.func(o,i);break;case 1:if(!f.func(o,i))continue e;break;case 2:--f.count,f.count||(u=!0);break;case 3:--f.count,f.count||aL(r,l);continue e;default:break e}}if(n=u,s)t[a++]=o;else return{value:o,done:!1}}}catch(o){if(o!==Xp)throw o}return n=!0,{done:n}}}var Pc=class{constructor(r){this.iteratees=[],this.yieldedValues=[],this.isDone=!1;let t;if(r instanceof Function&&(r={next:r}),iL(r)){let n=r;t=()=>{let i=n.next();if(i.done)throw Xp;return i.value}}else if(r instanceof Array){let n=r,i=n.length,a=0;t=()=>{if(a<i)return n[a++];throw Xp}}else if(!(r instanceof Function))throw new hn("Lazy must be initialized with an array, generator, or function.");this.getNext=sL(t,this.iteratees,this.yieldedValues)}push(r,t){return typeof t=="function"?this.iteratees.push({action:r,func:t}):typeof t=="number"&&this.iteratees.push({action:r,count:t}),this}next(){return this.getNext()}map(r){return this.push(0,r)}filter(r){return this.push(1,r)}take(r){return r>0?this.push(2,r):this}drop(r){return r>0?this.push(3,r):this}transform(r){let t=this,n;return ei(()=>(n||(n=ei(r(t.value()))),n.next()))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(r){for(;;){let t=this.next();if(t.done)break;if(r(t.value)===!1)return!1}return!0}reduce(r,t){let n=this.next();for(t===void 0&&!n.done&&(t=n.value,n=this.next());!n.done;)t=r(t,n.value),n=this.next();return t}size(){return this.reduce((r,t)=>++r,0)}[Symbol.iterator](){return this}};var Yi=class{constructor(r,t){this.pipeline=r,this.options=zo(t)}stream(r){let t=ei(r),n=this.options.processingMode;(n==zs.CLONE_ALL||n==zs.CLONE_INPUT)&&t.map(Jf);let i=new Array;if(!Zn(this.pipeline))for(let a of this.pipeline){let s=Object.keys(a),o=s[0],l=Pi(Li.PIPELINE,o,this.options);Ce(s.length===1&&!!l,`invalid pipeline operator ${o}`),i.push(o),t=l(t,a[o],this.options)}return(n==zs.CLONE_OUTPUT||n==zs.CLONE_ALL&&Ws([["$group","$unwind"],i]).length)&&t.map(Jf),t}run(r){return this.stream(r).value()}};var a0=class{constructor(r,t,n,i){this.source=r,this.predicate=t,this.projection=n,this.options=i,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result?this.result:(kt(this.projection)&&this.operators.push({$project:this.projection}),this.result=ei(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new Yi(this.operators,this.options).stream(this.result)),this.result)}fetchAll(){let r=ei([...this.buffer]);return this.buffer=[],i0(r,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(r){return this.operators.push({$skip:r}),this}limit(r){return this.operators.push({$limit:r}),this}sort(r){return this.operators.push({$sort:r}),this}collation(r){return this.options=ze(ie({},this.options),{collation:r}),this}next(){if(this.buffer.length>0)return this.buffer.pop();let r=this.fetch().next();if(!r.done)return r.value}hasNext(){if(this.buffer.length>0)return!0;let r=this.fetch().next();return r.done?!1:(this.buffer.push(r.value),!0)}map(r){return this.all().map(r)}forEach(r){this.all().forEach(r)}[Symbol.iterator](){return this.fetchAll()}};var ti=class{constructor(r,t){this.condition=r,this.options=zo(t),this.compiled=[],this.compile()}compile(){Ce(kt(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);let r={};for(let[t,n]of Object.entries(this.condition)){if(t==="$where")Object.assign(r,{field:t,expr:n});else if(Xi(["$and","$or","$nor","$expr","$jsonSchema"],t))this.processOperator(t,t,n);else{Ce(!Ni(t),`unknown top level operator: ${t}`);for(let[i,a]of Object.entries(n0(n)))this.processOperator(t,i,a)}r.field&&this.processOperator(r.field,r.field,r.expr)}}processOperator(r,t,n){let i=Pi(Li.QUERY,t,this.options);if(!i)throw new hn(`unknown query operator ${t}`);let a=i(r,n,this.options);this.compiled.push(a)}test(r){for(let t=0,n=this.compiled.length;t<n;t++)if(!this.compiled[t](r))return!1;return!0}find(r,t){return new a0(r,n=>this.test(n),t||{},this.options)}remove(r){return r.reduce((t,n)=>(this.test(n)||t.push(n),t),[])}};var jo=1e3*60*60*24,Xw={week:jo*7,day:jo,hour:1e3*60*60,minute:1e3*60,second:1e3,millisecond:1};var Yq={week:jo*7,day:jo,hour:jo/24,minute:6e4,second:1e3,millisecond:1};var o0=(e,r,t)=>{if(Zn(r)||!kt(r))return e;let n=Wr,i=t.collation;return kt(i)&&Nt(i.locale)&&(n=gL(i)),e.transform(a=>{let s=Object.keys(r);for(let o of s.reverse()){let l=t0(a,u=>_a(u,o),t.hashFunction),c=Array.from(l.keys()).sort(n);r[o]===-1&&c.reverse(),a=[],c.reduce((u,f)=>yi(u,l.get(f)),a)}return a})},mL={1:"base",2:"accent",3:"variant"};function gL(e){let r={sensitivity:mL[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(r.sensitivity==="base"&&(r.sensitivity="case"),r.sensitivity==="accent"&&(r.sensitivity="variant"));let t=new Intl.Collator(e.locale,r);return(n,i)=>{if(!Nt(n)||!Nt(i))return Wr(n,i);let a=t.compare(n,i);return a<0?-1:a>0?1:0}}function zt(e){let r=(t,n,i)=>{let a={unwrapArray:!0},s=Math.max(1,t.split(".").length-1);return o=>{let l=_a(o,t,a);return e(l,n,ze(ie({},i),{depth:s}))}};return r.op="query",r}function Un(e){return(r,t,n)=>{let i=ne(r,t,null,n);return e(...i)}}function Lc(e,r,t){if(Jn(e,r)||ke(e)&&ke(r))return!0;if(e instanceof Array){let n=Jn.bind(null,r);return e.some(n)||jp(e,t?.depth).some(n)}return!1}function l0(e,r,t){return!Lc(e,r,t)}function Yp(e,r,t){return ke(e)?r.some(n=>n===null):Ws([va(e),r],t?.hashFunction).length>0}function c0(e,r,t){return!Yp(e,r,t)}function u0(e,r,t){return p0(e,r,(n,i)=>Wr(n,i)<0)}function f0(e,r,t){return p0(e,r,(n,i)=>Wr(n,i)<=0)}function h0(e,r,t){return p0(e,r,(n,i)=>Wr(n,i)>0)}function d0(e,r,t){return p0(e,r,(n,i)=>Wr(n,i)>=0)}function t2(e,r,t){return va(e).some(n=>r.length===2&&n%r[0]===r[1])}function r2(e,r,t){let n=va(e),i=a=>Nt(a)&&Qi(r.exec(a),t?.useStrictMode);return n.some(i)||jp(n,1).some(i)}function n2(e,r,t){return(r===!1||r===0)&&e===void 0||(r===!0||r===1)&&e!==void 0}function i2(e,r,t){if(!tt(e)||!tt(r)||!e.length||!r.length)return!1;let n=!0;for(let i of r){if(!n)break;kt(i)&&Xi(Object.keys(i),"$elemMatch")?n=Zp(e,i.$elemMatch,t):i instanceof RegExp?n=e.some(a=>typeof a=="string"&&i.test(a)):n=e.some(a=>Jn(i,a))}return n}function a2(e,r,t){return Array.isArray(e)&&e.length===r}function yL(e){return Ni(e)&&["$and","$or","$nor"].indexOf(e)===-1}function Zp(e,r,t){if(tt(e)&&!Zn(e)){let n=s=>s,i=r;Object.keys(r).every(yL)&&(i={temp:r},n=s=>({temp:s}));let a=new ti(i,t);for(let s=0,o=e.length;s<o;s++)if(a.test(n(e[s])))return!0}return!1}var Yw=e=>e===null,Zw=e=>bt(e)&&e>=Xf&&e<=qf&&e.toString().indexOf(".")===-1,Jw=e=>bt(e)&&e>=Hp&&e<=Wp&&e.toString().indexOf(".")===-1,wL={array:tt,bool:Rc,boolean:Rc,date:$o,decimal:bt,double:bt,int:Zw,long:Jw,number:bt,null:Yw,object:kt,regex:Wo,regexp:Wo,string:Nt,undefined:ke,function:e=>{throw new hn("unsupported type key `function`.")},1:bt,2:Nt,3:kt,4:tt,6:ke,8:Rc,9:$o,10:Yw,11:Wo,16:Zw,18:Jw,19:bt};function e2(e,r,t){let n=wL[r];return n?n(e):!1}function s2(e,r,t){return Array.isArray(r)?r.findIndex(n=>e2(e,n,t))>=0:e2(e,r,t)}function p0(e,r,t){return va(e).some(n=>es(n)===es(r)&&t(n,r))}var lZ=Un(c0);var Go=(e,r)=>(t,n,i)=>{Ce(tt(n),`${e}: expression must be an array.`);let a=ne(t,n,null,i);return a.some(ke)?null:(Ce(a.every(bt),`${e}: expression must evalue to array of numbers.`),r(a))};var iJ=Go("$bitAnd",e=>e.reduce((r,t)=>r&t,-1));var uJ=Go("$bitOr",e=>e.reduce((r,t)=>r|t,0));var dJ=Go("$bitXor",e=>e.reduce((r,t)=>r^t,0));var PJ=Un(Lc);var VJ=Un(h0);var WJ=Un(d0);var jJ=Un(u0);var qJ=Un(f0);var YJ=Un(l0);var o2=(e,r)=>{let t={};return e.split("").forEach((n,i)=>t[n]=r*(i+1)),t},Dee=ze(ie(ie({},o2("ABCDEFGHIKLM",1)),o2("NOPQRSTUVWXY",-1)),{Z:0});var f2={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function nr(e,r=f2){let t=Object.assign({},f2,r),n=new Set(Object.keys(t));return(i,a,s)=>{let o=ne(i,a,null,s);if(n.has(`${o}`)){let l=t[`${o}`];if(l instanceof Error)throw new hn(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return l}return e(o)}}var Uie=nr(Math.acos,{Infinity:1/0,0:new Error});var Hie=nr(Math.acosh,{Infinity:1/0,0:new Error});var Gie=nr(Math.asin);var Xie=nr(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});var Zie=nr(Math.atan);var iae=nr(Math.atanh,{1:1/0,"-1":-1/0});var oae=nr(Math.cos);var uae=nr(Math.cosh,{"-Infinity":1/0,Infinity:1/0});var SL=Math.PI/180,dae=nr(e=>e*SL,{Infinity:1/0,"-Infinity":1/0});var TL=180/Math.PI,gae=nr(e=>e*TL,{Infinity:1/0,"-Infinity":-1/0});var xae=nr(Math.sin);var bae=nr(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});var Sae=nr(Math.tan);var em=(e,r,t)=>{if(Zn(r))return e;let n=Object.keys(r),i=!1;d2(r,t);let a=t.idKey;if(Xi(n,a)){let o=r[a];(o===0||o===!1)&&(n=n.filter(Zf.bind(null,[a])),i=n.length==0)}else n.push(a);let s=vr.init(t);return e.map(o=>Jp(o,r,s.update(o),n,i))};function Jp(e,r,t,n,i){let a={},s=!1,o=!1,l=[];i&&l.push(t.idKey);for(let c of n){let u,f=r[c];if(c!==t.idKey&&Xi([0,!1],f)&&(o=!0),c===t.idKey&&Zn(f))u=e[c];else if(Nt(f))u=ne(e,f,c,t);else if(!Xi([1,!0],f))if(f instanceof Array)u=f.map(d=>{let g=ne(e,d,null,t);return ke(g)?null:g});else if(kt(f)){let d=f,g=Object.keys(f),v=g.length==1?g[0]:"",p=Pi(Li.PROJECTION,v,t);if(p)v==="$slice"?va(d[v]).every(bt)?(u=p(e,d[v],c,t),s=!0):u=ne(e,d,c,t):u=p(e,d[v],c,t);else if(Ni(v))u=ne(e,d[v],v,t);else if(Vn(e,c)){d2(d,t);let m=e[c];m instanceof Array?u=m.map(x=>Jp(x,d,t,g,!1)):(m=kt(m)?m:e,u=Jp(m,d,t,g,!1))}else u=ne(e,f,null,t)}else{l.push(c);continue}let h=Uo(e,c,{preserveMissing:!0});h!==void 0&&jf(a,h,{flatten:!0}),Zf([0,1,!1,!0],f)&&(u===void 0?Nc(a,c,{descendArray:!0}):r0(a,c,u))}if(Gf(a),(s||o||i)&&(a=yi({},e,a),l.length>0))for(let c of l)Nc(a,c,{descendArray:!0});return a}function d2(e,r){let t=[!1,!1];for(let[n,i]of Object.entries(e)){if(n===r?.idKey)return;i===0||i===!1?t[0]=!0:(i===1||i===!0)&&(t[1]=!0),Ce(!(t[0]&&t[1]),"Projection cannot have a mix of inclusion and exclusion.")}}var p2=(e,r,t)=>{Ce(tt(r),"Invalid expression: $and expects value to be an Array.");let n=r.map(i=>new ti(i,t));return i=>n.every(a=>a.test(i))};var m0=(e,r,t)=>{Ce(tt(r),"Invalid expression. $or expects value to be an Array");let n=r.map(i=>new ti(i,t));return i=>n.some(a=>a.test(i))};var m2=(e,r,t)=>{Ce(tt(r),"Invalid expression. $nor expects value to be an array.");let n=m0("$or",r,t);return i=>!n(i)};var g2=(e,r,t)=>{let n={};n[e]=n0(r);let i=new ti(n,t);return a=>!i.test(a)};var tm=zt(Lc);var rm=zt(h0);var nm=zt(d0);var im=zt(Yp);var am=zt(u0);var sm=zt(f0);var om=zt(l0);var lm=zt(c0);var v2=zt(t2);var _2=zt(r2);var Ace=zt(i2);var x2=zt(Zp);var y2=zt(a2);var w2=zt(n2);var b2=zt(s2);var C2=!1;function E2(e){return C2||(qp(Li.PIPELINE,{$sort:o0,$project:em}),qp(Li.QUERY,{$and:p2,$eq:tm,$elemMatch:x2,$exists:w2,$gt:rm,$gte:nm,$in:im,$lt:am,$lte:sm,$ne:om,$nin:lm,$mod:v2,$nor:m2,$not:g2,$or:m0,$regex:_2,$size:y2,$type:b2}),C2=!0),new ti(e)}function xa(e,r){var t=Kr(e.primaryKey);r=It(r);var n=cr(r);if(typeof n.skip!="number"&&(n.skip=0),n.selector?(n.selector=n.selector,Object.entries(n.selector).forEach(([c,u])=>{(typeof u!="object"||u===null)&&(n.selector[c]={$eq:u})})):n.selector={},n.index){var i=Of(n.index);i.includes(t)||i.push(t),n.index=i}if(n.sort){var l=n.sort.find(c=>Dy(c)===t);l||(n.sort=n.sort.slice(0),n.sort.push({[t]:"asc"}))}else if(n.index)n.sort=n.index.map(c=>({[c]:"asc"}));else{if(e.indexes){var a=new Set;Object.entries(n.selector).forEach(([c,u])=>{var f=!1;typeof u=="object"&&u!==null?f=!!Object.keys(u).find(h=>Hf.has(h)):f=!0,f&&a.add(c)});var s=-1,o;e.indexes.forEach(c=>{var u=Lo(c)?c:[c],f=u.findIndex(h=>!a.has(h));f>0&&f>s&&(s=f,o=u)}),o&&(n.sort=o.map(c=>({[c]:"asc"})))}n.sort||(n.sort=[{[t]:"asc"}])}return n}function g0(e,r){if(!r.sort)throw Te("SNH",{query:r});var t=[];r.sort.forEach(i=>{var a=Object.keys(i)[0],s=Object.values(i)[0];t.push({key:a,direction:s,getValueFn:Df(a)})});var n=(i,a)=>{for(var s=0;s<t.length;++s){var o=t[s],l=o.getValueFn(i),c=o.getValueFn(a);if(l!==c){var u=o.direction==="asc"?Wr(l,c):Wr(c,l);return u}}};return n}function Ko(e,r){if(!r.sort)throw Te("SNH",{query:r});var t=E2(r.selector),n=i=>t.test(i);return n}function qo(e,r){return Z(this,null,function*(){var t=yield e.exec();if(!t)return null;if(Array.isArray(t))return Promise.all(t.map(i=>r(i)));var n=yield r(t);return n})}function AL(e,r){return!r.sort||r.sort.length===0?[e]:r.sort.map(t=>Object.keys(t)[0])}var OL=new WeakMap;function FL(e){return Rn(OL,e,()=>{var r=e.collection,t=xa(r.storageInstance.schema,cr(e.mangoQuery)),n=r.schema.primaryPath,i=g0(r.schema.jsonSchema,t),a=(c,u)=>{var f={docA:c,docB:u,rxQuery:e};return i(f.docA,f.docB)},s=Ko(r.schema.jsonSchema,t),o=c=>{var u={doc:c,rxQuery:e};return s(u.doc)},l={primaryKey:e.collection.schema.primaryPath,skip:t.skip,limit:t.limit,sortFields:AL(n,t),sortComparator:a,queryMatcher:o};return l})}function S2(e,r){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var t=FL(e),n=He(e._result).docsData.slice(0),i=He(e._result).docsDataMap,a=!1,s=r.map(l=>nw(l)).filter(Fy),o=s.find(l=>{var c={queryParams:t,changeEvent:l,previousResults:n,keyDocumentMap:i},u=Bw(c);if(u==="runFullQueryAgain")return!0;if(u!=="doNothing")return a=!0,Vw(u,t,l,n,i),!1});return o?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:a,newResults:n}}var DL=function(){function e(){this._map=new Map}var r=e.prototype;return r.getByQuery=function(n){var i=n.toString();return Rn(this._map,i,()=>n)},e}();function I2(){return new DL}function T2(e,r){r.uncached=!0;var t=r.toString();e._map.delete(t)}function RL(e){return e.refCount$.observers.length}var ML=100,NL=30*1e3,PL=(e,r)=>(t,n)=>{if(!(n._map.size<e)){var i=Yt()-r,a=[],s=Array.from(n._map.values());for(var o of s)if(!(RL(o)>0)){if(o._lastEnsureEqual===0&&o._creationTime<i){T2(n,o);continue}a.push(o)}var l=a.length-e;if(!(l<=0)){var c=a.sort((f,h)=>f._lastEnsureEqual-h._lastEnsureEqual),u=c.slice(0,l);u.forEach(f=>T2(n,f))}}},um=PL(ML,NL),cm=new WeakSet;function k2(e){cm.has(e)||(cm.add(e),By().then(()=>$y(200)).then(()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),cm.delete(e)}))}var v0=function(){function e(t,n,i){this.cacheItemByDocId=new Map,this.tasks=new Set,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(a=>{var s=a.docId,o=this.cacheItemByDocId.get(s);o&&(o[0].delete(a.revisionHeight),o[0].size===0&&this.cacheItemByDocId.delete(s))}):void 0,this.primaryPath=t,this.changes$=n,this.documentCreator=i,n.subscribe(a=>{this.tasks.add(()=>{for(var s=this.cacheItemByDocId,o=0;o<a.length;o++){var l=a[o],c=s.get(l.documentId);if(c){var u=l.documentData;u||(u=l.previousDocumentData),c[1]=u}}}),this.tasks.size<=1&&Qa().then(()=>{this.processTasks()})})}var r=e.prototype;return r.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},r.getLatestDocumentData=function(n){this.processTasks();var i=Di(this.cacheItemByDocId,n);return i[1]},r.getLatestDocumentDataIfExists=function(n){this.processTasks();var i=this.cacheItemByDocId.get(n);if(i)return i[1]},Dn(e,[{key:"getCachedRxDocuments",get:function(){var t=A2(this);return Yn(this,"getCachedRxDocuments",t)}},{key:"getCachedRxDocument",get:function(){var t=A2(this);return Yn(this,"getCachedRxDocument",n=>t([n])[0])}}])}();function A2(e){var r=e.primaryPath,t=e.cacheItemByDocId,n=e.registry,i=ft.deepFreezeWhenDevMode,a=e.documentCreator,s=o=>{for(var l=new Array(o.length),c=[],u=0;u<o.length;u++){var f=o[u],h=f[r],d=_i(f._rev),g=void 0,v=void 0,p=t.get(h);p?(g=p[0],v=g.get(d)):(g=new Map,p=[g,f],t.set(h,p));var m=v?v.deref():void 0;m||(f=i(f),m=a(f),g.set(d,BL(m)),n&&c.push(m)),l[u]=m}return c.length>0&&n&&(e.tasks.add(()=>{for(var x=0;x<c.length;x++){var _=c[x];n.register(_,{docId:_.primary,revisionHeight:_i(_.revision)})}}),e.tasks.size<=1&&Qa().then(()=>{e.processTasks()})),l};return s}function _0(e,r){var t=e.getCachedRxDocuments;return t(r)}var LL=typeof WeakRef=="function",BL=LL?VL:UL;function VL(e){return new WeakRef(e)}function UL(e){return{deref(){return e}}}var fm=function(){function e(t,n,i){this.time=Yt(),this.query=t,this.count=i,this.documents=_0(this.query.collection._docCache,n)}var r=e.prototype;return r.getValue=function(n){var i=this.query.op;if(i==="count")return this.count;if(i==="findOne"){var a=this.documents.length===0?null:this.documents[0];if(!a&&n)throw Te("QU10",{collection:this.query.collection.name,query:this.query.mangoQuery,op:i});return a}else return i==="findByIds"?this.docsMap:this.documents.slice(0)},Dn(e,[{key:"docsData",get:function(){return Yn(this,"docsData",this.documents.map(t=>t._data))}},{key:"docsDataMap",get:function(){var t=new Map;return this.documents.forEach(n=>{t.set(n.primary,n._data)}),Yn(this,"docsDataMap",t)}},{key:"docsMap",get:function(){for(var t=new Map,n=this.documents,i=0;i<n.length;i++){var a=n[i];t.set(a.primary,a)}return Yn(this,"docsMap",t)}}])}();var $L=0,WL=function(){return++$L},hm=function(){function e(t,n,i,a={}){this.id=WL(),this._execOverDatabaseCount=0,this._creationTime=Yt(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new _r(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=un,this.op=t,this.mangoQuery=n,this.collection=i,this.other=a,n||(this.mangoQuery=Bc()),this.isFindOneByIdQuery=GL(this.collection.schema.primaryPath,n)}var r=e.prototype;return r._setResultData=function(n){if(typeof n=="number"){this._result=new fm(this,[],n);return}else n instanceof Map&&(n=Array.from(n.values()));var i=new fm(this,n,n.length);this._result=i},r._execOverDatabase=function(){return Z(this,null,function*(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=Yt(),this.op==="count"){var n=this.getPreparedQuery(),i=yield this.collection.storageInstance.count(n);if(i.mode==="slow"&&!this.collection.database.allowSlowCount)throw Te("QU14",{collection:this.collection,queryObj:this.mangoQuery});return i.count}if(this.op==="findByIds"){var a=He(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,s=new Map,o=[];if(a.forEach(u=>{var f=this.collection._docCache.getLatestDocumentDataIfExists(u);if(f){if(!f._deleted){var h=this.collection._docCache.getCachedRxDocument(f);s.set(u,h)}}else o.push(u)}),o.length>0){var l=yield this.collection.storageInstance.findDocumentsById(o,!1);l.forEach(u=>{var f=this.collection._docCache.getCachedRxDocument(u);s.set(f.primary,f)})}return s}var c=jL(this);return c.then(u=>(this._lastExecEnd=Yt(),u))})},r.exec=function(n){return Z(this,null,function*(){if(n&&this.op!=="findOne")throw Te("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});yield O2(this);var i=He(this._result);return i.getValue(n)})},r.toString=function(){var n=Bo({op:this.op,query:this.mangoQuery,other:this.other},!0),i=JSON.stringify(n);return this.toString=()=>i,i},r.getPreparedQuery=function(){var n={rxQuery:this,mangoQuery:xa(this.collection.schema.jsonSchema,this.mangoQuery)};n.mangoQuery.selector._deleted={$eq:!1},n.mangoQuery.index&&n.mangoQuery.index.unshift("_deleted"),$r("prePrepareQuery",n);var i=js(this.collection.schema.jsonSchema,n.mangoQuery);return this.getPreparedQuery=()=>i,i},r.doesDocumentDataMatch=function(n){return n._deleted?!1:this.queryMatcher(n)},r.remove=function(){return this.exec().then(n=>Array.isArray(n)?Promise.all(n.map(i=>i.remove())):n.remove())},r.incrementalRemove=function(){return qo(this.asRxQuery,n=>n.incrementalRemove())},r.update=function(n){throw Bt("update")},r.patch=function(n){return qo(this.asRxQuery,i=>i.patch(n))},r.incrementalPatch=function(n){return qo(this.asRxQuery,i=>i.incrementalPatch(n))},r.modify=function(n){return qo(this.asRxQuery,i=>i.modify(n))},r.incrementalModify=function(n){return qo(this.asRxQuery,i=>i.incrementalModify(n))},r.where=function(n){throw Bt("query-builder")},r.sort=function(n){throw Bt("query-builder")},r.skip=function(n){throw Bt("query-builder")},r.limit=function(n){throw Bt("query-builder")},Dn(e,[{key:"$",get:function(){if(!this._$){var t=this.collection.$.pipe(Qe(n=>!n.isLocal),ai(null),ir(()=>O2(this)),Ue(()=>this._result),Vi(Ki),Oa((n,i)=>!!(n&&n.time===He(i).time)),Qe(n=>!!n),Ue(n=>He(n).getValue()));this._$=Qs(t,this.refCount$.pipe(Qe(()=>!1)))}return this._$}},{key:"$$",get:function(){var t=this.collection.database.getReactivityFactory();return t.fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var t=this.collection.schema.jsonSchema,n=xa(this.collection.schema.jsonSchema,this.mangoQuery);return Yn(this,"queryMatcher",Ko(t,n))}},{key:"asRxQuery",get:function(){return this}}])}();function Bc(){return{selector:{}}}function HL(e){return e.collection._queryCache.getByQuery(e)}function ts(e,r,t,n){$r("preCreateRxQuery",{op:e,queryObj:r,collection:t,other:n});var i=new hm(e,r,t,n);return i=HL(i),k2(t),i}function F2(e){var r=e.asRxQuery.collection._changeEventBuffer.getCounter();return e._latestChangeEvent>=r}function O2(e){return Z(this,null,function*(){return e.collection.awaitBeforeReads.size>0&&(yield Promise.all(Array.from(e.collection.awaitBeforeReads).map(r=>r()))),e.collection.database.destroyed||F2(e)?!1:(e._ensureEqualQueue=e._ensureEqualQueue.then(()=>zL(e)),e._ensureEqualQueue)})}function zL(e){if(e._lastEnsureEqual=Yt(),e.collection.database.destroyed||F2(e))return un;var r=!1,t=!1;if(e._latestChangeEvent===-1&&(t=!0),!t){var n=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(n===null)t=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.getCounter();var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(n);if(e.op==="count"){var a=He(e._result).count,s=a;i.forEach(l=>{var c=l.previousDocumentData&&e.doesDocumentDataMatch(l.previousDocumentData),u=e.doesDocumentDataMatch(l.documentData);!c&&u&&s++,c&&!u&&s--}),s!==a&&(r=!0,e._setResultData(s))}else{var o=S2(e,i);o.runFullQueryAgain?t=!0:o.changed&&(r=!0,e._setResultData(o.newResults))}}}return t?e._execOverDatabase().then(l=>(e._latestChangeEvent=e.collection._changeEventBuffer.getCounter(),typeof l=="number"?((!e._result||l!==e._result.count)&&(r=!0,e._setResultData(l)),r):((!e._result||!My(e.collection.schema.primaryPath,l,e._result.docsData))&&(r=!0,e._setResultData(l)),r))):Promise.resolve(r)}function js(e,r){if(!r.sort)throw Te("SNH",{query:r});var t=Uw(e,r);return{query:r,queryPlan:t}}function jL(e){return Z(this,null,function*(){var r=[],t=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var n=e.isFindOneByIdQuery;if(n=n.filter(u=>{var f=e.collection._docCache.getLatestDocumentDataIfExists(u);return f?(f._deleted||r.push(f),!1):!0}),n.length>0){var i=yield t.storageInstance.findDocumentsById(n,!1);Qn(r,i)}}else{var a=e.isFindOneByIdQuery,s=e.collection._docCache.getLatestDocumentDataIfExists(a);if(!s){var o=yield t.storageInstance.findDocumentsById([a],!1);o[0]&&(s=o[0])}s&&!s._deleted&&r.push(s)}else{var l=e.getPreparedQuery(),c=yield t.storageInstance.query(l);r=c.documents}return r})}function GL(e,r){if(!r.skip&&r.selector&&Object.keys(r.selector).length===1&&r.selector[e]){var t=r.selector[e];if(typeof t=="string")return t;if(Object.keys(t).length===1&&typeof t.$eq=="string"||Object.keys(t).length===1&&Array.isArray(t.$eq)&&!t.$eq.find(n=>typeof n!="string"))return t.$eq}return!1}var D2="_rxdb_internal";function ya(e,r){return Z(this,null,function*(){var t=yield e.findDocumentsById([r],!1),n=t[0];if(n)return n})}function wa(e,r,t){return Z(this,null,function*(){var n=yield e.bulkWrite([r],t);if(n.error.length>0){var i=n.error[0];throw i}else{var a=Kr(e.schema.primaryKey),s=Fr(a,[r],n),o=s[0];return o}})}function R2(e,r){var t=ya(e,r),n=e.changeStream().pipe(Ue(i=>i.events.find(a=>a.documentId===r)),Qe(i=>!!i),Ue(i=>Promise.resolve(He(i).documentData)),ai(t),mn(i=>i),Qe(i=>!!i));return n}function rs(e){return Object.assign({},...e)}function Xo(e,r,t,n){if(n)throw n.status===409?Te("CONFLICT",{collection:e.name,id:r,writeError:n,data:t}):n.status===422?Te("VD2",{collection:e.name,id:r,writeError:n,data:t}):n}function M2(e,r,t,n,i,a,s){for(var o=!!e.schema.attachments,l=[],c=[],u=[],f=Fi(10),h={id:f,events:[],checkpoint:null,context:i,startTime:Yt(),endTime:0},d=h.events,g=[],v=[],p=[],m=t.size>0,x,_=n.length,w=function(){var U=n[D],F=U.document,R=U.previous,M=F[r],W=F._deleted,B=R&&R._deleted,V=void 0;m&&(V=t.get(M));var G;if(V){var De=V._rev;if(!R||R&&De!==R._rev){var re={isError:!0,status:409,documentId:M,writeRow:U,documentInDb:V};return u.push(re),1}var ge=o?dm(U):U;o&&(W?R&&Object.keys(R._attachments).forEach(Ie=>{v.push({documentId:M,attachmentId:Ie,digest:He(R)._attachments[Ie].digest})}):(Object.entries(F._attachments).find(([Ie,Ee])=>{var lt=R?R._attachments[Ie]:void 0;return!lt&&!Ee.data&&(G={documentId:M,documentInDb:V,isError:!0,status:510,writeRow:U,attachmentId:Ie}),!0}),G||Object.entries(F._attachments).forEach(([Ie,Ee])=>{var lt=R?R._attachments[Ie]:void 0;if(!lt)g.push({documentId:M,attachmentId:Ie,attachmentData:Ee,digest:Ee.digest});else{var Me=ge.document._attachments[Ie].digest;Ee.data&&lt.digest!==Me&&p.push({documentId:M,attachmentId:Ie,attachmentData:Ee,digest:Ee.digest})}}))),G?u.push(G):(o?(c.push(dm(ge)),s&&s(F)):(c.push(ge),s&&s(F)),x=ge);var Oe=null,oe=null,We=null;if(B&&!W)We="INSERT",Oe=o?wi(F):F;else if(R&&!B&&!W)We="UPDATE",Oe=o?wi(F):F,oe=R;else if(W)We="DELETE",Oe=He(F),oe=R;else throw Te("SNH",{args:{writeRow:U}});var le={documentId:M,documentData:Oe,previousDocumentData:oe,operation:We};d.push(le)}else{var pe=!!W;if(o&&Object.entries(F._attachments).forEach(([Ie,Ee])=>{Ee.data?g.push({documentId:M,attachmentId:Ie,attachmentData:Ee,digest:Ee.digest}):(G={documentId:M,isError:!0,status:510,writeRow:U,attachmentId:Ie},u.push(G))}),G||(o?(l.push(dm(U)),a&&a(F)):(l.push(U),a&&a(F)),x=U),!pe){var ae={documentId:M,operation:"INSERT",documentData:o?wi(F):F,previousDocumentData:o&&R?wi(R):R};d.push(ae)}}},D=0;D<_;D++)w();return{bulkInsertDocs:l,bulkUpdateDocs:c,newestRow:x,errors:u,eventBulk:h,attachmentsAdd:g,attachmentsRemove:v,attachmentsUpdate:p}}function dm(e){return{previous:e.previous,document:wi(e.document)}}function KL(e){return atob(e).length}function qL(e){var r=e.data;if(!r)return e;var t={length:KL(r),digest:e.digest,type:e.type};return t}function wi(e){if(!e._attachments||Object.keys(e._attachments).length===0)return e;var r=It(e);return r._attachments={},Object.entries(e._attachments).forEach(([t,n])=>{r._attachments[t]=qL(n)}),r}function Gs(e){return Object.assign({},e,{_meta:It(e._meta)})}var N2=new WeakMap;function Qo(e,r,t){ft.deepFreezeWhenDevMode(t);var n=Kr(r.schema.primaryKey),i={originalStorageInstance:r,schema:r.schema,internals:r.internals,collectionName:r.collectionName,databaseName:r.databaseName,options:r.options,bulkWrite(a,s){for(var o=e.token,l=new Array(a.length),c=Yt(),u=0;u<a.length;u++){var f=a[u],h=Gs(f.document);h._meta.lwt=c;var d=f.previous;h._rev=En(o,d),l[u]={document:h,previous:d}}return $r("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:l}),e.lockedRun(()=>r.bulkWrite(l,s)).then(g=>{var v={error:[]},p=Fr(n,l,g);N2.set(v,p);var m=g.error.length===0?[]:g.error.filter(_=>_.status===409&&!_.writeRow.previous&&!_.writeRow.document._deleted&&He(_.documentInDb)._deleted?!0:(v.error.push(_),!1));if(m.length>0){var x=m.map(_=>({previous:_.documentInDb,document:Object.assign({},_.writeRow.document,{_rev:En(e.token,_.documentInDb)})}));return e.lockedRun(()=>r.bulkWrite(x,s)).then(_=>{Qn(v.error,_.error);var w=Fr(n,x,_);return Qn(p,w),v})}return v})},query(a){return e.lockedRun(()=>r.query(a))},count(a){return e.lockedRun(()=>r.count(a))},findDocumentsById(a,s){return e.lockedRun(()=>r.findDocumentsById(a,s))},getAttachmentData(a,s,o){return e.lockedRun(()=>r.getAttachmentData(a,s,o))},getChangedDocumentsSince:r.getChangedDocumentsSince?(a,s)=>e.lockedRun(()=>r.getChangedDocumentsSince(He(a),s)):void 0,cleanup(a){return e.lockedRun(()=>r.cleanup(a))},remove(){return e.storageInstances.delete(i),e.lockedRun(()=>r.remove())},close(){return e.storageInstances.delete(i),e.lockedRun(()=>r.close())},changeStream(){return r.changeStream()},conflictResultionTasks(){return r.conflictResultionTasks()},resolveConflictResultionTask(a){if(a.output.isEqual)return r.resolveConflictResultionTask(a);var s=Object.assign({},a.output.documentData,{_meta:Bn(),_rev:gr(),_attachments:{}}),o=It(s);return delete o._meta,delete o._rev,delete o._attachments,r.resolveConflictResultionTask({id:a.id,output:{isEqual:!1,documentData:o}})}};return e.storageInstances.add(i),i}function P2(e){if(e.schema.keyCompression)throw Te("UT5",{args:{params:e}});if(x0(e.schema))throw Te("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw Te("UT7",{args:{params:e}})}function x0(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}function XL(e,r,t){var n=Kr(e.schema.primaryKey),i=t?t.lwt:Ic,a=t?t.id:"";return xa(e.schema,{selector:{$or:[{"_meta.lwt":{$gt:i}},{"_meta.lwt":{$eq:i},[n]:{$gt:t?a:""}}],"_meta.lwt":{$gte:i}},sort:[{"_meta.lwt":"asc"},{[n]:"asc"}],skip:0,limit:r})}function y0(e,r,t){return Z(this,null,function*(){if(e.getChangedDocumentsSince)return e.getChangedDocumentsSince(r,t);var n=Kr(e.schema.primaryKey),i=js(e.schema,XL(e,r,t)),a=yield e.query(i),s=a.documents,o=Ay(s);return{documents:s,checkpoint:o?{id:o[n],lwt:o._meta.lwt}:t||{id:"",lwt:0}}})}function Fr(e,r,t){var n=N2.get(t);if(n)return n;var i=[];if(t.error.length>0){for(var a=new Set,s=0;s<t.error.length;s++){var o=t.error[s];a.add(o.documentId)}for(var l=0;l<r.length;l++){var c=r[l].document;a.has(c[e])||i.push(wi(c))}}else{i.length=r.length-t.error.length;for(var u=0;u<r.length;u++){var f=r[u].document;i[u]=wi(f)}}return i}var w0=function(){function e(t,n,i,a){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=t,this.primaryPath=n,this.preWrite=i,this.postWrite=a}var r=e.prototype;return r.addWrite=function(n,i){var a=n[this.primaryPath],s=Rn(this.queueByDocId,a,()=>[]),o=new Promise((l,c)=>{var u={lastKnownDocumentState:n,modifier:i,resolve:l,reject:c};He(s).push(u),this.triggerRun()});return o},r.triggerRun=function(){return Z(this,null,function*(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var n=[],i=this.queueByDocId;this.queueByDocId=new Map,yield Promise.all(Array.from(i.entries()).map(l=>Z(this,[l],function*([s,o]){var c=QL(o.map(h=>h.lastKnownDocumentState)),u=c;for(var f of o)try{u=yield f.modifier(cr(u))}catch(h){f.reject(h),f.reject=()=>{},f.resolve=()=>{}}try{yield this.preWrite(u,c)}catch(h){o.forEach(d=>d.reject(h));return}n.push({previous:c,document:u})})));var a=n.length>0?yield this.storageInstance.bulkWrite(n,"incremental-write"):{error:[]};return yield Promise.all(Fr(this.primaryPath,n,a).map(s=>{var o=s[this.primaryPath];this.postWrite(s);var l=Di(i,o);l.forEach(c=>c.resolve(s))})),a.error.forEach(s=>{var o=s.documentId,l=Di(i,o),c=Us(s);if(c){var u=Rn(this.queueByDocId,o,()=>[]);l.reverse().forEach(h=>{h.lastKnownDocumentState=He(c.documentInDb),He(u).unshift(h)})}else{var f=Qy(s);l.forEach(h=>h.reject(f))}}),this.isRunning=!1,this.triggerRun()}})},e}();function pm(e){var r=t=>Z(this,null,function*(){var n=Ry(t);n._deleted=t._deleted;var i=yield e(n),a=Object.assign({},i,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:typeof i._deleted<"u"?i._deleted:t._deleted});return typeof a._deleted>"u"&&(a._deleted=!1),a});return r}function QL(e){var r=e[0],t=_i(r._rev);return e.forEach(n=>{var i=_i(n._rev);i>t&&(r=n,t=i)}),r}var Ks={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(Ue(r=>r._data._deleted))},get deleted$$(){var e=this,r=e.collection.database.getReactivityFactory();return r.fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this;return e.collection.$.pipe(Qe(r=>!r.isLocal),Qe(r=>r.documentId===this.primary),Ue(r=>Nf(r)),ai(e.collection._docCache.getLatestDocumentData(this.primary)),Oa((r,t)=>r._rev===t._rev),Ue(r=>this.collection._docCache.getCachedRxDocument(r)),Vi(Ki))},get $$(){var e=this,r=e.collection.database.getReactivityFactory();return r.fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(ft.isDevMode()){if(e.includes(".item."))throw Te("DOC1",{path:e});if(e===this.primaryPath)throw Te("DOC2");if(this.collection.schema.finalFields.includes(e))throw Te("DOC3",{path:e});var r=xi(this.collection.schema.jsonSchema,e);if(!r)throw Te("DOC4",{path:e})}return this.$.pipe(Ue(t=>ga(t,e)),Oa())},get$$(e){var r=this.get$(e),t=this.collection.database.getReactivityFactory();return t.fromObservable(r,this.getLatest().get(e),this.collection.database)},populate(e){var r=xi(this.collection.schema.jsonSchema,e),t=this.get(e);if(!t)return Ac;if(!r)throw Te("DOC5",{path:e});if(!r.ref)throw Te("DOC6",{path:e,schemaObj:r});var n=this.collection.database.collections[r.ref];if(!n)throw Te("DOC7",{ref:r.ref,path:e,schemaObj:r});return r.type==="array"?n.findByIds(t).exec().then(i=>{var a=i.values();return Array.from(a)}):n.findOne(t).exec()},get(e){return Rn(this._propertyCache,e,()=>{var r=ga(this._data,e);if(typeof r!="object"||r===null||Array.isArray(r))return ft.deepFreezeWhenDevMode(r);var t=this,n=new Proxy(It(r),{get(i,a){if(typeof a!="string")return i[a];var s=a.charAt(a.length-1);if(a.endsWith("$$")){var o=a.slice(0,-2);return t.get$$(Vs(e+"."+o))}else if(s==="$"){var l=a.slice(0,-1);return t.get$(Vs(e+"."+l))}else if(s==="_"){var c=a.slice(0,-1);return t.populate(Vs(e+"."+c))}else return t.get(Vs(e+"."+a))}});return n})},toJSON(e=!1){if(e)return ft.deepFreezeWhenDevMode(this._data);var r=It(this._data);return delete r._rev,delete r._attachments,delete r._deleted,delete r._meta,ft.deepFreezeWhenDevMode(r)},toMutableJSON(e=!1){return cr(this.toJSON(e))},update(e){throw Bt("update")},incrementalUpdate(e){throw Bt("update")},updateCRDT(e){throw Bt("crdt")},putAttachment(){throw Bt("attachments")},getAttachment(){throw Bt("attachments")},allAttachments(){throw Bt("attachments")},get allAttachments$(){throw Bt("attachments")},modify(e,r){return Z(this,null,function*(){var t=this._data,n=yield pm(e)(t);return this._saveData(n,t)})},incrementalModify(e,r){return this.collection.incrementalWriteQueue.addWrite(this._data,pm(e)).then(t=>this.collection._docCache.getCachedRxDocument(t))},patch(e){var r=this._data,t=cr(r);return Object.entries(e).forEach(([n,i])=>{t[n]=i}),this._saveData(t,r)},incrementalPatch(e){return this.incrementalModify(r=>(Object.entries(e).forEach(([t,n])=>{r[t]=n}),r))},_saveData(e,r){return Z(this,null,function*(){if(e=It(e),this._data._deleted)throw Te("DOC11",{id:this.primary,document:this});yield mm(this.collection,e,r);var t=[{previous:r,document:e}],n=yield this.collection.storageInstance.bulkWrite(t,"rx-document-save-data"),i=n.error[0];return Xo(this.collection,this.primary,e,i),yield this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(Fr(this.collection.schema.primaryPath,t,n)[0])})},remove(){var e=this.collection;if(this.deleted)return Promise.reject(Te("DOC13",{document:this,id:this.primary}));var r=It(this._data),t;return e._runHooks("pre","remove",r,this).then(()=>Z(this,null,function*(){r._deleted=!0;var n=[{previous:this._data,document:r}],i=yield e.storageInstance.bulkWrite(n,"rx-document-remove"),a=i.error[0];return Xo(e,this.primary,r,a),Fr(this.collection.schema.primaryPath,n,i)[0]})).then(n=>(t=n,this.collection._runHooks("post","remove",r,this))).then(()=>this.collection._docCache.getCachedRxDocument(t))},incrementalRemove(){return this.incrementalModify(e=>Z(this,null,function*(){return yield this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e})).then(e=>Z(this,null,function*(){return yield this.collection._runHooks("post","remove",e._data,e),e}))},destroy(){throw Te("DOC14")}};function b0(e=Ks){var r=function(n,i){this.collection=n,this._data=i,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return r.prototype=e,r}function L2(e,r,t){var n=new e(r,t);return $r("createRxDocument",n),n}function mm(e,r,t){return r._meta=Object.assign({},t._meta,r._meta),ft.isDevMode()&&e.schema.validateChange(t,r),e._runHooks("pre","save",r,t)}var ba="collection",gm="storage-token",Vc="rx-migration-status",YL="RxInternalDocument",C0=Ja({version:0,title:YL,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[ba,gm,Vc,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Ca(e,r){return Ri(C0,{key:e,context:r})}function E0(e){return Z(this,null,function*(){var r=js(e.schema,{selector:{context:ba,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0}),t=yield e.query(r),n=t.documents;return n})}var B2="storageToken",ZL=Ca(B2,gm);function V2(e){return Z(this,null,function*(){var r=Fi(10),t=e.password?yield e.hashFunction(JSON.stringify(e.password)):void 0,n={id:ZL,context:gm,key:B2,data:{rxdbVersion:e.rxdbVersion,token:r,instanceToken:e.token,passwordHash:t},_deleted:!1,_meta:Bn(),_rev:gr(),_attachments:{}},i=[{document:n}],a=yield e.internalStore.bulkWrite(i,"internal-add-storage-token");if(!a.error[0])return Fr("id",i,a)[0];var s=He(a.error[0]);if(s.isError&&Us(s)){var o=s;if(!JL(o.documentInDb.data.rxdbVersion,e.rxdbVersion))throw Te("DM5",{args:{database:e.name,databaseStateVersion:o.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(t&&t!==o.documentInDb.data.passwordHash)throw Te("DB1",{passwordHash:t,existingPasswordHash:o.documentInDb.data.passwordHash});var l=o.documentInDb;return He(l)}throw s})}function JL(e,r){if(!e||r.includes("beta")&&r!==e)return!1;var t=e.split(".")[0],n=r.split(".")[0];return t===n}function U2(e,r,t){return Z(this,null,function*(){if(e.schema.version!==t.version)throw Te("SNH",{schema:t,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:r}});for(var n=S0(e.name,e.schema.jsonSchema),i=Ca(n,ba);;){var a=yield ya(e.database.internalStore,i),s=cr(He(a)),o=s.data.connectedStorages.find(l=>l.collectionName===r&&l.schema.version===t.version);if(o)return;s.data.connectedStorages.push({collectionName:r,schema:t});try{yield wa(e.database.internalStore,{previous:He(a),document:s},"add-connected-storage-to-collection")}catch(l){if(!Us(l))throw l}}})}function S0(e,r){return e+"-"+r.version}function Uc(e,r){return r=It(r),r=ew(e,r),typeof e.jsonSchema.primaryKey!="string"&&(r=Yy(e.primaryPath,e.jsonSchema,r)),r._meta=Bn(),Object.prototype.hasOwnProperty.call(r,"_deleted")||(r._deleted=!1),Object.prototype.hasOwnProperty.call(r,"_attachments")||(r._attachments={}),Object.prototype.hasOwnProperty.call(r,"_rev")||(r._rev=gr()),r}function $2(e,r){return Z(this,null,function*(){r.multiInstance=e.multiInstance;var t=yield e.storage.createStorageInstance(r);return t})}function T0(e,r,t,n,i,a,s){return Z(this,null,function*(){var o=yield E0(r),l=o.filter(h=>h.data.name===i),c=[];l.forEach(h=>{c.push({collectionName:h.data.name,schema:h.data.schema,isCollection:!0}),h.data.connectedStorages.forEach(d=>c.push({collectionName:d.collectionName,isCollection:!1,schema:d.schema}))});var u=new Set;if(c=c.filter(h=>{var d=h.collectionName+"||"+h.schema.version;return u.has(d)?!1:(u.add(d),!0)}),yield Promise.all(c.map(h=>Z(this,null,function*(){var d=yield e.createStorageInstance({collectionName:h.collectionName,databaseInstanceToken:t,databaseName:n,multiInstance:!1,options:{},schema:h.schema,password:a,devMode:ft.isDevMode()});yield d.remove(),h.isCollection&&(yield Za("postRemoveRxCollection",{storage:e,databaseName:n,collectionName:i}))}))),s){var f=l.map(h=>{var d=Gs(h);return d._deleted=!0,d._meta.lwt=Yt(),d._rev=En(t,h),{previous:h,document:d}});yield r.bulkWrite(f,"rx-database-remove-collection-all")}})}function ri(e){if(e.destroyed)throw Te("COL21",{collection:e.name,version:e.schema.version})}var e9=function(){function e(t){this.subs=[],this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.limit=100,this.tasks=new Set,this.collection=t,this.subs.push(this.collection.database.eventBulks$.pipe(Qe(n=>n.collectionName===this.collection.name),Qe(n=>{var i=n.events[0];return!i.isLocal})).subscribe(n=>{this.tasks.add(()=>this._handleChangeEvents(n.events)),this.tasks.size<=1&&Qa().then(()=>{this.processTasks()})}))}var r=e.prototype;return r.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},r._handleChangeEvents=function(n){var i=this.counter;this.counter=this.counter+n.length,n.length>this.limit?this.buffer=n.slice(n.length*-1):(Qn(this.buffer,n),this.buffer=this.buffer.slice(this.limit*-1));for(var a=i+1,s=this.eventCounterMap,o=0;o<n.length;o++){var l=n[o];s.set(l,a+o)}},r.getCounter=function(){return this.processTasks(),this.counter},r.getBuffer=function(){return this.processTasks(),this.buffer},r.getArrayIndexByPointer=function(n){this.processTasks();var i=this.buffer[0],a=this.eventCounterMap.get(i);if(n<a)return null;var s=n-a;return s},r.getFrom=function(n){this.processTasks();var i=[],a=this.getArrayIndexByPointer(n);if(a===null)return null;for(;;){var s=this.buffer[a];if(a++,s)i.push(s);else return i}},r.runFrom=function(n,i){this.processTasks();var a=this.getFrom(n);if(a===null)throw new Error("out of bounds");a.forEach(s=>i(s))},r.reduceByLastOfDoc=function(n){return this.processTasks(),n.slice(0);var i={};return n.forEach(a=>{i[a.documentId]=a}),Object.values(i)},r.destroy=function(){this.tasks.clear(),this.subs.forEach(n=>n.unsubscribe())},e}();function W2(e){return new e9(e)}var t9=new WeakMap;function r9(e){var r=e.schema.getDocumentPrototype(),t=n9(e),n=Ks,i={};return[r,t,n].forEach(a=>{var s=Object.getOwnPropertyNames(a);s.forEach(o=>{var l=Object.getOwnPropertyDescriptor(a,o),c=!0;(o.startsWith("_")||o.endsWith("_")||o.startsWith("$")||o.endsWith("$"))&&(c=!1),typeof l.value=="function"?Object.defineProperty(i,o,{get(){return l.value.bind(this)},enumerable:c,configurable:!1}):(l.enumerable=c,l.configurable=!1,l.writable&&(l.writable=!1),Object.defineProperty(i,o,l))})}),i}function H2(e){return Rn(t9,e,()=>b0(r9(e)))}function z2(e,r,t){var n=L2(r,e,ft.deepFreezeWhenDevMode(t));return e._runHooksSync("post","create",t,n),$r("postCreateRxDocument",n),n}function n9(e){var r={};return Object.entries(e.methods).forEach(([t,n])=>{r[t]=n}),r}function Yo(e,r){return Z(this,null,function*(){var t=Ri(e.input.metaInstance.schema,{isCheckpoint:"1",itemId:r}),n=yield e.input.metaInstance.findDocumentsById([t],!1),i=n[0];if(e.lastCheckpointDoc[r]=i,i)return i.checkpointData})}function Zo(e,r,t){return Z(this,null,function*(){e.checkpointQueue=e.checkpointQueue.then(()=>Z(this,null,function*(){var n=e.lastCheckpointDoc[r];if(t&&!e.events.canceled.getValue()&&(!n||JSON.stringify(n.checkpointData)!==JSON.stringify(t))){var i={id:"",isCheckpoint:"1",itemId:r,_deleted:!1,_attachments:{},checkpointData:t,_meta:Bn(),_rev:gr()};for(i.id=Ri(e.input.metaInstance.schema,i);!e.events.canceled.getValue();){if(n&&(i.checkpointData=rs([n.checkpointData,i.checkpointData])),i._meta.lwt=Yt(),i._rev=En(yield e.checkpointKey,n),e.events.canceled.getValue())return;var a=[{previous:n,document:i}],s=yield e.input.metaInstance.bulkWrite(a,"replication-set-checkpoint"),o=Fr(e.primaryPath,a,s)[0];if(o){e.lastCheckpointDoc[r]=o;return}else{var l=s.error[0];if(l.status!==409)throw l;n=He(l.documentInDb),i._rev=En(yield e.checkpointKey,n)}}}})),yield e.checkpointQueue})}function j2(e){return Z(this,null,function*(){var r=yield e.hashFunction([e.identifier,e.forkInstance.databaseName,e.forkInstance.collectionName].join("||"));return"rx_storage_replication_"+r})}function vm(e,r,t,n,i){var a=Object.assign({},n,{_attachments:r&&n._attachments?n._attachments:{},_meta:t?n._meta:Object.assign({},i?i._meta:{},{lwt:Yt()}),_rev:t?n._rev:gr()});return a._rev||(a._rev=En(e,i)),a}function Bi(e,r,t){var n=It(e);return r||delete n._attachments,t||(delete n._meta,delete n._rev),n}function $c(e,r){return e.hasAttachments?r.map(t=>{var n=cr(t.document);return n.docData=wi(n.docData),{document:n,previous:t.previous}}):r}function I0(e){for(;;)if(e.underlyingPersistentStorage)e=e.underlyingPersistentStorage;else return e}var Wc="RxReplicationProtocolMetaData";function _m(e,r){var t=Zy(e),n={title:Wc,primaryKey:{key:"id",fields:["itemId","isCheckpoint"],separator:"|"},type:"object",version:e.version,additionalProperties:!1,properties:{id:{type:"string",minLength:1,maxLength:t+2},isCheckpoint:{type:"string",enum:["0","1"],minLength:1,maxLength:1},itemId:{type:"string",maxLength:t>4?t:4},checkpointData:{type:"object",additionalProperties:!0},docData:{type:"object",properties:e.properties},isResolvedConflict:{type:"string"}},keyCompression:e.keyCompression,required:["id","isCheckpoint","itemId"]};r&&(n.encrypted=["docData"]);var i=Ja(n);return i}function k0(e,r){return e.input.metaInstance.findDocumentsById(r.map(t=>{var n=Ri(e.input.metaInstance.schema,{itemId:t,isCheckpoint:"0"});return n}),!0).then(t=>{var n={};return Object.values(t).forEach(i=>{n[i.itemId]={docData:i.docData,metaDocument:i}}),n})}function Jo(e,r,t,n){return Z(this,null,function*(){var i=r[e.primaryPath],a=t?Gs(t):{id:"",isCheckpoint:"0",itemId:i,docData:r,_attachments:{},_deleted:!1,_rev:gr(),_meta:{lwt:0}};a.docData=r,n&&(a.isResolvedConflict=n),a._meta.lwt=Yt(),a.id=Ri(e.input.metaInstance.schema,a),a._rev=En(yield e.checkpointKey,t);var s={previous:t,document:a};return s})}function G2(e){return Z(this,null,function*(){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.downstream){var r=yield Yo(e,"down");r||(yield Zo(e,"down",e.input.initialCheckpoint.downstream))}var t=yield e.input.hashFunction(e.input.identifier),n=e.input.replicationHandler,i=0,a=[];function s(g){e.stats.down.addNewTask=e.stats.down.addNewTask+1;var v={time:i++,task:g};a.push(v),e.streamQueue.down=e.streamQueue.down.then(()=>{for(var p=[];a.length>0;){e.events.active.down.next(!0);var m=He(a.shift());if(!(m.time<l)){if(m.task==="RESYNC")if(p.length===0){p.push(m.task);break}else break;p.push(m.task)}}if(p.length!==0)return p[0]==="RESYNC"?c():u(p)}).then(()=>{e.events.active.down.next(!1),!e.firstSyncDone.down.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.down.next(!0)})}if(s("RESYNC"),!e.events.canceled.getValue()){var o=n.masterChangeStream$.pipe(ir(g=>Z(this,null,function*(){return yield en(e.events.active.up.pipe(Qe(v=>!v))),g}))).subscribe(g=>{e.stats.down.masterChangeStreamEmit=e.stats.down.masterChangeStreamEmit+1,s(g)});en(e.events.canceled.pipe(Qe(g=>!!g))).then(()=>o.unsubscribe())}var l=-1;function c(){return Z(this,null,function*(){if(e.stats.down.downstreamResyncOnce=e.stats.down.downstreamResyncOnce+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>Yo(e,"down"));for(var g=yield e.checkpointQueue,v=[];!e.events.canceled.getValue();){l=i++;var p=yield n.masterChangesSince(g,e.input.pullBatchSize);if(p.documents.length===0||(g=rs([g,p.checkpoint]),v.push(d(p.documents,g)),p.documents.length<e.input.pullBatchSize))break}yield Promise.all(v)}})}function u(g){e.stats.down.downstreamProcessChanges=e.stats.down.downstreamProcessChanges+1;var v=[],p=null;return g.forEach(m=>{if(m==="RESYNC")throw new Error("SNH");Qn(v,m.documents),p=rs([p,m.checkpoint])}),d(v,He(p))}var f=Gr,h={docs:{}};function d(g,v){var p=e.primaryPath;return e.stats.down.persistFromMaster=e.stats.down.persistFromMaster+1,g.forEach(m=>{var x=m[p];h.docs[x]=m}),h.checkpoint=v,f=f.then(()=>{var m=h.docs;h.docs={};var x=h.checkpoint,_=Object.keys(m);if(e.events.canceled.getValue()||_.length===0)return Gr;var w=[],D={},U={},F=[];return Promise.all([e.input.forkInstance.findDocumentsById(_,!0),k0(e,_)]).then(([R,M])=>{var W=new Map;return R.forEach(B=>W.set(B[p],B)),Promise.all(_.map(B=>Z(this,null,function*(){var V=W.get(B),G=V?Bi(V,e.hasAttachments,!1):void 0,pe=m[B],ae=M[B];ae&&V&&ae.metaDocument.isResolvedConflict===V._rev&&(yield e.streamQueue.up);var De=!ae||!G?!1:yield e.input.conflictHandler({realMasterState:ae.docData,newDocumentState:G},"downstream-check-if-equal-0").then(We=>We.isEqual);if(!De&&ae&&ae.docData._rev&&V&&V._meta[e.input.identifier]&&_i(V._rev)===V._meta[e.input.identifier]&&(De=!0),V&&ae&&De===!1||V&&!ae)return Gr;var re=G?yield e.input.conflictHandler({realMasterState:pe,newDocumentState:G},"downstream-check-if-equal-1").then(We=>We.isEqual):!1;if(G&&re)return(!ae||De===!1)&&F.push(yield Jo(e,G,ae?ae.metaDocument:void 0)),Gr;var ge=Object.assign({},pe,V?{_meta:It(V._meta),_attachments:e.hasAttachments&&pe._attachments?pe._attachments:{},_rev:gr()}:{_meta:{lwt:Yt()},_rev:gr(),_attachments:e.hasAttachments&&pe._attachments?pe._attachments:{}});if(pe._rev){var Oe=V?_i(V._rev)+1:1;ge._meta[e.input.identifier]=Oe,e.input.keepMeta&&(ge._rev=pe._rev)}e.input.keepMeta&&pe._meta&&(ge._meta=pe._meta);var oe={previous:V,document:ge};oe.document._rev=oe.document._rev?oe.document._rev:En(t,oe.previous),w.push(oe),D[B]=oe,U[B]=yield Jo(e,pe,ae?ae.metaDocument:void 0)})))}).then(()=>Z(this,null,function*(){if(w.length>0)return e.input.forkInstance.bulkWrite(w,yield e.downstreamBulkWriteFlag).then(R=>{var M=Fr(e.primaryPath,w,R);M.forEach(W=>{var B=W[p];e.events.processed.down.next(D[B]),F.push(U[B])}),R.error.forEach(W=>{W.status!==409&&e.events.error.next(Te("RC_PULL",{writeError:W}))})})})).then(()=>{if(F.length>0)return e.input.metaInstance.bulkWrite($c(e,F),"replication-down-write-meta").then(R=>{R.error.forEach(M=>{e.events.error.next(Te("RC_PULL",{id:M.documentId,writeError:M}))})})}).then(()=>{Zo(e,"down",x)})}).catch(m=>e.events.error.next(m)),f}})}var el=function(e,r){var t=wi(e.newDocumentState),n=wi(e.realMasterState);return Gi(t,n)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};function K2(e,r,t){return Z(this,null,function*(){var n=e.input.conflictHandler,i=yield n(r,"replication-resolve-conflict");if(!i.isEqual){var a=Object.assign({},i.documentData,{_meta:It(t._meta),_rev:gr(),_attachments:It(t._attachments)});return a._meta.lwt=Yt(),a._rev=En(yield e.checkpointKey,t),{resolvedDoc:a,output:i}}})}function Hc(e,r,t,n){return Z(this,null,function*(){if(!t._attachments||n&&!n._attachments)throw new Error("_attachments missing");var i=t[e],a=new Set(n&&n._attachments?Object.keys(n._attachments):[]);return yield Promise.all(Object.entries(t._attachments).map(l=>Z(this,[l],function*([s,o]){if((!a.has(s)||n&&He(n._attachments)[s].digest!==o.digest)&&!o.data){var c=yield r.getAttachmentData(i,s,o.digest);o.data=c}}))),t})}function q2(e){return Z(this,null,function*(){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.upstream){var r=yield Yo(e,"up");r||(yield Zo(e,"up",e.input.initialCheckpoint.upstream))}var t=e.input.replicationHandler;e.streamQueue.up=e.streamQueue.up.then(()=>c().then(()=>{u()}));var n=0,i=-1,a=[],s=un,o={docs:{}},l=e.input.forkInstance.changeStream().subscribe(h=>Z(this,null,function*(){if(h.context!==(yield e.downstreamBulkWriteFlag))return e.stats.up.forkChangeStreamEmit=e.stats.up.forkChangeStreamEmit+1,a.push({task:h,time:n++}),e.events.active.up.getValue()||e.events.active.up.next(!0),e.input.waitBeforePersist?e.input.waitBeforePersist().then(()=>u()):u()}));en(e.events.canceled.pipe(Qe(h=>!!h))).then(()=>l.unsubscribe());function c(){return Z(this,null,function*(){if(e.stats.up.upstreamInitialSync=e.stats.up.upstreamInitialSync+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>Yo(e,"up"));for(var h=yield e.checkpointQueue,d=new Set,g=function(){return Z(this,null,function*(){i=n++,d.size>3&&(yield Promise.race(Array.from(d)));var m=yield y0(e.input.forkInstance,e.input.pushBatchSize,h);if(m.documents.length===0)return 1;h=rs([h,m.checkpoint]);var x=f(m.documents,He(h));d.add(x),x.catch().then(()=>d.delete(x))})};!e.events.canceled.getValue()&&!(yield g()););var v=yield Promise.all(d),p=v.find(m=>!!m);p?yield c():!e.firstSyncDone.up.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.up.next(!0)}})}function u(){if(e.events.canceled.getValue()||a.length===0){e.events.active.up.next(!1);return}e.stats.up.processTasks=e.stats.up.processTasks+1,e.events.active.up.next(!0),e.streamQueue.up=e.streamQueue.up.then(()=>{for(var h=[],d={};a.length>0;){var g=He(a.shift());g.time<i||(Qn(h,g.task.events.map(p=>p.documentData)),d=rs([d,g.task.checkpoint]))}var v=h.length===0?un:f(h,d);return v.then(()=>{a.length===0?e.events.active.up.next(!1):u()})})}function f(h,d){return e.stats.up.persistToMaster=e.stats.up.persistToMaster+1,h.forEach(g=>{var v=g[e.primaryPath];o.docs[v]=g}),o.checkpoint=d,s=s.then(()=>Z(this,null,function*(){if(e.events.canceled.getValue())return!1;var g=o.docs;o.docs={};var v=o.checkpoint,p=Object.keys(g);if(p.length===0)return!1;var m=yield k0(e,p),x={},_=[],w={},D={};if(yield Promise.all(p.map(re=>Z(this,null,function*(){var ge=g[re];D[re]=ge;var Oe=Bi(ge,e.hasAttachments,!!e.input.keepMeta),oe=m[re];oe&&oe.metaDocument.isResolvedConflict!==ge._rev&&(yield e.input.conflictHandler({realMasterState:oe.docData,newDocumentState:Oe},"upstream-check-if-equal")).isEqual||oe&&oe.docData._rev&&_i(ge._rev)===ge._meta[e.input.identifier]||(_.push(re),x[re]={assumedMasterState:oe?oe.docData:void 0,newDocumentState:Oe},w[re]=yield Jo(e,Oe,oe?oe.metaDocument:void 0))}))),_.length===0)return!1;var U=Object.values(x),F=new Set,R={},M=Oy(U,e.input.pushBatchSize);yield Promise.all(M.map(re=>Z(this,null,function*(){e.hasAttachments&&(yield Promise.all(re.map(Oe=>Z(this,null,function*(){Oe.newDocumentState=yield Hc(e.primaryPath,e.input.forkInstance,cr(Oe.newDocumentState),Oe.assumedMasterState)}))));var ge=yield t.masterWrite(re);ge.forEach(Oe=>{var oe=Oe[e.primaryPath];F.add(oe),R[oe]=Oe})})));var W=[];if(_.forEach(re=>{F.has(re)||(e.events.processed.up.next(x[re]),W.push(w[re]))}),e.events.canceled.getValue())return!1;W.length>0&&(yield e.input.metaInstance.bulkWrite($c(e,W),"replication-up-write-meta"));var B=!1;if(F.size>0){e.stats.up.persistToMasterHadConflicts=e.stats.up.persistToMasterHadConflicts+1;var V=[],G={};if(yield Promise.all(Object.entries(R).map(([re,ge])=>{var Oe=x[re],oe={newDocumentState:Oe.newDocumentState,assumedMasterState:Oe.assumedMasterState,realMasterState:ge};return K2(e,oe,D[re]).then(We=>Z(this,null,function*(){if(We){e.events.resolvedConflicts.next({input:oe,output:We.output}),V.push({previous:D[re],document:We.resolvedDoc});var le=m[re];G[re]=yield Jo(e,He(ge),le?le.metaDocument:void 0,We.resolvedDoc._rev)}}))})),V.length>0){B=!0,e.stats.up.persistToMasterConflictWrites=e.stats.up.persistToMasterConflictWrites+1;var pe=yield e.input.forkInstance.bulkWrite(V,"replication-up-write-conflict"),ae=[],De=Fr(e.primaryPath,V,pe);De.forEach(re=>{var ge=re[e.primaryPath];ae.push(G[ge])}),ae.length>0&&(yield e.input.metaInstance.bulkWrite($c(e,ae),"replication-up-write-conflict-meta"))}}return Zo(e,"up",v),B})).catch(g=>(e.events.error.next(g),!1)),s}})}function X2(e){e=It(e),e.forkInstance=I0(e.forkInstance),e.metaInstance=I0(e.metaInstance);var r=j2(e),t={primaryPath:Kr(e.forkInstance.schema.primaryKey),hasAttachments:!!e.forkInstance.schema.attachments,input:e,checkpointKey:r,downstreamBulkWriteFlag:r.then(n=>"replication-downstream-"+n),events:{canceled:new _r(!1),active:{down:new _r(!0),up:new _r(!0)},processed:{down:new Rt,up:new Rt},resolvedConflicts:new Rt,error:new Rt},stats:{down:{addNewTask:0,downstreamProcessChanges:0,downstreamResyncOnce:0,masterChangeStreamEmit:0,persistFromMaster:0},up:{forkChangeStreamEmit:0,persistToMaster:0,persistToMasterConflictWrites:0,persistToMasterHadConflicts:0,processTasks:0,upstreamInitialSync:0}},firstSyncDone:{down:new _r(!1),up:new _r(!1)},streamQueue:{down:Gr,up:Gr},checkpointQueue:Gr,lastCheckpointDoc:{}};return G2(t),q2(t),t}function Q2(e){return en(cl([e.firstSyncDone.down.pipe(Qe(r=>!!r)),e.firstSyncDone.up.pipe(Qe(r=>!!r))])).then(()=>{})}function Y2(e,r,t,n=!1){e=I0(e);var i=!!e.schema.attachments,a=Kr(e.schema.primaryKey),s={masterChangeStream$:e.changeStream().pipe(ir(l=>Z(this,null,function*(){var c={checkpoint:l.checkpoint,documents:yield Promise.all(l.events.map(u=>Z(this,null,function*(){var f=Bi(u.documentData,i,n);return i&&(f=yield Hc(a,e,cr(f),void 0)),f})))};return c}))),masterChangesSince(l,c){return y0(e,c,l).then(u=>Z(this,null,function*(){return{checkpoint:u.documents.length>0?u.checkpoint:l,documents:yield Promise.all(u.documents.map(f=>Z(this,null,function*(){var h=Bi(f,i,n);return i&&(h=yield Hc(a,e,cr(h),void 0)),h})))}}))},masterWrite(l){return Z(this,null,function*(){var c={};l.forEach(p=>{var m=p.newDocumentState[a];c[m]=p});var u=Object.keys(c),f=yield e.findDocumentsById(u,!0),h=new Map;f.forEach(p=>h.set(p[a],p));var d=[],g=[];if(yield Promise.all(Object.entries(c).map(x=>Z(this,[x],function*([p,m]){var _=h.get(p);_?_&&!m.assumedMasterState?d.push(Bi(_,i,n)):(yield r({realMasterState:Bi(_,i,n),newDocumentState:He(m.assumedMasterState)},"rxStorageInstanceToReplicationHandler-masterWrite")).isEqual===!0?g.push({previous:_,document:vm(t,i,n,m.newDocumentState,_)}):d.push(Bi(_,i,n)):g.push({document:vm(t,i,n,m.newDocumentState)})}))),g.length>0){var v=yield e.bulkWrite(g,"replication-master-write");v.error.forEach(p=>{if(p.status!==409)throw new Error("non conflict error");d.push(Bi(He(p.documentInDb),i,n))})}return d})}};return s}function Z2(e){return Z(this,null,function*(){e.events.canceled.next(!0),e.events.active.up.complete(),e.events.active.down.complete(),e.events.processed.up.complete(),e.events.processed.down.complete(),e.events.resolvedConflicts.complete(),e.events.canceled.complete(),yield e.checkpointQueue})}var eb=["pre","post"],tb=["insert","save","remove","create"],J2=!1,xm=function(){function e(t,n,i,a,s={},o={},l={},c={},u={},f=um,h={},d=el){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this.awaitBeforeReads=new Set,this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=I2(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.onRemove=[],this.database=t,this.name=n,this.schema=i,this.internalStorageInstance=a,this.instanceCreationOptions=s,this.migrationStrategies=o,this.methods=l,this.attachments=c,this.options=u,this.cacheReplacementPolicy=f,this.statics=h,this.conflictHandler=d,i9(this.asRxCollection)}var r=e.prototype;return r.prepare=function(){return Z(this,null,function*(){this.storageInstance=Qo(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new w0(this.storageInstance,this.schema.primaryPath,(l,c)=>mm(this,l,c),l=>this._runHooks("post","save",l));var n=this.database.eventBulks$.pipe(Qe(l=>l.collectionName===this.name));this.$=n.pipe(ir(l=>l.events)),this.checkpoint$=n.pipe(Ue(l=>l.checkpoint)),this._changeEventBuffer=W2(this.asRxCollection);var i;this._docCache=new v0(this.schema.primaryPath,this.database.eventBulks$.pipe(Qe(l=>l.collectionName===this.name&&!l.events[0].isLocal),Ue(l=>l.events)),l=>(i||(i=H2(this.asRxCollection)),z2(this.asRxCollection,i,l)));var a=this.database.internalStore.changeStream().pipe(Qe(l=>{var c=this.name+"-"+this.schema.version,u=l.events.find(f=>f.documentData.context==="collection"&&f.documentData.key===c&&f.operation==="DELETE");return!!u})).subscribe(()=>Z(this,null,function*(){yield this.destroy(),yield Promise.all(this.onRemove.map(l=>l()))}));this._subs.push(a);var s=yield this.database.storageToken,o=this.storageInstance.changeStream().subscribe(l=>{for(var c=new Array(l.events.length),u=l.events,f=this.name,h=ft.deepFreezeWhenDevMode,d=0;d<u.length;d++){var g=u[d];c[d]={documentId:g.documentId,collectionName:f,isLocal:!1,operation:g.operation,documentData:h(g.documentData),previousDocumentData:h(g.previousDocumentData)}}var v={id:l.id,internal:!1,collectionName:this.name,storageToken:s,events:c,databaseToken:this.database.token,checkpoint:l.checkpoint,context:l.context,endTime:l.endTime,startTime:l.startTime};this.database.$emit(v)});return this._subs.push(o),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe(l=>{this.conflictHandler(l.input,l.context).then(c=>{this.storageInstance.resolveConflictResultionTask({id:l.id,output:c})})})),Gr})},r.cleanup=function(n){throw ri(this),Bt("cleanup")},r.migrationNeeded=function(){throw Bt("migration-schema")},r.getMigrationState=function(){throw Bt("migration-schema")},r.startMigration=function(n=10){return ri(this),this.getMigrationState().startMigration(n)},r.migratePromise=function(n=10){return this.getMigrationState().migratePromise(n)},r.insert=function(n){return Z(this,null,function*(){ri(this);var i=yield this.bulkInsert([n]),a=i.error[0];Xo(this,n[this.schema.primaryPath],n,a);var s=He(i.success[0]);return s})},r.bulkInsert=function(n){return Z(this,null,function*(){if(ri(this),n.length===0)return{success:[],error:[]};var i=this.schema.primaryPath,a;if(this.hasHooks("pre","insert"))a=yield Promise.all(n.map(v=>{var p=Uc(this.schema,v);return this._runHooks("pre","insert",p).then(()=>({document:p}))}));else{a=new Array(n.length);for(var s=this.schema,o=0;o<n.length;o++){var l=n[o],c=Uc(s,l);a[o]={document:c}}}var u=yield this.storageInstance.bulkWrite(a,"rx-collection-bulk-insert"),f,h=this,d={get success(){if(!f){var v=Fr(h.schema.primaryPath,a,u);f=_0(h._docCache,v)}return f},error:u.error};if(this.hasHooks("post","insert")){var g=new Map;a.forEach(v=>{var p=v.document;g.set(p[i],p)}),yield Promise.all(d.success.map(v=>this._runHooks("post","insert",g.get(v.primary),v)))}return d})},r.bulkRemove=function(n){return Z(this,null,function*(){ri(this);var i=this.schema.primaryPath;if(n.length===0)return{success:[],error:[]};var a=yield this.findByIds(n).exec(),s=[],o=new Map;Array.from(a.values()).forEach(d=>{var g=d.toMutableJSON(!0);s.push(g),o.set(d.primary,g)}),yield Promise.all(s.map(d=>{var g=d[this.schema.primaryPath];return this._runHooks("pre","remove",d,a.get(g))}));var l=s.map(d=>{var g=It(d);return g._deleted=!0,{previous:d,document:g}}),c=yield this.storageInstance.bulkWrite(l,"rx-collection-bulk-remove"),u=Fr(this.schema.primaryPath,l,c),f=u.map(d=>d[i]);yield Promise.all(f.map(d=>this._runHooks("post","remove",o.get(d),a.get(d))));var h=f.map(d=>Di(a,d));return{success:h,error:c.error}})},r.bulkUpsert=function(n){return Z(this,null,function*(){ri(this);var i=[],a=new Map;n.forEach(c=>{var u=Uc(this.schema,c),f=u[this.schema.primaryPath];if(!f)throw Te("COL3",{primaryPath:this.schema.primaryPath,data:u,schema:this.schema.jsonSchema});a.set(f,u),i.push(u)});var s=yield this.bulkInsert(i),o=s.success.slice(0),l=[];return yield Promise.all(s.error.map(c=>Z(this,null,function*(){if(c.status!==409)l.push(c);else{var u=c.documentId,f=Di(a,u),h=He(c.documentInDb),d=this._docCache.getCachedRxDocuments([h])[0],g=yield d.incrementalModify(()=>f);o.push(g)}}))),{error:l,success:o}})},r.upsert=function(n){return Z(this,null,function*(){ri(this);var i=yield this.bulkUpsert([n]);return Xo(this.asRxCollection,n[this.schema.primaryPath],n,i.error[0]),i.success[0]})},r.incrementalUpsert=function(n){ri(this);var i=Uc(this.schema,n),a=i[this.schema.primaryPath];if(!a)throw Te("COL4",{data:n});var s=this._incrementalUpsertQueues.get(a);return s||(s=Gr),s=s.then(()=>s9(this,a,i)).then(o=>o.inserted?o.doc:a9(o.doc,i)),this._incrementalUpsertQueues.set(a,s),s},r.find=function(n){if(ri(this),typeof n=="string")throw Te("COL5",{queryObj:n});n||(n=Bc());var i=ts("find",n,this);return i},r.findOne=function(n){if(ri(this),typeof n=="number"||Array.isArray(n))throw fn("COL6",{queryObj:n});var i;if(typeof n=="string")i=ts("findOne",{selector:{[this.schema.primaryPath]:n},limit:1},this);else{if(n||(n=Bc()),n.limit)throw Te("QU6");n=It(n),n.limit=1,i=ts("findOne",n,this)}return i},r.count=function(n){ri(this),n||(n=Bc());var i=ts("count",n,this);return i},r.findByIds=function(n){ri(this);var i={selector:{[this.schema.primaryPath]:{$in:n.slice(0)}}},a=ts("findByIds",i,this);return a},r.exportJSON=function(){throw Bt("json-dump")},r.importJSON=function(n){throw Bt("json-dump")},r.insertCRDT=function(n){throw Bt("crdt")},r.addPipeline=function(n){throw Bt("pipeline")},r.addHook=function(n,i,a,s=!1){if(typeof a!="function")throw fn("COL7",{key:i,when:n});if(!eb.includes(n))throw fn("COL8",{key:i,when:n});if(!tb.includes(i))throw Te("COL9",{key:i});if(n==="post"&&i==="create"&&s===!0)throw Te("COL10",{when:n,key:i,parallel:s});var o=a.bind(this),l=s?"parallel":"series";this.hooks[i]=this.hooks[i]||{},this.hooks[i][n]=this.hooks[i][n]||{series:[],parallel:[]},this.hooks[i][n][l].push(o)},r.getHooks=function(n,i){return!this.hooks[i]||!this.hooks[i][n]?{series:[],parallel:[]}:this.hooks[i][n]},r.hasHooks=function(n,i){if(!this.hooks[i]||!this.hooks[i][n])return!1;var a=this.getHooks(n,i);return a?a.series.length>0||a.parallel.length>0:!1},r._runHooks=function(n,i,a,s){var o=this.getHooks(n,i);if(!o)return Gr;var l=o.series.map(c=>()=>c(a,s));return Wy(l).then(()=>Promise.all(o.parallel.map(c=>c(a,s))))},r._runHooksSync=function(n,i,a,s){if(this.hasHooks(n,i)){var o=this.getHooks(n,i);o&&o.series.forEach(l=>l(a,s))}},r.promiseWait=function(n){var i=new Promise(a=>{var s=setTimeout(()=>{this.timeouts.delete(s),a()},n);this.timeouts.add(s)});return i},r.destroy=function(){return Z(this,null,function*(){return this.destroyed?un:(yield Promise.all(this.onDestroy.map(n=>n())),this.destroyed=!0,Array.from(this.timeouts).forEach(n=>clearTimeout(n)),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(n=>n.unsubscribe()),delete this.database.collections[this.name],Za("postDestroyRxCollection",this).then(()=>!0))))})},r.remove=function(){return Z(this,null,function*(){yield this.destroy(),yield Promise.all(this.onRemove.map(n=>n())),yield T0(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)})},Dn(e,[{key:"insert$",get:function(){return this.$.pipe(Qe(t=>t.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(Qe(t=>t.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(Qe(t=>t.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}])}();function i9(e){if(!J2){J2=!0;var r=Object.getPrototypeOf(e);tb.forEach(t=>{eb.map(n=>{var i=n+Rf(t);r[i]=function(a,s){return this.addHook(n,t,a,s)}})})}}function a9(e,r){return e.incrementalModify(t=>r)}function s9(e,r,t){var n=e._docCache.getLatestDocumentDataIfExists(r);return n?Promise.resolve({doc:e._docCache.getCachedRxDocuments([n])[0],inserted:!1}):e.findOne(r).exec().then(i=>i?{doc:i,inserted:!1}:e.insert(t).then(a=>({doc:a,inserted:!0})))}function rb({database:e,name:r,schema:t,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:a=!0,statics:s={},methods:o={},attachments:l={},options:c={},localDocuments:u=!1,cacheReplacementPolicy:f=um,conflictHandler:h=el}){var d={databaseInstanceToken:e.token,databaseName:e.name,collectionName:r,schema:t.jsonSchema,options:n,multiInstance:e.multiInstance,password:e.password,devMode:ft.isDevMode()};return $r("preCreateRxStorageInstance",d),$2(e,d).then(g=>{var v=new xm(e,r,t,g,n,i,o,l,c,f,s,h);return v.prepare().then(()=>{Object.entries(s).forEach(([m,x])=>{Object.defineProperty(v,m,{get:()=>x.bind(v)})});var p=Gr;return a&&v.schema.version!==0&&(p=v.migratePromise()),p}).then(()=>($r("createRxCollection",{collection:v,creator:{name:r,schema:t,storageInstance:g,instanceCreationOptions:n,migrationStrategies:i,methods:o,attachments:l,options:c,cacheReplacementPolicy:f,localDocuments:u,statics:s}}),v)).catch(p=>g.close().then(()=>Promise.reject(p)))})}var bm=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=r||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};bm.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,wm(this)},wrapCall:function(r){var t=this;this.lock();var n;try{n=r()}catch(i){throw this.unlock(),i}return!n.then||typeof n.then!="function"?(this.unlock(),n):n.then(function(i){return t.unlock(),i}).catch(function(i){throw t.unlock(),i})},requestIdlePromise:function(r){var t=this;r=r||{};var n,i=new Promise(function(o){return n=o}),a=function(){ym(t,i),n()};if(i._manRes=a,r.timeout){var s=setTimeout(function(){i._manRes()},r.timeout);i._timeoutObj=s}return this._iC.add(i),wm(this),i},cancelIdlePromise:function(r){ym(this,r)},requestIdleCallback:function(r,t){var n=this._lHN++,i=this.requestIdlePromise(t);return this._hPM.set(n,i),this._pHM.set(i,n),i.then(function(){return r()}),n},cancelIdleCallback:function(r){var t=this._hPM.get(r);this.cancelIdlePromise(t)},clear:function(){var r=this;this._iC.forEach(function(t){return ym(r,t)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function o9(e){if(e._iC.size!==0){var r=e._iC.values(),t=r.next().value;t._manRes(),setTimeout(function(){return wm(e)},0)}}function ym(e,r){if(r){if(r._timeoutObj&&clearTimeout(r._timeoutObj),e._pHM.has(r)){var t=e._pHM.get(r);e._hPM.delete(t),e._pHM.delete(r)}e._iC.delete(r)}}function wm(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}o9(e),e._tryIR=!1},0)},0))}var ns=class{ttl;map=new Map;_to=!1;constructor(r){this.ttl=r}has(r){return this.map.has(r)}add(r){this.map.set(r,nb()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,l9(this)},0))}clear(){this.map.clear()}};function l9(e){let r=nb()-e.ttl,t=e.map[Symbol.iterator]();for(;;){let n=t.next().value;if(!n)return;let i=n[0];if(n[1]<r)e.map.delete(i);else return}}function nb(){return Date.now()}var A0=new Set,ib=0,O0=function(){function e(t,n,i,a,s,o,l=!1,c={},u,f,h,d,g){this.idleQueue=new bm,this.rxdbVersion=Oc,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new Rt,this.observable$=this.eventBulks$.pipe(ir(v=>v.events)),this.storageToken=un,this.storageTokenDocument=un,this.emittedEventBulkIds=new ns(60*1e3),this.name=t,this.token=n,this.storage=i,this.instanceCreationOptions=a,this.password=s,this.multiInstance=o,this.eventReduce=l,this.options=c,this.internalStore=u,this.hashFunction=f,this.cleanupPolicy=h,this.allowSlowCount=d,this.reactivity=g,ib++,this.name!=="pseudoInstance"&&(this.internalStore=Qo(this.asRxDatabase,u,C0),this.storageTokenDocument=V2(this.asRxDatabase).catch(v=>this.startupErrors.push(v)),this.storageToken=this.storageTokenDocument.then(v=>v.data.token).catch(v=>this.startupErrors.push(v)))}var r=e.prototype;return r.getReactivityFactory=function(){if(!this.reactivity)throw Te("DB14",{database:this.name});return this.reactivity},r.$emit=function(n){this.emittedEventBulkIds.has(n.id)||(this.emittedEventBulkIds.add(n.id),this.eventBulks$.next(n))},r.removeCollectionDoc=function(n,i){return Z(this,null,function*(){var a=yield ya(this.internalStore,Ca(S0(n,i),ba));if(!a)throw Te("SNH",{name:n,schema:i});var s=Gs(a);s._deleted=!0,yield this.internalStore.bulkWrite([{document:s,previous:a}],"rx-database-remove-collection")})},r.addCollections=function(n){return Z(this,null,function*(){var i={},a={},s=[],o={};yield Promise.all(Object.entries(n).map(h=>Z(this,[h],function*([u,f]){var d=u,g=f.schema;i[d]=g;var v=rw(g,this.hashFunction);if(a[d]=v,this.collections[u])throw Te("DB3",{name:u});var p=S0(u,g),m={id:Ca(p,ba),key:p,context:ba,data:{name:d,schemaHash:yield v.hash,schema:v.jsonSchema,version:v.version,connectedStorages:[]},_deleted:!1,_meta:Bn(),_rev:gr(),_attachments:{}};s.push({document:m});var x=Object.assign({},f,{name:d,schema:v,database:this}),_=It(f);_.database=this,_.name=u,$r("preCreateRxCollection",_),x.conflictHandler=_.conflictHandler,o[d]=x})));var l=yield this.internalStore.bulkWrite(s,"rx-database-add-collection");yield f9(this),yield Promise.all(l.error.map(u=>Z(this,null,function*(){if(u.status!==409)throw Te("DB12",{database:this.name,writeError:u});var f=He(u.documentInDb),h=f.data.name,d=a[h];if(f.data.schemaHash!==(yield d.hash))throw Te("DB6",{database:this.name,collection:h,previousSchemaHash:f.data.schemaHash,schemaHash:yield d.hash,previousSchema:f.data.schema,schema:He(i[h])})})));var c={};return yield Promise.all(Object.keys(n).map(u=>Z(this,null,function*(){var f=o[u],h=yield rb(f);c[u]=h,this.collections[u]=h,this[u]||Object.defineProperty(this,u,{get:()=>this.collections[u]})}))),c})},r.lockedRun=function(n){return this.idleQueue.wrapCall(n)},r.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},r.exportJSON=function(n){throw Bt("json-dump")},r.addState=function(n){throw Bt("state")},r.importJSON=function(n){throw Bt("json-dump")},r.backup=function(n){throw Bt("backup")},r.leaderElector=function(){throw Bt("leader-election")},r.isLeader=function(){throw Bt("leader-election")},r.waitForLeadership=function(){throw Bt("leader-election")},r.migrationStates=function(){throw Bt("migration-schema")},r.destroy=function(){return Z(this,null,function*(){return this.destroyed?un:(this.destroyed=!0,yield Za("preDestroyRxDatabase",this),this.eventBulks$.complete(),ib--,this._subs.map(n=>n.unsubscribe()),this.name==="pseudoInstance"?un:this.requestIdlePromise().then(()=>Promise.all(this.onDestroy.map(n=>n()))).then(()=>Promise.all(Object.keys(this.collections).map(n=>this.collections[n]).map(n=>n.destroy()))).then(()=>this.internalStore.close()).then(()=>A0.delete(this.storage.name+"|"+this.name)).then(()=>!0))})},r.remove=function(){return this.destroy().then(()=>u9(this.name,this.storage,this.password))},Dn(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();function c9(e,r){var t=r.name+"|"+e;if(A0.has(t))throw Te("DB8",{name:e,storage:r.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}function ab(e,r,t,n,i,a){return Z(this,null,function*(){var s=yield r.createStorageInstance({databaseInstanceToken:e,databaseName:t,collectionName:D2,schema:C0,options:n,multiInstance:i,password:a,devMode:ft.isDevMode()});return s})}function sb({storage:e,instanceCreationOptions:r,name:t,password:n,multiInstance:i=!0,eventReduce:a=!0,ignoreDuplicate:s=!1,options:o={},cleanupPolicy:l,allowSlowCount:c=!1,localDocuments:u=!1,hashFunction:f=Ly,reactivity:h}){$r("preCreateRxDatabase",{storage:e,instanceCreationOptions:r,name:t,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:s,options:o,localDocuments:u}),s||c9(t,e),A0.add(e.name+"|"+t);var d=Fi(10);return ab(d,e,t,r,i,n).catch(g=>{throw A0.delete(e.name+"|"+t),g}).then(g=>{var v=new O0(t,d,e,r,n,i,a,o,g,f,l,c,h);return Za("createRxDatabase",{database:v,creator:{storage:e,instanceCreationOptions:r,name:t,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:s,options:o,localDocuments:u}}).then(()=>v)})}function u9(e,r,t){return Z(this,null,function*(){var n=Fi(10),i=yield ab(n,r,e,{},!1,t),a=yield E0(i),s=new Set;a.forEach(l=>s.add(l.data.name));var o=Array.from(s);return yield Promise.all(o.map(l=>T0(r,i,n,e,l,t))),yield Za("postRemoveRxDatabase",{databaseName:e,storage:r}),yield i.remove(),o})}function ob(e){return e instanceof O0}function f9(e){return Z(this,null,function*(){if(yield e.storageToken,e.startupErrors[0])throw e.startupErrors[0]})}var h9={RxSchema:Dp.prototype,RxDocument:Ks,RxQuery:hm.prototype,RxCollection:xm.prototype,RxDatabase:O0.prototype},Cm=new Set,lb=new Set;function zc(e){if($r("preAddRxPlugin",{plugin:e,plugins:Cm}),!Cm.has(e)){{if(lb.has(e.name))throw Te("PL3",{name:e.name,plugin:e});Cm.add(e),lb.add(e.name)}if(!e.rxdb)throw fn("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach(([r,t])=>t(h9[r])),e.overwritable&&Object.assign(ft,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach(([r,t])=>{t.after&&Vo[r].push(t.after),t.before&&Vo[r].unshift(t.before)})}}function cb(e){return e&&typeof e.then=="function"}var d9=Promise.resolve(!1),ub=Promise.resolve(!0),ni=Promise.resolve();function Zi(e,r){return e||(e=0),new Promise(function(t){return setTimeout(function(){return t(r)},e)})}function fb(e,r){return Math.floor(Math.random()*(r-e+1)+e)}function Ea(){return Math.random().toString(36).substring(2)}var Em=0;function Sa(){var e=Date.now()*1e3;return e<=Em&&(e=Em+1),Em=e,e}function hb(){return typeof navigator<"u"&&typeof navigator.locks<"u"&&typeof navigator.locks.request=="function"}var p9=Sa,m9="native";function g9(e){var r={time:Sa(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return r.bc.onmessage=function(t){r.messagesCallback&&r.messagesCallback(t.data)},r}function v9(e){e.bc.close(),e.subFns=[]}function _9(e,r){try{return e.bc.postMessage(r,!1),ni}catch(t){return Promise.reject(t)}}function x9(e,r){e.messagesCallback=r}function y9(){if(typeof globalThis<"u"&&globalThis.Deno&&globalThis.Deno.args)return!0;if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function w9(){return 150}var db={create:g9,close:v9,onMessage:x9,postMessage:_9,canBeUsed:y9,type:m9,averageResponseTime:w9,microSeconds:p9};function tl(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=JSON.parse(JSON.stringify(e));return typeof r.webWorkerSupport>"u"&&(r.webWorkerSupport=!0),r.idb||(r.idb={}),r.idb.ttl||(r.idb.ttl=1e3*45),r.idb.fallbackInterval||(r.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(r.idb.onclose=e.idb.onclose),r.localstorage||(r.localstorage={}),r.localstorage.removeTimeout||(r.localstorage.removeTimeout=1e3*60),e.methods&&(r.methods=e.methods),r.node||(r.node={}),r.node.ttl||(r.node.ttl=1e3*60*2),r.node.maxParallelWrites||(r.node.maxParallelWrites=2048),typeof r.node.useFastPath>"u"&&(r.node.useFastPath=!0),r}var b9=Sa,C9="pubkey.broadcast-channel-0-",Ta="messages",F0={durability:"relaxed"},E9="idb";function pb(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function Sm(e){e.commit&&e.commit()}function S9(e){var r=pb(),t=C9+e,n=r.open(t);return n.onupgradeneeded=function(i){var a=i.target.result;a.createObjectStore(Ta,{keyPath:"id",autoIncrement:!0})},new Promise(function(i,a){n.onerror=function(s){return a(s)},n.onsuccess=function(){i(n.result)}})}function T9(e,r,t){var n=Date.now(),i={uuid:r,time:n,data:t},a=e.transaction([Ta],"readwrite",F0);return new Promise(function(s,o){a.oncomplete=function(){return s()},a.onerror=function(c){return o(c)};var l=a.objectStore(Ta);l.add(i),Sm(a)})}function I9(e,r){var t=e.transaction(Ta,"readonly",F0),n=t.objectStore(Ta),i=[],a=IDBKeyRange.bound(r+1,1/0);if(n.getAll){var s=n.getAll(a);return new Promise(function(l,c){s.onerror=function(u){return c(u)},s.onsuccess=function(u){l(u.target.result)}})}function o(){try{return a=IDBKeyRange.bound(r+1,1/0),n.openCursor(a)}catch{return n.openCursor()}}return new Promise(function(l,c){var u=o();u.onerror=function(f){return c(f)},u.onsuccess=function(f){var h=f.target.result;h?h.value.id<r+1?h.continue(r+1):(i.push(h.value),h.continue()):(Sm(t),l(i))}})}function k9(e,r){if(e.closed)return Promise.resolve([]);var t=e.db.transaction(Ta,"readwrite",F0),n=t.objectStore(Ta);return Promise.all(r.map(function(i){var a=n.delete(i);return new Promise(function(s){a.onsuccess=function(){return s()}})}))}function A9(e,r){var t=Date.now()-r,n=e.transaction(Ta,"readonly",F0),i=n.objectStore(Ta),a=[];return new Promise(function(s){i.openCursor().onsuccess=function(o){var l=o.target.result;if(l){var c=l.value;c.time<t?(a.push(c),l.continue()):(Sm(n),s(a))}else s(a)}})}function O9(e){return A9(e.db,e.options.idb.ttl).then(function(r){return k9(e,r.map(function(t){return t.id}))})}function F9(e,r){return r=tl(r),S9(e).then(function(t){var n={closed:!1,lastCursorId:0,channelName:e,options:r,uuid:Ea(),eMIs:new ns(r.idb.ttl*2),writeBlockPromise:ni,messagesCallback:null,readQueuePromises:[],db:t};return t.onclose=function(){n.closed=!0,r.idb.onclose&&r.idb.onclose()},mb(n),n})}function mb(e){e.closed||gb(e).then(function(){return Zi(e.options.idb.fallbackInterval)}).then(function(){return mb(e)})}function D9(e,r){return!(e.uuid===r.uuid||r.eMIs.has(e.id)||e.data.time<r.messagesCallbackTime)}function gb(e){return e.closed?ni:e.messagesCallback?I9(e.db,e.lastCursorId).then(function(r){var t=r.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return D9(n,e)}).sort(function(n,i){return n.time-i.time});return t.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),ni}):ni}function R9(e){e.closed=!0,e.db.close()}function M9(e,r){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return T9(e.db,e.uuid,r)}).then(function(){fb(0,10)===0&&O9(e)}),e.writeBlockPromise}function N9(e,r,t){e.messagesCallbackTime=t,e.messagesCallback=r,gb(e)}function P9(){return!!pb()}function L9(e){return e.idb.fallbackInterval*2}var vb={create:F9,close:R9,onMessage:N9,postMessage:M9,canBeUsed:P9,type:E9,averageResponseTime:L9,microSeconds:b9};var B9=Sa,V9="pubkey.broadcastChannel-",U9="localstorage";function _b(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function xb(e){return V9+e}function $9(e,r){return new Promise(function(t){Zi().then(function(){var n=xb(e.channelName),i={token:Ea(),time:Date.now(),data:r,uuid:e.uuid},a=JSON.stringify(i);_b().setItem(n,a);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=n,s.newValue=a,window.dispatchEvent(s),t()})})}function W9(e,r){var t=xb(e),n=function(a){a.key===t&&r(JSON.parse(a.newValue))};return window.addEventListener("storage",n),n}function H9(e){window.removeEventListener("storage",e)}function z9(e,r){if(r=tl(r),!yb())throw new Error("BroadcastChannel: localstorage cannot be used");var t=Ea(),n=new ns(r.localstorage.removeTimeout),i={channelName:e,uuid:t,eMIs:n};return i.listener=W9(e,function(a){i.messagesCallback&&a.uuid!==t&&(!a.token||n.has(a.token)||a.data.time&&a.data.time<i.messagesCallbackTime||(n.add(a.token),i.messagesCallback(a.data)))}),i}function j9(e){H9(e.listener)}function G9(e,r,t){e.messagesCallbackTime=t,e.messagesCallback=r}function yb(){var e=_b();if(!e)return!1;try{var r="__broadcastchannel_check";e.setItem(r,"works"),e.removeItem(r)}catch{return!1}return!0}function K9(){var e=120,r=navigator.userAgent.toLowerCase();return r.includes("safari")&&!r.includes("chrome")?e*2:e}var wb={create:z9,close:j9,onMessage:G9,postMessage:$9,canBeUsed:yb,type:U9,averageResponseTime:K9,microSeconds:B9};var bb=Sa,q9="simulate",Tm=new Set;function X9(e){var r={time:bb(),name:e,messagesCallback:null};return Tm.add(r),r}function Q9(e){Tm.delete(e)}var Cb=5;function Y9(e,r){return new Promise(function(t){return setTimeout(function(){var n=Array.from(Tm);n.forEach(function(i){i.name===e.name&&i!==e&&i.messagesCallback&&i.time<r.time&&i.messagesCallback(r)}),t()},Cb)})}function Z9(e,r){e.messagesCallback=r}function J9(){return!0}function e7(){return Cb}var Eb={create:X9,close:Q9,onMessage:Z9,postMessage:Y9,canBeUsed:J9,type:q9,averageResponseTime:e7,microSeconds:bb};var Sb=[db,vb,wb];function Tb(e){var r=[].concat(e.methods,Sb).filter(Boolean);if(e.type){if(e.type==="simulate")return Eb;var t=r.find(function(i){return i.type===e.type});if(t)return t;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(r=r.filter(function(i){return i.type!=="idb"}));var n=r.find(function(i){return i.canBeUsed()});if(n)return n;throw new Error("No usable method found in "+JSON.stringify(Sb.map(function(i){return i.type})))}var Im=new Set,t7=0,jc=function(r,t){this.id=t7++,Im.add(this),this.name=r,Ib&&(t=Ib),this.options=tl(t),this.method=Tb(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,r7(this)};jc._pubkey=!0;var Ib;jc.prototype={postMessage:function(r){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(r));return kb(this,"message",r)},postInternal:function(r){return kb(this,"internal",r)},set onmessage(e){var r=this.method.microSeconds(),t={time:r,fn:e};Ob(this,"message",this._onML),e&&typeof e=="function"?(this._onML=t,Ab(this,"message",t)):this._onML=null},addEventListener:function(r,t){var n=this.method.microSeconds(),i={time:n,fn:t};Ab(this,r,i)},removeEventListener:function(r,t){var n=this._addEL[r].find(function(i){return i.fn===t});Ob(this,r,n)},close:function(){var r=this;if(!this.closed){Im.delete(this),this.closed=!0;var t=this._prepP?this._prepP:ni;return this._onML=null,this._addEL.message=[],t.then(function(){return Promise.all(Array.from(r._uMP))}).then(function(){return Promise.all(r._befC.map(function(n){return n()}))}).then(function(){return r.method.close(r._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function kb(e,r,t){var n=e.method.microSeconds(),i={time:n,type:r,data:t},a=e._prepP?e._prepP:ni;return a.then(function(){var s=e.method.postMessage(e._state,i);return e._uMP.add(s),s.catch().then(function(){return e._uMP.delete(s)}),s})}function r7(e){var r=e.method.create(e.name,e.options);cb(r)?(e._prepP=r,r.then(function(t){e._state=t})):e._state=r}function Fb(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Ab(e,r,t){e._addEL[r].push(t),n7(e)}function Ob(e,r,t){e._addEL[r]=e._addEL[r].filter(function(n){return n!==t}),i7(e)}function n7(e){if(!e._iL&&Fb(e)){var r=function(i){e._addEL[i.type].forEach(function(a){i.time>=a.time&&a.fn(i.data)})},t=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,r,t)}):(e._iL=!0,e.method.onMessage(e._state,r,t))}}function i7(e){if(e._iL&&!Fb(e)){e._iL=!1;var r=e.method.microSeconds();e.method.onMessage(e._state,null,r)}}function Db(e){if(typeof WorkerGlobalScope=="function"&&self instanceof WorkerGlobalScope){var r=self.close.bind(self);self.close=function(){return e(),r()}}else{if(typeof window.addEventListener!="function")return;window.addEventListener("beforeunload",function(){e()},!0),window.addEventListener("unload",function(){e()},!0)}}function Rb(e){process.on("exit",function(){return e()}),process.on("beforeExit",function(){return e().then(function(){return process.exit()})}),process.on("SIGINT",function(){return e().then(function(){return process.exit()})}),process.on("uncaughtException",function(r){return e().then(function(){console.trace(r),process.exit(101)})})}var a7=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",s7=a7?Rb:Db,Gc=new Set,Mb=!1;function o7(){Mb||(Mb=!0,s7(l7))}function Nb(e){if(o7(),typeof e!="function")throw new Error("Listener is no function");Gc.add(e);var r={remove:function(){return Gc.delete(e)},run:function(){return Gc.delete(e),e()}};return r}function l7(){var e=[];return Gc.forEach(function(r){e.push(r()),Gc.delete(r)}),Promise.all(e)}function Ia(e,r){var t={context:"leader",action:r,token:e.token};return e.broadcastChannel.postInternal(t)}function D0(e){e.isLeader=!0,e._hasLeader=!0;var r=Nb(function(){return e.die()});e._unl.push(r);var t=function(i){i.context==="leader"&&i.action==="apply"&&Ia(e,"tell"),i.context==="leader"&&i.action==="tell"&&!e._dpLC&&(e._dpLC=!0,e._dpL(),Ia(e,"tell"))};return e.broadcastChannel.addEventListener("internal",t),e._lstns.push(t),Ia(e,"tell")}var km=function(r,t){var n=this;this.broadcastChannel=r,r._befC.push(function(){return n.die()}),this._options=t,this.isLeader=!1,this.isDead=!1,this.token=Ea(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+r.method.type+"||"+r.name};km.prototype={hasLeader:function(){var r=this;return navigator.locks.query().then(function(t){var n=t.held?t.held.filter(function(i){return i.name===r.lN}):[];return!!(n&&n.length>0)})},awaitLeadership:function(){var r=this;if(!this._wLMP){this._wKMC.c=new AbortController;var t=new Promise(function(n,i){r._wKMC.res=n,r._wKMC.rej=i});this._wLMP=new Promise(function(n){navigator.locks.request(r.lN,{signal:r._wKMC.c.signal},function(){return r._wKMC.c=void 0,D0(r),n(),t}).catch(function(){})})}return this._wLMP},set onduplicate(e){},die:function(){var r=this;return this._lstns.forEach(function(t){return r.broadcastChannel.removeEventListener("internal",t)}),this._lstns=[],this._unl.forEach(function(t){return t.remove()}),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),Ia(this,"death")}};var Pb=function(r,t){var n=this;this.broadcastChannel=r,this._options=t,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=Ea(),this._aplQ=ni,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var i=function(s){s.context==="leader"&&(s.action==="death"&&(n._hasLeader=!1),s.action==="tell"&&(n._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",i),this._lstns.push(i)};Pb.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(r){var t=this;if(this.isLeader)return Zi(0,!0);if(this.isDead)return Zi(0,!1);if(this._aplQC>1)return this._aplQ;var n=function(){if(t.isLeader)return ub;var a=!1,s,o=new Promise(function(u){s=function(){a=!0,u()}}),l=function(f){f.context==="leader"&&f.token!=t.token&&(f.action==="apply"&&f.token>t.token&&s(),f.action==="tell"&&(s(),t._hasLeader=!0))};t.broadcastChannel.addEventListener("internal",l);var c=r?t._options.responseTime*4:t._options.responseTime;return Ia(t,"apply").then(function(){return Promise.race([Zi(c),o.then(function(){return Promise.reject(new Error)})])}).then(function(){return Ia(t,"apply")}).then(function(){return Promise.race([Zi(c),o.then(function(){return Promise.reject(new Error)})])}).catch(function(){}).then(function(){return t.broadcastChannel.removeEventListener("internal",l),a?!1:D0(t).then(function(){return!0})})};return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then(function(){return n()}).then(function(){t._aplQC=t._aplQC-1}),this._aplQ.then(function(){return t.isLeader})},awaitLeadership:function(){return this._aLP||(this._aLP=c7(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var r=this;return this._lstns.forEach(function(t){return r.broadcastChannel.removeEventListener("internal",t)}),this._lstns=[],this._unl.forEach(function(t){return t.remove()}),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,Ia(this,"death")}};function c7(e){return e.isLeader?ni:new Promise(function(r){var t=!1;function n(){t||(t=!0,e.broadcastChannel.removeEventListener("internal",a),r(!0))}e.applyOnce().then(function(){e.isLeader&&n()});var i=function s(){return Zi(e._options.fallbackInterval).then(function(){if(!(e.isDead||t))if(e.isLeader)n();else return e.applyOnce(!0).then(function(){e.isLeader?n():s()})})};i();var a=function(o){o.context==="leader"&&o.action==="death"&&(e._hasLeader=!1,e.applyOnce().then(function(){e.isLeader&&n()}))};e.broadcastChannel.addEventListener("internal",a),e._lstns.push(a)})}function u7(e,r){return e||(e={}),e=JSON.parse(JSON.stringify(e)),e.fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=r.method.averageResponseTime(r.options)),e}function Am(e,r){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");r=u7(r,e);var t=hb()?new km(e,r):new Pb(e,r);return e._befC.push(function(){return t.die()}),e._leaderElector=t,t}function f7(e,r){var t=r.map(n=>{var i=xi(e,n);if(!i)throw new Error("not in schema: "+n);var a=i.type,s;(a==="number"||a==="integer")&&(s=Om(i));var o=Df(n),l=i.maxLength?i.maxLength:0,c;a==="string"?c=f=>{var h=o(f);return h||(h=""),h.padEnd(l," ")}:a==="boolean"?c=f=>{var h=o(f);return h?"1":"0"}:c=f=>{var h=o(f);return R0(s,h)};var u={fieldName:n,schemaPart:i,parsedLengths:s,getValue:o,getIndexStringPart:c};return u});return t}function Lb(e,r){var t=f7(e,r),n=t.length,i=t.map(s=>s.getIndexStringPart),a=function(s){for(var o="",l=0;l<n;++l)o+=i[l](s);return o};return a}function Om(e){var r=Math.floor(e.minimum),t=Math.ceil(e.maximum),n=e.multipleOf,i=t-r,a=i.toString().length,s=n.toString().split("."),o=0;return s.length>1&&(o=s[1].length),{minimum:r,maximum:t,nonDecimals:a,decimals:o,roundedMinimum:r}}function R0(e,r){typeof r>"u"&&(r=0),r<e.minimum&&(r=e.minimum),r>e.maximum&&(r=e.maximum);var t=(Math.floor(r)-e.roundedMinimum).toString(),n=t.padStart(e.nonDecimals,"0");if(e.decimals>0){var i=r.toString().split("."),a=i.length>1?i[1]:"0";n+=a.padEnd(e.decimals,"0")}return n}function Fm(e,r,t){var n="";return r.forEach((i,a)=>{var s=xi(e,i),o=t[a],l=s.type;switch(l){case"string":var c=He(s.maxLength,"maxLength not set");typeof o=="string"?n+=o.padEnd(c," "):n+="".padEnd(c," ");break;case"boolean":if(o===null)n+="0";else if(o===qi)n+="0";else if(o===Mi)n+="1";else{var u=o?"1":"0";n+=u}break;case"number":case"integer":var f=Om(s);if(o===null||o===qi){var h="0";n+=h.repeat(f.nonDecimals+f.decimals)}else if(o===Mi)n+=R0(f,f.maximum);else{var d=R0(f,o);n+=d}break;default:throw new Error("unknown index type "+l)}}),n}function Bb(e,r,t){var n="";return r.forEach((i,a)=>{var s=xi(e,i),o=t[a],l=s.type;switch(l){case"string":var c=He(s.maxLength,"maxLength not set");typeof o=="string"&&o!==Mi?n+=o.padEnd(c," "):o===qi?n+="".padEnd(c," "):n+="".padEnd(c,Mi);break;case"boolean":if(o===null)n+="1";else{var u=o?"1":"0";n+=u}break;case"number":case"integer":var f=Om(s);if(o===null||o===Mi){var h="9";n+=h.repeat(f.nonDecimals+f.decimals)}else if(o===qi){var d="0";n+=d.repeat(f.nonDecimals+f.decimals)}else n+=R0(f,o);break;default:throw new Error("unknown index type "+l)}}),n}function h7(e,r,t,n,i){for(var a=i+1;n<=i;){var s=n+i>>>1,o=e[s],l=t!==void 0?t(o,r):o-r;l>=0?(a=s,i=s-1):n=s+1}return a}function d7(e,r,t,n,i){for(var a=i+1;n<=i;){var s=n+i>>>1,o=e[s],l=t!==void 0?t(o,r):o-r;l>0?(a=s,i=s-1):n=s+1}return a}function p7(e,r,t,n,i){for(var a=n-1;n<=i;){var s=n+i>>>1,o=e[s],l=t!==void 0?t(o,r):o-r;l<0?(a=s,n=s+1):i=s-1}return a}function m7(e,r,t,n,i){for(var a=n-1;n<=i;){var s=n+i>>>1,o=e[s],l=t!==void 0?t(o,r):o-r;l<=0?(a=s,n=s+1):i=s-1}return a}function g7(e,r,t,n,i){for(;n<=i;){var a=n+i>>>1,s=e[a],o=t!==void 0?t(s,r):s-r;if(o===0)return a;o<=0?n=a+1:i=a-1}return-1}function Kc(e,r,t,n,i,a){return a(e,r,t,n===void 0?0:n|0,i===void 0?e.length-1:i|0)}function Vb(e,r,t,n,i){return Kc(e,r,t,n,i,h7)}function Dm(e,r,t,n,i){return Kc(e,r,t,n,i,d7)}function Ub(e,r,t,n,i){return Kc(e,r,t,n,i,p7)}function $b(e,r,t,n,i){return Kc(e,r,t,n,i,m7)}function Rm(e,r,t,n,i){return Kc(e,r,t,n,i,g7)}function Mm(e,r,t){return[e,r,t].join("--memory--")}function qc(e){if(e.internals.removed)throw new Error("removed")}function Xc(e,r){return e+"||"+r}function v7(e,r){return e[0]<r[0]?-1:1}function Nm(e,r,t,n,i){r.documents.set(e,n);for(var a=0;a<t.length;++a){var s=t[a],o=s.docsWithIndex,l=s.getIndexableString,c=l(n),u=Lf(o,[c,n,e],v7,0);if(i){var f=l(i);if(f===c){var h=o[u-1];if(h&&h[2]===e)o.splice(u-1,1);else{var d=o[u+1];if(d[2]===e)o.splice(u+1,1);else throw Te("SNH",{document:n,args:{byIndex:s}})}}else{var g=Rm(o,[f],rl);o.splice(g,1)}}}}function Wb(e,r,t,n){var i=n[e];t.documents.delete(i),Object.values(t.byIndex).forEach(a=>{var s=a.docsWithIndex,o=a.getIndexableString(n),l=Rm(s,[o],rl);s.splice(l,1)})}function rl(e,r){var t=e[0],n=r[0];return t<n?-1:t===n?0:1}function Hb(e,r){var t=Kr(r.primaryKey),n=r.indexes?r.indexes.map(i=>Of(i)):[];n.push(["_deleted","_meta.lwt",t]),n.forEach(i=>{e.byIndex[M0(i)]={index:i,docsWithIndex:[],getIndexableString:Lb(r,i)}})}function M0(e){return e.join(",")}var zb=new Set,_7=function(){function e(t,n,i,a,s,o,l,c){this.closed=!1,this.categorizedByWriteInput=new WeakMap,this.storage=t,this.databaseName=n,this.collectionName=i,this.schema=a,this.internals=s,this.options=o,this.settings=l,this.devMode=c,zb.add(this),this.primaryPath=Kr(this.schema.primaryKey)}var r=e.prototype;return r.bulkWrite=function(n,i){this.ensurePersistence(),qc(this);var a=this.internals,s=this.internals.documents,o=this.primaryPath,l=M2(this,o,s,n,i),c=l.errors,u=Promise.resolve({error:c});if(this.categorizedByWriteInput.set(n,l),this.internals.ensurePersistenceTask=l,this.internals.ensurePersistenceIdlePromise||(this.internals.ensurePersistenceIdlePromise=Qa().then(()=>{this.internals.ensurePersistenceIdlePromise=void 0,this.ensurePersistence()})),l.eventBulk.events.length>0){var f=He(l.newestRow).document;l.eventBulk.checkpoint={id:f[o],lwt:f._meta.lwt},l.eventBulk.endTime=Yt(),a.changes$.next(l.eventBulk)}return u},r.ensurePersistence=function(){if(this.internals.ensurePersistenceTask){var n=this.internals,i=this.internals.documents,a=this.primaryPath,s=this.internals.ensurePersistenceTask;this.internals.ensurePersistenceTask=void 0;for(var o=Object.values(this.internals.byIndex),l=s.bulkInsertDocs,c=0;c<l.length;++c){var u=l[c],f=u.document,h=f[a];Nm(h,n,o,f,void 0)}for(var d=s.bulkUpdateDocs,g=0;g<d.length;++g){var v=d[g],p=v.document,m=p[a];Nm(m,n,o,p,i.get(m))}if(this.schema.attachments){var x=n.attachments;s.attachmentsAdd.forEach(_=>{x.set(Xc(_.documentId,_.attachmentId),{writeData:_.attachmentData,digest:_.digest})}),this.schema.attachments&&(s.attachmentsUpdate.forEach(_=>{x.set(Xc(_.documentId,_.attachmentId),{writeData:_.attachmentData,digest:_.digest})}),s.attachmentsRemove.forEach(_=>{x.delete(Xc(_.documentId,_.attachmentId))}))}}},r.findDocumentsById=function(n,i){this.ensurePersistence();var a=this.internals.documents,s=[];if(a.size===0)return Promise.resolve(s);for(var o=0;o<n.length;++o){var l=n[o],c=a.get(l);c&&(!c._deleted||i)&&s.push(c)}return Promise.resolve(s)},r.query=function(n){this.ensurePersistence();var i=n.queryPlan,a=n.query,s=a.skip?a.skip:0,o=a.limit?a.limit:1/0,l=s+o,c=!1;i.selectorSatisfiedByIndex||(c=Ko(this.schema,n.query));var u=i.index,f=!i.sortSatisfiedByIndex,h=u,d=i.startKeys,g=Fm(this.schema,h,d),v=i.endKeys;v=v;var p=Bb(this.schema,h,v),m=M0(h);if(!this.internals.byIndex[m])throw new Error("index does not exist "+m);for(var x=this.internals.byIndex[m].docsWithIndex,_=(i.inclusiveStart?Vb:Dm)(x,[g],rl),w=(i.inclusiveEnd?$b:Ub)(x,[p],rl),D=[],U=!1;!U;){var F=x[_];if(!F||_>w)break;var R=F[1];(!c||c(R))&&D.push(R),D.length>=l&&!f&&(U=!0),_++}if(f){var M=g0(this.schema,n.query);D=D.sort(M)}return D=D.slice(s,l),Promise.resolve({documents:D})},r.count=function(n){return Z(this,null,function*(){this.ensurePersistence();var i=yield this.query(n);return{count:i.documents.length,mode:"fast"}})},r.cleanup=function(n){this.ensurePersistence();for(var i=Yt()-n,a=["_deleted","_meta.lwt",this.primaryPath],s=M0(a),o=this.internals.byIndex[s].docsWithIndex,l=Fm(this.schema,a,[!0,0,""]),c=Dm(o,[l],rl),u=!1;!u;){var f=o[c];!f||f[1]._meta.lwt>i?u=!0:(Wb(this.primaryPath,this.schema,this.internals,f[1]),c++)}return kc},r.getAttachmentData=function(n,i,a){this.ensurePersistence(),qc(this);var s=Xc(n,i),o=this.internals.attachments.get(s);if(!a||!o||o.digest!==a)throw new Error("attachment does not exist: "+s);return Promise.resolve(o.writeData.data)},r.changeStream=function(){return qc(this),this.internals.changes$.asObservable()},r.remove=function(){return Z(this,null,function*(){if(this.closed)throw new Error("closed");this.ensurePersistence(),qc(this),this.internals.removed=!0,this.storage.collectionStates.delete(Mm(this.databaseName,this.collectionName,this.schema.version)),yield this.close()})},r.close=function(){return zb.delete(this),this.ensurePersistence(),this.closed?Gr:(this.closed=!0,this.internals.refCount=this.internals.refCount-1,Gr)},r.conflictResultionTasks=function(){return this.internals.conflictResultionTasks$.asObservable()},r.resolveConflictResultionTask=function(n){return Gr},e}();function jb(e,r,t){var n=Mm(r.databaseName,r.collectionName,r.schema.version),i=e.collectionStates.get(n);if(!i)i={id:Fi(5),schema:r.schema,removed:!1,refCount:1,documents:new Map,attachments:r.schema.attachments?new Map:void 0,byIndex:{},conflictResultionTasks$:new Rt,changes$:new Rt},Hb(i,r.schema),e.collectionStates.set(n,i);else{if(r.devMode&&!Gi(i.schema,r.schema))throw new Error("storage was already created with a different schema");i.refCount=i.refCount+1}var a=new _7(e,r.databaseName,r.collectionName,r.schema,i,r.options,t,r.devMode);return Promise.resolve(a)}var x7=new Map;function Gb(e={}){var r={name:"memory",rxdbVersion:Oc,collectionStates:x7,createStorageInstance(t){P2(t);var n=Object.assign({},e,t.options);return jb(this,t,n)}};return r}function Pm(e){return Z(this,null,function*(){var r=tw(e.collection.schema.jsonSchema).map(n=>e.collection.name+"-"+n),t=yield e.database.internalStore.findDocumentsById(r.map(n=>Ca(n,ba)),!1);if(t.length>1)throw new Error("more than one old collection meta found");return t[0]})}function Kb(e,r,t){var n=It(t._attachments),i=cr(t),a=i._meta;delete i._meta,i._attachments=n;for(var s=r+1,o=Promise.resolve(i),l=function(){var c=s;o=o.then(u=>y7(e,c,u)),s++};s<=e.schema.version;)l();return o.then(c=>c===null?Ac:(c._meta=a,c))}function y7(e,r,t){if(t===null)return Ac;var n=e.migrationStrategies[r](t,e),i=Uy(n);return i}function N0(e){return Z(this,null,function*(){if(e.collection.schema.version===0)return un;var r=yield Pm(e);return!!r})}var qb=200,Xb=new WeakMap;function Qb(e){var r=Lm(e.database),t=r.getValue().slice(0);t.push(e),r.next(t)}function Lm(e){return Rn(Xb,e,()=>new _r([]))}function Yb(e){var r=Xb.get(e);r&&r.complete()}var Zb=function(){function e(t,n,i=[t.name,"v",t.schema.version].join("-")){this.started=!1,this.updateStatusHandlers=[],this.updateStatusQueue=kc,this.collection=t,this.migrationStrategies=n,this.statusDocKey=i,this.database=t.database,this.oldCollectionMeta=Pm(this),this.mustMigrate=N0(this),this.statusDocId=Ca(this.statusDocKey,Vc),Qb(this),this.$=R2(this.database.internalStore,this.statusDocId).pipe(Qe(a=>!!a),Ue(a=>He(a).data),Vi(Ki))}var r=e.prototype;return r.getStatus=function(){return en(this.$)},r.startMigration=function(){return Z(this,arguments,function*(n=qb){var i=yield this.mustMigrate;if(i){if(this.started)throw Te("DM1");this.started=!0;var a=void 0;if(this.database.multiInstance){a=new jc(["rx-migration-state",this.database.name,this.collection.name,this.collection.schema.version].join("|"));var s=Am(a);yield s.awaitLeadership()}var o=yield this.oldCollectionMeta,l=yield this.database.storage.createStorageInstance({databaseName:this.database.name,collectionName:this.collection.name,databaseInstanceToken:this.database.token,multiInstance:this.database.multiInstance,options:{},schema:o.data.schema,password:this.database.password,devMode:ft.isDevMode()}),c=yield this.getConnectedStorageInstances(),u=yield this.countAllDoucments([l].concat(c.map(f=>f.oldStorage)));yield this.updateStatus(f=>(f.count.total=u,f));try{yield Promise.all(c.map(f=>Z(this,null,function*(){yield U2(this.collection,f.newStorage.collectionName,f.newStorage.schema),yield this.migrateStorage(f.oldStorage,f.newStorage,n),yield f.newStorage.close()}))),yield this.migrateStorage(l,this.collection.storageInstance.originalStorageInstance,n)}catch(f){yield l.close(),yield this.updateStatus(h=>(h.status="ERROR",h.error=jy(f),h));return}yield wa(this.database.internalStore,{previous:o,document:Object.assign({},o,{_deleted:!0})},"rx-migration-remove-collection-meta"),yield this.updateStatus(f=>(f.status="DONE",f)),a&&(yield a.close())}})},r.updateStatus=function(n){return this.updateStatusHandlers.push(n),this.updateStatusQueue=this.updateStatusQueue.then(()=>Z(this,null,function*(){if(this.updateStatusHandlers.length!==0){var i=this.updateStatusHandlers;for(this.updateStatusHandlers=[];;){var a=yield ya(this.database.internalStore,this.statusDocId),s=cr(a);a||(s={id:this.statusDocId,key:this.statusDocKey,context:Vc,data:{collectionName:this.collection.name,status:"RUNNING",count:{total:0,handled:0,percent:0}},_deleted:!1,_meta:Bn(),_rev:gr(),_attachments:{}});var o=He(s).data;for(var l of i)o=l(o);if(o.count.percent=Math.round(o.count.handled/o.count.total*100),s&&a&&Gi(s.data,a.data))break;try{yield wa(this.database.internalStore,{previous:a,document:He(s)},Vc);break}catch(c){if(!Us(c))throw c}}}})),this.updateStatusQueue},r.migrateStorage=function(n,i,a){return Z(this,null,function*(){var s=yield this.database.storage.createStorageInstance({databaseName:this.database.name,collectionName:"rx-migration-state-meta-"+this.collection.name+"-"+this.collection.schema.version,databaseInstanceToken:this.database.token,multiInstance:this.database.multiInstance,options:{},schema:_m(n.schema,x0(n.schema)),password:this.database.password,devMode:ft.isDevMode()}),o=Y2(i,el,this.database.token,!0),l=X2({keepMeta:!0,identifier:["rx-migration-state",this.collection.name,n.schema.version,this.collection.schema.version].join("-"),replicationHandler:{masterChangesSince(){return Promise.resolve({checkpoint:null,documents:[]})},masterWrite:u=>Z(this,null,function*(){u=yield Promise.all(u.map(h=>Z(this,null,function*(){var d=h.newDocumentState;if(i.schema.title===Wc&&(d=h.newDocumentState.docData,h.newDocumentState.isCheckpoint==="1"))return{assumedMasterState:void 0,newDocumentState:h.newDocumentState};var g=yield Kb(this.collection,n.schema.version,d),v={assumedMasterState:void 0,newDocumentState:i.schema.title===Wc?Object.assign({},h.newDocumentState,{docData:g}):g};return v}))),u=u.filter(h=>!!h.newDocumentState);var f=yield o.masterWrite(u);return f}),masterChangeStream$:new Rt().asObservable()},forkInstance:n,metaInstance:s,pushBatchSize:a,pullBatchSize:0,conflictHandler:el,hashFunction:this.database.hashFunction}),c=!1;if(l.events.error.subscribe(u=>c=u),l.events.processed.up.subscribe(()=>{this.updateStatus(u=>(u.count.handled=u.count.handled+1,u))}),yield Q2(l),yield Z2(l),yield this.updateStatusQueue,c)throw yield s.close(),c;yield Promise.all([n.remove(),s.remove()])})},r.countAllDoucments=function(n){return Z(this,null,function*(){var i=0;return yield Promise.all(n.map(a=>Z(this,null,function*(){var s=js(a.schema,xa(a.schema,{selector:{}})),o=yield a.count(s);i+=o.count}))),i})},r.getConnectedStorageInstances=function(){return Z(this,null,function*(){var n=yield this.oldCollectionMeta,i=[];return yield Promise.all(yield Promise.all(n.data.connectedStorages.map(a=>Z(this,null,function*(){if(a.schema.title!==Wc)throw new Error("unknown migration handling for schema");var s=_m(cr(this.collection.schema.jsonSchema),x0(a.schema));s.version=this.collection.schema.version;var[o,l]=yield Promise.all([this.database.storage.createStorageInstance({databaseInstanceToken:this.database.token,databaseName:this.database.name,devMode:ft.isDevMode(),multiInstance:this.database.multiInstance,options:{},schema:a.schema,password:this.database.password,collectionName:a.collectionName}),this.database.storage.createStorageInstance({databaseInstanceToken:this.database.token,databaseName:this.database.name,devMode:ft.isDevMode(),multiInstance:this.database.multiInstance,options:{},schema:s,password:this.database.password,collectionName:a.collectionName})]);i.push({oldStorage:o,newStorage:l})})))),i})},r.migratePromise=function(n){return Z(this,null,function*(){this.startMigration(n);var i=yield this.mustMigrate;if(!i)return{status:"DONE",collectionName:this.collection.name,count:{handled:0,percent:0,total:0}};var a=yield Promise.race([en(this.$.pipe(Qe(s=>s.status==="DONE"))),en(this.$.pipe(Qe(s=>s.status==="ERROR")))]);if(a.status==="ERROR")throw Te("DM4",{collection:this.collection.name,error:a.error});return a})},e}();var w7=b0(),b7=function(e){function r(t,n,i){var a;return a=e.call(this,null,n)||this,a.id=t,a.parent=i,a}return Fc(r,e),r}(w7),Qc={get isLocal(){return!0},get allAttachments$(){throw Te("LD1",{document:this})},get primaryPath(){return"id"},get primary(){return this.id},get $(){var e=this,r=Di(P0,this.parent);return e.parent.$.pipe(Qe(t=>t.documentId===this.primary),Qe(t=>t.isLocal),Ue(t=>Nf(t)),ai(r.docCache.getLatestDocumentData(this.primary)),Oa((t,n)=>t._rev===n._rev),Ue(t=>r.docCache.getCachedRxDocument(t)),Vi(Ki))},get $$(){var e=this,r=Bm(e),t=r.getReactivityFactory();return t.fromObservable(e.$,e.getLatest()._data,r)},get deleted$$(){var e=this,r=Bm(e),t=r.getReactivityFactory();return t.fromObservable(e.deleted$,e.getLatest().deleted,r)},getLatest(){var e=Di(P0,this.parent),r=e.docCache.getLatestDocumentData(this.primary);return e.docCache.getCachedRxDocument(r)},get(e){if(e="data."+e,!!this._data){if(typeof e!="string")throw fn("LD2",{objPath:e});var r=ga(this._data,e);return r=ft.deepFreezeWhenDevMode(r),r}},get$(e){if(e="data."+e,ft.isDevMode()){if(e.includes(".item."))throw Te("LD3",{objPath:e});if(e===this.primaryPath)throw Te("LD4")}return this.$.pipe(Ue(r=>r._data),Ue(r=>ga(r,e)),Oa())},get$$(e){var r=Bm(this),t=r.getReactivityFactory();return t.fromObservable(this.get$(e),this.getLatest().get(e),r)},incrementalModify(e){return Z(this,null,function*(){var r=yield qs(this.parent);return r.incrementalWriteQueue.addWrite(this._data,t=>Z(this,null,function*(){return t.data=yield e(t.data,this),t})).then(t=>r.docCache.getCachedRxDocument(t))})},incrementalPatch(e){return this.incrementalModify(r=>(Object.entries(e).forEach(([t,n])=>{r[t]=n}),r))},_saveData(e){return Z(this,null,function*(){var r=yield qs(this.parent),t=this._data;e.id=this.id;var n=[{previous:t,document:e}];return r.storageInstance.bulkWrite(n,"local-document-save-data").then(i=>{if(i.error[0])throw i.error[0];var a=Fr(this.collection.schema.primaryPath,n,i)[0];e=It(e),e._rev=a._rev})})},remove(){return Z(this,null,function*(){var e=yield qs(this.parent),r=It(this._data);return r._deleted=!0,wa(e.storageInstance,{previous:this._data,document:r},"local-document-remove").then(t=>e.docCache.getCachedRxDocument(t))})}},Jb=!1,C7=()=>{if(!Jb){Jb=!0;var e=Ks,r=Object.getOwnPropertyNames(e);r.forEach(n=>{var i=Object.getOwnPropertyDescriptor(Qc,n);if(!i){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(Qc,n,a)}});var t=n=>()=>{throw Te("LD6",{functionName:n})};["populate","update","putAttachment","getAttachment","allAttachments"].forEach(n=>Qc[n]=t(n))}};function eC(e,r){C7();var t=new b7(e.id,e,r);return Object.setPrototypeOf(t,Qc),t.prototype=Qc,t}function Bm(e){var r=e.parent;return ob(r)?r:r.database}var L0=new WeakMap,P0=new WeakMap;function Vm(e){var r=e.database?e.database:e,t=e.database?e.name:"",n=Z(this,null,function*(){var i=yield tC(r.token,r.storage,r.name,t,r.instanceCreationOptions,r.multiInstance);i=Qo(r,i,rC);var a=new v0("id",r.eventBulks$.pipe(Qe(u=>{var f=!1;return(t===""&&!u.collectionName||t!==""&&u.collectionName===t)&&(f=!0),f&&u.events[0].isLocal}),Ue(u=>u.events)),u=>eC(u,e)),s=new w0(i,"id",()=>{},()=>{}),o=yield r.storageToken,l=i.changeStream().subscribe(u=>{for(var f=new Array(u.events.length),h=u.events,d=e.database?e.name:void 0,g=0;g<h.length;g++){var v=h[g];f[g]={documentId:v.documentId,collectionName:d,isLocal:!0,operation:v.operation,documentData:ft.deepFreezeWhenDevMode(v.documentData),previousDocumentData:ft.deepFreezeWhenDevMode(v.previousDocumentData)}}var p={id:u.id,internal:!1,collectionName:e.database?e.name:void 0,storageToken:o,events:f,databaseToken:r.token,checkpoint:u.checkpoint,context:u.context,endTime:u.endTime,startTime:u.startTime};r.$emit(p)});e._subs.push(l);var c={database:r,parent:e,storageInstance:i,docCache:a,incrementalWriteQueue:s};return P0.set(e,c),c});L0.set(e,n)}function qs(e){var r=L0.get(e);if(!r){var t=e.database?e.database:e,n=e.database?e.name:"";throw Te("LD8",{database:t.name,collection:n})}return r}function tC(e,r,t,n,i,a){return r.createStorageInstance({databaseInstanceToken:e,databaseName:t,collectionName:E7(n),schema:rC,options:i,multiInstance:a,devMode:ft.isDevMode()})}function Um(e){var r=L0.get(e);if(r)return L0.delete(e),r.then(t=>t.storageInstance.close())}function $m(e,r,t){return Z(this,null,function*(){var n=Fi(10),i=yield tC(n,e,r,t,{},!1);yield i.remove()})}function E7(e){return"plugin-local-documents-"+e}var rC=Ja({title:"RxLocalDocument",version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:128},data:{type:"object",additionalProperties:!0}},required:["id","data"]});function Wm(e,r){return Z(this,null,function*(){var t=yield qs(this),n={id:e,data:r,_deleted:!1,_meta:Bn(),_rev:gr(),_attachments:{}};return wa(t.storageInstance,{document:n},"local-document-insert").then(i=>t.docCache.getCachedRxDocument(i))})}function Hm(e,r){return this.getLocal(e).then(t=>{if(t)return t.incrementalModify(()=>r);var n=this.insertLocal(e,r);return n})}function zm(e){return Z(this,null,function*(){var r=yield qs(this),t=r.docCache,n=t.getLatestDocumentDataIfExists(e);return n?Promise.resolve(t.getCachedRxDocument(n)):ya(r.storageInstance,e).then(i=>i?r.docCache.getCachedRxDocument(i):null)})}function jm(e){return this.$.pipe(ai(null),ir(r=>Z(this,null,function*(){if(r)return{changeEvent:r};var t=yield this.getLocal(e);return{doc:t}})),ir(r=>Z(this,null,function*(){if(r.changeEvent){var t=r.changeEvent;if(!t.isLocal||t.documentId!==e)return{use:!1};var n=yield this.getLocal(e);return{use:!0,doc:n}}else return{use:!0,doc:r.doc}})),Qe(r=>r.use),Ue(r=>r.doc))}var nC={name:"local-documents",rxdb:!0,prototypes:{RxCollection:e=>{e.insertLocal=Wm,e.upsertLocal=Hm,e.getLocal=zm,e.getLocal$=jm},RxDatabase:e=>{e.insertLocal=Wm,e.upsertLocal=Hm,e.getLocal=zm,e.getLocal$=jm}},hooks:{createRxDatabase:{before:e=>{e.creator.localDocuments&&Vm(e.database)}},createRxCollection:{before:e=>{e.creator.localDocuments&&Vm(e.collection)}},preDestroyRxDatabase:{after:e=>Um(e)},postDestroyRxCollection:{after:e=>Um(e)},postRemoveRxDatabase:{after:e=>$m(e.storage,e.databaseName,"")},postRemoveRxCollection:{after:e=>$m(e.storage,e.databaseName,e.collectionName)}},overwritable:{}};var S7=new WeakMap,T7={name:"migration-schema",rxdb:!0,init(){zc(nC)},hooks:{preDestroyRxDatabase:{after:Yb}},prototypes:{RxDatabase:e=>{e.migrationStates=function(){return Lm(this).pipe(Vi(Ki))}},RxCollection:e=>{e.getMigrationState=function(){return Rn(S7,this,()=>new Zb(this.asRxCollection,this.migrationStrategies))},e.migrationNeeded=function(){return this.schema.version===0?un:N0(this.getMigrationState())}}}},iC=T7;var I7=["__proto__","constructor","prototype"];function nl(e,r){Object.keys(r).forEach(t=>{I7.includes(t)||(typeof e[t]>"u"?e[t]=r[t]:il(r[t])?nl(e[t],r[t]):e[t]=r[t])})}function il(e){return e.toString()==="[object Object]"}var B0=function(){function e(t,n){if(this.options={},this._conditions={},this._fields={},this._path=n,t){var i=this;t.selector&&i.find(t.selector),t.limit&&i.limit(t.limit),t.skip&&i.skip(t.skip),t.sort&&t.sort.forEach(a=>i.sort(a))}}var r=e.prototype;return r.where=function(n,i){if(!arguments.length)return this;var a=typeof arguments[0];if(a==="string")return this._path=arguments[0],arguments.length===2&&(this._conditions[this._path]=arguments[1]),this;if(a==="object"&&!Array.isArray(arguments[0]))return this.merge(arguments[0]);throw fn("MQ1",{path:arguments[0]})},r.equals=function(n){this._ensurePath("equals");var i=this._path;return this._conditions[i]=n,this},r.eq=function(n){this._ensurePath("eq");var i=this._path;return this._conditions[i]=n,this},r.or=function(n){var i=this._conditions.$or||(this._conditions.$or=[]);return Array.isArray(n)||(n=[n]),i.push.apply(i,n),this},r.nor=function(n){var i=this._conditions.$nor||(this._conditions.$nor=[]);return Array.isArray(n)||(n=[n]),i.push.apply(i,n),this},r.and=function(n){var i=this._conditions.$and||(this._conditions.$and=[]);return Array.isArray(n)||(n=[n]),i.push.apply(i,n),this},r.mod=function(n,i){var a,s;arguments.length===1?(this._ensurePath("mod"),a=arguments[0],s=this._path):arguments.length===2&&!Array.isArray(arguments[1])?(this._ensurePath("mod"),a=arguments.slice(),s=this._path):arguments.length===3?(a=arguments.slice(1),s=arguments[0]):(a=arguments[1],s=arguments[0]);var o=this._conditions[s]||(this._conditions[s]={});return o.$mod=a,this},r.exists=function(n,i){var a,s;arguments.length===0?(this._ensurePath("exists"),a=this._path,s=!0):arguments.length===1?typeof arguments[0]=="boolean"?(this._ensurePath("exists"),a=this._path,s=arguments[0]):(a=arguments[0],s=!0):arguments.length===2&&(a=arguments[0],s=arguments[1]);var o=this._conditions[a]||(this._conditions[a]={});return o.$exists=s,this},r.elemMatch=function(n,i){if(arguments[0]===null)throw fn("MQ2");var a,s,o;if(typeof arguments[0]=="function")this._ensurePath("elemMatch"),s=this._path,a=arguments[0];else if(il(arguments[0]))this._ensurePath("elemMatch"),s=this._path,o=arguments[0];else if(typeof arguments[1]=="function")s=arguments[0],a=arguments[1];else if(arguments[1]&&il(arguments[1]))s=arguments[0],o=arguments[1];else throw fn("MQ2");a&&(o=new e,a(o),o=o._conditions);var l=this._conditions[s]||(this._conditions[s]={});return l.$elemMatch=o,this},r.sort=function(n){if(!n)return this;var i,a=typeof n;if(Array.isArray(n)){i=n.length;for(var s=0;s<n.length;++s)A7(this.options,n[s][0],n[s][1]);return this}if(arguments.length===1&&a==="string"){n=n.split(/\s+/),i=n.length;for(var o=0;o<i;++o){var l=n[o];if(l){var c=l[0]==="-"?-1:1;c===-1&&(l=l.substring(1)),aC(this.options,l,c)}}return this}if(il(n)){var u=Object.keys(n);return u.forEach(f=>aC(this.options,f,n[f])),this}throw fn("MQ3",{args:arguments})},r.merge=function(n){if(!n)return this;if(!sC(n))throw fn("MQ4",{source:n});return n instanceof e?(n._conditions&&nl(this._conditions,n._conditions),n._fields&&(this._fields||(this._fields={}),nl(this._fields,n._fields)),n.options&&(this.options||(this.options={}),nl(this.options,n.options)),n._distinct&&(this._distinct=n._distinct),this):(nl(this._conditions,n),this)},r.find=function(n){return sC(n)&&this.merge(n),this},r._ensurePath=function(n){if(!this._path)throw Te("MQ5",{method:n})},r.toJSON=function(){var n={selector:this._conditions};return this.options.skip&&(n.skip=this.options.skip),this.options.limit&&(n.limit=this.options.limit),this.options.sort&&(n.sort=k7(this.options.sort)),{query:n,path:this._path}},e}();function k7(e){return Object.entries(e).map(([r,t])=>{var n=t===1?"asc":"desc",i={[r]:n};return i})}var Gm=["limit","skip","maxScan","batchSize","comment"];Gm.forEach(function(e){B0.prototype[e]=function(r){return this.options[e]=r,this}});var Km=["gt","gte","lt","lte","ne","in","nin","all","regex","size"];Km.forEach(function(e){B0.prototype[e]=function(){var r,t;arguments.length===1?(this._ensurePath(e),t=arguments[0],r=this._path):(t=arguments[1],r=arguments[0]);var n=this._conditions[r]===null||typeof this._conditions[r]=="object"?this._conditions[r]:this._conditions[r]={};if(e==="regex"){if(t instanceof RegExp)throw Te("QU16",{field:r,query:this._conditions});typeof t=="string"?n["$"+e]=t:(n["$"+e]=t.$regex,t.$options&&(n.$options=t.$options))}else n["$"+e]=t;return this}});function aC(e,r,t){if(Array.isArray(e.sort))throw fn("MQ6",{opts:e,field:r,value:t});if(t&&t.$meta){var n=e.sort||(e.sort={});n[r]={$meta:t.$meta};return}var i=String(t||1).toLowerCase();if(!/^(?:ascending|asc|descending|desc|1|-1)$/.test(i))throw Array.isArray(t)&&(t="["+t+"]"),fn("MQ7",{field:r,value:t});var a=e.sort||(e.sort={}),s=t.toString().replace("asc","1").replace("ascending","1").replace("desc","-1").replace("descending","-1");a[r]=parseInt(s,10)}function A7(e,r,t){if(e.sort=e.sort||[],!Array.isArray(e.sort))throw fn("MQ8",{opts:e,field:r,value:t});e.sort.push([r,t])}function sC(e){return e instanceof B0||il(e)}function oC(e,r){return new B0(e,r)}var lC="queryBuilderPath";function O7(e,r,t){var n=oC(cr(e.mangoQuery),e.other[lC]);n[r](t);var i=n.toJSON();return ts(e.op,i.query,e.collection,ze(ie({},e.other),{[lC]:i.path}))}function qm(e,r){e[r]=function(t){if(ft.isDevMode()&&this.op==="findByIds")throw Te("QU17",{collection:this.collection.name,query:this.mangoQuery});return O7(this,r,t)}}var cC={name:"query-builder",rxdb:!0,prototypes:{RxQuery(e){["where","equals","eq","or","nor","and","mod","exists","elemMatch","sort"].forEach(r=>{qm(e,r)}),Gm.forEach(r=>{qm(e,r)}),Km.forEach(r=>{qm(e,r)})}}};zc(iC);zc(cC);var is=class e{constructor(){this._mainDb$.subscribe(r=>this._handle_main_db_created(r)),this.init().then(()=>console.log(`rx database initialized in ${this.uid}`))}uid=so();_mainDb$=new os(1);mainDb;mainDbName="mainDb";collectionMetadata={characterQA:{name:"character-qa-main",schema:Sy}};_handle_main_db_created(r){this.mainDb=r}init(){return Z(this,null,function*(){let r=yield sb({name:this.mainDbName,storage:Gb(),ignoreDuplicate:!0,eventReduce:!0,multiInstance:!0});yield r.addCollections({[this.collectionMetadata.characterQA.name]:{schema:this.collectionMetadata.characterQA.schema}}),this._mainDb$.next(r)})}create_collection(r,t){return Z(this,null,function*(){return yield en(this._mainDb$).then(i=>i.addCollections({[t]:{schema:r}}))})}get_main_db(){return Z(this,null,function*(){return yield en(this._mainDb$)})}get_collection(r){return Z(this,null,function*(){return yield en(this._mainDb$).then(n=>n[r])})}clear_collection(r){return Z(this,null,function*(){yield en(this._mainDb$).then(t=>t[r].find().remove())})}delete_collection(r){return Z(this,null,function*(){yield en(this._mainDb$).then(t=>t[r].remove())})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=dt({token:e,factory:e.\u0275fac,providedIn:"root"})};var F7=(e,r)=>r.dbKey;function D7(e,r){if(e&1){let t=nt();ue(0,"p-divider"),z(1,"div",4)(2,"div",5)(3,"label",6),Ct(4,"\u5DE5\u4F5C\u7C3F "),j(),z(5,"p-dropdown",7,1),pl("ngModelChange",function(i){_e(t);let a=P();return dl(a.currentXlsFile.primarySheetName,i)||(a.currentXlsFile.primarySheetName=i),xe(i)}),Pe("onChange",function(i){_e(t);let a=sr(6),s=P();return xe(s.ui_dropdown_select_sheet(i,a))}),j()()()}if(e&2){let t=P();S(5),b("options",t.currentXlsFile.get_sheet_names()),hl("ngModel",t.currentXlsFile.primarySheetName)}}function R7(e,r){if(e&1){let t=nt();z(0,"div",5)(1,"label",6),Ct(2),j(),z(3,"p-dropdown",12,2),pl("ngModelChange",function(i){let a=_e(t).$implicit;return dl(a.mapToHeader,i)||(a.mapToHeader=i),xe(i)}),Pe("onChange",function(i){let a=_e(t).$implicit,s=sr(4),o=P(2);return xe(o.ui_dropdown_select_dbkey_to_header(i,s,a))}),j()()}if(e&2){let t=r.$implicit,n=P(2);S(2),Ma("",t.description," "),S(),hl("ngModel",t.mapToHeader),b("options",n.xlsHeaders)("styleClass",n.ui_dropdown_select_dbkey_to_header_style_class(t))}}function M7(e,r){if(e&1){let t=nt();ue(0,"p-divider"),z(1,"div",4)(2,"p-button",8),Pe("onClick",function(i){_e(t);let a=P();return xe(a.ui_btn_auto_match_dbkey_header(i))}),j(),z(3,"p-button",9),Pe("onClick",function(i){_e(t);let a=P();return xe(a.ui_btn_reset_dbkey_to_header(i))}),j(),z(4,"p-button",10),Pe("onClick",function(){_e(t);let i=P();return xe(i.ui_btn_upload_on_parse())}),j()(),ue(5,"p-divider"),z(6,"div",11),su(7,R7,5,4,"div",5,F7),j()}if(e&2){let t=P();S(7),ou(t.ui_get_db_entries())}}var Yc=class e{constructor(r,t,n){this.http=r;this.coreDb=t;this.messageService=n;let i=this.coreDb.collectionMetadata.characterQA.schema.properties;this.dbCollectionName=this.coreDb.collectionMetadata.characterQA.name,Object.entries(i).sort((a,s)=>a[1].importance!=s[1].importance?s[1].importance-a[1].importance:a[0].localeCompare(s[0])).forEach(([a,s])=>{let o=new yf({dbKey:a,title:s.title,importance:s.importance,description:s.description});a!="uid"&&this.dbKeyProps.set(a,o)})}xlsFile$=new os(1);xlsHeaders=[];fakeOptions=[{name:"xxx",value:0},{name:"yyy",value:1},{name:"zzz",value:2}];dbKeyProps=new Map;currentXlsFile;dbCollectionName;dbCollection;ui_dropdown_select_dbkey_to_header_style_class(r){let t=["w-22rem"];return r&&r.mapToHeader?t.push("bg-green-100"):t.push("bg-gray-300"),t.join(" ")}ui_dropdown_select_dbkey_to_header(r,t,n){if(r.value!==null)for(let[i,a]of this.dbKeyProps.entries())a!==n&&a.mapToHeader&&a.mapToHeader===r.value&&(a.mapToHeader=void 0)}ui_dropdown_select_sheet(r,t){if(!this.currentXlsFile){console.error("currentXlsFile is not set");return}let n=new xc(ze(ie({},this.currentXlsFile),{primarySheetName:r.value}));this.xlsFile$.next(n)}ui_get_db_entries(){return Array.from(this.dbKeyProps.values())}ui_btn_auto_match_dbkey_header(r){if(!this.currentXlsFile||!this.currentXlsFile.header2colIndex)throw new Error("currentXlsFile is not properly setup");let t=Array.from(this.dbKeyProps.values()).map(a=>a.title),n=Array.from(this.currentXlsFile.header2colIndex.keys()),i=Ux(t,n);for(let[a,s]of this.dbKeyProps.entries()){let o=i.dbkey2header.get(s.title),l=i.dbkey2headerIndex.get(s.title);o&&l!==void 0?s.mapToHeader=this.xlsHeaders.find(c=>c.name===o):s.mapToHeader=void 0}}ui_btn_upload_on_select(r){let t=r.currentFiles[0],n=new FileReader;n.onload=i=>{let a=i.target?.result,s=this.load_excel_from_buf(a);this.xlsFile$.next(s)},n.readAsArrayBuffer(t)}ui_btn_upload_on_parse(){if(!(!this.currentXlsFile||!this.currentXlsFile.primarySheetName)){if(!Array.from(this.dbKeyProps.values()).some(r=>r.mapToHeader)){this.messageService.add({severity:"error",summary:"Error",detail:"\u672A\u6307\u5B9A\u4EFB\u4F55\u5217\u542B\u4E49"});return}this._update_db_by_xls().then(r=>Z(this,null,function*(){let t=yield r.count().exec();console.debug(`number of documents in collection: ${t}`),this.messageService.add({severity:"success",summary:"Success",detail:`\u6210\u529F\u5BFC\u5165 ${t} \u6761\u8BB0\u5F55`})}),r=>{console.error("update failed: ",r),this.messageService.add({severity:"error",summary:"Error",detail:`\u5BFC\u5165\u5931\u8D25: ${r}`})}).then()}}ui_btn_upload_on_clear(r,t){this.currentXlsFile=void 0,this.coreDb.clear_collection(this.dbCollectionName).then()}ui_btn_reset_dbkey_to_header(r){for(let[t,n]of this.dbKeyProps.entries())n.mapToHeader=void 0}load_excel_from_buf(r){let t=Es(r,{type:"array"});return new xc({workbook:t})}_update_db_by_xls(){return Z(this,null,function*(){let r=this.coreDb.collectionMetadata.characterQA.name;return yield this.coreDb.clear_collection(r).then(()=>Z(this,null,function*(){return yield this._write_current_xls_to_db()})),this.coreDb.get_collection(r)})}_write_current_xls_to_db(){return Z(this,null,function*(){if(!this.currentXlsFile)throw new Error("currentXlsFile is not set");if(!this.currentXlsFile.header2colIndex)throw new Error("header not parsed yet");let r=this.currentXlsFile.get_primary_sheet(),t=this.get_rows_with_merged_cells(r),n=this.coreDb.collectionMetadata.characterQA.name,i=yield this.coreDb.get_collection(n);if(!i)throw new Error(`collection ${n} not found`);let a=Rs.decode_range(r["!ref"]);for(let s=a.s.r+1;s<=a.e.r;++s){if(t.has(s))continue;let o={};for(let[l,c]of this.dbKeyProps.entries()){if(!c.mapToHeader)continue;let u=c.mapToHeader.index,f=Rs.encode_cell({r:s,c:u}),h=r[f];o[l]=h?h.v:null}"caseIndex"in o||(o.caseIndex=s+1),o.uid=so();try{let l=yield i.insert(o)}catch(l){console.error("insert failed: ",l)}}})}get_rows_with_merged_cells(r){let t=new Map,n=Rs.decode_range(r["!ref"]);for(let i of r["!merges"]||[]){let a=i.s,s=i.e;t.set(a.r,{col_begin:a.c,col_end:s.c})}return t}_register_xlsfile_event(){this.xlsFile$.subscribe(r=>{this.currentXlsFile=r,r.parse_headers();for(let[n,i]of this.dbKeyProps.entries())i.mapToHeader=void 0;let t=[];if(r.header2colIndex)for(let[n,i]of r.header2colIndex.entries()){let a={name:n,index:i};t.push(a)}this.xlsHeaders=t})}ngOnInit(){this.coreDb.get_main_db().then(r=>Z(this,null,function*(){this.dbCollection=yield this.coreDb.get_collection(this.coreDb.collectionMetadata.characterQA.name)})),this._register_xlsfile_event()}static \u0275fac=function(t){return new(t||e)(ce(xl),ce(is),ce(Ba))};static \u0275cmp=Fe({type:e,selectors:[["app-open-data"]],standalone:!0,features:[ta([Ba]),ot],decls:6,vars:3,consts:[["xlsUpload",""],["selectSheet",""],["selectDbkeyToHeader",""],["mode","advanced","accept",".xlsx,.xls,.csv","uploadLabel","\u8F7D\u5165\u6570\u636E","cancelLabel","\u6E05\u7A7A","chooseLabel","\u6253\u5F00\u6587\u4EF6","customUpload","true",3,"uploadHandler","onSelect","onClear","onRemove","showUploadButton"],[1,"flex","flex-row","w-full"],[1,"flex","flex-column","m-2"],[1,"text-base","text-left","text-primary","border-round","p-2","mb-2","bg-primary","w-22rem"],[3,"ngModelChange","onChange","options","ngModel"],["label","\u81EA\u52A8\u5206\u914D\u5404\u5217\u542B\u4E49","severity","help",1,"p-2",3,"onClick"],["label","\u91CD\u7F6E\u5404\u5217\u542B\u4E49","severity","secondary",1,"p-2",3,"onClick"],["label","\u8F7D\u5165\u6587\u4EF6","severity","success",1,"p-2",3,"onClick"],[1,"flex","flex-row","flex-wrap","w-full"],["optionLabel","name","showClear","true",3,"ngModelChange","onChange","ngModel","options","styleClass"]],template:function(t,n){if(t&1){let i=nt();z(0,"div"),ue(1,"p-toast"),z(2,"p-fileUpload",3,0),Pe("uploadHandler",function(){return _e(i),xe(n.ui_btn_upload_on_parse())})("onSelect",function(s){return _e(i),xe(n.ui_btn_upload_on_select(s))})("onClear",function(s){_e(i);let o=sr(3);return xe(n.ui_btn_upload_on_clear(s,o))})("onRemove",function(s){_e(i);let o=sr(3);return xe(n.ui_btn_upload_on_clear(s,o))}),j()(),Y(4,D7,7,2)(5,M7,9,0)}t&2&&(S(2),b("showUploadButton",!1),S(2),ah(n.currentXlsFile?4:-1),S(),ah(n.currentXlsFile&&n.currentXlsFile.primarySheetName?5:-1))},dependencies:[Et,dy,uy,Sc,Ns,Ms,Kx,Gx,bf,Af,kf,xy,wp,Cy,by],styles:[".text-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-weight:700;background-color:var(--primary-color);color:#fff;border-radius:var(--border-radius);margin:.5rem;padding:.5rem}"]})};var uC="w-8rem",Ym="text-sm",fC="text-base";var hC=`m-1 w-5rem bg-red-400 ${Ym}`,Xs={div:{columnWidth:"w-full"},combinedPrompt:{maxNumRows:5*3},promptBlock:{default:{numRows:5,numCols:35,numColsExpanded:50},SingleEntry:{button:{add:`m-1 ${uC} bg-primary ${fC}`,delete:hC},textarea:{numRows:5,numColsTemplate:35,numColsInstantiated:50,fontSize:`${Ym}`,bgColor:"bg-blue-100"}},ForEachEntry:{button:{add:`m-1 ${uC} bg-green-400 ${fC}`,delete:hC},textarea:{numRows:5,numColsTemplate:35,numColsInstantiated:50,fontSize:`${Ym}`,bgColor:"bg-green-100"}}}};var U0={promptUpdateIntervalMs:100,dbUpdateIntervalMs:100},Zm=(t=>(t.SingleEntry="SingleEntry",t.ForEachEntry="ForEachEntry",t))(Zm||{}),V0=class{uid=so();enabled=!0;uiProps;finalString=Sr(void 0);_indexedInstArgs;_indexKey;_error={invokeError:"\u89E3\u6790\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u6A21\u677F\u53C2\u6570\u540D\u662F\u5426\u6B63\u786E",templateError:"\u6A21\u677F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u6A21\u677F\u683C\u5F0F\u662F\u5426\u6B63\u786E"};constructor(r){if(Object.assign(this,r),this.templateObject||(this.templateObject=uh.fromTemplate(this.templateString)),this.kind=="SingleEntry"){let t=Xs.promptBlock.SingleEntry;this.uiProps=ie({},t)}else if(this.kind=="ForEachEntry"){let t=Xs.promptBlock.ForEachEntry;this.uiProps=ie({},t)}else throw new Error("PromptBlock: unknown kind")}set_instantiate_args(r,t){if(r){this.instantiateArgs=[...r],this._indexedInstArgs={key:"_indexedInstArgs",data:{}},this._indexKey=t;for(let n=0;n<r.length;n++){let i=r[n].data;for(let a in i){let s=n;if(this._indexKey&&this._indexKey in i){let o=parseInt(i[this._indexKey]);isNaN(o)||(s=o)}this._indexedInstArgs.data[`${a}:${s}`]=i[a]}}}else this.instantiateArgs=void 0,this._indexedInstArgs=void 0}set_template_string(r){this.templateString=r;try{let t=uh.fromTemplate(this.templateString);this.templateObject=t}catch{}}instantiate_by_assignment(){return Z(this,null,function*(){if(!this.templateObject)return;let r;if(this.kind==="SingleEntry"&&this._indexedInstArgs?r=[this._indexedInstArgs]:this.kind==="ForEachEntry"&&this.instantiateArgs&&(r=this.instantiateArgs),!r)return;let t=[];for(let n of r)try{let i=yield this.templateObject.invoke(n.data);t.push(i.toString())}catch{t.push(this._error.invokeError)}return this.finalString.set(t.join(`
`)),t})}};var dC=(()=>{class e{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new Be;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(t,n,i,a,s){this.el=t,this.ngModel=n,this.control=i,this.cd=a,this.config=s}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(t){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(t){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(t||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||e)(ce(qt),ce(Sc,8),ce(Ps,8),ce(hr),ce(an))};static \u0275dir=Mr({type:e,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(n,i){n&1&&Pe("input",function(s){return i.onInput(s)}),n&2&&Ra("p-filled",i.filled)("p-inputtextarea-resizable",i.autoResize)("p-variant-filled",i.variant==="filled"||i.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",Se],variant:"variant"},outputs:{onResize:"onResize"},features:[Qt]})}return e})(),pC=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et]})}return e})();var mC=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr]})}return e})();var L7=["*",[["p-header"]],[["p-footer"]]],B7=["*","p-header","p-footer"];function V7(e,r){e&1&&st(0)}function U7(e,r){if(e&1&&(z(0,"div",8),xr(1,1),Y(2,V7,1,0,"ng-container",6),j()),e&2){let t=P();S(2),b("ngTemplateOutlet",t.headerTemplate)}}function $7(e,r){e&1&&st(0)}function W7(e,r){if(e&1&&(z(0,"div",9),Ct(1),Y(2,$7,1,0,"ng-container",6),j()),e&2){let t=P();S(),Ma(" ",t.header," "),S(),b("ngTemplateOutlet",t.titleTemplate)}}function H7(e,r){e&1&&st(0)}function z7(e,r){if(e&1&&(z(0,"div",10),Ct(1),Y(2,H7,1,0,"ng-container",6),j()),e&2){let t=P();S(),Ma(" ",t.subheader," "),S(),b("ngTemplateOutlet",t.subtitleTemplate)}}function j7(e,r){e&1&&st(0)}function G7(e,r){e&1&&st(0)}function K7(e,r){if(e&1&&(z(0,"div",11),xr(1,2),Y(2,G7,1,0,"ng-container",6),j()),e&2){let t=P();S(2),b("ngTemplateOutlet",t.footerTemplate)}}var gC=(()=>{class e{el;header;subheader;set style(t){Je.equals(this._style(),t)||this._style.set(t)}styleClass;headerFacet;footerFacet;templates;headerTemplate;titleTemplate;subtitleTemplate;contentTemplate;footerTemplate;_style=Sr(null);constructor(t){this.el=t}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"title":this.titleTemplate=t.template;break;case"subtitle":this.subtitleTemplate=t.template;break;case"content":this.contentTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}getBlockableElement(){return this.el.nativeElement.children[0]}static \u0275fac=function(n){return new(n||e)(ce(qt))};static \u0275cmp=Fe({type:e,selectors:[["p-card"]],contentQueries:function(n,i,a){if(n&1&&(ar(a,tv,5),ar(a,rv,5),ar(a,mr,4)),n&2){let s;je(s=Ge())&&(i.headerFacet=s.first),je(s=Ge())&&(i.footerFacet=s.first),je(s=Ge())&&(i.templates=s)}},hostAttrs:[1,"p-element"],inputs:{header:"header",subheader:"subheader",style:"style",styleClass:"styleClass"},ngContentSelectors:B7,decls:9,vars:10,consts:[[3,"ngClass","ngStyle"],["class","p-card-header",4,"ngIf"],[1,"p-card-body"],["class","p-card-title",4,"ngIf"],["class","p-card-subtitle",4,"ngIf"],[1,"p-card-content"],[4,"ngTemplateOutlet"],["class","p-card-footer",4,"ngIf"],[1,"p-card-header"],[1,"p-card-title"],[1,"p-card-subtitle"],[1,"p-card-footer"]],template:function(n,i){n&1&&(Pr(L7),z(0,"div",0),Y(1,U7,3,1,"div",1),z(2,"div",2),Y(3,W7,3,2,"div",3)(4,z7,3,2,"div",4),z(5,"div",5),xr(6),Y(7,j7,1,0,"ng-container",6),j(),Y(8,K7,3,1,"div",7),j()()),n&2&&(Ve(i.styleClass),b("ngClass","p-card p-component")("ngStyle",i._style()),ee("data-pc-name","card"),S(),b("ngIf",i.headerFacet||i.headerTemplate),S(2),b("ngIf",i.header||i.titleTemplate),S(),b("ngIf",i.subheader||i.subtitleTemplate),S(3),b("ngTemplateOutlet",i.contentTemplate),S(),b("ngIf",i.footerFacet||i.footerTemplate))},dependencies:[dr,yr,wr,or],styles:[`@layer primeng{.p-card-header img{width:100%}}
`],encapsulation:2,changeDetection:0})}return e})(),vC=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ut({type:e});static \u0275inj=ct({imports:[Et,lr]})}return e})();var X7=(e,r)=>r().uid,Q7=()=>({"box-sizing":"border-box"}),Y7=()=>({resize:"none"});function Z7(e,r){if(e&1){let t=nt();z(0,"div",null,4)(2,"div")(3,"p-button",16),Pe("onClick",function(i){let a=_e(t).$implicit,s=P();return xe(s.ui_remove_prompt_block(i,a()))}),j()(),z(4,"div",17,5)(6,"textarea",18,6),Pe("input",function(i){let a=_e(t).$implicit,s=sr(7),o=P();return xe(o.ui_template_change(i,s,a()))}),Ct(8,"            "),j()(),z(9,"div",19,7)(11,"textarea",20,8),Ct(13,"            "),j()()()}if(e&2){let t,n,i,a,s,o=r.$implicit,l=P();ih("flex flex-row w-full mb-2 border-round-lg ",(t=o().uiProps)==null||t.textarea==null?null:t.textarea.bgColor,""),S(3),lu("styleClass",l._presetStyles.promptBlock.SingleEntry.button.delete),S(),b("ngStyle",fs(13,Q7)),S(2),b("rows",(n=o().uiProps)==null||n.textarea==null?null:n.textarea.numRows)("cols",(i=o().uiProps)==null||i.textarea==null?null:i.textarea.numColsTemplate)("value",o().templateString),ee("item",o),S(5),b("rows",(a=o().uiProps)==null||a.textarea==null?null:a.textarea.numRows)("cols",(s=o().uiProps)==null||s.textarea==null?null:s.textarea.numColsInstantiated)("value",o().finalString())("ngStyle",fs(14,Y7))}}var Zc=class e{constructor(r){this.coreDb=r;let t=r.collectionMetadata.characterQA.schema;this.dbCollectionName=r.collectionMetadata.characterQA.name,this.dbCollectionFieldNames=Object.keys(t.properties),this.dbCollectionSortKey="caseIndex",this._register_prompt_creation_events(),this._register_prompt_update_event(),this._register_db_update_event(),this._register_instantiate_args_update_event()}dbCollectionName;dbCollectionFieldNames;dbCollectionSortKey;_presetStyles=Xs;_PromptKindType=Zm;$promptBlocks=Sr([]);$_uiCombinedPromptString=si(()=>{let r=this.$promptBlocks();return r.length===0?"":r.map(i=>i().finalString()).join(`
`)});$_uiCombinedPromptNumLines=si(()=>{let r=this.$_uiCombinedPromptString().match(/\r?\n/g),t=r?r.length:0;return t<=Xs.combinedPrompt.maxNumRows?t:Xs.combinedPrompt.maxNumRows});_requestPromptCreation$=new Rt;_requestInstantiatePromptFast$=new Rt;_requestInstantiatePromptSlow$=new Rt;evtInstantiatePrompt$=Qs(this._requestInstantiatePromptFast$,this._requestInstantiatePromptSlow$.pipe(ru(U0.promptUpdateIntervalMs,void 0,{leading:!0,trailing:!0})));_notifyDbColUpdateFast$=new os(1);_notifyDbColUpdateSlow$=new os(1);evtDbColUpdated$=Qs(this._notifyDbColUpdateFast$,this._notifyDbColUpdateSlow$.pipe(ru(U0.dbUpdateIntervalMs,void 0,{leading:!0,trailing:!0})));_promptInstArgs=new Map;_requestInstArgsUpdateFast$=new Rt;_requestInstArgsUpdateSlow$=new Rt;evtInstArgsUpdated$=Qs(this._requestInstArgsUpdateFast$,this._requestInstArgsUpdateSlow$.pipe(ru(U0.promptUpdateIntervalMs,void 0,{leading:!0,trailing:!0})));ui_textarea_resize_and_sync(r,t,n){}ui_template_change(r,t,n){n.set_template_string(t.value),this._requestInstantiatePromptSlow$.next(n)}ui_add_prompt_block(r,t){this.add_prompt_block(t)}ui_remove_prompt_block(r,t){this.remove_prompt_block(t)}remove_prompt_block(r){this.$promptBlocks.update(t=>{let n=t.findIndex(i=>i().uid===r.uid);return n>-1&&t.splice(n,1),[...t]})}add_prompt_block(r,t=""){let n=new V0({templateString:t,kind:r});this._requestPromptCreation$.next(n);let i=Array.from(this._promptInstArgs.entries()).map(([a,s])=>({key:a,data:s}));return n.set_instantiate_args(i,this.dbCollectionSortKey),this._requestInstantiatePromptFast$.next(n),n}_register_prompt_creation_events(){this._requestPromptCreation$.subscribe(r=>{this.$promptBlocks.update(t=>{let n=Sr(r);return[...t,n]}),this._requestInstantiatePromptFast$.next(r)})}_register_prompt_update_event(){this.evtInstantiatePrompt$.pipe(mn(r=>Z(this,null,function*(){return yield r.instantiate_by_assignment().catch(t=>{}),r}))).subscribe(r=>{this.$promptBlocks().forEach(t=>{t().uid===r.uid&&t.update(()=>r)})})}_register_db_update_event(){this.evtDbColUpdated$.subscribe(r=>{switch(r.operation){case"INSERT":case"UPDATE":{let t={};for(let n of this.dbCollectionFieldNames){let i=r.documentData[n];i?t[n]=i:t[n]="<UNKNOWN>"}this._promptInstArgs.set(r.documentId,t);break}case"DELETE":{this._promptInstArgs.delete(r.documentId);break}}}),this.coreDb.get_collection(this.dbCollectionName).then(r=>{r.$.subscribe(t=>{this._notifyDbColUpdateFast$.next(t)})})}_register_instantiate_args_update_event(){this.evtDbColUpdated$.subscribe(r=>{this._requestInstArgsUpdateFast$.next(this._promptInstArgs)}),this.evtInstArgsUpdated$.subscribe(r=>{let t=Array.from(r.entries()).map(([n,i])=>({key:n,data:i}));this.$promptBlocks().forEach(n=>{n.update(i=>(i.set_instantiate_args(t,this.dbCollectionSortKey),i)),this._requestInstantiatePromptFast$.next(n())})})}static \u0275fac=function(t){return new(t||e)(ce(is))};static \u0275cmp=Fe({type:e,selectors:[["app-prompt-creation"]],standalone:!0,features:[ot],decls:18,vars:8,consts:[["mainArea",""],["promptTemplateControl",""],["promptArea",""],["combinedPromptOutput",""],["promptAreaOne",""],["promptTemplateArea",""],["templateInput",""],["promptInstantiateArea",""],["templateOutput",""],[1,"flex","flex-column","w-full"],["label","+\u56FA\u5B9A\u6A21\u677F",3,"onClick","styleClass"],["label","+\u52A8\u6001\u6A21\u677F",3,"onClick","styleClass"],["header","\u6A21\u677F"],[3,"class"],["header","\u6700\u7EC8\u9898\u8BCD"],["pInputTextarea","",1,"w-full",3,"cols","rows","value"],["label","\u5220\u9664",3,"onClick","styleClass"],[1,"flex","m-1","w-full",3,"ngStyle"],["pInputTextarea","",1,"w-full",3,"input","rows","cols","value"],[1,"flex","w-full","m-1"],["pInputTextarea","",1,"h-full","w-full",3,"rows","cols","value","ngStyle"]],template:function(t,n){if(t&1){let i=nt();z(0,"div",9,0)(2,"div",null,1)(4,"p-button",10),Pe("onClick",function(s){return _e(i),xe(n.ui_add_prompt_block(s,n._PromptKindType.SingleEntry))}),j(),z(5,"p-button",11),Pe("onClick",function(s){return _e(i),xe(n.ui_add_prompt_block(s,n._PromptKindType.ForEachEntry))}),j()(),ue(6,"p-divider"),z(7,"div",9,2)(9,"p-card",12)(10,"div"),su(11,Z7,14,15,"div",13,X7),j()(),ue(13,"p-divider"),z(14,"p-card",14)(15,"textarea",15,3),Ct(17,"      "),j()()()()}t&2&&(S(2),ih("flex flex-row ",n._presetStyles.div.columnWidth,""),S(2),lu("styleClass",n._presetStyles.promptBlock.SingleEntry.button.add),S(),lu("styleClass",n._presetStyles.promptBlock.ForEachEntry.button.add),S(6),ou(n.$promptBlocks()),S(4),b("cols",n._presetStyles.promptBlock.default.numCols)("rows",n.$_uiCombinedPromptNumLines())("value",n.$_uiCombinedPromptString()))},dependencies:[Et,or,Ns,Ms,pC,dC,mC,bf,Af,kf,vC,gC]})};var Jc=class e{constructor(r){this.cdr=r}openDataComponent;promptCreationComponent;tabView;ngAfterViewInit(){}ngOnInit(){}static \u0275fac=function(t){return new(t||e)(ce(hr))};static \u0275cmp=Fe({type:e,selectors:[["app-table-prompt"]],viewQuery:function(t,n){if(t&1&&(At(Yc,5),At(Zc,5),At(zl,5)),t&2){let i;je(i=Ge())&&(n.openDataComponent=i.first),je(i=Ge())&&(n.promptCreationComponent=i.first),je(i=Ge())&&(n.tabView=i.first)}},standalone:!0,features:[ot],decls:5,vars:0,consts:[["header","\u6587\u4EF6\u7BA1\u7406"],["header","Prompt\u751F\u6210"]],template:function(t,n){t&1&&(z(0,"p-tabView")(1,"p-tabPanel",0),ue(2,"app-open-data"),j(),z(3,"p-tabPanel",1),ue(4,"app-prompt-creation"),j()())},dependencies:[Et,Yc,Zc,av,zl,ud]})};var _C=[{path:"",component:Jc},{path:"table-prompt",component:Jc}];var J7="@",eB=(()=>{let r=class r{constructor(n,i,a,s,o){this.doc=n,this.delegate=i,this.zone=a,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=$e(Ig,{optional:!0}),this.loadingSchedulerFn=$e(tB,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let n=()=>this.moduleImpl??import("./chunk-XHYARZP2.js").then(a=>a),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(n):i=n(),i.catch(a=>{throw new Jt(5300,!1)}).then(({\u0275createEngine:a,\u0275AnimationRendererFactory:s})=>{this._engine=a(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(n,i){let a=this.delegate.createRenderer(n,i);if(a.\u0275type===0)return a;typeof a.throwOnSyntheticProps=="boolean"&&(a.throwOnSyntheticProps=!1);let s=new Jm(a);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let l=o.createRenderer(n,i);s.use(l),this.scheduler?.notify(10)}).catch(o=>{s.use(a)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};r.\u0275fac=function(i){rh()},r.\u0275prov=dt({token:r,factory:r.\u0275fac});let e=r;return e})(),Jm=class{constructor(r){this.delegate=r,this.replay=[],this.\u0275type=1}use(r){if(this.delegate=r,this.replay!==null){for(let t of this.replay)t(r);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(r,t){return this.delegate.createElement(r,t)}createComment(r){return this.delegate.createComment(r)}createText(r){return this.delegate.createText(r)}get destroyNode(){return this.delegate.destroyNode}appendChild(r,t){this.delegate.appendChild(r,t)}insertBefore(r,t,n,i){this.delegate.insertBefore(r,t,n,i)}removeChild(r,t,n){this.delegate.removeChild(r,t,n)}selectRootElement(r,t){return this.delegate.selectRootElement(r,t)}parentNode(r){return this.delegate.parentNode(r)}nextSibling(r){return this.delegate.nextSibling(r)}setAttribute(r,t,n,i){this.delegate.setAttribute(r,t,n,i)}removeAttribute(r,t,n){this.delegate.removeAttribute(r,t,n)}addClass(r,t){this.delegate.addClass(r,t)}removeClass(r,t){this.delegate.removeClass(r,t)}setStyle(r,t,n,i){this.delegate.setStyle(r,t,n,i)}removeStyle(r,t,n){this.delegate.removeStyle(r,t,n)}setProperty(r,t,n){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(r,t,n)),this.delegate.setProperty(r,t,n)}setValue(r,t){this.delegate.setValue(r,t)}listen(r,t,n){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(r,t,n)),this.delegate.listen(r,t,n)}shouldReplay(r){return this.replay!==null&&r.startsWith(J7)}},tB=new Kt("");function xC(e="animations"){return nh("NgAsyncAnimations"),cs([{provide:au,useFactory:(r,t,n)=>new eB(r,t,n,e),deps:[Ut,bu,fr]},{provide:vg,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var yC={providers:[Pg({eventCoalescing:!0}),Q1(_C),r1(),xC()]};var $0=class e{constructor(r){this.coreDatabaseService=r}title="sim-character";static \u0275fac=function(t){return new(t||e)(ce(is))};static \u0275cmp=Fe({type:e,selectors:[["app-root"]],standalone:!0,features:[ot],decls:2,vars:0,template:function(t,n){t&1&&(z(0,"section"),ue(1,"router-outlet"),j())},dependencies:[rd]})};f1($0,yC).catch(e=>console.error(e));
